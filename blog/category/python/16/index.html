

<!doctype html>
<!--[if lt IE 7 ]> <html lang="en" class="no-js ie6"> <![endif]-->
<!--[if IE 7 ]>    <html lang="en" class="no-js ie7"> <![endif]-->
<!--[if IE 8 ]>    <html lang="en" class="no-js ie8"> <![endif]-->
<!--[if IE 9 ]>    <html lang="en" class="no-js ie9"> <![endif]-->
<!--[if (gt IE 9)|!(IE)]><!--> <html lang="en" class="no-js"> <!--<![endif]-->
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>The Kitchin Research Group: python</title>
  <meta name="google-site-verification" content="CGcacJdHc2YoZyI0Vey9XRA5qwhhFDzThKJezbRFcJ4" />
  <meta name="description" content="Chemical Engineering at Carnegie Mellon University">
  <meta name="author" content="John Kitchin">
  <link rel="alternate" type="application/rss+xml" title="RSS 2.0" href="/blog/feed" />
  <link rel="alternate" type="application/atom+xml" title="Atom 1.0" href="/blog/feed/atom" />
  <link rel="shortcut icon" href="/favicon.ico">
  <link rel="apple-touch-icon" href="/img/apple-touch-icon.png">

  <link rel="stylesheet" href="/css/base.css?v=1">
  <link rel="stylesheet" href="/css/grid.css?v=1">
  <link rel="stylesheet" media="handheld" href="/css/handheld.css?v=1">
  <link rel="stylesheet" href="/css/pygments_murphy.css" type="text/css" />

  <script src="/js/libs/modernizr-1.7.min.js"></script>
<script type="text/javascript"
  src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
  <link rel="stylesheet" href="/themes/theme1/style.css?v=1">
<link href='http://fonts.googleapis.com/css?family=Roboto' rel='stylesheet' type='text/css'>

</head>
  <body>
    <div id="container" class="container container_12">
      <div id="main" role="main">
        <div id="main_block">
          <header>
<div id="header" class="header_gradient theme_font">
<table><tr><td>
    <h1><a href="/">The Kitchin Research Group</a></h1>
    <h2>Chemical Engineering at Carnegie Mellon University</h2>
</td>
<td colspan=100%><div style="float:right;width:100%;text-align:right;"> <span id='badgeCont737515' style='width:126px'><script src='http://labs.researcherid.com/mashlets?el=badgeCont737515&mashlet=badge&showTitle=false&className=a&rid=A-2363-2010'></script></span></div>
</td></tr>
</table>
</div>
  <div id="navigation" class="grid_12">

    <ul class="theme_font">
      <li><a href="/blog"
             class="">Blog</a></li>

      <li><a href="/blog/archive"
             class="">Archives</a></li>

      <li><a href="/publications.html">Publications</a></li>
      <li><a href="/group.html">Group</a></li>

      <li><a href="/research.html"
             class="">Research</a></li>

      <li><a href="/categories.html"
             class="">Categories</a></li>

      <li><a href="/about.html"
             class="">About us</a></li>

      <li><a href="/subscribe.html">Subscribe</a></li>

    </ul>
  </div>
</header>

          <div id="prose_block" class="grid_8">
            
  





<article>
  <div class="blog_post">
    <header>
      <div id="Creating-arrays-in-python"></div>
      <h2 class="blog_post_title"><a href="/blog/2013/02/26/Creating-arrays-in-python/" rel="bookmark" title="Permanent Link to Creating arrays in python">Creating arrays in python</a></h2>
      <p><small><span class="blog_post_date">Posted February 26, 2013 at 09:00 AM</span> | categories:
        <span class="blog_post_categories"><a href='/blog/category/python/'>python</a></span> | tags: 
        | <a href="http://jkitchin.github.io/blog/2013/02/26/Creating-arrays-in-python#disqus_thread">View Comments</a>
      <p><small><span class="blog_post_date">Updated March 06, 2013 at 07:39 PM</span>
      </small></p>
    </header>
    <div class="post_prose">
      



<p>
Often, we will have a set of 1-D arrays, and we would like to construct a 2D array with those vectors as either the rows or columns of the array. This may happen because we have data from different sources we want to combine, or because we organize the code with variables that are easy to read, and then want to combine the variables. Here are examples of doing that to get the vectors as the columns.
</p>
<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">import</span> numpy <span style="color: #8b0000;">as</span> np

a = np.array([1, 2, 3])
b = np.array([4, 5, 6])

<span style="color: #8b0000;">print</span> np.column_stack([a, b])

<span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">this means stack the arrays vertically, e.g. on top of each other</span>
<span style="color: #8b0000;">print</span> np.vstack([a, b]).T
</pre>
</div>

<pre class="example">
[[1 4]
 [2 5]
 [3 6]]
[[1 4]
 [2 5]
 [3 6]]
</pre>

<p>
Or rows:
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">import</span> numpy <span style="color: #8b0000;">as</span> np

a = np.array([1, 2, 3])
b = np.array([4, 5, 6])

<span style="color: #8b0000;">print</span> np.row_stack([a, b])

<span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">this means stack the arrays vertically, e.g. on top of each other</span>
<span style="color: #8b0000;">print</span> np.vstack([a, b])
</pre>
</div>

<pre class="example">
[[1 2 3]
 [4 5 6]]
[[1 2 3]
 [4 5 6]]
</pre>

<p>
The opposite operation is to extract the rows or columns of a 2D array into smaller arrays. We might want to do that to extract a row or column from a calculation for further analysis, or plotting for example. There are splitting functions in numpy. They are somewhat confusing, so we examine some examples. The numpy.hsplit command splits an array &ldquo;horizontally&rdquo;. The best way to think about it is that the &ldquo;splits&rdquo; move horizontally across the array. In other words, you draw a vertical split, move over horizontally, draw another vertical split, etc&hellip; You must specify the number of splits that you want, and the array must be evenly divisible by the number of splits.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">import</span> numpy <span style="color: #8b0000;">as</span> np

A = np.array([[1, 2, 3, 5], 
              [4, 5, 6, 9]])

<span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">split into two parts</span>
p1, p2 = np.hsplit(A, 2)
<span style="color: #8b0000;">print</span> p1
<span style="color: #8b0000;">print</span> p2

<span style="color: #ff0000; font-weight: bold;">#</span><span style="color: #ff0000; font-weight: bold;">split into 4 parts</span>
p1, p2, p3, p4 = np.hsplit(A, 4)
<span style="color: #8b0000;">print</span> p1
<span style="color: #8b0000;">print</span> p2
<span style="color: #8b0000;">print</span> p3
<span style="color: #8b0000;">print</span> p4
</pre>
</div>

<pre class="example">
[[1 2]
 [4 5]]
[[3 5]
 [6 9]]
[[1]
 [4]]
[[2]
 [5]]
[[3]
 [6]]
[[5]
 [9]]
</pre>

<p>
In the numpy.vsplit command the &ldquo;splits&rdquo; go &ldquo;vertically&rdquo; down the array. Note that the split commands return 2D arrays.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">import</span> numpy <span style="color: #8b0000;">as</span> np

A = np.array([[1, 2, 3, 5], 
              [4, 5, 6, 9]])

<span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">split into two parts</span>
p1, p2 = np.vsplit(A, 2)
<span style="color: #8b0000;">print</span> p1
<span style="color: #8b0000;">print</span> p2
<span style="color: #8b0000;">print</span> p2.shape
</pre>
</div>

<pre class="example">
[[1 2 3 5]]
[[4 5 6 9]]
(1, 4)
</pre>

<p>
An alternative approach is array unpacking. In this example, we unpack the array into two variables. The array unpacks by row.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">import</span> numpy <span style="color: #8b0000;">as</span> np

A = np.array([[1, 2, 3, 5], 
              [4, 5, 6, 9]])

<span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">split into two parts</span>
p1, p2 = A
<span style="color: #8b0000;">print</span> p1
<span style="color: #8b0000;">print</span> p2
</pre>
</div>

<pre class="example">
[1 2 3 5]
[4 5 6 9]
</pre>

<p>
To get the columns, just transpose the array.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">import</span> numpy <span style="color: #8b0000;">as</span> np

A = np.array([[1, 2, 3, 5], 
              [4, 5, 6, 9]])

<span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">split into two parts</span>
p1, p2, p3, p4 = A.T
<span style="color: #8b0000;">print</span> p1
<span style="color: #8b0000;">print</span> p2
<span style="color: #8b0000;">print</span> p3
<span style="color: #8b0000;">print</span> p4
<span style="color: #8b0000;">print</span> p4.shape
</pre>
</div>

<pre class="example">
[1 4]
[2 5]
[3 6]
[5 9]
(2,)
</pre>

<p>
Note that now, we have 1D arrays.
</p>

<p>
You can also access rows and columns by indexing. We index an array by [row, column]. To get a row, we specify the row number, and all the columns in that row like this [row, :]. Similarly, to get a column, we specify that we want all rows in that column like this: [:, column]. This approach is useful when you only want a few columns or rows.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">import</span> numpy <span style="color: #8b0000;">as</span> np

A = np.array([[1, 2, 3, 5], 
              [4, 5, 6, 9]])

<span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">get row 1</span>
<span style="color: #8b0000;">print</span> A[1]
<span style="color: #8b0000;">print</span> A[1, :]  <span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">row 1, all columns</span>

<span style="color: #8b0000;">print</span> A[:, 2]  <span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">get third column </span>
<span style="color: #8b0000;">print</span> A[:, 2].shape
</pre>
</div>

<pre class="example">
[4 5 6 9]
[4 5 6 9]
[3 6]
(2,)
</pre>

<p>
Note that even when we specify a column, it is returned as a 1D array.</p>
<p>Copyright (C) 2013 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2013/02/26/Creating-arrays-in-python.org">org-mode source</a><p>

    </div>
  </div>
</article>



<a href="https://twitter.com/share" class="twitter-share-button" data-via="johnkitchin">Tweet</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>

  <div class="after_post"><a href="http://jkitchin.github.io/blog/2013/02/26/Creating-arrays-in-python#disqus_thread">Read and Post Comments</a></div>
  <hr class="interblog" />
  





<article>
  <div class="blog_post">
    <header>
      <div id="Advanced-string-formatting"></div>
      <h2 class="blog_post_title"><a href="/blog/2013/02/20/Advanced-string-formatting/" rel="bookmark" title="Permanent Link to Advanced string formatting">Advanced string formatting</a></h2>
      <p><small><span class="blog_post_date">Posted February 20, 2013 at 09:00 AM</span> | categories:
        <span class="blog_post_categories"><a href='/blog/category/python/'>python</a></span> | tags: 
        | <a href="http://jkitchin.github.io/blog/2013/02/20/Advanced-string-formatting#disqus_thread">View Comments</a>
      <p><small><span class="blog_post_date">Updated February 27, 2013 at 02:50 PM</span>
      </small></p>
    </header>
    <div class="post_prose">
      



<p>
There are several more advanced ways to include formatted values in a string. In the previous case we examined replacing format specifiers by <i>positional</i> arguments in the format command. We can instead use <i>keyword</i> arguments. 
</p>

<div class="org-src-container">

<pre class="src src-python">s = <span style="color: #228b22;">'The {speed} {color} fox'</span>.format(color=<span style="color: #228b22;">'brown'</span>, speed=<span style="color: #228b22;">'quick'</span>)
<span style="color: #8b0000;">print</span> s
</pre>
</div>

<pre class="example">
The quick brown fox
</pre>

<p>
If you have a lot of variables already defined in a script, it is convenient to use them in string formatting with the locals command:
</p>

<div class="org-src-container">

<pre class="src src-python">speed = <span style="color: #228b22;">'slow'</span>
color= <span style="color: #228b22;">'blue'</span>

<span style="color: #8b0000;">print</span> <span style="color: #228b22;">'The {speed} {color} fox'</span>.format(**<span style="color: #8b0000;">locals</span>())
</pre>
</div>

<pre class="example">
The slow blue fox
</pre>

<p>
If you want to access attributes on an object, you can specify them directly in the format identifier.
</p>
<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">class</span> <span style="color: #4682b4;">A</span>:
    <span style="color: #8b0000;">def</span> <span style="color: #8b2323;">__init__</span>(<span style="color: #8b0000;">self</span>, a, b, c):
        <span style="color: #8b0000;">self</span>.a = a
        <span style="color: #8b0000;">self</span>.b = b
        <span style="color: #8b0000;">self</span>.c = c

mya = A(3,4,5)

<span style="color: #8b0000;">print</span> <span style="color: #228b22;">'a = {obj.a}, b = {obj.b}, c = {obj.c:1.2f}'</span>.format(obj=mya)
</pre>
</div>

<pre class="example">
a = 3, b = 4, c = 5.00
</pre>

<p>
You can access values of a dictionary:
</p>
<div class="org-src-container">

<pre class="src src-python">d = {<span style="color: #228b22;">'a'</span>: 56, <span style="color: #228b22;">"test"</span>:<span style="color: #228b22;">'woohoo!'</span>}

<span style="color: #8b0000;">print</span> <span style="color: #228b22;">"the value of a in the dictionary is {obj[a]}. It works {obj[test]}"</span>.format(obj=d)
</pre>
</div>

<pre class="example">
the value of a in the dictionary is 56. It works woohoo!.
</pre>

<p>
And, you can access elements of a list. Note, however you cannot use -1 as an index in this case.
</p>

<div class="org-src-container">

<pre class="src src-python">L = [4, 5, <span style="color: #228b22;">'cat'</span>]

<span style="color: #8b0000;">print</span> <span style="color: #228b22;">'element 0 = {obj[0]}, and the last element is {obj[2]}'</span>.format(obj=L)
</pre>
</div>

<pre class="example">
element 0 = 4, and the last element is cat
</pre>

<p>
There are three different ways to &ldquo;print&rdquo; an object. If an object has a <span style="text-decoration:underline;"><span style="text-decoration:underline;">format</span></span> function, that is the default used in the format command. It may be helpful to use the <code>str</code> or <code>repr</code> of an object instead. We get this with !s for <code>str</code> and !r for <code>repr</code>.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">class</span> <span style="color: #4682b4;">A</span>:
    <span style="color: #8b0000;">def</span> <span style="color: #8b2323;">__init__</span>(<span style="color: #8b0000;">self</span>, a, b):
        <span style="color: #8b0000;">self</span>.a = a; <span style="color: #8b0000;">self</span>.b = b

    <span style="color: #8b0000;">def</span> <span style="color: #8b2323;">__format__</span>(<span style="color: #8b0000;">self</span>, format):
        s = <span style="color: #228b22;">'a={{0:{0}}} b={{1:{0}}}'</span>.format(format)
        <span style="color: #8b0000;">return</span> s.format(<span style="color: #8b0000;">self</span>.a, <span style="color: #8b0000;">self</span>.b)

    <span style="color: #8b0000;">def</span> <span style="color: #8b2323;">__str__</span>(<span style="color: #8b0000;">self</span>):
        <span style="color: #8b0000;">return</span> <span style="color: #228b22;">'str: class A, a={0} b={1}'</span>.format(<span style="color: #8b0000;">self</span>.a, <span style="color: #8b0000;">self</span>.b)

    <span style="color: #8b0000;">def</span> <span style="color: #8b2323;">__repr__</span>(<span style="color: #8b0000;">self</span>):
        <span style="color: #8b0000;">return</span> <span style="color: #228b22;">'representing: class A, a={0}, b={1}'</span>.format(<span style="color: #8b0000;">self</span>.a, <span style="color: #8b0000;">self</span>.b)

mya = A(3, 4)

<span style="color: #8b0000;">print</span> <span style="color: #228b22;">'{0}'</span>.format(mya)   <span style="color: #ff0000; font-weight: bold;"># uses __format__</span>
<span style="color: #8b0000;">print</span> <span style="color: #228b22;">'{0!s}'</span>.format(mya) <span style="color: #ff0000; font-weight: bold;"># uses __str__</span>
<span style="color: #8b0000;">print</span> <span style="color: #228b22;">'{0!r}'</span>.format(mya) <span style="color: #ff0000; font-weight: bold;"># uses __repr__</span>
</pre>
</div>

<pre class="example">
a=3 b=4
str: class A, a=3 b=4
representing: class A, a=3, b=4
</pre>

<p>
This covers the majority of string formatting requirements I have come across. If there are more sophisticated needs, they can be met with various string templating python modules. the one I have used most is <a href="http://www.cheetahtemplate.org/" >Cheetah</a>.</p>
<p>Copyright (C) 2013 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2013/02/20/Advanced-string-formatting.org">org-mode source</a><p>

    </div>
  </div>
</article>



<a href="https://twitter.com/share" class="twitter-share-button" data-via="johnkitchin">Tweet</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>

  <div class="after_post"><a href="http://jkitchin.github.io/blog/2013/02/20/Advanced-string-formatting#disqus_thread">Read and Post Comments</a></div>
  <hr class="interblog" />
  





<article>
  <div class="blog_post">
    <header>
      <div id="Integrating-functions-in-python"></div>
      <h2 class="blog_post_title"><a href="/blog/2013/02/02/Integrating-functions-in-python/" rel="bookmark" title="Permanent Link to Integrating functions in python">Integrating functions in python</a></h2>
      <p><small><span class="blog_post_date">Posted February 02, 2013 at 09:00 AM</span> | categories:
        <span class="blog_post_categories"><a href='/blog/category/math/'>math</a>, <a href='/blog/category/python/'>python</a></span> | tags: 
        | <a href="http://jkitchin.github.io/blog/2013/02/02/Integrating-functions-in-python#disqus_thread">View Comments</a>
      <p><small><span class="blog_post_date">Updated February 27, 2013 at 02:54 PM</span>
      </small></p>
    </header>
    <div class="post_prose">
      



<p>
<a href="http://matlab.cheme.cmu.edu/2011/08/01/integrating-functions-in-matlab/" >Matlab post</a>
</p>

<p>
<b>Problem statement</b>
</p>

<p>
find the integral of a function f(x) from a to b i.e.
</p>

<p>
$$\int_a^b f(x) dx$$
</p>

<p>
In python we use numerical quadrature to achieve this with the scipy.integrate.quad command. 
</p>

<p>
as a specific example, lets integrate
</p>

<p>
$$y=x^2$$
</p>

<p>
from x=0 to x=1. You should be able to work out that the answer is 1/3.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">from</span> scipy.integrate <span style="color: #8b0000;">import</span> quad

<span style="color: #8b0000;">def</span> <span style="color: #8b2323;">integrand</span>(x):
    <span style="color: #8b0000;">return</span> x**2

ans, err = quad(integrand, 0, 1)
<span style="color: #8b0000;">print</span> ans
</pre>
</div>

<pre class="example">
0.333333333333
</pre>

<div id="outline-container-1" class="outline-2">
<h2 id="sec-1"><span class="section-number-2">1</span> double integrals</h2>
<div class="outline-text-2" id="text-1">
<p>
we use the scipy.integrate.dblquad command
</p>

<p>
Integrate \(f(x,y)=y sin(x)+x cos(y)\) over
</p>

<p>
\(\pi <= x <= 2\pi\)
</p>

<p>
\(0 <= y <= \pi\)
</p>

<p>
i.e.
</p>

<p>
\(\int_{x=\pi}^{2\pi}\int_{y=0}^{\pi}y sin(x)+x cos(y)dydx\)
</p>

<p>
The syntax in dblquad is a bit more complicated than in Matlab. We have to provide callable functions for the range of the y-variable. Here they are constants, so we create lambda functions that return the constants. Also, note that the order of arguments in the integrand is different than in Matlab.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">from</span> scipy.integrate <span style="color: #8b0000;">import</span> dblquad
<span style="color: #8b0000;">import</span> numpy <span style="color: #8b0000;">as</span> np

<span style="color: #8b0000;">def</span> <span style="color: #8b2323;">integrand</span>(y, x):
    <span style="color: #228b22;">'y must be the first argument, and x the second.'</span>
    <span style="color: #8b0000;">return</span> y * np.sin(x) + x * np.cos(y)

ans, err = dblquad(integrand, np.pi, 2*np.pi,
                   <span style="color: #8b0000;">lambda</span> x: 0,
                   <span style="color: #8b0000;">lambda</span> x: np.pi)
<span style="color: #8b0000;">print</span> ans
</pre>
</div>

<pre class="example">
-9.86960440109
</pre>

<p>
we use the tplquad command  to integrate \(f(x,y,z)=y sin(x)+z cos(x)\) over the region
</p>

<p>
\(0 <= x <= \pi\)
</p>

<p>
\(0 <= y <= 1\)
</p>

<p>
\(-1 <= z <= 1\)
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">from</span> scipy.integrate <span style="color: #8b0000;">import</span> tplquad
<span style="color: #8b0000;">import</span> numpy <span style="color: #8b0000;">as</span> np

<span style="color: #8b0000;">def</span> <span style="color: #8b2323;">integrand</span>(z, y, x):
    <span style="color: #8b0000;">return</span> y * np.sin(x) + z * np.cos(x)

ans, err = tplquad(integrand,
                   0, np.pi,  <span style="color: #ff0000; font-weight: bold;"># x limits</span>
                   <span style="color: #8b0000;">lambda</span> x: 0,
                   <span style="color: #8b0000;">lambda</span> x: 1, <span style="color: #ff0000; font-weight: bold;"># y limits</span>
                   <span style="color: #8b0000;">lambda</span> x,y: -1,
                   <span style="color: #8b0000;">lambda</span> x,y: 1) <span style="color: #ff0000; font-weight: bold;"># z limits</span>

<span style="color: #8b0000;">print</span> ans
</pre>
</div>

<pre class="example">
2.0
</pre>
</div>
</div>
<div id="outline-container-2" class="outline-2">
<h2 id="sec-2"><span class="section-number-2">2</span> Summary</h2>
<div class="outline-text-2" id="text-2">
<p>
scipy.integrate offers the same basic functionality as Matlab does. The syntax differs significantly for these simple examples, but the use of functions for the limits enables freedom to integrate over non-constant limits.</p>
</div>
</div>
<p>Copyright (C) 2013 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2013/02/02/Integrating-functions-in-python.org">org-mode source</a><p>

    </div>
  </div>
</article>



<a href="https://twitter.com/share" class="twitter-share-button" data-via="johnkitchin">Tweet</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>

  <div class="after_post"><a href="http://jkitchin.github.io/blog/2013/02/02/Integrating-functions-in-python#disqus_thread">Read and Post Comments</a></div>
  <hr class="interblog" />
  





<article>
  <div class="blog_post">
    <header>
      <div id="On-the-quad-or-trapz-d-in-ChemE-heaven"></div>
      <h2 class="blog_post_title"><a href="/blog/2013/02/02/On-the-quad-or-trapz-d-in-ChemE-heaven/" rel="bookmark" title="Permanent Link to On the quad or trapz'd in ChemE heaven">On the quad or trapz'd in ChemE heaven</a></h2>
      <p><small><span class="blog_post_date">Posted February 02, 2013 at 09:00 AM</span> | categories:
        <span class="blog_post_categories"><a href='/blog/category/python/'>python</a>, <a href='/blog/category/integration/'>integration</a></span> | tags: 
        | <a href="http://jkitchin.github.io/blog/2013/02/02/On-the-quad-or-trapz-d-in-ChemE-heaven#disqus_thread">View Comments</a>
      <p><small><span class="blog_post_date">Updated February 27, 2013 at 02:53 PM</span>
      </small></p>
    </header>
    <div class="post_prose">
      



<p>


<a href="http://matlab.cheme.cmu.edu/2011/09/12/on-the-quad-or-trapzd-in-cheme-heaven/" >Matlab post</a>
</p>

<p>
What is the difference between quad and trapz? The short answer is that quad integrates functions (via a function handle) using numerical quadrature, and trapz performs integration of arrays of data using the trapezoid method.
</p>

<p>
Let us look at some examples. We consider the example of computing \(\int_0^2 x^3 dx\). the analytical integral is \(1/4 x^4\), so we know the integral evaluates to 16/4 = 4. This will be our benchmark for comparison to the numerical methods.
</p>

<p>
We use the scipy.integrate.quad command  to evaluate this \(\int_0^2 x^3 dx\).
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">from</span> scipy.integrate <span style="color: #8b0000;">import</span> quad

ans, err = quad(<span style="color: #8b0000;">lambda</span> x: x**3, 0, 2)
<span style="color: #8b0000;">print</span> ans
</pre>
</div>

<pre class="example">
4.0
</pre>

<p>
you can also define a function for the integrand.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">from</span> scipy.integrate <span style="color: #8b0000;">import</span> quad

<span style="color: #8b0000;">def</span> <span style="color: #8b2323;">integrand</span>(x):
    <span style="color: #8b0000;">return</span> x**3

ans, err = quad(integrand, 0, 2)
<span style="color: #8b0000;">print</span> ans
</pre>
</div>

<pre class="example">
4.0
</pre>

<div id="outline-container-1" class="outline-2">
<h2 id="sec-1"><span class="section-number-2">1</span> Numerical data integration</h2>
<div class="outline-text-2" id="text-1">
<p>
if we had numerical data like this, we use trapz to integrate it
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">import</span> numpy <span style="color: #8b0000;">as</span> np

x = np.array([0, 0.5, 1, 1.5, 2])
y = x**3

i2 = np.trapz(y, x)

error = (i2 - 4)/4

<span style="color: #8b0000;">print</span> i2, error
</pre>
</div>

<pre class="example">
4.25 0.0625
</pre>

<p>
Note the integral of these vectors is greater than 4! You can see why here.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">import</span> numpy <span style="color: #8b0000;">as</span> np
<span style="color: #8b0000;">import</span> matplotlib.pyplot <span style="color: #8b0000;">as</span> plt
x = np.array([0, 0.5, 1, 1.5, 2])
y = x**3

x2 = np.linspace(0, 2)
y2 = x2**3

plt.plot(x, y, label=<span style="color: #228b22;">'5 points'</span>)
plt.plot(x2, y2, label=<span style="color: #228b22;">'50 points'</span>)
plt.legend()
plt.savefig(<span style="color: #228b22;">'images/quad-1.png'</span>)
</pre>
</div>

<p><img src="/img/./images/quad-1.png"><p>

<p>
The trapezoid method is overestimating the area significantly. With more points, we get much closer to the analytical value.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">import</span> numpy <span style="color: #8b0000;">as</span> np

x2 = np.linspace(0, 2, 100)
y2 = x2**3

<span style="color: #8b0000;">print</span> np.trapz(y2, x2)
</pre>
</div>

<pre class="example">
4.00040812162
</pre>
</div>
</div>
<div id="outline-container-2" class="outline-2">
<h2 id="sec-2"><span class="section-number-2">2</span> Combining numerical data with quad</h2>
<div class="outline-text-2" id="text-2">
<p>
You might want to combine numerical data with the quad function if you want to perform integrals easily. Let us say you are given this data:
</p>

<p>
x = [0 0.5 1 1.5 2];
y = [0    0.1250    1.0000    3.3750    8.0000];
</p>

<p>
and you want to integrate this from x = 0.25 to 1.75. We do not have data in those regions, so some interpolation is going to be needed. Here is one approach.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">from</span> scipy.interpolate <span style="color: #8b0000;">import</span> interp1d
<span style="color: #8b0000;">from</span> scipy.integrate <span style="color: #8b0000;">import</span> quad
<span style="color: #8b0000;">import</span> numpy <span style="color: #8b0000;">as</span> np

x = [0, 0.5, 1, 1.5, 2]
y = [0,    0.1250,    1.0000,    3.3750,    8.0000]

f = interp1d(x, y)

<span style="color: #ff0000; font-weight: bold;"># numerical trapezoid method</span>
xfine = np.linspace(0.25, 1.75)
yfine = f(xfine)
<span style="color: #8b0000;">print</span> np.trapz(yfine, xfine)

<span style="color: #ff0000; font-weight: bold;"># quadrature with interpolation</span>
ans, err = quad(f, 0.25, 1.75)
<span style="color: #8b0000;">print</span> ans
</pre>
</div>

<pre class="example">
2.53199187838
2.53125
</pre>

<p>
These approaches are very similar, and both rely on linear interpolation. The second approach is simpler, and uses fewer lines of code.
</p>
</div>
</div>
<div id="outline-container-3" class="outline-2">
<h2 id="sec-3"><span class="section-number-2">3</span> Summary</h2>
<div class="outline-text-2" id="text-3">
<p>
trapz and quad are functions for getting integrals. Both can be used with numerical data if interpolation is used. The syntax for the quad and trapz function is different in scipy than in Matlab.
</p>

<p>
Finally, see this <a href="http://matlab.cheme.cmu.edu/2011/08/30/solving-integral-equations/" >post</a> for an example of solving an integral equation using quad and fsolve.</p>
</div>
</div>
<p>Copyright (C) 2013 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2013/02/02/On-the-quad-or-trapz'd-in-ChemE-heaven.org">org-mode source</a><p>

    </div>
  </div>
</article>



<a href="https://twitter.com/share" class="twitter-share-button" data-via="johnkitchin">Tweet</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>

  <div class="after_post"><a href="http://jkitchin.github.io/blog/2013/02/02/On-the-quad-or-trapz-d-in-ChemE-heaven#disqus_thread">Read and Post Comments</a></div>
  <hr class="interblog" />
  





<article>
  <div class="blog_post">
    <header>
      <div id="Controlling-the-format-of-printed-variables"></div>
      <h2 class="blog_post_title"><a href="/blog/2013/01/21/Controlling-the-format-of-printed-variables/" rel="bookmark" title="Permanent Link to Controlling the format of printed variables">Controlling the format of printed variables</a></h2>
      <p><small><span class="blog_post_date">Posted January 21, 2013 at 09:00 AM</span> | categories:
        <span class="blog_post_categories"><a href='/blog/category/python/'>python</a></span> | tags: 
        | <a href="http://jkitchin.github.io/blog/2013/01/21/Controlling-the-format-of-printed-variables#disqus_thread">View Comments</a>
      <p><small><span class="blog_post_date">Updated February 27, 2013 at 02:50 PM</span>
      </small></p>
    </header>
    <div class="post_prose">
      



<p>
This was first worked out in this <a href="http://matlab.cheme.cmu.edu/2011/10/06/sprintfing-to-the-finish/" >original Matlab post</a>.
</p>

<p>
Often you will want to control the way a variable is printed. You may want to only show a few decimal places, or print in scientific notation, or embed the result in a string. Here are some examples of printing with no control over the format.
</p>

<div class="org-src-container">

<pre class="src src-python">a = 2./3
<span style="color: #8b0000;">print</span> a
<span style="color: #8b0000;">print</span> 1/3
<span style="color: #8b0000;">print</span> 1./3.
<span style="color: #8b0000;">print</span> 10.1
<span style="color: #8b0000;">print</span> <span style="color: #228b22;">"Avogadro's number is "</span>, 6.022e23,<span style="color: #228b22;">'.'</span>
</pre>
</div>

<pre class="example">
0.666666666667
0
0.333333333333
10.1
Avogadro's number is  6.022e+23 .
</pre>

<p>
There is no control over the number of decimals, or spaces around a printed number. 
</p>

<p>
In python, we use the format function to control how variables are printed. With the format function you use codes like {<i>n</i>:format specifier} to indicate that a formatted string should be used. <i>n</i> is the <i>n^{th}</i> argument passed to format, and there are a variety of format specifiers. Here we examine how to format float numbers. The specifier has the general form &ldquo;w.df&rdquo; where w is the width of the field, and d is the number of decimals, and f indicates a float number. &ldquo;1.3f&rdquo; means to print a float number with 3 decimal places. Here is an example.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">print</span> <span style="color: #228b22;">'The value of 1/3 to 3 decimal places is {0:1.3f}'</span>.format(1./3.)
</pre>
</div>

<pre class="example">
The value of 1/3 to 3 decimal places is 0.333
</pre>

<p>
In that example, the 0 in {0:1.3f} refers to the first (and only) argument to the format function. If there is more than one argument, we can refer to them like this:
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">print</span> <span style="color: #228b22;">'Value 0 = {0:1.3f}, value 1 = {1:1.3f}, value 0 = {0:1.3f}'</span>.format(1./3., 1./6.)
</pre>
</div>

<pre class="example">
Value 0 = 0.333, value 1 = 0.167, value 0 = 0.333
</pre>

<p>
Note you can refer to the same argument more than once, and in arbitrary order within the string.
</p>

<p>
Suppose you have a list of numbers you want to print out, like this:
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">for</span> x <span style="color: #8b0000;">in</span> [1./3., 1./6., 1./9.]:
    <span style="color: #8b0000;">print</span> <span style="color: #228b22;">'The answer is {0:1.2f}'</span>.format(x)
</pre>
</div>

<pre class="example">
The answer is 0.33
The answer is 0.17
The answer is 0.11
</pre>

<p>
The &ldquo;g&rdquo; format specifier is a general format that can be used to indicate a precision, or to indicate significant digits. To print a number with a specific number of significant digits we do this:
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">print</span> <span style="color: #228b22;">'{0:1.3g}'</span>.format(1./3.)
<span style="color: #8b0000;">print</span> <span style="color: #228b22;">'{0:1.3g}'</span>.format(4./3.)
</pre>
</div>

<pre class="example">
0.333
1.33
</pre>

<p>
We can also specify plus or minus signs. Compare the next two outputs.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">for</span> x <span style="color: #8b0000;">in</span> [-1., 1.]: 
    <span style="color: #8b0000;">print</span> <span style="color: #228b22;">'{0:1.2f}'</span>.format(x)
</pre>
</div>

<pre class="example">
-1.00
1.00
</pre>

<p>
You can see the decimals do not align. That is because there is a minus sign in front of one number. We can specify to show the sign for positive and negative numbers, or to pad positive numbers to leave space for positive numbers.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">for</span> x <span style="color: #8b0000;">in</span> [-1., 1.]: 
    <span style="color: #8b0000;">print</span> <span style="color: #228b22;">'{0:+1.2f}'</span>.format(x) <span style="color: #ff0000; font-weight: bold;"># explicit sign</span>

<span style="color: #8b0000;">for</span> x <span style="color: #8b0000;">in</span> [-1., 1.]: 
    <span style="color: #8b0000;">print</span> <span style="color: #228b22;">'{0: 1.2f}'</span>.format(x) <span style="color: #ff0000; font-weight: bold;"># pad positive numbers</span>
</pre>
</div>

<pre class="example">
-1.00
+1.00
-1.00
 1.00
</pre>

<p>
We use the &ldquo;e&rdquo; or &ldquo;E&rdquo; format modifier to specify scientific notation.
</p>
<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">import</span> numpy <span style="color: #8b0000;">as</span> np
eps = np.finfo(np.double).eps
<span style="color: #8b0000;">print</span> eps
<span style="color: #8b0000;">print</span> <span style="color: #228b22;">'{0}'</span>.format(eps)
<span style="color: #8b0000;">print</span> <span style="color: #228b22;">'{0:1.2f}'</span>.format(eps)
<span style="color: #8b0000;">print</span> <span style="color: #228b22;">'{0:1.2e}'</span>.format(eps)  <span style="color: #ff0000; font-weight: bold;">#exponential notation</span>
<span style="color: #8b0000;">print</span> <span style="color: #228b22;">'{0:1.2E}'</span>.format(eps)  <span style="color: #ff0000; font-weight: bold;">#exponential notation with capital E</span>
</pre>
</div>

<pre class="example">
2.22044604925e-16
2.22044604925e-16
0.00
2.22e-16
2.2E-16
</pre>

<p>
As a float with 2 decimal places, that very small number is practically equal to 0.
</p>

<p>
We can even format percentages. Note you do not need to put the % in your string.
</p>
<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">print</span> <span style="color: #228b22;">'the fraction {0} corresponds to {0:1.0%}'</span>.format(0.78)
</pre>
</div>

<pre class="example">
the fraction 0.78 corresponds to 78%
</pre>

<p>
There are many other options for formatting strings. See <a href="http://docs.python.org/2/library/string.html#formatstrings" >http://docs.python.org/2/library/string.html#formatstrings</a> for a full specification of the options.
</p>
<p>Copyright (C) 2013 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2013/01/21/Controlling-the-format-of-printed-variables.org">org-mode source</a><p>

    </div>
  </div>
</article>



<a href="https://twitter.com/share" class="twitter-share-button" data-via="johnkitchin">Tweet</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>

  <div class="after_post"><a href="http://jkitchin.github.io/blog/2013/01/21/Controlling-the-format-of-printed-variables#disqus_thread">Read and Post Comments</a></div>
  <hr class="interblog" />
 <a href="/blog/category/python/15">« Previous Page</a>
  --  
 <a href="/blog/category/python/17">Next Page »</a>

          </div>
          <div id="sidebar" class="grid_4">
            <aside>
<section>
<script>
  (function() {
    var cx = '002533177287215655227:l7uvu35ssbc';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
        '//www.google.com/cse/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>
</section>

<section>
    <h1 class="post_header_gradient theme_font">Twitter</h1>
    <a class="twitter-timeline" href="https://twitter.com/johnkitchin" data-widget-id="545217643582881792">Tweets by @johnkitchin</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+"://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
</section>


  <section>
    <h1 class="post_header_gradient theme_font">Links</h1>
    <ul>
      <li><a href="https://www.continuum.io">Anaconda Python</a></li>
      <li><a href="/pycse">Pycse</a></li>
      <li><a href="/dft-book">DFT-book</a></li>
    </ul>
  </section>

  <section>
    <h1 class="post_header_gradient theme_font">Latest Posts</h1>
    <ul>
      <li><a href="/blog/2019/03/12/An-improvement-for-figures-in-ipython-+-scimax/">An improvement for figures in ipython + scimax</a></li>
      <li><a href="/blog/2019/02/12/Using-results-from-one-code-block-in-another-org-mode/">Using results from one code block in another org-mode</a></li>
      <li><a href="/blog/2018/12/31/2018-in-a-nutshell-for-the-Kitchin-Research-Group/">2018 in a nutshell for the Kitchin Research Group</a></li>
      <li><a href="/blog/2018/11/16/Line-integrals-in-Python-with-autograd/">Line integrals in Python with autograd</a></li>
      <li><a href="/blog/2018/11/05/Using-autograd-for-error-propagation/">Using autograd for error propagation</a></li>
    </ul>
  </section>

<section>
<h1 class="post_header_gradient theme_font">Latest GitHub Repos</h1>
  <a href="https://github.com/jkitchin">@jkitchin</a> on GitHub.
  <ul id="my-github-projects">
        <li class="loading">Status updating&#8230;</li>
  </ul>

</section>
</aside>

          </div>
          <div class="clear"></div>
        </div>
      </div>
      
<footer>
  <div id="footer" class="grid_12">
    <div class="grid_8">
      <p>
        <a href="/blog/feed/index.xml">RSS</a>
        <a href="http://kitchinresearchgroup.disqus.com/latest.rss">Comments RSS Feed</a>.
      </p>
    </div>
    <div class="grid_4" id="credits">
      <p>
        Copyright 2019
        John Kitchin
      </p>
      <p>
        Powered by <a href="http://www.blogofile.com">Blogofile</a>
      </p>
    </div>
  </div>
</footer>

    </div>
      <script src="//ajax.googleapis.com/ajax/libs/jquery/1.5.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="/js/libs/jquery-1.5.1.min.js"%3E%3C/script%3E'))</script>
  <script src="/js/plugins.js"></script>
  <script src="/js/script.js"></script>
  <script src="/js/jquery.tweet.js"></script>  
  <script src="/js/site.js"></script>
  <!--[if lt IE 7 ]>
  <script src="js/libs/dd_belatedpng.js"></script>
  <script> DD_belatedPNG.fix('img, .png_bg');</script>
  <![endif]-->
  <script>
      var _gaq=[['_setAccount','UA-35731398-1'],['_trackPageview']];
      (function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];g.async=1;
      g.src=('https:'==location.protocol?'//ssl':'//www')+'.google-analytics.com/ga.js';
      s.parentNode.insertBefore(g,s)}(document,'script'));
  </script>
  <script>
  (function() {
      var links = document.getElementsByTagName('a');
      var query = '?';
      for(var i = 0; i < links.length; i++) {
          if(links[i].href.indexOf('#disqus_thread') >= 0) {
              query += 'url' + i + '=' + encodeURIComponent(links[i].href) + '&';
          }
      }
      document.write('<script charset="utf-8" type="text/javascript" src="http://disqus.com/forums/kitchinresearchgroup/get_num_replies.js' + query + '"></' + 'script>');
  })();
  </script>

  </body>
</html>






<script src="http://ajax.microsoft.com/ajax/jquery/jquery-1.4.2.min.js" type="text/javascript"></script>
<script src="/js/git.js" type="text/javascript"></script>
<script type="text/javascript">
    $(function() {
     $("#my-github-projects").loadRepositories("jkitchin");
    });
</script>



