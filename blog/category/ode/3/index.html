

<!doctype html>
<!--[if lt IE 7 ]> <html lang="en" class="no-js ie6"> <![endif]-->
<!--[if IE 7 ]>    <html lang="en" class="no-js ie7"> <![endif]-->
<!--[if IE 8 ]>    <html lang="en" class="no-js ie8"> <![endif]-->
<!--[if IE 9 ]>    <html lang="en" class="no-js ie9"> <![endif]-->
<!--[if (gt IE 9)|!(IE)]><!--> <html lang="en" class="no-js"> <!--<![endif]-->
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>The Kitchin Research Group</title>
  <meta name="google-site-verification" content="CGcacJdHc2YoZyI0Vey9XRA5qwhhFDzThKJezbRFcJ4" />
  <meta name="description" content="Chemical Engineering at Carnegie Mellon University">
  <meta name="author" content="John Kitchin">
  <link rel="alternate" type="application/rss+xml" title="RSS 2.0" href="/blog/feed" />
  <link rel="alternate" type="application/atom+xml" title="Atom 1.0" href="/blog/feed/atom" />
  <link rel="shortcut icon" href="/favicon.ico">
  <link rel="apple-touch-icon" href="/img/apple-touch-icon.png">

  <link rel="stylesheet" href="/css/base.css?v=1">
  <link rel="stylesheet" href="/css/grid.css?v=1">
  <link rel="stylesheet" media="handheld" href="/css/handheld.css?v=1">
  <link rel="stylesheet" href="/css/pygments_murphy.css" type="text/css" />

  <script src="/js/libs/modernizr-1.7.min.js"></script>
<script type="text/javascript"
  src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
  <link rel="stylesheet" href="/themes/theme1/style.css?v=1">
<link href='http://fonts.googleapis.com/css?family=Roboto' rel='stylesheet' type='text/css'>

</head>
  <body>
    <div id="container" class="container container_12">
      <div id="main" role="main">
        <div id="main_block">
          <header>
<div id="header" class="header_gradient theme_font">
<table><tr><td>
    <h1><a href="/">The Kitchin Research Group</a></h1>
    <h2>Chemical Engineering at Carnegie Mellon University</h2>
</td>
<td colspan=100%><div style="float:right;width:100%;text-align:right;"> <span id='badgeCont737515' style='width:126px'><script src='http://labs.researcherid.com/mashlets?el=badgeCont737515&mashlet=badge&showTitle=false&className=a&rid=A-2363-2010'></script></span></div>
</td></tr>
</table>
</div>
  <div id="navigation" class="grid_12">

    <ul class="theme_font">
      <li><a href="/blog"
             class="">Blog</a></li>

      <li><a href="/blog/archive"
             class="">Archives</a></li>

      <li><a href="http://www.researcherid.com/rid/A-2363-2010" target="_new">Publications</a></li>

      <li><a href="/research.html"
             class="">Research</a></li>

      <li><a href="/group.html"
             class="">Group</a></li>

      <li><a href="/categories.html"
             class="">Categories</a></li>

      <li><a href="/about.html"
             class="">About us</a></li>
    </ul>
  </div>
</header>

          <div id="prose_block" class="grid_8">
            
  





<article>
  <div class="blog_post">
    <header>
      <div id="Phase-portraits-of-a-system-of-ODEs"></div>
      <h2 class="blog_post_title"><a href="/blog/2013/02/21/Phase-portraits-of-a-system-of-ODEs/" rel="bookmark" title="Permanent Link to Phase portraits of a system of ODEs">Phase portraits of a system of ODEs</a></h2>
      <p><small><span class="blog_post_date">Posted February 21, 2013 at 09:00 AM</span> | categories: 
        <span class="blog_post_categories"><a href='/blog/category/ode/'>ode</a>, <a href='/blog/category/math/'>math</a></span> | tags: 
        | <a href="http://jkitchin.github.io/blog/2013/02/21/Phase-portraits-of-a-system-of-ODEs#disqus_thread">View Comments</a>
      <p><small><span class="blog_post_date">Updated February 27, 2013 at 02:56 PM</span>
      </small></p>
    </header>
    <div class="post_prose">
      



<p>
<a href="http://matlab.cheme.cmu.edu/2011/08/09/phase-portraits-of-a-system-of-odes/" >Matlab post</a>
An undamped pendulum with no driving force is described by
</p>

<p>
$$ y'' + sin(y) = 0$$
</p>

<p>
We reduce this to standard matlab form of a system of first order ODEs by letting \(y_1 = y\) and \(y_2=y_1'\). This leads to:
</p>

<p>
\(y_1' = y_2\)
</p>

<p>
\(y_2' = -sin(y_1)\)
</p>

<p>
The phase portrait is a plot of a vector field which qualitatively shows how the solutions to these equations will go from a given starting point. here is our definition of the differential equations:
</p>

<p>
To generate the phase portrait, we need to compute the derivatives \(y_1'\) and \(y_2'\) at \(t=0\) on a grid over the range of values for \(y_1\) and \(y_2\) we are interested in. We will plot the derivatives as a vector at each (y1, y2) which will show us the initial direction from each point. We will examine the solutions over the range -2 &lt; y1 &lt; 8, and -2 &lt; y2 &lt; 2 for y2, and create a grid of 20 x 20 points.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">import</span> numpy <span style="color: #8b0000;">as</span> np
<span style="color: #8b0000;">import</span> matplotlib.pyplot <span style="color: #8b0000;">as</span> plt

<span style="color: #8b0000;">def</span> <span style="color: #8b2323;">f</span>(Y, t):
    y1, y2 = Y
    <span style="color: #8b0000;">return</span> [y2, -np.sin(y1)]

y1 = np.linspace(-2.0, 8.0, 20)
y2 = np.linspace(-2.0, 2.0, 20)

Y1, Y2 = np.meshgrid(y1, y2)

t = 0

u, v = np.zeros(Y1.shape), np.zeros(Y2.shape)

NI, NJ = Y1.shape

<span style="color: #8b0000;">for</span> i <span style="color: #8b0000;">in</span> <span style="color: #8b0000;">range</span>(NI):
    <span style="color: #8b0000;">for</span> j <span style="color: #8b0000;">in</span> <span style="color: #8b0000;">range</span>(NJ):
        x = Y1[i, j]
        y = Y2[i, j]
        yprime = f([x, y], t)
        u[i,j] = yprime[0]
        v[i,j] = yprime[1]
     

Q = plt.quiver(Y1, Y2, u, v, color=<span style="color: #228b22;">'r'</span>)

plt.xlabel(<span style="color: #228b22;">'$y_1$'</span>)
plt.ylabel(<span style="color: #228b22;">'$y_2$'</span>)
plt.xlim([-2, 8])
plt.ylim([-4, 4])
plt.savefig(<span style="color: #228b22;">'images/phase-portrait.png'</span>)
</pre>
</div>

<pre class="example">
&gt;&gt;&gt; ... &gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; ... ... ... &gt;&gt;&gt; &gt;&gt;&gt; &lt;matplotlib.text.Text object at 0xbcfd290&gt;
&lt;matplotlib.text.Text object at 0xbd14750&gt;
(-2, 8)
(-4, 4)
</pre>

<p><img src="/img/./images/phase-portrait.png"><p>

<p>
Let us plot a few solutions on the vector field. We will consider the solutions where y1(0)=0, and values of y2(0) = [0 0.5 1 1.5 2 2.5], in otherwords we start the pendulum at an angle of zero, with some angular velocity.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">from</span> scipy.integrate <span style="color: #8b0000;">import</span> odeint

<span style="color: #8b0000;">for</span> y20 <span style="color: #8b0000;">in</span> [0, 0.5, 1, 1.5, 2, 2.5]:
    tspan = np.linspace(0, 50, 200)
    y0 = [0.0, y20]
    ys = odeint(f, y0, tspan)
    plt.plot(ys[:,0], ys[:,1], <span style="color: #228b22;">'b-'</span>) <span style="color: #ff0000; font-weight: bold;"># path</span>
    plt.plot([ys[0,0]], [ys[0,1]], <span style="color: #228b22;">'o'</span>) <span style="color: #ff0000; font-weight: bold;"># start</span>
    plt.plot([ys[-1,0]], [ys[-1,1]], <span style="color: #228b22;">'s'</span>) <span style="color: #ff0000; font-weight: bold;"># end</span>
    

plt.xlim([-2, 8])
plt.savefig(<span style="color: #228b22;">'images/phase-portrait-2.png'</span>)
plt.show()
</pre>
</div>

<pre class="example">
&gt;&gt;&gt; ... ... ... [&lt;matplotlib.lines.Line2D object at 0xbc0dbd0&gt;]
[&lt;matplotlib.lines.Line2D object at 0xc135050&gt;]
[&lt;matplotlib.lines.Line2D object at 0xbd1a450&gt;]
[&lt;matplotlib.lines.Line2D object at 0xbd1a1d0&gt;]
[&lt;matplotlib.lines.Line2D object at 0xb88aa10&gt;]
[&lt;matplotlib.lines.Line2D object at 0xb88a5d0&gt;]
[&lt;matplotlib.lines.Line2D object at 0xc14e410&gt;]
[&lt;matplotlib.lines.Line2D object at 0xc14ed90&gt;]
[&lt;matplotlib.lines.Line2D object at 0xc2c5290&gt;]
[&lt;matplotlib.lines.Line2D object at 0xbea4bd0&gt;]
[&lt;matplotlib.lines.Line2D object at 0xbea4d50&gt;]
[&lt;matplotlib.lines.Line2D object at 0xbc401d0&gt;]
[&lt;matplotlib.lines.Line2D object at 0xc2d1190&gt;]
[&lt;matplotlib.lines.Line2D object at 0xc2f3e90&gt;]
[&lt;matplotlib.lines.Line2D object at 0xc2f3bd0&gt;]
[&lt;matplotlib.lines.Line2D object at 0xc2e4790&gt;]
[&lt;matplotlib.lines.Line2D object at 0xc2e0a90&gt;]
[&lt;matplotlib.lines.Line2D object at 0xc2c7390&gt;]
(-2, 8)
</pre>

<p><img src="/img/./images/phase-portrait-2.png"><p>

<p>
What do these figures mean? For starting points near the origin, and small velocities, the pendulum goes into a stable limit cycle. For others, the trajectory appears to fly off into y1 space. Recall that y1 is an angle that has values from \(-\pi\) to \(\pi\). The y1 data in this case is not wrapped around to be in this range.
</p>
<p>Copyright (C) 2013 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2013/02/21/Phase-portraits-of-a-system-of-ODEs.org">org-mode source</a><p>

    </div>
  </div>
</article>



  <div class="after_post"><a href="http://jkitchin.github.io/blog/2013/02/21/Phase-portraits-of-a-system-of-ODEs#disqus_thread">Read and Post Comments</a></div>
  <hr class="interblog" />
  





<article>
  <div class="blog_post">
    <header>
      <div id="Integrating-the-batch-reactor-mole-balance"></div>
      <h2 class="blog_post_title"><a href="/blog/2013/02/18/Integrating-the-batch-reactor-mole-balance/" rel="bookmark" title="Permanent Link to Integrating the batch reactor mole balance">Integrating the batch reactor mole balance</a></h2>
      <p><small><span class="blog_post_date">Posted February 18, 2013 at 09:00 AM</span> | categories: 
        <span class="blog_post_categories"><a href='/blog/category/ode/'>ode</a></span> | tags: <a href='/blog/tag/reaction-engineering/'>reaction engineering</a>
        | <a href="http://jkitchin.github.io/blog/2013/02/18/Integrating-the-batch-reactor-mole-balance#disqus_thread">View Comments</a>
      <p><small><span class="blog_post_date">Updated March 03, 2013 at 10:36 AM</span>
      </small></p>
    </header>
    <div class="post_prose">
      




<p>
An alternative approach of evaluating an integral is to integrate a differential equation. For the batch reactor, the differential equation that describes conversion as a function of time is:
</p>

<p>
\(\frac{dX}{dt} = -r_A V/N_{A0}\).
</p>

<p>
Given a value of initial concentration, or volume and initial number of moles of A, we can integrate this ODE to find the conversion at some later time. We assume that \(X(t=0)=0\). We will integrate the ODE over a time span of 0 to 10,000 seconds.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">from</span> scipy.integrate <span style="color: #8b0000;">import</span> odeint
<span style="color: #8b0000;">import</span> numpy <span style="color: #8b0000;">as</span> np
<span style="color: #8b0000;">import</span> matplotlib.pyplot <span style="color: #8b0000;">as</span> plt

k = 1.0e-3
Ca0 = 1.0  <span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">mol/L</span>

<span style="color: #8b0000;">def</span> <span style="color: #8b2323;">func</span>(X, t):
    ra = -k * (Ca0 * (1 - X))**2
    <span style="color: #8b0000;">return</span> -ra / Ca0

X0 = 0
tspan = np.linspace(0,10000)

sol = odeint(func, X0, tspan)
plt.plot(tspan,sol)
plt.xlabel(<span style="color: #228b22;">'Time (sec)'</span>)
plt.ylabel(<span style="color: #228b22;">'Conversion'</span>)
plt.savefig(<span style="color: #228b22;">'images/2013-01-06-batch-conversion.png'</span>)
</pre>
</div>

<p><img src="/img/./images/2013-01-06-batch-conversion.png"><p>

<p>
You can read off of this figure to find the time required to achieve a particular conversion.
</p>
<p>Copyright (C) 2013 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2013/02/18/Integrating-the-batch-reactor-mole-balance.org">org-mode source</a><p>


    </div>
  </div>
</article>



  <div class="after_post"><a href="http://jkitchin.github.io/blog/2013/02/18/Integrating-the-batch-reactor-mole-balance#disqus_thread">Read and Post Comments</a></div>
  <hr class="interblog" />
  





<article>
  <div class="blog_post">
    <header>
      <div id="Plug-flow-reactor-with-a-pressure-drop"></div>
      <h2 class="blog_post_title"><a href="/blog/2013/02/18/Plug-flow-reactor-with-a-pressure-drop/" rel="bookmark" title="Permanent Link to Plug flow reactor with a pressure drop">Plug flow reactor with a pressure drop</a></h2>
      <p><small><span class="blog_post_date">Posted February 18, 2013 at 09:00 AM</span> | categories: 
        <span class="blog_post_categories"><a href='/blog/category/ode/'>ode</a></span> | tags: <a href='/blog/tag/reaction-engineering/'>reaction engineering</a>, <a href='/blog/tag/fluids/'>fluids</a>
        | <a href="http://jkitchin.github.io/blog/2013/02/18/Plug-flow-reactor-with-a-pressure-drop#disqus_thread">View Comments</a>
      <p><small><span class="blog_post_date">Updated March 06, 2013 at 04:39 PM</span>
      </small></p>
    </header>
    <div class="post_prose">
      




<p>
If there is a pressure drop in a plug flow reactor, <sup><a id="fnr.1" name="fnr.1" class="footref" href="#fn.1">1</a></sup> there are two equations needed to determine the exit conversion: one for the conversion, and one from the pressure drop.
</p>

\begin{eqnarray}
\frac{dX}{dW} &=& \frac{k'}{F_A0} \left ( \frac{1-X}{1 + \epsilon X} \right) y\\
\frac{dX}{dy} &=& -\frac{\alpha (1 + \epsilon X)}{2y}
\end{eqnarray}

<p>
Here is how to integrate these equations numerically in python.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">import</span> numpy <span style="color: #8b0000;">as</span> np
<span style="color: #8b0000;">from</span> scipy.integrate <span style="color: #8b0000;">import</span> odeint
<span style="color: #8b0000;">import</span> matplotlib.pyplot <span style="color: #8b0000;">as</span> plt

kprime = 0.0266
Fa0 = 1.08
alpha = 0.0166
epsilon = -0.15

<span style="color: #8b0000;">def</span> <span style="color: #8b2323;">dFdW</span>(F, W):
    <span style="color: #228b22;">'set of ODEs to integrate'</span>
    X = F[0]
    y = F[1]
    dXdW = kprime / Fa0 * (1-X) / (1 + epsilon*X) * y
    dydW = -alpha * (1 + epsilon * X) / (2 * y)
    <span style="color: #8b0000;">return</span> [dXdW, dydW]

Wspan = np.linspace(0,60)
X0 = 0.0
y0 = 1.0
F0 = [X0, y0]
sol = odeint(dFdW, F0, Wspan)

<span style="color: #ff0000; font-weight: bold;"># now plot the results</span>
plt.plot(Wspan, sol[:,0], label=<span style="color: #228b22;">'Conversion'</span>)
plt.plot(Wspan, sol[:,1], <span style="color: #228b22;">'g--'</span>, label=<span style="color: #228b22;">'y=$P/P_0$'</span>)
plt.legend(loc=<span style="color: #228b22;">'best'</span>)
plt.xlabel(<span style="color: #228b22;">'Catalyst weight (lb_m)'</span>)
plt.savefig(<span style="color: #228b22;">'images/2013-01-08-pdrop.png'</span>)
</pre>
</div>

<p>
Here is the resulting figure.
</p>

<p><img src="/img/./images/2013-01-08-pdrop.png"><p>
<p>Copyright (C) 2013 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2013/02/18/Plug-flow-reactor-with-a-pressure-drop.org">org-mode source</a><p>

    </div>
  </div>
</article>



  <div class="after_post"><a href="http://jkitchin.github.io/blog/2013/02/18/Plug-flow-reactor-with-a-pressure-drop#disqus_thread">Read and Post Comments</a></div>
  <hr class="interblog" />
  





<article>
  <div class="blog_post">
    <header>
      <div id="Plotting-ODE-solutions-in-cylindrical-coordinates"></div>
      <h2 class="blog_post_title"><a href="/blog/2013/02/07/Plotting-ODE-solutions-in-cylindrical-coordinates/" rel="bookmark" title="Permanent Link to Plotting ODE solutions in cylindrical coordinates">Plotting ODE solutions in cylindrical coordinates</a></h2>
      <p><small><span class="blog_post_date">Posted February 07, 2013 at 09:00 AM</span> | categories: 
        <span class="blog_post_categories"><a href='/blog/category/ode/'>ode</a></span> | tags: 
        | <a href="http://jkitchin.github.io/blog/2013/02/07/Plotting-ODE-solutions-in-cylindrical-coordinates#disqus_thread">View Comments</a>
      <p><small><span class="blog_post_date">Updated March 06, 2013 at 06:33 PM</span>
      </small></p>
    </header>
    <div class="post_prose">
      




<p>
<a href="http://matlab.cheme.cmu.edu/2011/11/08/plot-the-solution-to-an-ode-in-cylindrical-coordinates-2/" >Matlab post</a>
</p>

<p>
It is straightforward to plot functions in Cartesian coordinates. It is less convenient to plot them in cylindrical coordinates. Here we solve an ODE in cylindrical coordinates, and then convert the solution to Cartesian coordinates for simple plotting.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">import</span> numpy <span style="color: #8b0000;">as</span> np
<span style="color: #8b0000;">from</span> scipy.integrate <span style="color: #8b0000;">import</span> odeint

<span style="color: #8b0000;">def</span> <span style="color: #8b2323;">dfdt</span>(F, t):
    rho, theta, z = F
    drhodt = 0   <span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">constant radius</span>
    dthetadt = 1 <span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">constant angular velocity</span>
    dzdt = -1    <span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">constant dropping velocity</span>
    <span style="color: #8b0000;">return</span> [drhodt, dthetadt, dzdt]

<span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">initial conditions</span>
rho0 = 1
theta0 = 0
z0 = 100

tspan = np.linspace(0, 50, 500)
sol = odeint(dfdt, [rho0, theta0, z0], tspan)

rho = sol[:,0]
theta = sol[:,1]
z = sol[:,2]

<span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">convert cylindrical coords to cartesian for plotting.</span>
X = rho * np.cos(theta)
Y = rho * np.sin(theta)

<span style="color: #8b0000;">from</span> mpl_toolkits.mplot3d <span style="color: #8b0000;">import</span> Axes3D
<span style="color: #8b0000;">import</span> matplotlib.pyplot <span style="color: #8b0000;">as</span> plt
fig = plt.figure()
ax = fig.gca(projection=<span style="color: #228b22;">'3d'</span>)
ax.plot(X, Y, z)
plt.savefig(<span style="color: #228b22;">'images/ode-cylindrical.png'</span>)
</pre>
</div>

<p><img src="/img/./images/ode-cylindrical.png"><p>
<p>Copyright (C) 2013 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2013/02/07/Plotting-ODE-solutions-in-cylindrical-coordinates.org">org-mode source</a><p>

    </div>
  </div>
</article>



  <div class="after_post"><a href="http://jkitchin.github.io/blog/2013/02/07/Plotting-ODE-solutions-in-cylindrical-coordinates#disqus_thread">Read and Post Comments</a></div>
  <hr class="interblog" />
  





<article>
  <div class="blog_post">
    <header>
      <div id="Solving-Bessel-s-Equation-numerically"></div>
      <h2 class="blog_post_title"><a href="/blog/2013/02/07/Solving-Bessel-s-Equation-numerically/" rel="bookmark" title="Permanent Link to Solving Bessel's Equation numerically">Solving Bessel's Equation numerically</a></h2>
      <p><small><span class="blog_post_date">Posted February 07, 2013 at 09:00 AM</span> | categories: 
        <span class="blog_post_categories"><a href='/blog/category/ode/'>ode</a>, <a href='/blog/category/math/'>math</a></span> | tags: 
        | <a href="http://jkitchin.github.io/blog/2013/02/07/Solving-Bessel-s-Equation-numerically#disqus_thread">View Comments</a>
      <p><small><span class="blog_post_date">Updated March 06, 2013 at 06:33 PM</span>
      </small></p>
    </header>
    <div class="post_prose">
      



<p>
<a href="http://matlab.cheme.cmu.edu/2011/08/08/solving-bessels-equation-numerically/" >Matlab post</a>
</p>

<p>
Reference Ch 5.5 Kreysig, Advanced Engineering Mathematics, 9th ed.
</p>

<p>
Bessel's equation \(x^2 y'' + x y' + (x^2 - \nu^2)y=0\) comes up often in engineering problems such as heat transfer. The solutions to this equation are the Bessel functions. To solve this equation numerically, we must convert it to a system of first order ODEs. This can be done by letting \(z = y'\) and \(z' = y''\) and performing the change of variables:
</p>

<p>
$$ y' = z$$
</p>

<p>
$$ z' = \frac{1}{x^2}(-x z - (x^2 - \nu^2) y$$
</p>

<p>
if we take the case where \(\nu = 0\), the solution is known to be the Bessel function \(J_0(x)\), which is represented in Matlab as besselj(0,x). The initial conditions for this problem are: \(y(0) = 1\) and \(y'(0)=0\).
</p>

<p>
There is a problem with our system of ODEs at x=0. Because of the \(1/x^2\) term, the ODEs are not defined at x=0. If we start very close to zero instead, we avoid the problem.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">import</span> numpy <span style="color: #8b0000;">as</span> np
<span style="color: #8b0000;">from</span> scipy.integrate <span style="color: #8b0000;">import</span> odeint
<span style="color: #8b0000;">from</span> scipy.special <span style="color: #8b0000;">import</span> jn <span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">bessel function</span>
<span style="color: #8b0000;">import</span> matplotlib.pyplot <span style="color: #8b0000;">as</span> plt

<span style="color: #8b0000;">def</span> <span style="color: #8b2323;">fbessel</span>(Y, x):
    nu = 0.0
    y = Y[0]
    z = Y[1]
  
    dydx = z
    dzdx = 1.0 / x**2 * (-x * z - (x**2 - nu**2) * y)
    <span style="color: #8b0000;">return</span> [dydx, dzdx]

x0 = 1e-15
y0 = 1
z0 = 0
Y0 = [y0, z0]

xspan = np.linspace(1e-15, 10)
sol = odeint(fbessel, Y0, xspan)

plt.plot(xspan, sol[:,0], label=<span style="color: #228b22;">'numerical soln'</span>)
plt.plot(xspan, jn(0, xspan), <span style="color: #228b22;">'r--'</span>, label=<span style="color: #228b22;">'Bessel'</span>)
plt.legend()
plt.savefig(<span style="color: #228b22;">'images/bessel.png'</span>)
</pre>
</div>

<p><img src="/img/./images/bessel.png"><p>

<p>
You can see the numerical and analytical solutions overlap, indicating they are at least visually the same.
</p>
<p>Copyright (C) 2013 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2013/02/07/Solving-Bessel's-Equation-numerically.org">org-mode source</a><p>

    </div>
  </div>
</article>



  <div class="after_post"><a href="http://jkitchin.github.io/blog/2013/02/07/Solving-Bessel-s-Equation-numerically#disqus_thread">Read and Post Comments</a></div>
  <hr class="interblog" />
 <a href="/blog/category/ode/2">« Previous Page</a>
  --  
 <a href="/blog/category/ode/4">Next Page »</a>

          </div>
          <div id="sidebar" class="grid_4">
            <aside>
<section>
Search
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:kitchingroup.cheme.cmu.edu" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
</section>


  <section>
    <h1 class="post_header_gradient theme_font">Links</h1>
    <ul>
    <li><a href="http://enthought.com">Enthought Python</a></li>
    <li><a href="/pycse">Pycse</a></li>
    <li><a href="/dft-book">DFT-book</a></li>
    </ul>
  </section>

  <section>
    <h1 class="post_header_gradient theme_font">Latest Posts</h1>
    <ul>
      <li><a href="/blog/2014/09/06/Randomize-a-list-in-Emacs/">Randomize a list in Emacs</a></li>
      <li><a href="/blog/2014/08/31/Using-Mac-gestures-in-Emacs/">Using Mac gestures in Emacs</a></li>
      <li><a href="/blog/2014/08/25/Collecting-entries-from-files-in-a-directory/">Collecting entries from files in a directory</a></li>
      <li><a href="/blog/2014/08/21/Using-org-entries-like-a-database/">Using org-entries like a database</a></li>
      <li><a href="/blog/2014/08/20/Creating-a-dynamic-menu-for-Emacs/">Creating a dynamic menu for Emacs</a></li>
    </ul>
  </section>

  <section>
 <h1 class="post_header_gradient theme_font"><a href="http://www.citeulike.org/user/jkitchin" class="external text" title="http://www.citeulike.org/user/jkitchin" rel="nofollow">CiteULike</a> Reading List</h1>
<script type="text/javascript" src="http://code.jquery.com/jquery-1.7.1.min.js"></script>
<script type="text/javascript">
$(document).ready(function() {

var d = new Date();
curr_year = d.getFullYear();

$.getJSON('http://www.citeulike.org/json/user/jkitchin/,,?callback=?&per_page=5',
function(data) {
  var items = [];
  year=curr_year
  $.each(data, function(i) {
    year=data[i].published[0];
    var cit='<li id="' + i + '">' + '<a class="pap" href="http://dx.doi.org/'+data[i].doi+'">'+ data[i].title + '</a><br>';
    cit+='</li>';
    items.push( cit )      
  });

  $('<ul/>', {
    'class': 'my-new-list',
    html: items.join('')
  }).appendTo('#papers2');
});
});
</script>

<div id="papers2"></div>

  </section>

<section>
<h1 class="post_header_gradient theme_font">Latest GitHub Repos</h1>
  <a href="https://github.com/jkitchin">@jkitchin</a> on GitHub.
<ul id="my-github-projects">
    <li class="loading">Status updating&#8230;</li>
  </ul>

</section>
</aside>

          </div>
          <div class="clear"></div>
        </div>
      </div>
      
<footer>
  <div id="footer" class="grid_12">
    <div class="grid_8">
      <p>
        <a href="/blog/feed/index.xml">RSS</a>
        <a href="http://kitchinresearchgroup.disqus.com/latest.rss">Comments RSS Feed</a>.
      </p>
    </div>
    <div class="grid_4" id="credits">
      <p>
        Copyright 2014
        John Kitchin
      </p>
      <p>
        Powered by <a href="http://www.blogofile.com">Blogofile</a>
      </p>
    </div>
  </div>
</footer>

    </div>
      <script src="//ajax.googleapis.com/ajax/libs/jquery/1.5.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="/js/libs/jquery-1.5.1.min.js"%3E%3C/script%3E'))</script>
  <script src="/js/plugins.js"></script>
  <script src="/js/script.js"></script>
  <script src="/js/jquery.tweet.js"></script>  
  <script src="/js/site.js"></script>
  <!--[if lt IE 7 ]>
  <script src="js/libs/dd_belatedpng.js"></script>
  <script> DD_belatedPNG.fix('img, .png_bg');</script>
  <![endif]-->
  <script>
      var _gaq=[['_setAccount','UA-35731398-1'],['_trackPageview']];
      (function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];g.async=1;
      g.src=('https:'==location.protocol?'//ssl':'//www')+'.google-analytics.com/ga.js';
      s.parentNode.insertBefore(g,s)}(document,'script'));
  </script>
  <script>
  (function() {
      var links = document.getElementsByTagName('a');
      var query = '?';
      for(var i = 0; i < links.length; i++) {
          if(links[i].href.indexOf('#disqus_thread') >= 0) {
              query += 'url' + i + '=' + encodeURIComponent(links[i].href) + '&';
          }
      }
      document.write('<script charset="utf-8" type="text/javascript" src="http://disqus.com/forums/kitchinresearchgroup/get_num_replies.js' + query + '"></' + 'script>');
  })();
  </script>

  </body>
</html>






<script src="http://ajax.microsoft.com/ajax/jquery/jquery-1.4.2.min.js" type="text/javascript"></script>
<script src="/js/git.js" type="text/javascript"></script>
<script type="text/javascript">
    $(function() {
     $("#my-github-projects").loadRepositories("jkitchin");
    });
</script>



