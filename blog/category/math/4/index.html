

<!doctype html>
<!--[if lt IE 7 ]> <html lang="en" class="no-js ie6"> <![endif]-->
<!--[if IE 7 ]>    <html lang="en" class="no-js ie7"> <![endif]-->
<!--[if IE 8 ]>    <html lang="en" class="no-js ie8"> <![endif]-->
<!--[if IE 9 ]>    <html lang="en" class="no-js ie9"> <![endif]-->
<!--[if (gt IE 9)|!(IE)]><!--> <html lang="en" class="no-js"> <!--<![endif]-->
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>The Kitchin Research Group</title>
  <meta name="google-site-verification" content="CGcacJdHc2YoZyI0Vey9XRA5qwhhFDzThKJezbRFcJ4" />
  <meta name="description" content="Chemical Engineering at Carnegie Mellon University">
  <meta name="author" content="John Kitchin">
  <link rel="alternate" type="application/rss+xml" title="RSS 2.0" href="/blog/feed" />
  <link rel="alternate" type="application/atom+xml" title="Atom 1.0" href="/blog/feed/atom" />
  <link rel="shortcut icon" href="/favicon.ico">
  <link rel="apple-touch-icon" href="/img/apple-touch-icon.png">

  <link rel="stylesheet" href="/css/base.css?v=1">
  <link rel="stylesheet" href="/css/grid.css?v=1">
  <link rel="stylesheet" media="handheld" href="/css/handheld.css?v=1">
  <link rel="stylesheet" href="/css/pygments_murphy.css" type="text/css" />

  <script src="/js/libs/modernizr-1.7.min.js"></script>
<script type="text/javascript"
  src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
  <link rel="stylesheet" href="/themes/theme1/style.css?v=1">
<link href='http://fonts.googleapis.com/css?family=Roboto' rel='stylesheet' type='text/css'>

</head>
  <body>
    <div id="container" class="container container_12">
      <div id="main" role="main">
        <div id="main_block">
          <header>
<div id="header" class="header_gradient theme_font">
<table><tr><td>
    <h1><a href="/">The Kitchin Research Group</a></h1>
    <h2>Chemical Engineering at Carnegie Mellon University</h2>
</td>
<td colspan=100%><div style="float:right;width:100%;text-align:right;"> <span id='badgeCont737515' style='width:126px'><script src='http://labs.researcherid.com/mashlets?el=badgeCont737515&mashlet=badge&showTitle=false&className=a&rid=A-2363-2010'></script></span></div>
</td></tr>
</table>
</div>
  <div id="navigation" class="grid_12">

    <ul class="theme_font">
      <li><a href="/blog"
             class="">Blog</a></li>

      <li><a href="/blog/archive"
             class="">Archives</a></li>

      <li><a href="http://www.researcherid.com/rid/A-2363-2010" target="_new">Publications</a></li>

      <li><a href="/research.html"
             class="">Research</a></li>

      <li><a href="/categories.html"
             class="">Categories</a></li>

      <li><a href="/about.html"
             class="">About us</a></li>
    </ul>
  </div>
</header>

          <div id="prose_block" class="grid_8">
            
  





<article>
  <div class="blog_post">
    <header>
      <div id="Lather-rinse-and-repeat"></div>
      <h2 class="blog_post_title"><a href="/blog/2013/02/02/Lather-rinse-and-repeat/" rel="bookmark" title="Permanent Link to Lather, rinse and repeat">Lather, rinse and repeat</a></h2>
      <p><small><span class="blog_post_date">Posted February 02, 2013 at 09:00 AM</span> | categories: 
        <span class="blog_post_categories"><a href='/blog/category/recursive/'>recursive</a>, <a href='/blog/category/math/'>math</a></span> | tags: 
        | <a href="http://jkitchin.github.io/blog/2013/02/02/Lather-rinse-and-repeat#disqus_thread">View Comments</a>
      <p><small><span class="blog_post_date">Updated February 27, 2013 at 02:45 PM</span>
      </small></p>
    </header>
    <div class="post_prose">
      



<p>
<a href="http://matlab.cheme.cmu.edu/2012/05/28/lather-rinse-and-repeat/" >Matlab post</a>
</p>

<p>
Recursive functions are functions that call themselves repeatedly until some exit condition is met. Today we look at a classic example of recursive function for computing a factorial. The factorial of a non-negative integer n is denoted n!, and is defined as the product of all positive integers less than or equal to n.
</p>

<p>
The key ideas in defining a recursive function is that there needs to be some logic to identify when to terminate the function. Then, you need logic that calls the function again, but with a smaller part of the problem. Here we recursively call the function with n-1 until it gets called with n=0. 0! is defined to be 1.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">def</span> <span style="color: #8b2323;">recursive_factorial</span>(n):
    <span style="color: #228b22;">'''compute the factorial recursively. Note if you put a negative</span>
<span style="color: #228b22;">    number in, this function will never end. We also do not check if</span>
<span style="color: #228b22;">    n is an integer.'''</span>
    <span style="color: #8b0000;">if</span> n == 0:
        <span style="color: #8b0000;">return</span> 1
    <span style="color: #8b0000;">else:</span>
        <span style="color: #8b0000;">return</span> n * recursive_factorial(n - 1)

<span style="color: #8b0000;">print</span> recursive_factorial(5)
</pre>
</div>

<pre class="example">
120
</pre>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">from</span> scipy.misc <span style="color: #8b0000;">import</span> factorial
<span style="color: #8b0000;">print</span> factorial(5)
</pre>
</div>

<pre class="example">
120.0
</pre>

<div id="outline-container-0-1" class="outline-3">
<h3 id="sec-0-1"><span class="section-number-3">0.1</span> Compare to a loop solution</h3>
<div class="outline-text-3" id="text-0-1">
<p>
This example can also be solved by a loop. This loop is easier to read and understand than the recursive function. Note the recursive nature of defining the variable as itself times a number.
</p>

<div class="org-src-container">

<pre class="src src-python">n = 5
factorial_loop = 1
<span style="color: #8b0000;">for</span> i <span style="color: #8b0000;">in</span> <span style="color: #8b0000;">range</span>(1, n + 1):
    factorial_loop *= i

<span style="color: #8b0000;">print</span> factorial_loop
</pre>
</div>

<pre class="example">
120
</pre>

<p>
There are some significant differences in this example than in Matlab. 
</p>

<ol>
<li>the syntax of the for loop is quite different with the use of the <code>in</code> operator.
</li>
<li>python has the nice *= operator to replace a = a * i
</li>
<li>We have to loop from 1 to n+1 because the last number in the range is not returned.
</li>
</ol>
</div>
</div>
<div id="outline-container-1" class="outline-2">
<h2 id="sec-1"><span class="section-number-2">1</span> Conclusions</h2>
<div class="outline-text-2" id="text-1">
<p>
Recursive functions have a special niche in mathematical programming. There is often another way to accomplish the same goal. That is not always true though, and in a future post we will examine cases where recursion is the only way to solve a problem.
</p>
</div>
</div>
<p>Copyright (C) 2013 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2013/02/02/Lather,-rinse-and-repeat.org">org-mode source</a><p>

    </div>
  </div>
</article>



  <div class="after_post"><a href="http://jkitchin.github.io/blog/2013/02/02/Lather-rinse-and-repeat#disqus_thread">Read and Post Comments</a></div>
  <hr class="interblog" />
  





<article>
  <div class="blog_post">
    <header>
      <div id="Solving-a-second-order-ode"></div>
      <h2 class="blog_post_title"><a href="/blog/2013/02/02/Solving-a-second-order-ode/" rel="bookmark" title="Permanent Link to Solving a second order ode">Solving a second order ode</a></h2>
      <p><small><span class="blog_post_date">Posted February 02, 2013 at 09:00 AM</span> | categories: 
        <span class="blog_post_categories"><a href='/blog/category/ode/'>ode</a>, <a href='/blog/category/math/'>math</a></span> | tags: 
        | <a href="http://jkitchin.github.io/blog/2013/02/02/Solving-a-second-order-ode#disqus_thread">View Comments</a>
      <p><small><span class="blog_post_date">Updated February 27, 2013 at 02:32 PM</span>
      </small></p>
    </header>
    <div class="post_prose">
      



<p>
<a href="http://matlab.cheme.cmu.edu/2011/09/26/solving-a-second-order-ode/" >Matlab post</a>

</p>

<p>
The odesolvers in scipy can only solve first order ODEs, or systems of first order ODES. To solve a second order ODE, we must convert it by changes of variables to a system of first order ODES. We consider the Van der Pol oscillator here:
</p>

<p>
$$\frac{d^2x}{dt^2} - \mu(1-x^2)\frac{dx}{dt} + x = 0$$
</p>

<p>
\(\mu\) is a constant. If we let \(y=x - x^3/3\) <a href="http://en.wikipedia.org/wiki/Van_der_Pol_oscillator" >http://en.wikipedia.org/wiki/Van_der_Pol_oscillator</a>, then we arrive at this set of equations:
</p>

<p>
$$\frac{dx}{dt} = \mu(x-1/3x^3-y)$$
</p>

<p>
$$\frac{dy}{dt} = \mu/x$$
</p>

<p>
here is how we solve this set of equations. Let \(\mu=1\).
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">from</span> scipy.integrate <span style="color: #8b0000;">import</span> odeint
<span style="color: #8b0000;">import</span> numpy <span style="color: #8b0000;">as</span> np

mu = 1.0

<span style="color: #8b0000;">def</span> <span style="color: #8b2323;">vanderpol</span>(X, t):
    x = X[0]
    y = X[1]
    dxdt = mu * (x - 1./3.*x**3 - y)
    dydt = x / mu
    <span style="color: #8b0000;">return</span> [dxdt, dydt]

X0 = [1, 2]
t = np.linspace(0, 40, 250)

sol = odeint(vanderpol, X0, t)

<span style="color: #8b0000;">import</span> matplotlib.pyplot <span style="color: #8b0000;">as</span> plt
x = sol[:, 0]
y = sol[:, 1]

plt.plot(t,x, t, y)
plt.xlabel(<span style="color: #228b22;">'t'</span>)
plt.legend((<span style="color: #228b22;">'x'</span>, <span style="color: #228b22;">'y'</span>))
plt.savefig(<span style="color: #228b22;">'images/vanderpol-1.png'</span>)

<span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">phase portrait</span>
plt.figure()
plt.plot(x,y)
plt.plot(x[0], y[0], <span style="color: #228b22;">'ro'</span>)
plt.xlabel(<span style="color: #228b22;">'x'</span>)
plt.ylabel(<span style="color: #228b22;">'y'</span>)
plt.savefig(<span style="color: #228b22;">'images/vanderpol-2.png'</span>)
</pre>
</div>

<p><img src="/img/./images/vanderpol-1.png"><p>

<p>
Here is the phase portrait. You can see that a limit cycle is approached, indicating periodicity in the solution.
</p>

<p><img src="/img/./images/vanderpol-2.png"><p>
<p>Copyright (C) 2013 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2013/02/02/Solving-a-second-order-ode.org">org-mode source</a><p>

    </div>
  </div>
</article>



  <div class="after_post"><a href="http://jkitchin.github.io/blog/2013/02/02/Solving-a-second-order-ode#disqus_thread">Read and Post Comments</a></div>
  <hr class="interblog" />
  





<article>
  <div class="blog_post">
    <header>
      <div id="Polynomials-in-python"></div>
      <h2 class="blog_post_title"><a href="/blog/2013/01/22/Polynomials-in-python/" rel="bookmark" title="Permanent Link to Polynomials in python">Polynomials in python</a></h2>
      <p><small><span class="blog_post_date">Posted January 22, 2013 at 09:00 AM</span> | categories: 
        <span class="blog_post_categories"><a href='/blog/category/polynomials/'>polynomials</a>, <a href='/blog/category/math/'>math</a></span> | tags: 
        | <a href="http://jkitchin.github.io/blog/2013/01/22/Polynomials-in-python#disqus_thread">View Comments</a>
      <p><small><span class="blog_post_date">Updated February 27, 2013 at 02:53 PM</span>
      </small></p>
    </header>
    <div class="post_prose">
      



<p>
<a href="http://matlab.cheme.cmu.edu/2011/08/01/polynomials-in-matlab/" >Matlab post</a>
</p>

<p>
Polynomials can be represented as a list of coefficients. For example, the polynomial \(4*x^3 + 3*x^2 -2*x + 10 = 0\) can be represented as [4, 3, -2, 10]. Here are some ways to create a polynomial object, and evaluate it.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">import</span> numpy <span style="color: #8b0000;">as</span> np

ppar = [4, 3, -2, 10]
p = np.poly1d(ppar)

<span style="color: #8b0000;">print</span> p(3)
<span style="color: #8b0000;">print</span> np.polyval(ppar, 3)

x = 3
<span style="color: #8b0000;">print</span> 4*x**3 + 3*x**2 -2*x + 10
</pre>
</div>

<pre class="example">
139
139
139
</pre>

<p>
numpy makes it easy to get the derivative and integral of a polynomial.
</p>

<p>
Consider: \(y = 2x^2 - 1\). We know the derivative is \(4x\). Here we compute the derivative and evaluate it at x=4.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">import</span> numpy <span style="color: #8b0000;">as</span> np

p = np.poly1d([2, 0, -1])
p2 = np.polyder(p)
<span style="color: #8b0000;">print</span> p2
<span style="color: #8b0000;">print</span> p2(4)
</pre>
</div>

<pre class="example">
 
4 x
16
</pre>

<p>
The integral of the previous polynomial is \(\frac{2}{3} x^3 - x + c\). We assume \(C=0\). Let us compute the integral \(\int_2^4 2x^2 - 1 dx\).
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">import</span> numpy <span style="color: #8b0000;">as</span> np

p = np.poly1d([2, 0, -1])
p2 = np.polyint(p)
<span style="color: #8b0000;">print</span> p2
<span style="color: #8b0000;">print</span> p2(4) - p2(2)
</pre>
</div>

<pre class="example">
        3
0.6667 x - 1 x
35.3333333333
</pre>

<p>
One reason to use polynomials is the ease of finding all of the roots using numpy.roots. 
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">import</span> numpy <span style="color: #8b0000;">as</span> np
<span style="color: #8b0000;">print</span> np.roots([2, 0, -1]) <span style="color: #ff0000; font-weight: bold;"># roots are +- sqrt(2)</span>

<span style="color: #ff0000; font-weight: bold;"># note that imaginary roots exist, e.g. x^2 + 1 = 0 has two roots, +-i</span>
p = np.poly1d([1, 0, 1])
<span style="color: #8b0000;">print</span> np.roots(p)
</pre>
</div>

<pre class="example">
[ 0.70710678 -0.70710678]
[ 0.+1.j  0.-1.j]
</pre>

<p>
There are applications of polynomials in thermodynamics. The van der waal equation is a cubic polynomial \(f(V) = V^3 - \frac{p n b + n R T}{p} V^2 + \frac{n^2 a}{p}V - \frac{n^3 a b}{p} = 0\), where \(a\) and \(b\) are constants, \(p\) is the pressure, \(R\) is the gas constant, \(T\) is an absolute temperature and \(n\) is the number of moles. The roots of this equation tell you the volume of the gas at those conditions.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">import</span> numpy <span style="color: #8b0000;">as</span> np
<span style="color: #ff0000; font-weight: bold;"># numerical values of the constants</span>
a = 3.49e4
b = 1.45
p = 679.7   <span style="color: #ff0000; font-weight: bold;"># pressure in psi</span>
T = 683     <span style="color: #ff0000; font-weight: bold;"># T in Rankine</span>
n = 1.136   <span style="color: #ff0000; font-weight: bold;"># lb-moles</span>
R = 10.73       <span style="color: #ff0000; font-weight: bold;"># ft^3 * psi /R / lb-mol</span>

ppar = [1.0, -(p*n*b+n*R*T)/p, n**2*a/p,  -n**3*a*b/p];
<span style="color: #8b0000;">print</span> np.roots(ppar)
</pre>
</div>

<pre class="example">
[ 5.09432376+0.j          4.40066810+1.43502848j  4.40066810-1.43502848j]
</pre>

<p>
Note that only one root is real (and even then, we have to interpet 0.j as not being imaginary. Also, in a cubic polynomial, there can only be two imaginary roots). In this case that means there is only one phase present.
</p>

<div id="outline-container-1" class="outline-2">
<h2 id="sec-1"><span class="section-number-2">1</span> Summary</h2>
<div class="outline-text-2" id="text-1">
<p>
Polynomials in numpy are even better than in Matlab, because you get a polynomial object that acts just like a function. Otherwise, they are functionally equivalent.</p>
</div>
</div>
<p>Copyright (C) 2013 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2013/01/22/Polynomials-in-python.org">org-mode source</a><p>

    </div>
  </div>
</article>



  <div class="after_post"><a href="http://jkitchin.github.io/blog/2013/01/22/Polynomials-in-python#disqus_thread">Read and Post Comments</a></div>
  <hr class="interblog" />
 <a href="/blog/category/math/3">Â« Previous Page</a>

          </div>
          <div id="sidebar" class="grid_4">
            <aside>
<section>
<script>
  (function() {
    var cx = '002533177287215655227:l7uvu35ssbc';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
        '//www.google.com/cse/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>
</section>

<section>
    <h1 class="post_header_gradient theme_font">Twitter</h1>
    <a class="twitter-timeline" href="https://twitter.com/johnkitchin" data-widget-id="545217643582881792">Tweets by @johnkitchin</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+"://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
</section>

  <section>
    <h1 class="post_header_gradient theme_font">Links</h1>
    <ul>
    <li><a href="http://enthought.com">Enthought Python</a></li>
    <li><a href="/pycse">Pycse</a></li>
    <li><a href="/dft-book">DFT-book</a></li>
    </ul>
  </section>

  <section>
    <h1 class="post_header_gradient theme_font">Latest Posts</h1>
    <ul>
      <li><a href="/blog/2015/02/22/org-mode-links-meet-hydra/">org-mode links meet hydra</a></li>
      <li><a href="/blog/2015/02/20/org-ref-meets-hydra/">org-ref meets hydra</a></li>
      <li><a href="/blog/2015/02/05/Extending-the-org-mode-link-syntax-with-attributes/">Extending the org-mode link syntax with attributes</a></li>
      <li><a href="/blog/2015/02/04/Helm-at-the-Emacs/">Helm at the Emacs</a></li>
      <li><a href="/blog/2015/02/03/helm-and-prefix-functions/">helm and prefix functions</a></li>
    </ul>
  </section>

<section>
<h1 class="post_header_gradient theme_font">Latest GitHub Repos</h1>
  <a href="https://github.com/jkitchin">@jkitchin</a> on GitHub.
  <ul id="my-github-projects">
        <li class="loading">Status updating&#8230;</li>
  </ul>

</section>
</aside>

          </div>
          <div class="clear"></div>
        </div>
      </div>
      
<footer>
  <div id="footer" class="grid_12">
    <div class="grid_8">
      <p>
        <a href="/blog/feed/index.xml">RSS</a>
        <a href="http://kitchinresearchgroup.disqus.com/latest.rss">Comments RSS Feed</a>.
      </p>
    </div>
    <div class="grid_4" id="credits">
      <p>
        Copyright 2015
        John Kitchin
      </p>
      <p>
        Powered by <a href="http://www.blogofile.com">Blogofile</a>
      </p>
    </div>
  </div>
</footer>

    </div>
      <script src="//ajax.googleapis.com/ajax/libs/jquery/1.5.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="/js/libs/jquery-1.5.1.min.js"%3E%3C/script%3E'))</script>
  <script src="/js/plugins.js"></script>
  <script src="/js/script.js"></script>
  <script src="/js/jquery.tweet.js"></script>  
  <script src="/js/site.js"></script>
  <!--[if lt IE 7 ]>
  <script src="js/libs/dd_belatedpng.js"></script>
  <script> DD_belatedPNG.fix('img, .png_bg');</script>
  <![endif]-->
  <script>
      var _gaq=[['_setAccount','UA-35731398-1'],['_trackPageview']];
      (function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];g.async=1;
      g.src=('https:'==location.protocol?'//ssl':'//www')+'.google-analytics.com/ga.js';
      s.parentNode.insertBefore(g,s)}(document,'script'));
  </script>
  <script>
  (function() {
      var links = document.getElementsByTagName('a');
      var query = '?';
      for(var i = 0; i < links.length; i++) {
          if(links[i].href.indexOf('#disqus_thread') >= 0) {
              query += 'url' + i + '=' + encodeURIComponent(links[i].href) + '&';
          }
      }
      document.write('<script charset="utf-8" type="text/javascript" src="http://disqus.com/forums/kitchinresearchgroup/get_num_replies.js' + query + '"></' + 'script>');
  })();
  </script>

  </body>
</html>






<script src="http://ajax.microsoft.com/ajax/jquery/jquery-1.4.2.min.js" type="text/javascript"></script>
<script src="/js/git.js" type="text/javascript"></script>
<script type="text/javascript">
    $(function() {
     $("#my-github-projects").loadRepositories("jkitchin");
    });
</script>



