<?xml version="1.0" encoding="UTF-8"?>
<feed
  xmlns="http://www.w3.org/2005/Atom"
  xmlns:thr="http://purl.org/syndication/thread/1.0"
  xml:lang="en"
   >
  <title type="text">The Kitchin Research Group</title>
  <subtitle type="text">Chemical Engineering at Carnegie Mellon University</subtitle>

  <updated>2014-10-30T23:42:57Z</updated>
  <generator uri="http://blogofile.com/">Blogofile</generator>

  <link rel="alternate" type="text/html" href="http://jkitchin.github.io/blog" />
  <id>http://jkitchin.github.io/blog/feed/atom/</id>
  <link rel="self" type="application/atom+xml" href="http://jkitchin.github.io/blog/feed/atom/" />
  <entry>
    <author>
      <name></name>
      <uri>http://jkitchin.github.io/blog</uri>
    </author>
    <title type="html"><![CDATA[Generating your bibliography in another file]]></title>
    <link rel="alternate" type="text/html" href="http://jkitchin.github.io/blog/2014/10/30/Generating-your-bibliography-in-another-file" />
    <id>http://jkitchin.github.io/blog/2014/10/30/Generating-your-bibliography-in-another-file</id>
    <updated>2014-10-30T19:42:35Z</updated>
    <published>2014-10-30T19:42:35Z</published>
    <category scheme="http://jkitchin.github.io/blog" term="bibtex" />
    <summary type="html"><![CDATA[Generating your bibliography in another file]]></summary>
    <content type="html" xml:base="http://jkitchin.github.io/blog/2014/10/30/Generating-your-bibliography-in-another-file"><![CDATA[


<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#sec-1">1. Getting the references in another file</a></li>
</ul>
</div>
</div>

<p>
It has been proposal season. This particular round of proposals had a requirement to print the references in a separate file from the proposal. Usually I just build a pdf from org-mode, and then manually separate the references. That is not very fun if you have to do it several times. Here we examine a way to avoid this issue by using a new nobibliography link from org-ref with the bibentry LaTeX package.
</p>

<p>
We wrote this paper <a href="#mehta-2014-ident-poten">mehta-2014-ident-poten</a> and this one <a href="#xu-2014-relat">xu-2014-relat</a>.
</p>

<p>

<h1>Bibliography</h1>
<ul><li><a id="mehta-2014-ident-poten">[mehta-2014-ident-poten] Prateek Mehta, Paul Salvador, John \& Kitchin, Identifying Potential \ce{BO2} Oxide Polymorphs for  Epitaxial Growth Candidates, <i>ACS Appl. Mater. Interfaces</i>, <b>6(5)</b>, 3630-3639 (2014). <a href="http://dx.doi.org/10.1021/am4059149">link</a>. <a href="http://dx.doi.org/10.1021/am4059149">doi</a>.</a></li>
<li><a id="xu-2014-relat">[xu-2014-relat] Zhongnan Xu \& John Kitchin, Relating the Electronic Structure and Reactivity of  the 3d Transition Metal Monoxide Surfaces, <i>Catalysis Communications</i>, <b>52()</b>, 60-64 (2014). <a href="http://dx.doi.org/10.1016/j.catcom.2013.10.028">link</a>. <a href="http://dx.doi.org/10.1016/j.catcom.2013.10.028">doi</a>.</a></li>
</ul>
</p>

<p>
Here is the resulting pdf, with no references: <a href="separate-bib.pdf">separate-bib.pdf</a>.
</p>


<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1"><span class="section-number-2">1</span> Getting the references in another file</h2>
<div class="outline-text-2" id="text-1">
<p>
Now, we need to get the reference file. We create a new file, in org-mode, mostly for the convenience of exporting that to a pdf. Here is the code that does that.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #8b0000;">let*</span> ((base (file-name-sans-extension
              (file-name-nondirectory (buffer-file-name))))
       (bbl (concat base <span style="color: #228b22;">".bbl"</span>))
       (orgfile (concat base <span style="color: #228b22;">"-references.org"</span>))
       (pdffile (concat base <span style="color: #228b22;">"-references.pdf"</span>)))
  (<span style="color: #8b0000;">with-temp-file</span> orgfile
    (insert 
     (format <span style="color: #228b22;">"#+LATEX_CLASS: cmu-article</span>
<span style="color: #228b22;">#+OPTIONS: toc:nil</span>

<span style="color: #228b22;">#+BEGIN_LaTeX</span>
<span style="color: #228b22;">\\input{%s}</span>
<span style="color: #228b22;">#+END_LaTeX</span>
<span style="color: #228b22;">"</span> bbl)))

  (find-file orgfile)
  (org-latex-export-to-pdf)
  (org-open-file pdffile))
</pre>
</div>

<p>
And, here is the reference file: <a href="/media/2014-10-30-Generating-your-bibliography-in-another-file/separate-bib.pdf">separate-bib.pdf</a> 
</p>

<p>
I think this would be integrated into a noexport build section of a document that would generate the pdf and references. 
</p>
</div>
</div>
<p>Copyright (C) 2014 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2014/10/30/Generating-your-bibliography-in-another-file.org">org-mode source</a><p><p>Org-mode version = 8.2.7c</p>]]></content>
  </entry>
  <entry>
    <author>
      <name></name>
      <uri>http://jkitchin.github.io/blog</uri>
    </author>
    <title type="html"><![CDATA[Navigating your bibtex file]]></title>
    <link rel="alternate" type="text/html" href="http://jkitchin.github.io/blog/2014/10/13/Navigating-your-bibtex-file" />
    <id>http://jkitchin.github.io/blog/2014/10/13/Navigating-your-bibtex-file</id>
    <updated>2014-10-13T10:22:27Z</updated>
    <published>2014-10-13T10:22:27Z</published>
    <category scheme="http://jkitchin.github.io/blog" term="bibtex" />
    <summary type="html"><![CDATA[Navigating your bibtex file]]></summary>
    <content type="html" xml:base="http://jkitchin.github.io/blog/2014/10/13/Navigating-your-bibtex-file"><![CDATA[



<p>
You may be able to tell I am spending some time cleaning up bibtex files these days. One of the things I need to do is navigate around a bibtex file easily. There are some built-in navigation keys within an entry.
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="left" />

<col  class="left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="left">navigation</th>
<th scope="col" class="left">key strokes</th>
</tr>
</thead>
<tbody>
<tr>
<td class="left">next field</td>
<td class="left">C-j</td>
</tr>

<tr>
<td class="left">end of field</td>
<td class="left">TAB</td>
</tr>

<tr>
<td class="left">beginning of entry</td>
<td class="left">C-M-a</td>
</tr>

<tr>
<td class="left">end of entry</td>
<td class="left">C-M-e</td>
</tr>
</tbody>
</table>

<p>
I am not aware of an easy way to navigate to the next or previous entry though. I would like something simple to do that. There is a regexp defined in bibtex "bibtex-entry-head", to search for the next or previous entry.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">bibtex-entry-head
</pre>
</div>

<pre class="example">
^[      ]*\(@[  ]*\(?:\(?:Article\|Book\(?:let\)?\|In\(?:Book\|Collection\|Proceedings\)\|M\(?:a\(?:nual\|stersThesis\)\|isc\)\|P\(?:\(?:hdThesi\|roceeding\)s\)\|TechReport\|Unpublished\)\)\)[        ]*[({][         
]*\([][[:alnum:].:;?!`'/*@+|()&lt;&gt;&amp;_^$-]+\)
</pre>

<p>
Here are two functions that do it. This was a little more subtle than I anticipated.  The subtlety comes about if you are at the beginning of the entry, we need to move the cursor by a character, and then search forward because of the way re-search-forward works. I also wrote in an option for a prefix argument, so you can go forward or backward several entries.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #8b0000;">defun</span> <span style="color: #8b2323;">bibtex-next-entry</span> (<span style="color: #4682b4;">&amp;optional</span> n)
  <span style="color: #228b22;">"Jump to the beginning of the next bibtex entry. N is a prefix</span>
<span style="color: #228b22;">argument. If it is numeric, jump that many entries</span>
<span style="color: #228b22;">forward. Negative numbers do nothing."</span>
  (interactive <span style="color: #228b22;">"P"</span>)
  ;; <span style="color: #ff0000; font-weight: bold;">Note if we start at the beginning of an entry, nothing</span>
  ;; <span style="color: #ff0000; font-weight: bold;">happens. We need to move forward a char, and call again.</span>
  (<span style="color: #8b0000;">when</span> (= (point) (<span style="color: #8b0000;">save-excursion</span>
                     (bibtex-beginning-of-entry)))
    (forward-char)
    (bibtex-next-entry))

  ;; <span style="color: #ff0000; font-weight: bold;">search forward for an entry </span>
  (<span style="color: #8b0000;">when</span> 
      (re-search-forward bibtex-entry-head nil t (and (numberp n) n))
    ;; <span style="color: #ff0000; font-weight: bold;">go to beginning of the entry</span>
    (bibtex-beginning-of-entry)))


(<span style="color: #8b0000;">defun</span> <span style="color: #8b2323;">bibtex-previous-entry</span> (<span style="color: #4682b4;">&amp;optional</span> n)
  <span style="color: #228b22;">"Jump to beginning of the previous bibtex entry. N is a prefix</span>
<span style="color: #228b22;">argument. If it is numeric, jump that many entries back."</span>
  (interactive <span style="color: #228b22;">"P"</span>)
  (bibtex-beginning-of-entry)
 (<span style="color: #8b0000;">when</span> 
     (re-search-backward bibtex-entry-head nil t (and (numberp n) n))
   (bibtex-beginning-of-entry)))
</pre>
</div>

<pre class="example">
bibtex-previous-entry
</pre>

<p>
That is pretty simple. Let us go ahead and bind these to M-n, and M-p, but only in bibtex-mode. Thanks to <a href="http://ergoemacs.org/emacs/emacs_set_keys_for_major_mode.html">Xah Lee</a> for this idea. 
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #8b0000;">defun</span> <span style="color: #8b2323;">jmax-bibtex-mode-keys</span> ()
  <span style="color: #228b22;">"Modify keymaps used by `</span><span style="color: #cd0000;">bibtex-mode</span><span style="color: #228b22;">'."</span>
  (local-set-key (kbd <span style="color: #228b22;">"M-n"</span>) 'bibtex-next-entry)
  (local-set-key (kbd <span style="color: #228b22;">"M-p"</span>) 'bibtex-previous-entry))

;; <span style="color: #ff0000; font-weight: bold;">add to bibtex-mode-hook</span>
(add-hook 'bibtex-mode-hook 'jmax-bibtex-mode-keys)
</pre>
</div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="left" />
</colgroup>
<tbody>
<tr>
<td class="left">jmax-bibtex-mode-keys</td>
</tr>
</tbody>
</table>

<p>
Now, C-n moves forward an entry, C-u 2 C-n moves you two entries, etc&#x2026; and C-p moves you back an entry, while C-u 2 C-p moves you back two entries. 
</p>

<p>
Finally, I sometimes want to jump to a field in an entry. Basically, I want a completion enabled function that lists the fields in the current entry, and then jumps to the selected field. Yes, you could simply do an incremental search forward or backward that is about as simple. But, then I would not get to remind myself how to do a completion command ;)
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #8b0000;">defun</span> <span style="color: #8b2323;">jmax-bibtex-get-fields</span> ()
  <span style="color: #228b22;">"Get a list of fields in a bibtex entry."</span>
  (bibtex-beginning-of-entry)
  (remove <span style="color: #228b22;">"=type="</span>
          (remove <span style="color: #228b22;">"=key="</span>
                  (mapcar 'car (bibtex-parse-entry)))))

(<span style="color: #8b0000;">defun</span> <span style="color: #8b2323;">jmax-bibtex-jump-to-field</span> (field)
  <span style="color: #228b22;">"Jump to FIELD in the current bibtex entry"</span>
  (interactive
   (list
    (ido-completing-read <span style="color: #228b22;">"Field: "</span> (jmax-bibtex-get-fields))))
  (<span style="color: #8b0000;">save-restriction</span>
    (bibtex-narrow-to-entry)
    (bibtex-beginning-of-entry)
    (<span style="color: #8b0000;">when</span>
        ;; <span style="color: #ff0000; font-weight: bold;">fields start with spaces, a field name, possibly more</span>
        ;; <span style="color: #ff0000; font-weight: bold;">spaces, then =</span>
        (re-search-forward (format <span style="color: #228b22;">"^\\s-*%s\\s-*="</span> field) nil t))))
</pre>
</div>

<pre class="example">
jmax-bibtex-jump-to-field
</pre>

<p>
These functions live in <a href="https://github.com/jkitchin/jmax/blob/master/jmax-bibtex.el">https://github.com/jkitchin/jmax/blob/master/jmax-bibtex.el</a> , which is the version we use on a regular basis.
</p>
<p>Copyright (C) 2014 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2014/10/13/Navigating-your-bibtex-file.org">org-mode source</a><p><p>Org-mode version = 8.2.7c</p>]]></content>
  </entry>
  <entry>
    <author>
      <name></name>
      <uri>http://jkitchin.github.io/blog</uri>
    </author>
    <title type="html"><![CDATA[Title casing bibtex entry journal titles]]></title>
    <link rel="alternate" type="text/html" href="http://jkitchin.github.io/blog/2014/10/12/Title-casing-bibtex-entry-journal-titles" />
    <id>http://jkitchin.github.io/blog/2014/10/12/Title-casing-bibtex-entry-journal-titles</id>
    <updated>2014-10-12T09:23:17Z</updated>
    <published>2014-10-12T09:23:17Z</published>
    <category scheme="http://jkitchin.github.io/blog" term="bibtex" />
    <summary type="html"><![CDATA[Title casing bibtex entry journal titles]]></summary>
    <content type="html" xml:base="http://jkitchin.github.io/blog/2014/10/12/Title-casing-bibtex-entry-journal-titles"><![CDATA[



<p>
I mostly love bibtex. You keep bibliographic entries in a central file, and you can cite them in your writing. Bibtex takes care of <i>most</i> of the formatting for you, but not always all of it. Lately, we have been writing some manuscripts for submission to ACS journals. They want the titles of journal articles included in the bibliography, preferrably in title-case, or in sentence case, but all the same format either way. Unfortunately, the achemso.bst bibtex format does not make this happen. You have to title-case or sentence case the titles themselves in your bibtex file. Well, at least we can get Emacs to do the heavy lifting on that for us. 
</p>

<p>
First, the manual approach. Open your bibtex file, navigate to a title field, put your cursor on the first letter of the title, and press M-c until you get to the end of the title. That runs (capitalize-word). For a few titles, you might just do this. It does not take long.
</p>

<p>
For a lot of entries though, you might prefer some code to do it. Here we consider how to convert all article titles to Title case. The current code can be found at <a href="https://github.com/jkitchin/jmax/blob/master/jmax-bibtex.el">https://github.com/jkitchin/jmax/blob/master/jmax-bibtex.el</a> .
</p>

<p>
First, we need to decide on some rules. We will capitalize every word in a title except for words like a, an, the, &#x2026; unless they start the title. We do not want to change words with $, {} in them, or \, because these are either protected or LaTeX commands and we probably do not want to change them. The gist of our idea is to get the title, split it into words, capitalize each word that needs to be,  join the words together, and then set the entry title to the new capitalized title. 
</p>

<p>
We use functions from <a href="https://github.com/magnars/s.el">s.el</a> , and <a href="https://github.com/jkitchin/jmax/blob/master/org/doi-utils.org">doi-utils.org</a> here.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #8b0000;">defvar</span> <span style="color: #8b008b;">jmax-lower-case-words</span>
  '(<span style="color: #228b22;">"a"</span> <span style="color: #228b22;">"an"</span> <span style="color: #228b22;">"on"</span> <span style="color: #228b22;">"and"</span> <span style="color: #228b22;">"for"</span>
    <span style="color: #228b22;">"the"</span> <span style="color: #228b22;">"of"</span> <span style="color: #228b22;">"in"</span>)
  <span style="color: #228b22;">"List of words to keep lowercase"</span>)

(<span style="color: #8b0000;">defun</span> <span style="color: #8b2323;">jmax-title-case-article</span> (<span style="color: #4682b4;">&amp;optional</span> key start end)
  <span style="color: #228b22;">"Convert a bibtex entry article title to title-case. The</span>
<span style="color: #228b22;">arguments are optional, and are only there so you can use this</span>
<span style="color: #228b22;">function with `</span><span style="color: #cd0000;">bibtex-map-entries</span><span style="color: #228b22;">' to change all the title</span>
<span style="color: #228b22;">entries in articles."</span>
  (interactive)
  (bibtex-beginning-of-entry)

  (<span style="color: #8b0000;">let*</span> ((title (bibtex-autokey-get-field <span style="color: #228b22;">"title"</span>))
         (words (split-string title))
         (lower-case-words '(<span style="color: #228b22;">"a"</span> <span style="color: #228b22;">"an"</span> <span style="color: #228b22;">"on"</span> <span style="color: #228b22;">"and"</span> <span style="color: #228b22;">"for"</span>
                             <span style="color: #228b22;">"the"</span> <span style="color: #228b22;">"of"</span> <span style="color: #228b22;">"in"</span>)))
    (<span style="color: #8b0000;">when</span>
        (string= <span style="color: #228b22;">"article"</span> (downcase (cdr (assoc <span style="color: #228b22;">"=type="</span> (bibtex-parse-entry)))))
      (setq words (mapcar
                   (<span style="color: #8b0000;">lambda</span> (word)
                     (<span style="color: #8b0000;">if</span> (or
                          ;; <span style="color: #ff0000; font-weight: bold;">match words containing {} or \ which are probably</span>
                          ;; <span style="color: #ff0000; font-weight: bold;">LaTeX or protected words</span>
                          (string-match <span style="color: #228b22;">"\\$</span><span style="color: #228b22;">\\</span><span style="color: #228b22;">|</span><span style="color: #228b22;">{</span><span style="color: #228b22;">\\</span><span style="color: #228b22;">|</span><span style="color: #228b22;">}</span><span style="color: #228b22;">\\</span><span style="color: #228b22;">|</span><span style="color: #228b22;">\\\\"</span> word)
                          ;; <span style="color: #ff0000; font-weight: bold;">these words should not be capitalized, unless they</span>
                          ;; <span style="color: #ff0000; font-weight: bold;">are the first word</span>
                          (-contains? lower-case-words (s-downcase word)))
                         word
                       (s-capitalize word)))
                   words))

      ;; <span style="color: #ff0000; font-weight: bold;">Check if first word should be capitalized</span>
      (<span style="color: #8b0000;">when</span> (-contains? jmax-lower-case-words (car words))
        (setf (car words) (s-capitalize (car words))))
            
      ;; <span style="color: #ff0000; font-weight: bold;">this is defined in doi-utils</span>
      (bibtex-set-field
       <span style="color: #228b22;">"title"</span>
       (mapconcat 'identity words <span style="color: #228b22;">" "</span>))
      (bibtex-fill-entry))))
</pre>
</div>

<pre class="example">
jmax-title-case-article
</pre>


<p>
Now, a single command converts this:
</p>

<div class="org-src-container">

<pre class="src src-bibtex"><span style="color: #8b2323;">@article</span>{<span style="color: #cd0000;">campbell-2013-enthal-entrop</span>,
  <span style="color: #8b008b;">author</span> =       {Charles T. Campbell and Jason R. V. Sellers},
  <span style="color: #8b008b;">title</span> =        {Enthalpies and entropies of adsorption on
                  well-defined oxide surfaces: experimental
                  measurements},
  <span style="color: #8b008b;">journal</span> =      CR,
  <span style="color: #8b008b;">volume</span> =       113,
  <span style="color: #8b008b;">number</span> =       6,
  <span style="color: #8b008b;">pages</span> =        {4106-4135},
  <span style="color: #8b008b;">year</span> =         2013,
  <span style="color: #8b008b;">doi</span> =          {<span style="color: #3a5fcd; text-decoration: underline;">10.1021/cr300329s</span>},
  <span style="color: #8b008b;">url</span> =          {<span style="color: #3a5fcd; text-decoration: underline;">http://dx.doi.org/10.1021/cr300329s</span>},
  <span style="color: #8b008b;">month</span> =        6,
}
</pre>
</div>

<p>
to this:
</p>

<div class="org-src-container">

<pre class="src src-bibtex"><span style="color: #8b2323;">@article</span>{<span style="color: #cd0000;">campbell-2013-enthal-entrop</span>,
  <span style="color: #8b008b;">author</span> =       {Charles T. Campbell and Jason R. V. Sellers},
  <span style="color: #8b008b;">title</span> =        {Enthalpies and Entropies of Adsorption on
                  Well-defined Oxide Surfaces: Experimental
                  Measurements},
  <span style="color: #8b008b;">journal</span> =      CR,
  <span style="color: #8b008b;">volume</span> =       113,
  <span style="color: #8b008b;">number</span> =       6,
  <span style="color: #8b008b;">pages</span> =        {4106-4135},
  <span style="color: #8b008b;">year</span> =         2013,
  <span style="color: #8b008b;">doi</span> =          {<span style="color: #3a5fcd; text-decoration: underline;">10.1021/cr300329s</span>},
  <span style="color: #8b008b;">url</span> =          {<span style="color: #3a5fcd; text-decoration: underline;">http://dx.doi.org/10.1021/cr300329s</span>},
  <span style="color: #8b008b;">month</span> =        6,
}
</pre>
</div>

<p>
We wrote the title case function so we can use it with bibtex-map-entries. That means we can fix every entry in a file by putting a comment at the top like this:
</p>

<div class="org-src-container">

<pre class="src src-bibtex"><span style="color: #ff0000; font-weight: bold;">% (bibtex-map-entries 'jmax-title-case-article)  &lt;- put cursor here. C-x C-e</span>
</pre>
</div>

<p>
The function is not perfect, and does not include every word that should not be capitalized. You will still want to review your entries, but hopefully this saves some typing in the end.</p>
<p>Copyright (C) 2014 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2014/10/12/Title-casing-bibtex-entry-journal-titles.org">org-mode source</a><p><p>Org-mode version = 8.2.7c</p>]]></content>
  </entry>
  <entry>
    <author>
      <name></name>
      <uri>http://jkitchin.github.io/blog</uri>
    </author>
    <title type="html"><![CDATA[Abbreviated journal names in bibtex]]></title>
    <link rel="alternate" type="text/html" href="http://jkitchin.github.io/blog/2014/10/11/Abbreviated-journal-names-in-bibtex" />
    <id>http://jkitchin.github.io/blog/2014/10/11/Abbreviated-journal-names-in-bibtex</id>
    <updated>2014-10-11T17:31:59Z</updated>
    <published>2014-10-11T17:31:59Z</published>
    <category scheme="http://jkitchin.github.io/blog" term="bibtex" />
    <summary type="html"><![CDATA[Abbreviated journal names in bibtex]]></summary>
    <content type="html" xml:base="http://jkitchin.github.io/blog/2014/10/11/Abbreviated-journal-names-in-bibtex"><![CDATA[



<p>
Some journals require abbreviated journal names in the bibliography, and some require full names. Unfortunately, it is not possible to have both in your bibtex file. Or is it&#x2026;
</p>

<p>
It is possible to define a <a href="http://www.bibtex.org/Format/">@string</a> that is replaced in your bibtex file. If we have the definition of the @string in a separate file, we can specify its definition there, e.g. as an abbreviation, or as the full name. To make this useful, we need a simple way to add new journals, and to generate the definitions. 
</p>

<p>
First, you can find accepted journal name abbreviations here: <a href="http://cassi.cas.org/search.jsp">http://cassi.cas.org/search.jsp</a> . 
</p>

<p>
We are going to define a variable to hold the string definition, journal full name and an abbreviation. You can find our production version of what follows here: <a href="https://github.com/jkitchin/jmax/blob/master/jmax-bibtex.el">https://github.com/jkitchin/jmax/blob/master/jmax-bibtex.el</a> 
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #8b0000;">defvar</span> <span style="color: #8b008b;">jmax-bibtex-abbreviations</span>
  '((<span style="color: #228b22;">"ACAT"</span> <span style="color: #228b22;">"ACS Catalysis"</span> <span style="color: #228b22;">"ACS Catal."</span>)
    (<span style="color: #228b22;">"AM"</span> <span style="color: #228b22;">"Acta Materialia"</span> <span style="color: #228b22;">"Acta Mater."</span>)
    (<span style="color: #228b22;">"AMM"</span> <span style="color: #228b22;">"Acta Metallurgica et Materialia"</span> <span style="color: #228b22;">"Acta Metall. Mater."</span>)
    (<span style="color: #228b22;">"AMiner"</span> <span style="color: #228b22;">"American Mineralogist"</span> <span style="color: #228b22;">"Am. Mineral."</span>)
    (<span style="color: #228b22;">"AngC"</span> <span style="color: #228b22;">"Angewandte Chemie-International Edition"</span> <span style="color: #228b22;">"Angew. Chem. Int. Edit."</span>)
    (<span style="color: #228b22;">"APLM"</span> <span style="color: #228b22;">"APL Materials"</span> <span style="color: #228b22;">"APL Mat."</span>)
    (<span style="color: #228b22;">"ACBE"</span> <span style="color: #228b22;">"Applied Catalysis B: Environmental"</span> <span style="color: #228b22;">"Appl. Catal. B-Environ."</span>)
    (<span style="color: #228b22;">"APL"</span> <span style="color: #228b22;">"Applied Physics Letters"</span> <span style="color: #228b22;">"Appl. Phys. Lett."</span>)
    (<span style="color: #228b22;">"ASS"</span> <span style="color: #228b22;">"Applied Surface Science"</span> <span style="color: #228b22;">"Appl. Surf. Sci."</span>)
    (<span style="color: #228b22;">"CL"</span> <span style="color: #228b22;">"Catalysis Letters"</span> <span style="color: #228b22;">"Catal. Lett."</span>)
    (<span style="color: #228b22;">"CT"</span> <span style="color: #228b22;">"Catalysis Today"</span> <span style="color: #228b22;">"Catal. Today"</span>)
    (<span style="color: #228b22;">"CPL"</span> <span style="color: #228b22;">"Chemical Physics Letters"</span> <span style="color: #228b22;">"Chem. Phys. Lett"</span>)
    (<span style="color: #228b22;">"CR"</span> <span style="color: #228b22;">"Chemical Reviews"</span> <span style="color: #228b22;">"Chem. Rev."</span>)
    (<span style="color: #228b22;">"CSR"</span> <span style="color: #228b22;">"Chemical Society Reviews"</span> <span style="color: #228b22;">"Chem. Soc. Rev."</span>)
    (<span style="color: #228b22;">"CSR"</span> <span style="color: #228b22;">"Chemical Society Reviews"</span> <span style="color: #228b22;">"Chem. Soc. Rev."</span>)
    (<span style="color: #228b22;">"CM"</span> <span style="color: #228b22;">"Chemistry of Materials"</span> <span style="color: #228b22;">"Chem. Mater."</span>)
    (<span style="color: #228b22;">"CSA"</span> <span style="color: #228b22;">"Colloids and Surfaces, A: Physicochemical and Engineering Aspects"</span> <span style="color: #228b22;">"Colloids Surf., A"</span>)
    (<span style="color: #228b22;">"CPMS"</span> <span style="color: #228b22;">"Computational Materials Science"</span> <span style="color: #228b22;">"Comp. Mater. Sci."</span>)
    (<span style="color: #228b22;">"CPC"</span> <span style="color: #228b22;">"Computer Physics Communications"</span> <span style="color: #228b22;">"Comput. Phys. Commun."</span>)
    (<span style="color: #228b22;">"CGD"</span> <span style="color: #228b22;">"Crystal Growth \\&amp; Design"</span> <span style="color: #228b22;">"Cryst. Growth Des."</span>)
    (<span style="color: #228b22;">"CEC"</span> <span style="color: #228b22;">"CrystEngComm"</span> <span style="color: #228b22;">"CrystEngComm"</span>)
    (<span style="color: #228b22;">"ECST"</span> <span style="color: #228b22;">"ECS Transactions"</span> <span style="color: #228b22;">"ECS Trans."</span>)
    (<span style="color: #228b22;">"EES"</span> <span style="color: #228b22;">"Energy \\&amp; Environmental Science"</span> <span style="color: #228b22;">"Energy Environ. Sci."</span>)
    (<span style="color: #228b22;">"HPR"</span> <span style="color: #228b22;">"High Pressure Research"</span> <span style="color: #228b22;">"High Pressure Res."</span>)
    (<span style="color: #228b22;">"IC"</span> <span style="color: #228b22;">"Inorganic Chemistry"</span> <span style="color: #228b22;">"Inorg. Chem."</span>)
    (<span style="color: #228b22;">"IECR"</span> <span style="color: #228b22;">"Industrial \\&amp; Engineering Chemistry Research"</span> <span style="color: #228b22;">"Ind. Eng. Chem. Res."</span>)
    (<span style="color: #228b22;">"JJAP"</span> <span style="color: #228b22;">"Japanese Journal of Applied Physics"</span> <span style="color: #228b22;">"Jpn. J. Appl. Phys."</span>)
    (<span style="color: #228b22;">"JMatR"</span> <span style="color: #228b22;">"Journal of  Materials Research"</span> <span style="color: #228b22;">"J. Mater. Res."</span>)
    (<span style="color: #228b22;">"JALC"</span> <span style="color: #228b22;">"Journal of Alloys and Compounds"</span> <span style="color: #228b22;">"J. Alloy Compd."</span>)
    (<span style="color: #228b22;">"JAC"</span> <span style="color: #228b22;">"Journal of Applied Crystallography"</span> <span style="color: #228b22;">"J. Appl. Crystallogr."</span>)
    (<span style="color: #228b22;">"JAP"</span> <span style="color: #228b22;">"Journal of Applied Physics"</span> <span style="color: #228b22;">"J. Appl. Phys."</span>)
    (<span style="color: #228b22;">"JC"</span> <span style="color: #228b22;">"Journal of Catalysis"</span> <span style="color: #228b22;">"J. Catal."</span>)
    (<span style="color: #228b22;">"JCP"</span> <span style="color: #228b22;">"Journal of Chemical Physics"</span> <span style="color: #228b22;">"J. Chem. Phys."</span>)
    (<span style="color: #228b22;">"JCG"</span> <span style="color: #228b22;">"Journal of Crystal Growth"</span> <span style="color: #228b22;">"J. Crys. Growth"</span>)
    (<span style="color: #228b22;">"JMC"</span> <span style="color: #228b22;">"Journal of Materials Chemistry"</span> <span style="color: #228b22;">"J. Mater. Chem."</span>)
    (<span style="color: #228b22;">"JMC"</span> <span style="color: #228b22;">"Journal of Materials Chemistry"</span> <span style="color: #228b22;">"J. Mater. Chem."</span>)
    (<span style="color: #228b22;">"JMSL"</span> <span style="color: #228b22;">"Journal of Materials Science Letters"</span> <span style="color: #228b22;">"J. Mater. Sci. Lett."</span>)
    (<span style="color: #228b22;">"JMS"</span> <span style="color: #228b22;">"Journal of Membrane Science"</span> <span style="color: #228b22;">"J. Memb. Sci."</span>)
    (<span style="color: #228b22;">"JPE"</span> <span style="color: #228b22;">"Journal of Phase Equilibria"</span> <span style="color: #228b22;">"J. Phase Equilib."</span>)
    (<span style="color: #228b22;">"JPCS"</span> <span style="color: #228b22;">"Journal of Physics and Chemistry of Solids"</span> <span style="color: #228b22;">"J. Phys. Chem. Solids"</span>)
    (<span style="color: #228b22;">"JPCM"</span> <span style="color: #228b22;">"Journal of Physics: Condensed Matter"</span> <span style="color: #228b22;">"J. Phys.: Condens. Matter"</span>)
    (<span style="color: #228b22;">"JSSC"</span> <span style="color: #228b22;">"Journal of Solid State Chemistry"</span> <span style="color: #228b22;">"J. Solid State Chem."</span>)
    (<span style="color: #228b22;">"JACerS"</span> <span style="color: #228b22;">"Journal of the American Ceramic Society"</span> <span style="color: #228b22;">"J. Am. Ceram. Soc."</span>)
    (<span style="color: #228b22;">"JACS"</span> <span style="color: #228b22;">"Journal of the American Chemical Society"</span> <span style="color: #228b22;">"J. Am. Chem. Soc."</span>)
    (<span style="color: #228b22;">"JES"</span> <span style="color: #228b22;">"Journal of The Electrochemical Society"</span> <span style="color: #228b22;">"J. Electrochem. Soc."</span>)
    (<span style="color: #228b22;">"JES"</span> <span style="color: #228b22;">"Journal of The Electrochemical Society"</span> <span style="color: #228b22;">"J. Electrochem. Soc."</span>)
    (<span style="color: #228b22;">"JMS"</span> <span style="color: #228b22;">"Journal of Membrane Science"</span> <span style="color: #228b22;">"J. Memb. Sci."</span>)
    (<span style="color: #228b22;">"JVST"</span> <span style="color: #228b22;">"Journal of Vacuum Science \\&amp; Technology A"</span> <span style="color: #228b22;">"J. Vac. Sci. Technol. A"</span>)
    (<span style="color: #228b22;">"ML"</span> <span style="color: #228b22;">"Materials Letters"</span> <span style="color: #228b22;">"Mater. Lett."</span>)
    (<span style="color: #228b22;">"MSE-BS"</span> <span style="color: #228b22;">"Materials Science and Engineering B"</span> <span style="color: #228b22;">"Mat. Sci. Eng. B-Solid"</span>)
    (<span style="color: #228b22;">"MOLSIM"</span> <span style="color: #228b22;">"Molecular Simulation"</span> <span style="color: #228b22;">"Mol. Sim."</span>)
    (<span style="color: #228b22;">"Nature"</span> <span style="color: #228b22;">"Nature"</span> <span style="color: #228b22;">"Nature"</span>)
    (<span style="color: #228b22;">"NM"</span> <span style="color: #228b22;">"Nature Materials"</span> <span style="color: #228b22;">"Nat. Mater."</span>)
    (<span style="color: #228b22;">"PML"</span> <span style="color: #228b22;">"Philosophical Magazine Letters"</span> <span style="color: #228b22;">"Phil. Mag. Lett."</span>)
    (<span style="color: #228b22;">"PMA"</span> <span style="color: #228b22;">"Philosophical Magazine A"</span> <span style="color: #228b22;">"Phil. Mag. A"</span>)
    (<span style="color: #228b22;">"PA"</span> <span style="color: #228b22;">"Physica A: Statistical Mechanics and its Applications"</span> <span style="color: #228b22;">"Physica A"</span>)
    (<span style="color: #228b22;">"PB"</span> <span style="color: #228b22;">"Physica B-Condensed Matter"</span> <span style="color: #228b22;">"Physica B"</span>)
    (<span style="color: #228b22;">"PCCP"</span> <span style="color: #228b22;">"Physical Chemistry Chemical Physics"</span> <span style="color: #228b22;">"Phys. Chem. Chem. Phys."</span>)
    (<span style="color: #228b22;">"PSSB"</span> <span style="color: #228b22;">"physica status solidi (b)"</span> <span style="color: #228b22;">"Phys. Status Solidi B"</span>)
    (<span style="color: #228b22;">"PRA"</span> <span style="color: #228b22;">"Physical Review A"</span> <span style="color: #228b22;">"Phys. Rev. A"</span>)
    (<span style="color: #228b22;">"PRB"</span> <span style="color: #228b22;">"Physical Review B"</span> <span style="color: #228b22;">"Phys. Rev. B"</span>)
    (<span style="color: #228b22;">"PRL"</span> <span style="color: #228b22;">"Physical Review Letters"</span> <span style="color: #228b22;">"Phys. Rev. Lett."</span>)
    (<span style="color: #228b22;">"PCM"</span> <span style="color: #228b22;">"Physics and Chemistry of Minerals"</span> <span style="color: #228b22;">"Phys. Chem. Miner."</span>)
    (<span style="color: #228b22;">"PSurfSci"</span> <span style="color: #228b22;">"Progress in Surface Science"</span> <span style="color: #228b22;">"Prog. Surf. Sci."</span>)
    (<span style="color: #228b22;">"Science"</span> <span style="color: #228b22;">"Science"</span> <span style="color: #228b22;">"Science"</span>)
    (<span style="color: #228b22;">"SABC"</span> <span style="color: #228b22;">"Sensors and Actuators B: Chemical"</span> <span style="color: #228b22;">"Sensor. Actuat. B-Chem."</span>)
    (<span style="color: #228b22;">"SS"</span> <span style="color: #228b22;">"Surface Science"</span> <span style="color: #228b22;">"Surf. Sci."</span>)
    (<span style="color: #228b22;">"EPJB"</span> <span style="color: #228b22;">"The European Physical Journal B"</span> <span style="color: #228b22;">"Eur. Phys. J. B"</span>)
    (<span style="color: #228b22;">"JPC"</span> <span style="color: #228b22;">"The Journal of Physical Chemistry"</span> <span style="color: #228b22;">"J. Phys. Chem."</span>)
    (<span style="color: #228b22;">"JPCB"</span> <span style="color: #228b22;">"The Journal of Physical Chemistry  B"</span> <span style="color: #228b22;">"J. Phys. Chem. B"</span>)
    (<span style="color: #228b22;">"JPCC"</span> <span style="color: #228b22;">"The Journal of Physical Chemistry C"</span> <span style="color: #228b22;">"J. Phys. Chem. C"</span>)
    (<span style="color: #228b22;">"JCP"</span> <span style="color: #228b22;">"The Journal of Chemical Physics"</span> <span style="color: #228b22;">"J. Chem. Phys."</span>)
    (<span style="color: #228b22;">"TSF"</span> <span style="color: #228b22;">"Thin Solid Films"</span> <span style="color: #228b22;">"Thin Solid Films"</span>)
    (<span style="color: #228b22;">"TC"</span> <span style="color: #228b22;">"Topics in Catalysis"</span> <span style="color: #228b22;">"Top. Catal."</span>)
    (<span style="color: #228b22;">"WR"</span> <span style="color: #228b22;">"Water Research"</span> <span style="color: #228b22;">"Water Res."</span>))
  <span style="color: #228b22;">"List of (string journal-full-name journal-abbreviation)"</span>)
</pre>
</div>

<pre class="example">
bibtex-abbreviations
</pre>

<p>
This data structure will serve a few purposes.
</p>

<ol class="org-ol">
<li>We will generate the bib files that define the @string definitions
</li>
<li>We will use it to modify bibtex files to use those strings.
</li>
</ol>

<p>
First, here are some simple functions to generate the @string definitions.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #8b0000;">defun</span> <span style="color: #8b2323;">jmax-bibtex-generate-longtitles</span> ()
  (interactive)
  (<span style="color: #8b0000;">with-temp-file</span> <span style="color: #228b22;">"longtitles.bib"</span>
    (<span style="color: #8b0000;">dolist</span> (row bibtex-abbreviations)
      (insert (format <span style="color: #228b22;">"@string{%s=\"%s\"}\n"</span>
                      (nth 0 row)
                      (nth 1 row))))))

(<span style="color: #8b0000;">defun</span> <span style="color: #8b2323;">jmax-bibtex-generate-shorttitles</span> ()
  (interactive)
  (<span style="color: #8b0000;">with-temp-file</span> <span style="color: #228b22;">"shorttitles.bib"</span>
    (<span style="color: #8b0000;">dolist</span> (row bibtex-abbreviations)
      (insert (format <span style="color: #228b22;">"@string{%s=\"%s\"}\n"</span>
                      (nth 0 row)
                      (nth 2 row))))))
</pre>
</div>

<pre class="example">
jmax-bibtex-generate-shorttitles
</pre>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(jmax-bibtex-generate-longtitles)
(jmax-bibtex-generate-shorttitles)
</pre>
</div>

<p>
Here are the results of running that code: <a href="/media/2014-10-11-Abbreviated-journal-names-in-bibtex/shorttitles.bib">shorttitles.bib</a> and <a href="/media/2014-10-11-Abbreviated-journal-names-in-bibtex/longtitles.bib">longtitles.bib</a> . This is the first step. We have the @strings defined. Now, we need to convert the names in a bibtex entry to use our string. We want to replace full names and abbreviated names with the @string.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #8b0000;">defun</span> <span style="color: #8b2323;">jmax-stringify-journal-name</span> (<span style="color: #4682b4;">&amp;optional</span> key start end)
  <span style="color: #228b22;">"replace journal name with a string. The strings are defined in `</span><span style="color: #cd0000;">bibtex-abbreviations</span><span style="color: #228b22;">'."</span>
  (interactive)
  (bibtex-beginning-of-entry)
  (<span style="color: #8b0000;">when</span>
      (string= <span style="color: #228b22;">"article"</span>
               (downcase
                (cdr (assoc <span style="color: #228b22;">"=type="</span> (bibtex-parse-entry)))))
    (<span style="color: #8b0000;">let*</span> ((full-names (mapcar
                        (<span style="color: #8b0000;">lambda</span> (row)
                          (cons  (nth 1 row) (nth 0 row)))
                        bibtex-abbreviations))
           (abbrev-names (mapcar
                          (<span style="color: #8b0000;">lambda</span> (row)
                            (cons  (nth 2 row) (nth 0 row)))
                          bibtex-abbreviations))
           (journal (s-trim (bibtex-autokey-get-field <span style="color: #228b22;">"journal"</span>)))
           (bstring (or
                     (cdr (assoc journal full-names))
                     (cdr (assoc journal abbrev-names)))))
      (<span style="color: #8b0000;">when</span> bstring
        (bibtex-set-field <span style="color: #228b22;">"journal"</span> bstring t)
        (bibtex-fill-entry)))))
</pre>
</div>

<pre class="example">
jmax-stringify-journal-name
</pre>

<p>
Now, with a single command, we can convert this:
</p>

<div class="org-src-container">

<pre class="src src-bibtex"><span style="color: #8b2323;">@article</span>{<span style="color: #cd0000;">lizzit-2001-surfac-ru</span>,
  <span style="color: #8b008b;">author</span> =       {S. Lizzit and A. Baraldi and A. Groso and K. Reuter
                  and M. Ganduglia-Pirovano and C. Stampfl and
                  M. Scheffler and M. Stichler and C. Keller and
                  W. Wurth and D. Menzel},
  <span style="color: #8b008b;">title</span> =        {Surface Core-level Shifts of Clean and
                  Oxygen-covered {R}u(0001)},
  <span style="color: #8b008b;">journal</span> =      {Physical Review B,
  <span style="color: #8b008b;">volume</span> =       63,
  <span style="color: #8b008b;">number</span> =       20,
  <span style="color: #8b008b;">pages</span> =        {nil},
  <span style="color: #8b008b;">year</span> =         2001,
  <span style="color: #8b008b;">doi</span> =          {<span style="color: #3a5fcd; text-decoration: underline;">10.1103/physrevb.63.205419</span>},
  <span style="color: #8b008b;">url</span> =          {<span style="color: #3a5fcd; text-decoration: underline;">http://dx.doi.org/10.1103/PhysRevB.63.205419</span>},
  <span style="color: #8b008b;">month</span> =        5,
}
</pre>
</div>

<p>
into this:
</p>

<div class="org-src-container">

<pre class="src src-bibtex"><span style="color: #8b2323;">@article</span>{<span style="color: #cd0000;">lizzit-2001-surfac-ru</span>,
  <span style="color: #8b008b;">author</span> =       {S. Lizzit and A. Baraldi and A. Groso and K. Reuter
                  and M. Ganduglia-Pirovano and C. Stampfl and
                  M. Scheffler and M. Stichler and C. Keller and
                  W. Wurth and D. Menzel},
  <span style="color: #8b008b;">title</span> =        {Surface Core-level Shifts of Clean and
                  Oxygen-covered {R}u(0001)},
  <span style="color: #8b008b;">journal</span> =      PRB,
  <span style="color: #8b008b;">volume</span> =       63,
  <span style="color: #8b008b;">number</span> =       20,
  <span style="color: #8b008b;">pages</span> =        {nil},
  <span style="color: #8b008b;">year</span> =         2001,
  <span style="color: #8b008b;">doi</span> =          {<span style="color: #3a5fcd; text-decoration: underline;">10.1103/physrevb.63.205419</span>},
  <span style="color: #8b008b;">url</span> =          {<span style="color: #3a5fcd; text-decoration: underline;">http://dx.doi.org/10.1103/PhysRevB.63.205419</span>},
  <span style="color: #8b008b;">month</span> =        5,
}
</pre>
</div>

<p>
If you have a lot of entries you want to modify, you can use bibtex-map-entries like this. Basically, put the elisp form in a comment, and then execute the elisp form
</p>

<div class="org-src-container">

<pre class="src src-bibtex"><span style="color: #ff0000; font-weight: bold;">%% (bibtex-map-entries 'jmax-stringify-journal-name)  &lt;- put cursor here. C-x C-e</span>
</pre>
</div>

<p>
This saves some effort. Over time, I will keep adding entries to the abbreviation table. As long as a standard journal name or abbreviation is in your bibtex file, this approach should work pretty well. After you replace the journal names with @string entries, you have to generate the string file, either shorttitles.bib or longtitles.bib, and in your LaTeX file, change your bibliography line to:
</p>

<div class="org-src-container">

<pre class="src src-latex"><span style="color: #8b0000;">\bibliography</span>{<span style="color: #cd0000;">shorttitles,references</span>}
</pre>
</div>

<p>
The order is important. The @string definitions are in shorttitles.bib, and your bibtex entries in references.bib.</p>
<p>Copyright (C) 2014 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2014/10/11/Abbreviated-journal-names-in-bibtex.org">org-mode source</a><p><p>Org-mode version = 8.2.7c</p>]]></content>
  </entry>
  <entry>
    <author>
      <name></name>
      <uri>http://jkitchin.github.io/blog</uri>
    </author>
    <title type="html"><![CDATA[Automatic downloading of a pdf from a journal site]]></title>
    <link rel="alternate" type="text/html" href="http://jkitchin.github.io/blog/2014/05/23/Automatic-downloading-of-a-pdf-from-a-journal-site" />
    <id>http://jkitchin.github.io/blog/2014/05/23/Automatic-downloading-of-a-pdf-from-a-journal-site</id>
    <updated>2014-05-23T11:44:11Z</updated>
    <published>2014-05-23T11:44:11Z</published>
    <category scheme="http://jkitchin.github.io/blog" term="emacs" />
    <category scheme="http://jkitchin.github.io/blog" term="bibtex" />
    <summary type="html"><![CDATA[Automatic downloading of a pdf from a journal site]]></summary>
    <content type="html" xml:base="http://jkitchin.github.io/blog/2014/05/23/Automatic-downloading-of-a-pdf-from-a-journal-site"><![CDATA[


<p>
Many bibliography software packages can automatically download a pdf for you. In this post, we explore how that can be done from emacs. The principle idea is that the pdf is obtained from a url, and that you can calculate the url by some method. Then you can download the file. 
</p>

<p>
For example, consider this article in Phys. Rev. Lett. <a href="http://journals.aps.org/prl/abstract/10.1103/PhysRevLett.99.016105">http://journals.aps.org/prl/abstract/10.1103/PhysRevLett.99.016105</a> . There is a link to get the pdf for this article at <a href="http://journals.aps.org/prl/pdf/10.1103/PhysRevLett.99.016105">http://journals.aps.org/prl/pdf/10.1103/PhysRevLett.99.016105</a> . It is not difficult to construct that url; you just replace <code>/abstract/</code> with <code>/pdf/</code>.
</p>

<p>
The trick is how to get the first url. We have previously seen that we can construct a bibtex entry from a doi. In fact, we can use the doi to get the url above. If you visit <a href="http://dx.doi.org/10.1103/PhysRevLett.99.016105">http://dx.doi.org/10.1103/PhysRevLett.99.016105</a> , you will be redirected to the url. It so happens that you can use code to get the redirected url. In emacs-lisp it is a little convoluted; you have to use url-retrieve, and provide a callback that sets the redirect. Here is an example. It appears you need to run this block twice to get the right variable setting. That seems like some kind of error in what I have set up, but I cannot figure out why.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(defvar *doi-utils-redirect*)

(defun callback (&amp;optional status)
 (when status ;  is nil if there none
   (setq *doi-utils-redirect* (plist-get status :redirect))))

(url-retrieve 
  "http://dx.doi.org/10.1103/PhysRevLett.99.016105"
  'callback)

(print *doi-utils-redirect*)
</pre>
</div>

<pre class="example">
"http://journals.aps.org/prl/abstract/10.1103/PhysRevLett.99.016105"
</pre>

<p>
From there, creating the pdf url is as simple as
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(replace-regexp-in-string "prl/abstract" "prl/pdf" "http://journals.aps.org/prl/abstract/10.1103/PhysRevLett.99.016105")
</pre>
</div>

<pre class="example">
http://journals.aps.org/prl/pdf/10.1103/PhysRevLett.99.016105
</pre>

<p>
And finally we download the file with
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(url-copy-file "http://journals.aps.org/prl/pdf/10.1103/PhysRevLett.99.016105" "PhysRevLett.99.016105.pdf" nil)
</pre>
</div>

<pre class="example">
t
</pre>

<p>
So that is the gist of automating pdf downloads. You do these steps:
</p>
<ol class="org-ol">
<li>Get the DOI
</li>
<li>Get the url that the DOI redirects to
</li>
<li>Calculate the link to the pdf
</li>
<li>Download the pdf
</li>
</ol>

<p>
Each publisher does something a little bit different, so you have to work this out for each one. I have worked alot of them out at <a href="https://github.com/jkitchin/jmax/blob/master/user/doi-utils.el">https://github.com/jkitchin/jmax/blob/master/user/doi-utils.el</a> . That file is a work in progress, but it is a project I intend to use on a regular basis.
</p>
<p>Copyright (C) 2014 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2014/05/23/Automatic-downloading-of-a-pdf-from-a-journal-site.org">org-mode source</a><p><p>Org-mode version = 8.2.6</p>]]></content>
  </entry>
  <entry>
    <author>
      <name></name>
      <uri>http://jkitchin.github.io/blog</uri>
    </author>
    <title type="html"><![CDATA[Converting a doi to a bibtex entry]]></title>
    <link rel="alternate" type="text/html" href="http://jkitchin.github.io/blog/2014/05/22/Converting-a-doi-to-a-bibtex-entry" />
    <id>http://jkitchin.github.io/blog/2014/05/22/Converting-a-doi-to-a-bibtex-entry</id>
    <updated>2014-05-22T16:22:31Z</updated>
    <published>2014-05-22T16:22:31Z</published>
    <category scheme="http://jkitchin.github.io/blog" term="bibtex" />
    <summary type="html"><![CDATA[Converting a doi to a bibtex entry]]></summary>
    <content type="html" xml:base="http://jkitchin.github.io/blog/2014/05/22/Converting-a-doi-to-a-bibtex-entry"><![CDATA[


<p>
Many citation management packages allow you to download a bibliography entry from a doi. I want to be able to do that in emacs. I found this <a href="http://homepages.see.leeds.ac.uk/~eeaol/notes/2013/02/doi-metadata/">page</a> that shows it is possible to get metadata about a doi with an http request, and from that data, we can create a bibtex entry. So, here is the basic code for getting metadata about a doi. We specify that we want json code, and then use <a href="http://edward.oconnor.cx/2006/03/json.el">json.el</a> to view the results.
</p>

<p>
We temporarily set a few url-* variables with affect the url-retrieve results. And we rely on url-http-end-of-headers which tells us the end of the headers that get returned, so we can use the remaining text as the data.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(require 'json)

(let ((url-request-method "GET") 
      (url-mime-accept-string "application/citeproc+json")
      (json-object-type 'plist)
      (results))
  (setq results 
	(with-current-buffer (url-retrieve-synchronously "http://dx.doi.org/10.1016/S0022-0248(97)00279-0")
	  (json-read-from-string (buffer-substring url-http-end-of-headers (point-max))))))
</pre>
</div>

<p>
(:volume 181 :indexed (:timestamp 1389218884442 :date-parts <i>2014 1 8</i>) :publisher Elsevier BV :source CrossRef :URL <a href="http://dx.doi.org/10.1016/S0022-0248(97)">http://dx.doi.org/10.1016/S0022-0248(97)</a> 00279-0 :ISSN [0022-0248] :DOI 10.1016/s0022-0248(97)00279-0 :type journal-article :title Effect of growth conditions on formation of TiO2-II thin films in atomic layer deposition process :issue 3 :deposited (:timestamp 1386028800000 :date-parts <i>2013 12 3</i>) :page 259-264 :reference-count nil :container-title Journal of Crystal Growth :author [(:given Jaan :family Aarik) (:given Aleks :family Aidla) (:given Vino :family Sammelselg) (:given Teet :family Uustare)] :prefix <a href="http://id.crossref.org/prefix/10.1016">http://id.crossref.org/prefix/10.1016</a> :score 1.0 :issued (:date-parts <i>1997 11</i>) :subject [Condensed Matter Physics Inorganic Chemistry Materials Chemistry] :subtitle [])
</p>

<p>
That data is now sufficient for us to consider constructing a bibtex entry. For an article, a prototypical entry looks like:
</p>

<pre class="example">
@Article{,
  author = 	 {},
  title = 	 {},
  journal = 	 {},
  year = 	 {},
  OPTkey = 	 {},
  OPTvolume = 	 {},
  OPTnumber = 	 {},
  OPTpages = 	 {},
  OPTmonth = 	 {},
  OPTnote = 	 {},
  OPTannote = 	 {}
}
</pre>

<p>
Let us create a function that takes a doi and constructs a bibtex entry. I do not use all the metadata, so I just store the json data in the annote field. Maybe I should use another field for that, but annote seems ok since I do not use if for anything. I am going to use a template expansion function I developed earlier to make the bibtex entry template easier to write and read. Here is the code.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(require 'json)

(defun expand-template (s)
  "expand a template containing %{} with the eval of its contents"
  (replace-regexp-in-string "%{\\([^}]+\\)}"
                            (lambda (arg)
                              (let ((sexp (substring arg 2 -1)))
                                (format "%s" (eval (read sexp))))) s))

(defun doi-to-bibtex-article (doi)
 "insert a bibtex entry for doi at point"
 (interactive "sDOI: ")
 (let ((url-request-method "GET") 
       (url-mime-accept-string "application/citeproc+json")
       (json-object-type 'plist)
       type
       results
       author
       title
       journal
       year
       volume
       number
       pages
       month
       url json-data)
   
   (setq results 
	 (with-current-buffer
	     (url-retrieve-synchronously
	      (concat "http://dx.doi.org/" doi))
	 (json-read-from-string (buffer-substring url-http-end-of-headers (point-max))))
         type (plist-get results :type)
	 author (mapconcat (lambda (x) (concat (plist-get x :given) " " (plist-get x :family)))
		     (plist-get results :author) " and ")
	 title (plist-get results :title)
	 journal (plist-get results :container-title)
	 volume (plist-get results :volume)
	 issue (plist-get results :issue)
	 year (elt (elt (plist-get (plist-get results :issued) :date-parts) 0) 0)
	 month (elt (elt (plist-get (plist-get results :issued) :date-parts) 0) 1)
	 pages (plist-get results :page)
	 doi (plist-get results :DOI)
	 url (plist-get results :URL)
	 json-data (format "%s" results))

   (when (string= type "journal-article")

     (expand-template "@article{,
  author = 	 {%{author}},
  title = 	 {%{title}},
  journal = 	 {%{journal}},
  year = 	 {%{year}},
  volume = 	 {%{volume}},
  number = 	 {%{issue}},
  pages = 	 {%{pages}},
  doi =          {%{doi}},
  url =          {%{url}},
  month = 	 {%{month}},
  json = 	 {%{json-data}}
}"))))
   
(doi-to-bibtex-article "10.1016/s0022-0248(97)00279-0")
</pre>
</div>

<pre class="example">
@article{,
  author = 	 {Jaan Aarik and Aleks Aidla and Vino Sammelselg and Teet Uustare},
  title = 	 {Effect of growth conditions on formation of TiO2-II thin films in atomic layer deposition process},
  journal = 	 {Journal of Crystal Growth},
  year = 	 {1997},
  volume = 	 {181},
  number = 	 {3},
  pages = 	 {259-264},
  doi =          {10.1016/s0022-0248(97)00279-0},
  url =          {http://dx.doi.org/10.1016/s0022-0248(97)00279-0},
  month = 	 {11},
  json = 	 {(:volume 181 :indexed (:timestamp 1389218884442 :date-parts [[2014 1 8]]) :publisher Elsevier BV :source CrossRef :URL http://dx.doi.org/10.1016/s0022-0248(97)00279-0 :ISSN [0022-0248] :DOI 10.1016/s0022-0248(97)00279-0 :type journal-article :title Effect of growth conditions on formation of TiO2-II thin films in atomic layer deposition process :issue 3 :deposited (:timestamp 1386028800000 :date-parts [[2013 12 3]]) :page 259-264 :reference-count nil :container-title Journal of Crystal Growth :author [(:given Jaan :family Aarik) (:given Aleks :family Aidla) (:given Vino :family Sammelselg) (:given Teet :family Uustare)] :prefix http://id.crossref.org/prefix/10.1016 :score 1.0 :issued (:date-parts [[1997 11]]) :subject [Condensed Matter Physics Inorganic Chemistry Materials Chemistry] :subtitle [])}
}
</pre>

<p>
That looks excellent. Note there are some non-ascii characters in it, which would have to be fixed. Let us try it on an ASAP article.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(doi-to-bibtex-article "10.1021/ie403744u")
</pre>
</div>

<pre class="example">
@article{,
  author = 	 {Jos A. Delgado and V. I. gueda and M. A. Uguina and J. L. Sotelo and P. Brea and Carlos A. Grande},
  title = 	 { Adsorption and Diffusion of H 2 , CO, CH 4 , and CO 2 in BPL Activated Carbon and 13X Zeolite: Evaluation of Performance in Pressure Swing Adsorption Hydrogen Purification by Simulation },
  journal = 	 {Industrial &amp; Engineering Chemistry Research},
  year = 	 {2014},
  volume = 	 {nil},
  number = 	 {nil},
  pages = 	 {140117091024005},
  doi =          {10.1021/ie403744u},
  url =          {http://dx.doi.org/10.1021/ie403744u},
  month = 	 {1},
  json = 	 {(:indexed (:timestamp 1392935578089 :date-parts [[2014 2 20]]) :publisher American Chemical Society (ACS) :source CrossRef :URL http://dx.doi.org/10.1021/ie403744u :ISSN [0888-5885 1520-5045] :DOI 10.1021/ie403744u :type journal-article :title  Adsorption and Diffusion of H 2 , CO, CH 4 , and CO 2 in BPL Activated Carbon and 13X Zeolite: Evaluation of Performance in Pressure Swing Adsorption Hydrogen Purification by Simulation  :deposited (:timestamp 1389916800000 :date-parts [[2014 1 17]]) :page 140117091024005 :reference-count nil :container-title Industrial &amp; Engineering Chemistry Research :author [(:given Jos A. :family Delgado) (:given V. I. :family gueda) (:given M. A. :family Uguina) (:given J. L. :family Sotelo) (:given P. :family Brea) (:given Carlos A. :family Grande)] :prefix http://id.crossref.org/prefix/10.1021 :score 1.0 :issued (:date-parts [[2014 1 17]]) :subject [Chemistry(all) Industrial and Manufacturing Engineering Chemical Engineering(all)] :subtitle [])}
}
</pre>

<p>
You see that nil is put in for missing entries. That is probably ok. There is an &amp; in the journal that needs to be cleaned up, but that is easily done with org-ref-clean-bibtex-entry. In summary, this looks like a very convenient way to get bibtex entries inside emacs. I should probably have the function insert that string to a buffer at point, but that is not difficult to do.
</p>
<p>Copyright (C) 2014 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2014/05/22/Converting-a-doi-to-a-bibtex-entry.org">org-mode source</a><p><p>Org-mode version = 8.2.6</p>]]></content>
  </entry>
  <entry>
    <author>
      <name></name>
      <uri>http://jkitchin.github.io/blog</uri>
    </author>
    <title type="html"><![CDATA[org-shift hooks for ordering citations]]></title>
    <link rel="alternate" type="text/html" href="http://jkitchin.github.io/blog/2014/05/21/org-shift-hooks-for-ordering-citations" />
    <id>http://jkitchin.github.io/blog/2014/05/21/org-shift-hooks-for-ordering-citations</id>
    <updated>2014-05-21T11:37:40Z</updated>
    <published>2014-05-21T11:11:56Z</published>
    <category scheme="http://jkitchin.github.io/blog" term="org-mode" />
    <category scheme="http://jkitchin.github.io/blog" term="bibtex" />
    <summary type="html"><![CDATA[org-shift hooks for ordering citations]]></summary>
    <content type="html" xml:base="http://jkitchin.github.io/blog/2014/05/21/org-shift-hooks-for-ordering-citations"><![CDATA[


<p>
I wrote a function that sorts citations by year, but there might be a reason to order them some other way. Here we develop a method to use shift-arrow keys to do the ordering. We will need to write a function that gets the citations in a link, gets the key under point, and then swap with neighboring keys depending on the arrow pressed. It is trivial to get the key under point (org-ref-get-bibtex-key-under-cursor), and we saw before it is easy to get the keys in a link. Let us examine swapping elements of a list here. This is an old algorithm, we store the first value, replace it with the second value, and then set the second value.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(defun org-ref-swap-keys (i j keys)
 "swap the keys in a list with index i and j"
 (let ((tempi (nth i keys)))
   (setf (nth i keys) (nth j keys))
   (setf (nth j keys) tempi))
  keys)

(org-ref-swap-keys 2 3 '(1 2 3 4))
</pre>
</div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="right" />

<col  class="right" />

<col  class="right" />

<col  class="right" />
</colgroup>
<tbody>
<tr>
<td class="right">1</td>
<td class="right">2</td>
<td class="right">4</td>
<td class="right">3</td>
</tr>
</tbody>
</table>

<p>
So, we need to get the keys in the link at point, the key at point, the index of the key at point, and then we can swap them, and reconstruct the link. Here is the function that does this, and that adds the hooks.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(defun org-ref-swap-citation-link (direction)
 "move citation at point in direction +1 is to the right, -1 to the left"
 (interactive)
 (let* ((object (org-element-context))	 
        (type (org-element-property :type object))
	(begin (org-element-property :begin object))
	(end (org-element-property :end object))
	(link-string (org-element-property :path object))
        (key (org-ref-get-bibtex-key-under-cursor))
	(keys (org-ref-split-and-strip-string link-string))
        (i (index key keys)) point) ;; defined in org-ref
   (if (&gt; direction 0) ;; shift right
     (org-ref-swap-keys i (+ i 1) keys)
     (org-ref-swap-keys i (- i 1) keys))	
  (setq keys (mapconcat 'identity keys ","))
  ;; and replace the link with the sorted keys
  (cl--set-buffer-substring begin end (concat type ":" keys))
  ;; now go forward to key so we can move with the key
  (re-search-forward key) 
  (goto-char (match-beginning 0))))

(add-hook 'org-shiftright-hook (lambda () (org-ref-swap-citation-link 1)))
(add-hook 'org-shiftleft-hook (lambda () (org-ref-swap-citation-link -1)))
</pre>
</div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="left" />

<col  class="left" />

<col  class="left" />
</colgroup>
<tbody>
<tr>
<td class="left">lambda</td>
<td class="left">nil</td>
<td class="left">(org-ref-swap-citation-link -1)</td>
</tr>
</tbody>
</table>

<p>
<a href="#kanan-2008-in-situ">kanan-2008-in-situ</a>,<a href="#kanan-2009-cobal">kanan-2009-cobal</a>,<a href="#lutterman-2009-self-healin">lutterman-2009-self-healin</a>,<a href="#mcalpin-2010-epr-eviden">mcalpin-2010-epr-eviden</a>,<a href="#liu-2014-spect-studies">liu-2014-spect-studies</a>! 
</p>

<p>
That is it! Wow, not hard at all. Check out this video of the code in action: <a href="http://screencast.com/t/YmgA0fnZ1Ogl">http://screencast.com/t/YmgA0fnZ1Ogl</a> 
</p>
<p>Copyright (C) 2014 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2014/05/21/org-shift-hooks-for-ordering-citations.org">org-mode source</a><p><p>Org-mode version = 8.2.6</p>]]></content>
  </entry>
  <entry>
    <author>
      <name></name>
      <uri>http://jkitchin.github.io/blog</uri>
    </author>
    <title type="html"><![CDATA[Sorting citation links by year]]></title>
    <link rel="alternate" type="text/html" href="http://jkitchin.github.io/blog/2014/05/21/Sorting-citation-links-by-year" />
    <id>http://jkitchin.github.io/blog/2014/05/21/Sorting-citation-links-by-year</id>
    <updated>2014-05-21T09:57:48Z</updated>
    <published>2014-05-21T09:57:48Z</published>
    <category scheme="http://jkitchin.github.io/blog" term="bibtex" />
    <summary type="html"><![CDATA[Sorting citation links by year]]></summary>
    <content type="html" xml:base="http://jkitchin.github.io/blog/2014/05/21/Sorting-citation-links-by-year"><![CDATA[



<p>
When there are several citations grouped together, I like them sorted by year. For example, I do not like this <a href="#liu-2014-spect-studies">liu-2014-spect-studies</a>,<a href="#mcalpin-2010-epr-eviden">mcalpin-2010-epr-eviden</a>,<a href="#kanan-2009-cobal">kanan-2009-cobal</a>,<a href="#lutterman-2009-self-healin">lutterman-2009-self-healin</a>,<a href="#kanan-2008-in-situ">kanan-2008-in-situ</a>. I prefer <a href="#kanan-2008-in-situ">kanan-2008-in-situ</a>,<a href="#kanan-2009-cobal">kanan-2009-cobal</a>,<a href="#lutterman-2009-self-healin">lutterman-2009-self-healin</a>,<a href="#mcalpin-2010-epr-eviden">mcalpin-2010-epr-eviden</a>,<a href="#liu-2014-spect-studies">liu-2014-spect-studies</a>. It is just a preference, but it seems appropriate to cite things in chronological order. 
</p>

<p>
It is actually a little tedious to sort this by hand though. Hence, today we examine some tools to automate the sorting. The idea is to make a function that will get the keys, sort them by year, and then replace the link with the sorted text.
</p>

<p>
Let us try some sorting. We will construct a set of cons cells with a year and key, sort that list by year, and then concatenate the keys. Here is an example of the sorting. The years will come as strings from the bibtex file.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(setq data '(("2014" . "key1") ("2012" . "key2")("2016" . "key3")))
(setq data 
	(cl-sort data (lambda (x y) (&lt; (string-to-int (car x)) (string-to-int (car y))))))
(mapconcat (lambda (x) (cdr x)) data ",")
</pre>
</div>

<pre class="example">
key2,key1,key3
</pre>

<p>
That is easy enough. Now, a function to get the year, and then the function to sort a link. 
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(defun org-ref-get-citation-year (key)
  "get the year of an entry with key"
  (interactive)
  (let* ((results (org-ref-get-bibtex-key-and-file key))
	 (bibfile (cdr results))
	 (cb (current-buffer)))
    (message "---------%s %s" key bibfile)
    (set-buffer (find-file-noselect bibfile))
    (bibtex-search-entry key nil 0)
    (prog1 (reftex-get-bib-field "year" (bibtex-parse-entry t))
      (set-buffer cb))))

(defun org-ref-sort-citation-link ()
 "replace link at point with sorted link by year"
 (interactive)
 (let* ((object (org-element-context))	 
        (type (org-element-property :type object))
	(begin (org-element-property :begin object))
	(end (org-element-property :end object))
	(link-string (org-element-property :path object))
	keys years data)
  (setq keys (org-ref-split-and-strip-string link-string))
  (setq years (mapcar 'org-ref-get-citation-year keys)) 
  (setq data (mapcar* (lambda (a b) `(,a . ,b)) years keys))
  (setq data (cl-sort data (lambda (x y) (&lt; (string-to-int (car x)) (string-to-int (car y))))))
  ;; now get the keys separated by commas
  (setq keys (mapconcat (lambda (x) (cdr x)) data ","))
  ;; and replace the link with the sorted keys
  (cl--set-buffer-substring begin end (concat type ":" keys))
))
</pre>
</div>

<p>
Now, you put your cursor on a link, run M-x org-ref-sort-citation-link, and the magic happens  <a href="#kanan-2008-in-situ">kanan-2008-in-situ</a>,<a href="#kanan-2009-cobal">kanan-2009-cobal</a>,<a href="#lutterman-2009-self-healin">lutterman-2009-self-healin</a>,<a href="#mcalpin-2010-epr-eviden">mcalpin-2010-epr-eviden</a>,<a href="#liu-2014-spect-studies">liu-2014-spect-studies</a>! It would also be nice to have some arrow commands so you could do something like manually reorder them with S-arrow or something like in the calendar, but that will be another day.</p>
<p>Copyright (C) 2014 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2014/05/21/Sorting-citation-links-by-year.org">org-mode source</a><p><p>Org-mode version = 8.2.6</p>]]></content>
  </entry>
  <entry>
    <author>
      <name></name>
      <uri>http://jkitchin.github.io/blog</uri>
    </author>
    <title type="html"><![CDATA[Creating bibliographies in other formats with org-ref]]></title>
    <link rel="alternate" type="text/html" href="http://jkitchin.github.io/blog/2014/05/18/Creating-bibliographies-in-other-formats-with-org-ref" />
    <id>http://jkitchin.github.io/blog/2014/05/18/Creating-bibliographies-in-other-formats-with-org-ref</id>
    <updated>2014-05-18T11:55:34Z</updated>
    <published>2014-05-18T10:11:18Z</published>
    <category scheme="http://jkitchin.github.io/blog" term="org-mode" />
    <category scheme="http://jkitchin.github.io/blog" term="bibtex" />
    <summary type="html"><![CDATA[Creating bibliographies in other formats with org-ref]]></summary>
    <content type="html" xml:base="http://jkitchin.github.io/blog/2014/05/18/Creating-bibliographies-in-other-formats-with-org-ref"><![CDATA[



<p>
org-ref automatically generates bibliographies in LaTeX export, and it does a reasonable job automatically generating HTML bibliographies (ox-bibtex probably does this better, but it relies on an external program, whereas this approach is all elisp). Here we illustrate how to generate other formats, e.g. plain text, or org-mode formatted.
</p>

<p>
org-ref provides a convenient function that generates a bibliography entry for a key formatted according to the variable org-ref-bibliography-entry-format. This variable is a string that uses the reftex percent escapes to create an entry. The default is setup for an HTML entry like this:
</p>

<pre class="example">
  "%a, %t, &lt;i&gt;%j&lt;/i&gt;, &lt;b&gt;%v(%n)&lt;/b&gt;, %p (%y). &lt;a href=\"%U\"&gt;link&lt;/a&gt;. &lt;a href=\"http://dx.doi.org/%D\"&gt;doi&lt;/a&gt;."
</pre>

<p>
We can redefine it temporarily to get other formats. Here is an example of getting an org-formatted entry with some italics and bold text.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(let ((org-ref-bibliography-entry-format "%a, %t, /%j/, *%v(%n)*, %p (%y). [[%U][link]]. [[http://dx.doi.org/%D][doi]]."))
(org-ref-get-bibtex-entry-citation "andriotis-2014-infor"))
</pre>
</div>

<p>
"Andriotis, Mpourmpakis, , Broderick, Rajan, Datta, Somnath, Sunkara \&amp; Menon, Informatics guided discovery of surface  structure-chemistry relationships in catalytic  nanoparticles, <i>The Journal of Chemical Physics</i>, <b>140(9)</b>, 094705 (2014). <a href="http://scitation.aip.org/content/aip/journal/jcp/140/9/10.1063/1.4867010">link</a> . <a href="http://dx.doi.org/10.1063/1.4867010">doi</a> .
</p>

<p>
Now, we put some citations of various types in for water splitting <a href="#mccrory-2013-bench-heter">mccrory-2013-bench-heter</a>, CO<sub>2</sub> capture <a href="#alesi-2012-evaluat-primar">alesi-2012-evaluat-primar</a>, and microfluidic devices <a href="#voicu-2014-microf-studies">voicu-2014-microf-studies</a>. We will convert these links to a bibliography shortly.
</p>

<p>
Next, we generate an org-formatted bibliography. We will create a bracketed label at the beginning of the entry, and the org-format after that. This is a functional enough bibliography to be useful I think, and it illustrates the ideas. We will do some light transforming to replace escaped &amp; with regular &amp; in the bibliography.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">;; temorarily redefine the format
(let ((org-ref-bibliography-entry-format "%a, %t, /%j/, *%v(%n)*, %p (%y). [[%U][link]]. [[http://dx.doi.org/%D][doi]]."))

  (mapconcat 
   (lambda (key)
     (format "[%s] %s" key 
	     (replace-regexp-in-string 
	      "\\\\&amp;" 
	      "&amp;" (org-ref-get-bibtex-entry-citation key))))
   (org-ref-get-bibtex-keys) "\n\n"))
</pre>
</div>

<p>
[alesi-2012-evaluat-primar] Alesi &amp; Kitchin, Evaluation of a Primary Amine-Functionalized  Ion-Exchange Resin for \ce{CO_2} Capture, <i>Industrial &amp; Engineering Chemistry Research</i>, <b>51(19)</b>, 6907-6915 (2012). <a href="http://dx.doi.org/10.1021/ie300452c">link</a> . <a href="http://dx.doi.org/10.1021/ie300452c">doi</a> .
</p>

<p>
[mccrory-2013-bench-heter] McCrory, Jung, Peters, Jonas &amp; Jaramillo, Benchmarking Heterogeneous Electrocatalysts for the  Oxygen Evolution Reaction, <i>J. Am. Chem. Soc.</i>, <b>135(45)</b>, 16977&#x2013;16987 (2013). <a href="http://dx.doi.org/10.1021/ja407115p">link</a> . <a href="http://dx.doi.org/10.1021/ja407115p">doi</a> .
</p>

<p>
[voicu-2014-microf-studies] Voicu, Abolhasani, Choueiri, Rachelle, Lestari, Seiler, , Menard, Greener, Guenther, Axel, Stephan &amp; Kumacheva, Microfluidic Studies of \ce{CO_2} Sequestration by  Frustrated {L}ewis Pairs, <i>Journal of the American Chemical Society</i>, <b>0(0)</b>, null (2014). [[][link]]. <a href="http://dx.doi.org/10.1021/ja411601a">doi</a> .
</p>

<p>
You can see some minor issues with the formatting, e.g. sometimes the link is empty, if there is no url in the bibtex entry. There is no easy way to fix that. The 0 and null values in the last entry are because that is an ASAP article, and that is what is in the bibtex entry. I do not try to expand the latex code, and do not plan to do that. I do not know why there appears to be a blank author in the last entry, or why the author full names are not used. Those are reftex issues and  low priority to fix for me. They do not exist in the LaTeX export. The main point here is to get a reasonably useful bibliography that you can adapt as you want.
</p>


<p>
<h1>Bibliography</h1>
<ul><li><a id="alesi-2012-evaluat-primar">[alesi-2012-evaluat-primar] Alesi \& Kitchin, Evaluation of a Primary Amine-Functionalized  Ion-Exchange Resin for \ce{CO_2} Capture, <i>Industrial \& Engineering Chemistry Research</i>, <b>51(19)</b>, 6907-6915 (2012). <a href="http://dx.doi.org/10.1021/ie300452c">link</a>. <a href="http://dx.doi.org/10.1021/ie300452c">doi</a>.</a></li>
<li><a id="mccrory-2013-bench-heter">[mccrory-2013-bench-heter] McCrory, Jung, Peters, Jonas \& Jaramillo, Benchmarking Heterogeneous Electrocatalysts for the  Oxygen Evolution Reaction, <i>J. Am. Chem. Soc.</i>, <b>135(45)</b>, 16977--16987 (2013). <a href="http://dx.doi.org/10.1021/ja407115p">link</a>. <a href="http://dx.doi.org/10.1021/ja407115p">doi</a>.</a></li>
<li><a id="voicu-2014-microf-studies">[voicu-2014-microf-studies] Voicu, Abolhasani, Choueiri, Rachelle, Lestari, Seiler, , Menard, Greener, Guenther, Axel, Stephan \& Kumacheva, Microfluidic Studies of \ce{CO_2} Sequestration by  Frustrated {L}ewis Pairs, <i>Journal of the American Chemical Society</i>, <b>0(0)</b>, null (2014). <a href="">link</a>. <a href="http://dx.doi.org/10.1021/ja411601a">doi</a>.</a></li>
</ul>
</p>
<p>Copyright (C) 2014 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2014/05/18/Creating-bibliographies-in-other-formats-with-org-ref.org">org-mode source</a><p><p>Org-mode version = 8.2.6</p>]]></content>
  </entry>
  <entry>
    <author>
      <name></name>
      <uri>http://jkitchin.github.io/blog</uri>
    </author>
    <title type="html"><![CDATA[Using org-ref to keep your bibtex files in order]]></title>
    <link rel="alternate" type="text/html" href="http://jkitchin.github.io/blog/2014/05/15/Using-org-ref-to-keep-your-bibtex-files-in-order" />
    <id>http://jkitchin.github.io/blog/2014/05/15/Using-org-ref-to-keep-your-bibtex-files-in-order</id>
    <updated>2014-05-15T12:19:49Z</updated>
    <published>2014-05-15T10:59:19Z</published>
    <category scheme="http://jkitchin.github.io/blog" term="bibtex" />
    <category scheme="http://jkitchin.github.io/blog" term="emacs" />
    <summary type="html"><![CDATA[Using org-ref to keep your bibtex files in order]]></summary>
    <content type="html" xml:base="http://jkitchin.github.io/blog/2014/05/15/Using-org-ref-to-keep-your-bibtex-files-in-order"><![CDATA[


<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#sec-1">1. "cleaning" a bibtex entry</a></li>
<li><a href="#sec-2">2. Validating your bibliography</a></li>
<li><a href="#sec-3">3. Sorting your bibtex file</a></li>
<li><a href="#sec-4">4. Make a full bibliography pdf</a></li>
<li><a href="#sec-5">5. Finding bad citation links</a></li>
<li><a href="#sec-6">6. Extracting citations entries</a></li>
<li><a href="#sec-7">7. Summary</a></li>
<li><a href="#sec-8">8. References</a></li>
<li><a href="#sec-9">9. Bibtex entries</a></li>
</ul>
</div>
</div>

<p>
Maintaining an accurate, useful bibliography of references is critical for scientific writing. It is also not trivial. While it is easy to download and copy bibliographic entries to your database, these entries are often incomplete, not consistently formatted, and can contain invalid characters. org-ref provides several utility functions to help with this.
</p>

<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1"><span class="section-number-2">1</span> "cleaning" a bibtex entry</h2>
<div class="outline-text-2" id="text-1">
<p>
Consider this bibtex entry from <a href="http://pubs.acs.org/action/showCitFormats?doi=10.1021%2Fie500588j">http://pubs.acs.org/action/showCitFormats?doi=10.1021%2Fie500588j</a> .
</p>

<div class="org-src-container">

<pre class="src src-bibtex">@article{doi:10.1021/ie500588j,
author = {Okada, Tomohiko and Ozono, Shoya and Okamoto, Masami and Takeda, Yohei and Minamisawa, Hikari M. and Haeiwa, Tetsuji and Sakai, Toshio and Mishima, Shozi},
title = {Magnetic Rattle-Type CoreShell Particles Containing Iron Compounds with Acid Tolerance by Dense Silica},
journal = {Industrial &amp; Engineering Chemistry Research},
volume = {0},
number = {0},
pages = {null},
year = {0},
doi = {10.1021/ie500588j},

URL = {http://pubs.acs.org/doi/abs/10.1021/ie500588j},
eprint = {http://pubs.acs.org/doi/pdf/10.1021/ie500588j}
}
</pre>
</div>

<p>
On the surface it looks fine, but there are the following issues with it:
</p>

<ol class="org-ol">
<li>The bibtex key is hard to remember. I like systematically named keys.
</li>
<li>There is a bare &amp; in the journal title, which is not legal in LaTeX.
</li>
<li>There is no year entry, even though it is a 2014 entry. The pages, volume, and number are also problematic, but this is an ASAP article and the reference does not have those yet.
</li>
<li>It is hard to see, but the dash between core and shell is a non-ascii character, which can cause problems in LaTeX.
</li>
<li>The entry is not very nicely aligned or indented.
</li>
</ol>

<p>
You can fix these problems by putting your cursor on the bibtex entry, and typing M-x org-ref-clean-bibtex-entry. This will fix the bibtex key to a standard form, align and indent the entry, escape the &amp; so it is legal syntax, prompt you for a year, and show you the non-ascii characters so you can replace them. The resulting, nicely formatted entry is shown below.
</p>

<div class="org-src-container">

<pre class="src src-bibtex">@article{okada-2014-magnet-rattl,
  author =	 {Okada, Tomohiko and Ozono, Shoya and Okamoto, Masami
                  and Takeda, Yohei and Minamisawa, Hikari M. and
                  Haeiwa, Tetsuji and Sakai, Toshio and Mishima,
                  Shozi},
  title =	 {Magnetic Rattle-Type Core-Shell Particles Containing
                  Iron Compounds with Acid Tolerance by Dense Silica},
  journal =	 {Industrial \&amp; Engineering Chemistry Research},
  volume =	 0,
  pages =	 {null},
  year =	 2014,
  doi =		 {10.1021/ie500588j},
  number =	 0,
  url =		 {http://pubs.acs.org/doi/abs/10.1021/ie500588j},
  eprint =	 {http://pubs.acs.org/doi/pdf/10.1021/ie500588j},
}
</pre>
</div>

<p>
The key formatting comes from these definitions:
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">;; variables that control bibtex key format for auto-generation
;; I want firstauthor-year-title-words
;; this usually makes a legitimate filename to store pdfs under.
(setq bibtex-autokey-year-length 4
      bibtex-autokey-name-year-separator "-"
      bibtex-autokey-year-title-separator "-"
      bibtex-autokey-titleword-separator "-"
      bibtex-autokey-titlewords 2
      bibtex-autokey-titlewords-stretch 1
      bibtex-autokey-titleword-length 5)
</pre>
</div>

<p>
You should develop a discipline to clean each entry as you add them, and before you cite them. It is a pain to change the key, and then find and change all the places you used that key before. Now that you have a systematic key, go ahead and download the pdf for the article, and save it in your pdf directory by that key name. Set the variable org-ref-pdf-directory to this directory, and later when you click on citations you will be able to open the pdf easily.
</p>
</div>
</div>

<div id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2"><span class="section-number-2">2</span> Validating your bibliography</h2>
<div class="outline-text-2" id="text-2">
<p>
<pre>elisp:bibtex-validate</pre> will check your bibliography for valid syntax. This is a bibtex command.
</p>

<p>
<a href="/media/2014-05-15-Using-org-ref-to-keep-your-bibtex-files-in-order/org-bib.bib">org-bib.bib</a> 
</p>
</div>
</div>

<div id="outline-container-sec-3" class="outline-2">
<h2 id="sec-3"><span class="section-number-2">3</span> Sorting your bibtex file</h2>
<div class="outline-text-2" id="text-3">
<p>
It is a good idea to keep your bibtex file sorted. This will facilitate finding duplicate entries, and will make it easier to find things. I usually add entries to the top of the file, and then clean them. Then run the command <pre>elisp:bibtex-sort-buffer</pre> . This will sort the entries for you. This is also a bibtex command.
</p>

<p>
<a href="/media/2014-05-15-Using-org-ref-to-keep-your-bibtex-files-in-order/org-bib.bib">org-bib.bib</a> 
</p>
</div>
</div>

<div id="outline-container-sec-4" class="outline-2">
<h2 id="sec-4"><span class="section-number-2">4</span> Make a full bibliography pdf</h2>
<div class="outline-text-2" id="text-4">
<p>
A good way to check your bibliography for duplicates, spelling errors, and invalid formats is to make a pdf containing all the entries. Open your bibtex file, and run <pre>elisp:org-ref-build-full-bibliography</pre> . If all goes well, you will get a pdf of your bibliography that you can check for accuracy. If there are errors, you will have to fix them until the pdf is generated.
</p>

<p>
Try it out: <a href="/media/2014-05-15-Using-org-ref-to-keep-your-bibtex-files-in-order/org-bib.bib">org-bib.bib</a> 
</p>
</div>
</div>

<div id="outline-container-sec-5" class="outline-2">
<h2 id="sec-5"><span class="section-number-2">5</span> Finding bad citation links</h2>
<div class="outline-text-2" id="text-5">
<p>
Sometimes you will get bad citation links in your document. Maybe there is no corresponding entry, maybe you typed in the wrong key, maybe you changed the key. Either way, you need to find them and fix them. Run the command <pre>elisp:org-ref-find-bad-citations</pre> to find them. <pre>cite:test</pre> 
</p>
</div>
</div>

<div id="outline-container-sec-6" class="outline-2">
<h2 id="sec-6"><span class="section-number-2">6</span> Extracting citations entries</h2>
<div class="outline-text-2" id="text-6">
<p>
You will often work from your default bibliography for your own work. Eventually you will need to extract the entries cited so you can send them to someone. The command  <pre>elisp:org-ref-extract-bibtex-entries</pre> will do that for you. If I have cited something <pre>cite:calle-vallejo-2010-trend-stabil</pre> .
</p>
</div>
</div>

<div id="outline-container-sec-7" class="outline-2">
<h2 id="sec-7"><span class="section-number-2">7</span> Summary</h2>
<div class="outline-text-2" id="text-7">
<p>
You can see a screen cast of this post here: <a href="http://screencast.com/t/yZCOdO6kJ">http://screencast.com/t/yZCOdO6kJ</a> 
</p>
</div>
</div>

<div id="outline-container-sec-8" class="outline-2">
<h2 id="sec-8"><span class="section-number-2">8</span> References</h2>
</div>

<div id="outline-container-sec-9" class="outline-2">
<h2 id="sec-9"><span class="section-number-2">9</span> Bibtex entries</h2>
<div class="outline-text-2" id="text-9">
<p>
#+BEGIN<sub>SRC</sub>: text :tangle extract-bib7108tYg.bib
@article{calle-vallejo-2010-trend-stabil,
  author =         {Calle-Vallejo, F. and Martinez, J. I. and Garcia-
                  Lastra, J. M. and Mogensen, M. and Rossmeisl, J.},
  title =         {Trends in Stability of Perovskite Oxides},
  journal =         "Angewandte Chemie-International Edition",
  volume =         49,
  number =         42,
  pages =         {7699-7701},
  year =         2010,
  doi =                 {10.1002/anie.201002301},
  keyword =         {density functional calculations heats of formation
                  perovskites thermochemistry transition-metals
                  catalysts ferroelectricity},
}
#+END<sub>SRC</sub>
</p>
</div>
</div>
<p>Copyright (C) 2014 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2014/05/15/Using-org-ref-to-keep-your-bibtex-files-in-order.org">org-mode source</a><p><p>Org-mode version = 8.2.6</p>]]></content>
  </entry>
</feed>
