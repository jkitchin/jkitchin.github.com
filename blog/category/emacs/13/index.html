

<!doctype html>
<!--[if lt IE 7 ]> <html lang="en" class="no-js ie6"> <![endif]-->
<!--[if IE 7 ]>    <html lang="en" class="no-js ie7"> <![endif]-->
<!--[if IE 8 ]>    <html lang="en" class="no-js ie8"> <![endif]-->
<!--[if IE 9 ]>    <html lang="en" class="no-js ie9"> <![endif]-->
<!--[if (gt IE 9)|!(IE)]><!--> <html lang="en" class="no-js"> <!--<![endif]-->
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>The Kitchin Research Group: emacs</title>
  <meta name="google-site-verification" content="CGcacJdHc2YoZyI0Vey9XRA5qwhhFDzThKJezbRFcJ4" />
  <meta name="description" content="Chemical Engineering at Carnegie Mellon University">
  <meta name="author" content="John Kitchin">
  <link rel="alternate" type="application/rss+xml" title="RSS 2.0" href="/blog/feed" />
  <link rel="alternate" type="application/atom+xml" title="Atom 1.0" href="/blog/feed/atom" />
  <link rel="shortcut icon" href="/favicon.ico">
  <link rel="apple-touch-icon" href="/img/apple-touch-icon.png">

  <link rel="stylesheet" href="/css/base.css?v=1">
  <link rel="stylesheet" href="/css/grid.css?v=1">
  <link rel="stylesheet" media="handheld" href="/css/handheld.css?v=1">
  <link rel="stylesheet" href="/css/pygments_murphy.css" type="text/css" />

  <script src="/js/libs/modernizr-1.7.min.js"></script>
<script type="text/javascript"
  src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
  <link rel="stylesheet" href="/themes/theme1/style.css?v=1">
<link href='http://fonts.googleapis.com/css?family=Roboto' rel='stylesheet' type='text/css'>

</head>
  <body>
    <div id="container" class="container container_12">
      <div id="main" role="main">
        <div id="main_block">
          <header>
<div id="header" class="header_gradient theme_font">
<table><tr><td>
    <h1><a href="/">The Kitchin Research Group</a></h1>
    <h2>Chemical Engineering at Carnegie Mellon University</h2>
</td>
<td colspan=100%><div style="float:right;width:100%;text-align:right;"> <span id='badgeCont737515' style='width:126px'><script src='http://labs.researcherid.com/mashlets?el=badgeCont737515&mashlet=badge&showTitle=false&className=a&rid=A-2363-2010'></script></span></div>
</td></tr>
</table>
</div>
  <div id="navigation" class="grid_12">

    <ul class="theme_font">
      <li><a href="/blog"
             class="">Blog</a></li>

      <li><a href="/blog/archive"
             class="">Archives</a></li>

      <li><a href="/publications.html">Publications</a></li>
      <li><a href="/group.html">Group</a></li>

      <li><a href="/research.html"
             class="">Research</a></li>

      <li><a href="/categories.html"
             class="">Categories</a></li>

      <li><a href="/about.html"
             class="">About us</a></li>

      <li><a href="/subscribe.html">Subscribe</a></li>

    </ul>
  </div>
</header>

          <div id="prose_block" class="grid_8">
            
  





<article>
  <div class="blog_post">
    <header>
      <div id="A-framework-for-automated-feedback-with-Python-and-org-mode"></div>
      <h2 class="blog_post_title"><a href="/blog/2015/10/03/A-framework-for-automated-feedback-with-Python-and-org-mode/" rel="bookmark" title="Permanent Link to A framework for automated feedback with Python and org-mode">A framework for automated feedback with Python and org-mode</a></h2>
      <p><small><span class="blog_post_date">Posted October 03, 2015 at 08:23 PM</span> | categories:
        <span class="blog_post_categories"><a href='/blog/category/python/'>python</a>, <a href='/blog/category/emacs/'>emacs</a></span> | tags: 
        | <a href="http://jkitchin.github.io/blog/2015/10/03/A-framework-for-automated-feedback-with-Python-and-org-mode#disqus_thread">View Comments</a>
      <p><small><span class="blog_post_date">Updated October 03, 2015 at 08:29 PM</span>
      </small></p>
    </header>
    <div class="post_prose">
      




<p>
<a href="http://docs.autolab.cs.cmu.edu">Autolab</a> is an autograding service that automatically grades code assignments. It uses a program to evaluate a program on a secure virtual system. Using this requires you to run a server, and run code from students. I have never liked that because it is hard to sandbox code well enough to prevent malicious code from doing bad things. Autolab does it well, but it is a heavy solution. Here we explore a local version, one that is used to test for correctness, and not for grading. Here, if you are malicious, you reap what you sow&#x2026;
</p>

<p>
The basic idea I am working towards is that Emacs will provide content to be learned (through org-mode) with active exercises. The exercises will involve a code block, and the user will run a command on their code (or an advised C-c C-c) that checks the solution for correctness. A user will be able to see the solution, and maybe get hints.
</p>

<p>
Suppose we have a problem to solve \(e^x = 3\). This is a simple problem to solve, and here is a solution.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #0000FF;">from</span> scipy.optimize <span style="color: #0000FF;">import</span> fsolve
<span style="color: #0000FF;">import</span> numpy <span style="color: #0000FF;">as</span> np

<span style="color: #0000FF;">def</span> <span style="color: #006699;">objective</span>(x):
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #0000FF;">return</span> np.exp(x) - 3

<span style="color: #0000FF;">def</span> <span style="color: #006699;">solve</span>():
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #0000FF;">return</span> fsolve(objective, 3)

<span style="color: #0000FF;">print</span> solve()
</pre>
</div>

<pre class="example">
[ 1.09861229]
</pre>

<p>
We would like to test this for correctness. We code this in a function-based form because we will later use the function <code>solve</code> to test for correctness. Let's see how we could test it with a test function. We will use exec on a string representing our code to get it into our namespace. I don't see a security issue here. You are writing the code! Eventually, we will be passing code to the test framework this way from an org-mode source block.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #0000FF;">import</span> unittest
<span style="color: #BA36A5;">TOLERANCE</span> = 1e-5

<span style="color: #BA36A5;">s</span> = <span style="color: #008000;">'''from scipy.optimize import fsolve</span>
<span style="color: #008000;">import numpy as np</span>

<span style="color: #008000;">def objective(x):</span>
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span><span style="color: #008000;">   return np.exp(x) - 3</span>

<span style="color: #008000;">def solve():</span>
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span><span style="color: #008000;">   return fsolve(objective, 3)[0]</span>

<span style="color: #008000;">print solve()'''</span>

<span style="color: #0000FF;">def</span> <span style="color: #006699;">test_solve</span>(s):
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #0000FF;">exec</span> s <span style="color: #0000FF;">in</span> <span style="color: #006FE0;">globals</span>()
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #0000FF;">if</span> (<span style="color: #006FE0;">abs</span>(np.log(3) - solve()) &lt;= TOLERANCE):
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #0000FF;">print</span>(<span style="color: #008000;">'Correct'</span>)
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #0000FF;">else</span>:
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #0000FF;">print</span>(<span style="color: #008000;">'incorrect'</span>)

test_solve(s)
</pre>
</div>

<pre class="example">
1.09861228867
Correct
</pre>

<p>
Next, we need to think about how we could generate an import statement from a code block name, import in python, and run a test function. We can assume that the test code will be in a file called "test_%s.py" on your python path. Here are the contents of test_solve.py.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #0000FF;">import</span> numpy <span style="color: #0000FF;">as</span> np
<span style="color: #BA36A5;">TOLERANCE</span> = 1e-5

<span style="color: #0000FF;">def</span> <span style="color: #006699;">solve_solution</span>():
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #0000FF;">from</span> scipy. optimize <span style="color: #0000FF;">import</span> fsolve
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #0000FF;">import</span> numpy <span style="color: #0000FF;">as</span> np

<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #0000FF;">def</span> <span style="color: #006699;">objective</span>(x):
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #0000FF;">return</span> np.exp(x) - 3

<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #0000FF;">return</span> fsolve(objective, 3)[0]


<span style="color: #0000FF;">def</span> <span style="color: #006699;">test_solve</span>(s):
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #0000FF;">exec</span> s <span style="color: #0000FF;">in</span> <span style="color: #006FE0;">globals</span>()
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #0000FF;">if</span> (<span style="color: #006FE0;">abs</span>(solve_solution() - solve()) &lt;= TOLERANCE):
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #0000FF;">print</span>(<span style="color: #008000;">'Correct!'</span>)
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #0000FF;">else</span>:
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #0000FF;">print</span>(<span style="color: #008000;">'Incorrect'</span>)
</pre>
</div>

<p>
Now, we can import that, and use the functions. Here is the Python script we need to run to test it.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #0000FF;">import</span> test_solve
test_solve.test_solve(<span style="color: #036A07;">'''</span>
<span style="color: #036A07;">from scipy. optimize import fsolve</span>
<span style="color: #036A07;">import numpy as np</span>

<span style="color: #036A07;">def objective(x):</span>
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span><span style="color: #036A07;">   return np.exp(x) - 3</span>

<span style="color: #036A07;">def solve():</span>
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span><span style="color: #036A07;">   return fsolve(objective, 3)[0]</span>

<span style="color: #036A07;">print solve()'''</span>)
</pre>
</div>

<pre class="example">
1.09861228867
Correct!
</pre>

<p>
Now, an elisp block to do that. One way to do this is to just run a shell command passing the string to a python interpreter. This is a short way away from an Emacs command now.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #0000FF;">let*</span> ((string <span style="color: #008000;">"import test_solve</span>
<span style="color: #008000;">test_solve.test_solve('''</span>
<span style="color: #008000;">from scipy. optimize import fsolve</span>
<span style="color: #008000;">import numpy as np</span>

<span style="color: #008000;">def objective(x):</span>
<span style="color: #008000;">    return np.exp(x) - 3</span>

<span style="color: #008000;">def solve():</span>
<span style="color: #008000;">    return fsolve(objective, 3)[0]</span>

<span style="color: #008000;">print solve()''')"</span>))
  (shell-command-to-string (format <span style="color: #008000;">"python -c \"%s\""</span> string)))
</pre>
</div>

<pre class="example">
1.09861228867
Correct!
</pre>

<p>
Ok, now to wrap it all up in a function we can run from Emacs in a code block to test it. With the cursor in a code block, we get the name, and build the python code, and run it. The function is more complex than I anticipated because I end up  running the code block essentially twice, once to get a results block and once to get the test results. For short problems this is not an issue. I also add the test results in a way that is compatible with the current results.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #0000FF;">defun</span> <span style="color: #006699;">check</span> ()
  (<span style="color: #0000FF;">interactive</span>)
  (<span style="color: #0000FF;">let*</span> ((src-block (org-element-context))
         (name (org-element-property <span style="color: #006FE0;">:name</span> src-block))
         (code (org-element-property <span style="color: #006FE0;">:value</span> src-block))
         (end (org-element-property <span style="color: #006FE0;">:end</span> src-block))
         (results)
         (template (format <span style="color: #008000;">"import test_%s</span>
<span style="color: #008000;">test_%s.test_%s('''%s''')"</span> name name name code))
         (output (format
                  <span style="color: #008000;">"\n%s\n"</span>
                  (s-join
                   <span style="color: #008000;">"\n"</span>
                   (mapcar
                    (<span style="color: #0000FF;">lambda</span> (s)
                      (<span style="color: #0000FF;">if</span> (s-starts-with? <span style="color: #008000;">":"</span> s)
                          s
                        (concat <span style="color: #008000;">": "</span> s)))
                    (s-split
                     <span style="color: #008000;">"\n"</span>
                     (shell-command-to-string
                      (format <span style="color: #008000;">"python -c \"%s\""</span> template))))))))
    <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">execute block as normal</span>
    (org-babel-execute-src-block)
    <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">and add some output to the Results block</span>
    (<span style="color: #0000FF;">if</span> (org-babel-where-is-src-block-result)
        (<span style="color: #0000FF;">progn</span>
          (goto-char (org-babel-where-is-src-block-result))
          (<span style="color: #0000FF;">setq</span> results (org-element-context))
          <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">delete results line</span>
          (kill-line)
          <span style="color: #8D8D84;">;;  </span><span style="color: #8D8D84; font-style: italic;">delete the results</span>
          (<span style="color: #0000FF;">setf</span> (buffer-substring (org-element-property <span style="color: #006FE0;">:begin</span> results)
                                  (org-element-property <span style="color: #006FE0;">:post-affiliated</span> results))
                <span style="color: #008000;">""</span>)
          <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">paste results line back</span>
          (yank)
          <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">and the output from your code</span>
          (insert output))
      (message <span style="color: #008000;">"%s"</span> output))))
</pre>
</div>

<pre class="example">
check
</pre>

<p>
Now, we use a named src-block so we can call M-x check in it, and check the answer.
</p>

<div class="org-src-container">

<pre class="src src-python" id="solve"><span style="color: #0000FF;">from</span> scipy.optimize <span style="color: #0000FF;">import</span> fsolve
<span style="color: #0000FF;">import</span> numpy <span style="color: #0000FF;">as</span> np

<span style="color: #0000FF;">def</span> <span style="color: #006699;">objective</span>(x):
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #0000FF;">return</span> np.exp(x) - 3

<span style="color: #0000FF;">def</span> <span style="color: #006699;">solve</span>():
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #0000FF;">return</span> fsolve(objective, 3)

<span style="color: #0000FF;">print</span> solve()
</pre>
</div>

<pre class="example">
[ 1.09861229]
Correct!
</pre>

<p>
I would like to be able to provide a solution function that would show a user my solution they were tested against. Python provides the <code>inspect</code> module that can do this. Here is how we get the code in Python.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #0000FF;">import</span> inspect
<span style="color: #0000FF;">import</span> test_solve

<span style="color: #0000FF;">print</span> inspect.getsource(test_solve.solve_solution)
</pre>
</div>

<pre class="example">
def solve_solution():
    from scipy. optimize import fsolve
    import numpy as np

    def objective(x):
        return np.exp(x) - 3

    return fsolve(objective, 3)[0]
</pre>

<p>
This makes it easy to wrap up a function in emacs that will show this from at src block. We just get the block name, and build the python code and execute it here.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #0000FF;">defun</span> <span style="color: #006699;">show-solution</span> ()
  (<span style="color: #0000FF;">interactive</span>)
  (<span style="color: #0000FF;">let*</span> ((src-block (org-element-context))
         (name (org-element-property <span style="color: #006FE0;">:name</span> src-block))
         (template (format  <span style="color: #008000;">"import inspect</span>
<span style="color: #008000;">import test_%s</span>

<span style="color: #008000;">print inspect.getsource(test_%s.%s_solution)"</span> name name name)))
    (switch-to-buffer-other-window (get-buffer-create <span style="color: #008000;">"solution"</span>))
    (erase-buffer)
    (insert (shell-command-to-string
             (format <span style="color: #008000;">"python -c \"%s\""</span> template)))
    (python-mode)))
</pre>
</div>

<pre class="example">
show-solution
</pre>

<p>
That summarizes the main features. It allows me to write a test module that has some name conventions to define a solution function, and a test function. Emacs can generate some boilerplate code for different problem names, and run the test to give the user some feedback. Most of the code in this post would not be directly visible to a user, it would be buried in a python module somewhere on the path, and in elisp files providing the glue. I am not sure how much obfuscation you can put in the python files, e.g. just providing byte-compiled code, so it is less easy to just read it. That is not as big a deal when it is just a study guide/feedback system.
</p>

<p>
From an authoring point of view, this seems pretty good to me. It is feasible I think to write an org-source document like this with tangling for the test modules, and an export to org that does not have the solutions in it. The only subtle point might be needing to alter Python paths to find the test modules if they aren't installed via something like pip.
</p>


<p>
I think this is pretty flexible, and could handle problems that take arguments, e.g. write a function that sorts a list. Here is a simple example of that. First we write the test_sort.py file with a solution, and some tests.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #0000FF;">def</span> <span style="color: #006699;">sort_solution</span>(LIST):
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #0000FF;">return</span> LIST.sort()

<span style="color: #0000FF;">def</span> <span style="color: #006699;">test_sort</span>(s):
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #0000FF;">exec</span> s <span style="color: #0000FF;">in</span> <span style="color: #006FE0;">globals</span>()
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #0000FF;">if</span> sort([3, 4, 2]) == [2, 3, 4]:
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #0000FF;">print</span>(<span style="color: #008000;">'passed test 1'</span>)
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #0000FF;">if</span> sort([<span style="color: #008000;">'z'</span>, <span style="color: #008000;">'b'</span>]) == [<span style="color: #008000;">'b'</span>, <span style="color: #008000;">'z'</span>]:
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #0000FF;">print</span>(<span style="color: #008000;">'passed test 2'</span>)
</pre>
</div>


<div class="org-src-container">

<pre class="src src-python" id="sort"><span style="color: #0000FF;">def</span> <span style="color: #006699;">sort</span>(LIST):
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #BA36A5;">s</span> = <span style="color: #006FE0;">sorted</span>(LIST)
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #0000FF;">return</span> s
</pre>
</div>
<pre class="example">
passed test 1
passed test 2
</pre>

<p>
Maybe it would make sense to use unittests, or nose or some other testing framework if it makes writing the tests easier. Another day.
</p>
<p>Copyright (C) 2015 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2015/10/03/A-framework-for-automated-feedback-with-Python-and-org-mode.org">org-mode source</a><p><p>Org-mode version = 8.2.10</p>

    </div>
  </div>
</article>



<a href="https://twitter.com/share" class="twitter-share-button" data-via="johnkitchin">Tweet</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>

  <div class="after_post"><a href="http://jkitchin.github.io/blog/2015/10/03/A-framework-for-automated-feedback-with-Python-and-org-mode#disqus_thread">Read and Post Comments</a></div>
  <hr class="interblog" />
  





<article>
  <div class="blog_post">
    <header>
      <div id="A-cursor-goto-hydra-for-emacs"></div>
      <h2 class="blog_post_title"><a href="/blog/2015/09/28/A-cursor-goto-hydra-for-emacs/" rel="bookmark" title="Permanent Link to A cursor goto hydra for emacs">A cursor goto hydra for emacs</a></h2>
      <p><small><span class="blog_post_date">Posted September 28, 2015 at 04:38 PM</span> | categories:
        <span class="blog_post_categories"><a href='/blog/category/hydra/'>hydra</a>, <a href='/blog/category/emacs/'>emacs</a></span> | tags: 
        | <a href="http://jkitchin.github.io/blog/2015/09/28/A-cursor-goto-hydra-for-emacs#disqus_thread">View Comments</a>
      </small></p>
    </header>
    <div class="post_prose">
      




<p>
In the spirit of upping my navigation game, here we examine navigation by search like methods. You probably know about C-s with will search forward for a word, and C-r which will search backwards. This will get you to the start of a word pretty easily. It won't get you into a word though, you have to navigate to that, and it isn't too handy to get to a line, or window, or headline in an org-file. Each of these is an emacs command, which as with navigation I don't always remember. Today, we build a hydra to make this easy too.
</p>

<p>
We will use features from <a href="https://github.com/abo-abo/avy">avy</a> , and <a href="https://github.com/emacs-helm/helm">helm</a> , and some standard emacs features. <code>avy</code> is pretty neat. It provides an interface to jump to characters, words and subwords by pressing keys. To jump to a character that is visible on the screen, you invoke avy-goto-char and press the character you want to jump to. <code>avy</code> will overlay a sequence of keys you then type to jump to that character. It might be more convenient to jump to a pair of characters, which you do by invoking avy-goto-char-2. Similarly, there are commands to jump to the beginning of a word, and a subword, both with variations that allow you to specify the beginning letter of the word, or to get overlays on every word.
</p>

<p>
I spend most of my days in org-files, so I frequently want to jump to an org headline in the current buffer, or some headline in an org-file in my agenda. Helm provides a nice set of functions for this in helm-org-headlines and helm-org-agenda-files-headings. We can also use helm-multi-swoop-org to use the swoop search function in all open org-buffers with helm selection. Within a buffer, you might also use the search forward and backward capabilities, or the more advanced helm-occur or swiper-helm features.
Finally, I may want my cursor to go to another recent file, or open buffer.
</p>

<p>
The hydra we will develop here puts all of these commands a few keystrokes away, with a hint system to remind you what is possible. In addition to these "goto" commands, I add a character to switch to the navigation hydra we developed in the last <a href="http://kitchingroup.cheme.cmu.edu/blog/2015/09/27/Upping-my-Emacs-navigation-game/">post</a> so I can switch to navigation if I change my mind. I also put two commands to store the current position before the goto command, and to return to that stored position conveniently. I bind this hydra to super-g, because the super key isn't used much on my Mac, and g reminds of "goto". So, here is my hydra code:
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #0000FF;">defhydra</span> goto (<span style="color: #006FE0;">:color</span> blue <span style="color: #006FE0;">:hint</span> nil)
  <span style="color: #008000;">"</span>
<span style="color: #008000;">Goto:</span>
<span style="color: #008000;">^Char^              ^Word^                ^org^                    ^search^</span>
<span style="color: #008000;">^^^^^^^^---------------------------------------------------------------------------</span>
<span style="color: #008000;">_c_: 2 chars        _w_: word by char     _h_: headline in buffer  _o_: helm-occur</span>
<span style="color: #008000;">_C_: char           _W_: some word        _a_: heading in agenda   _p_: helm-swiper</span>
<span style="color: #008000;">_L_: char in line   _s_: subword by char  _q_: swoop org buffers   _f_: search forward</span>
<span style="color: #008000;">^  ^                _S_: some subword     ^ ^                      _b_: search backward</span>
<span style="color: #008000;">-----------------------------------------------------------------------------------</span>
<span style="color: #008000;">_B_: helm-buffers       _l_: avy-goto-line</span>
<span style="color: #008000;">_m_: helm-mini          _i_: ace-window</span>
<span style="color: #008000;">_R_: helm-recentf</span>

<span style="color: #008000;">_n_: Navigate           _._: mark position _/_: jump to mark</span>
<span style="color: #008000;">"</span>
  (<span style="color: #008000;">"c"</span> avy-goto-char-2)
  (<span style="color: #008000;">"C"</span> avy-goto-char)
  (<span style="color: #008000;">"L"</span> avy-goto-char-in-line)
  (<span style="color: #008000;">"w"</span> avy-goto-word-1)
  <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">jump to beginning of some word</span>
  (<span style="color: #008000;">"W"</span> avy-goto-word-0)
  <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">jump to subword starting with a char</span>
  (<span style="color: #008000;">"s"</span> avy-goto-subword-1)
  <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">jump to some subword</span>
  (<span style="color: #008000;">"S"</span> avy-goto-subword-0)

  (<span style="color: #008000;">"l"</span> avy-goto-line)
  (<span style="color: #008000;">"i"</span> ace-window)

  (<span style="color: #008000;">"h"</span> helm-org-headlines)
  (<span style="color: #008000;">"a"</span> helm-org-agenda-files-headings)
  (<span style="color: #008000;">"q"</span> helm-multi-swoop-org)

  (<span style="color: #008000;">"o"</span> helm-occur)
  (<span style="color: #008000;">"p"</span> swiper-helm)

  (<span style="color: #008000;">"f"</span> isearch-forward)
  (<span style="color: #008000;">"b"</span> isearch-backward)

  (<span style="color: #008000;">"."</span> org-mark-ring-push <span style="color: #006FE0;">:color</span> red)
  (<span style="color: #008000;">"/"</span> org-mark-ring-goto <span style="color: #006FE0;">:color</span> blue)
  (<span style="color: #008000;">"B"</span> helm-buffers-list)
  (<span style="color: #008000;">"m"</span> helm-mini)
  (<span style="color: #008000;">"R"</span> helm-recentf)
  (<span style="color: #008000;">"n"</span> hydra-navigate/body))

(global-set-key (kbd <span style="color: #008000;">"s-g"</span>) 'goto/body)
</pre>
</div>

<p>
As with the last navigation hydra, this is a pretty massive set of options and takes up some decent screen space at the bottom om my emacs. They are mostly here to remind me that there are better navigation options, and with practice I suspect muscle memory will provide fast navigation tools with more precision and fewer keystrokes than simple navigation.
</p>
<p>Copyright (C) 2015 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2015/09/28/A-cursor-goto-hydra-for-emacs.org">org-mode source</a><p><p>Org-mode version = 8.2.10</p>

    </div>
  </div>
</article>



<a href="https://twitter.com/share" class="twitter-share-button" data-via="johnkitchin">Tweet</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>

  <div class="after_post"><a href="http://jkitchin.github.io/blog/2015/09/28/A-cursor-goto-hydra-for-emacs#disqus_thread">Read and Post Comments</a></div>
  <hr class="interblog" />
  





<article>
  <div class="blog_post">
    <header>
      <div id="Upping-my-Emacs-navigation-game"></div>
      <h2 class="blog_post_title"><a href="/blog/2015/09/27/Upping-my-Emacs-navigation-game/" rel="bookmark" title="Permanent Link to Upping my Emacs navigation game">Upping my Emacs navigation game</a></h2>
      <p><small><span class="blog_post_date">Posted September 27, 2015 at 09:21 PM</span> | categories:
        <span class="blog_post_categories"><a href='/blog/category/hydra/'>hydra</a>, <a href='/blog/category/emacs/'>emacs</a></span> | tags: 
        | <a href="http://jkitchin.github.io/blog/2015/09/27/Upping-my-Emacs-navigation-game#disqus_thread">View Comments</a>
      </small></p>
    </header>
    <div class="post_prose">
      




<p>
I have been trying to up my navigation game in Emacs, by which I mean I want to get my cursor where I want it with a minimal number of keystrokes, and preferrably no mouse actions. There are lots of little and big navigations I do a lot:
</p>
<ol class="org-ol">
<li>forward/backward by a character
</li>
<li>forward/backward by a word/subword
</li>
<li>forward/backward by a sentence
</li>
<li>forward/backward by a line
</li>
<li>to the beginning and end of a line
</li>
<li>to the beginning and end of a sentence
</li>
<li>to the beginning and end of a paragraph
</li>
<li>to the beginning and end of a page
</li>
<li>to the beginning and end of a buffer
</li>
<li>scrolling up/down
</li>
<li>into another window
</li>
<li>back and forth to buffers
</li>
</ol>

<p>
Occasionally, I want to save a location so I can easily get back to it. Not all of these are strictly speaking navigation in the usual sense, but they are things I do often enough. There are Emacs commands for all these, and keyboard shortcuts for many of them, but I don't use them often, and as a result I don't remember them either.
</p>

<p>
Here I develop a <a href="https://github.com/abo-abo/hydra">hydra</a> that will provide these features. Hydra is a super amazing, menu prompting system that provides hints to remind you of what can be done, and to access it from a character. It is possible to pass numeric and universal arguments to the commands by typing -, a number, or C-u before pressing the character.
</p>

<p>
I want some commands to be repeatable, which we get with a "red" hydra, and some commands to exit on running, which we get with a "blue" head. So, here is an over-the-top hydra for navigation.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #0000FF;">defhydra</span> hydra-navigate (<span style="color: #006FE0;">:color</span> red
                          <span style="color: #006FE0;">:hint</span> nil)
  <span style="color: #008000;">"</span>
<span style="color: #008000;">_f_: forward-char       _w_: forward-word       _n_: next-line</span>
<span style="color: #008000;">_b_: backward-char      _W_: backward-word      _p_: previous-line</span>
<span style="color: #008000;">^ ^                     _o_: subword-right      _,_: beginning-of-line</span>
<span style="color: #008000;">^ ^                     _O_: subword-left       _._: end-of-line</span>

<span style="color: #008000;">_s_: forward sentence   _a_: forward paragraph  _g_: forward page</span>
<span style="color: #008000;">_S_: backward sentence  _A_: backward paragraph _G_: backward page</span>

<span style="color: #008000;">_h_: helm mini _B_: buffer list _i_: window</span>
<span style="color: #008000;">_&lt;left&gt;_: previous buffer   _&lt;right&gt;_: next buffer</span>
<span style="color: #008000;">_&lt;up&gt;_: scroll-up           _&lt;down&gt;_: scroll-down</span>

<span style="color: #008000;">_[_: backward-sexp _]_: forward-sexp</span>
<span style="color: #008000;">_&lt;_ beginning of buffer _&gt;_ end of buffer _m_: set mark _/_: jump to mark</span>
<span style="color: #008000;">"</span>
  (<span style="color: #008000;">"f"</span> forward-char)
  (<span style="color: #008000;">"b"</span> backward-char)
  (<span style="color: #008000;">"w"</span> forward-word)
  (<span style="color: #008000;">"W"</span> backward-word)
  (<span style="color: #008000;">"n"</span> next-line)
  (<span style="color: #008000;">"p"</span> previous-line)
  (<span style="color: #008000;">"o"</span> subword-right)
  (<span style="color: #008000;">"O"</span> subword-left)
  (<span style="color: #008000;">"s"</span> forward-sentence)
  (<span style="color: #008000;">"S"</span> backward-sentence)
  (<span style="color: #008000;">"a"</span> forward-paragraph)
  (<span style="color: #008000;">"A"</span> backward-paragraph)
  (<span style="color: #008000;">"g"</span> forward-page)
  (<span style="color: #008000;">"G"</span> backward-page)
  (<span style="color: #008000;">"&lt;right&gt;"</span> next-buffer)
  (<span style="color: #008000;">"&lt;left&gt;"</span> previous-buffer)
  (<span style="color: #008000;">"h"</span> helm-mini <span style="color: #006FE0;">:color</span> blue)
  (<span style="color: #008000;">"i"</span> ace-window <span style="color: #006FE0;">:color</span> blue)
  (<span style="color: #008000;">"m"</span> org-mark-ring-push)
  (<span style="color: #008000;">"/"</span> org-mark-ring-goto <span style="color: #006FE0;">:color</span> blue)
  (<span style="color: #008000;">"B"</span> helm-buffers-list)
  (<span style="color: #008000;">"&lt;up&gt;"</span> scroll-up)
  (<span style="color: #008000;">"&lt;down&gt;"</span> scroll-down)
  (<span style="color: #008000;">"&lt;"</span> beginning-of-buffer)
  (<span style="color: #008000;">"&gt;"</span> end-of-buffer)
  (<span style="color: #008000;">"."</span> end-of-line)
  (<span style="color: #008000;">"["</span> backward-sexp)
  (<span style="color: #008000;">"]"</span> forward-sexp)
  (<span style="color: #008000;">","</span> beginning-of-line)
  (<span style="color: #008000;">"q"</span> nil <span style="color: #008000;">"quit"</span> <span style="color: #006FE0;">:color</span> blue))

(global-set-key (kbd <span style="color: #008000;">"s-n"</span>) 'hydra-navigate/body)
</pre>
</div>

<pre class="example">
hydra-navigate/body
</pre>

<p>
I basically like it. The menu is a little on the large side, but it makes for easy modal navigation in a buffer, to other windows, and other buffers. On the whole for moderate cursor movements, this results in basically equal keystrokes. For example, to move 3 characters forward, we have C-f C-f C-f or C-u 3 C-f, or s-n 3 f. The advantage (I think) is a single interface to all these navigation commands with hints on what to do.
</p>

<p>
There is still another level of navigation, which is related to navigation by searching. That is a whole different level of navigation I will work on another day!
</p>
<p>Copyright (C) 2015 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2015/09/27/Upping-my-Emacs-navigation-game.org">org-mode source</a><p><p>Org-mode version = 8.2.10</p>

    </div>
  </div>
</article>



<a href="https://twitter.com/share" class="twitter-share-button" data-via="johnkitchin">Tweet</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>

  <div class="after_post"><a href="http://jkitchin.github.io/blog/2015/09/27/Upping-my-Emacs-navigation-game#disqus_thread">Read and Post Comments</a></div>
  <hr class="interblog" />
  





<article>
  <div class="blog_post">
    <header>
      <div id="Checking-for-email-attachments-before-you-send-email"></div>
      <h2 class="blog_post_title"><a href="/blog/2015/09/04/Checking-for-email-attachments-before-you-send-email/" rel="bookmark" title="Permanent Link to Checking for email attachments before you send email">Checking for email attachments before you send email</a></h2>
      <p><small><span class="blog_post_date">Posted September 04, 2015 at 07:03 PM</span> | categories:
        <span class="blog_post_categories"><a href='/blog/category/email/'>email</a>, <a href='/blog/category/emacs/'>emacs</a></span> | tags: 
        | <a href="http://jkitchin.github.io/blog/2015/09/04/Checking-for-email-attachments-before-you-send-email#disqus_thread">View Comments</a>
      <p><small><span class="blog_post_date">Updated September 04, 2015 at 07:04 PM</span>
      </small></p>
    </header>
    <div class="post_prose">
      



<p>
Does this comic (<a href="http://www.phdcomics.com/comics/archive.php?comicid=1817">http://www.phdcomics.com/comics/archive.php?comicid=1817</a> ) apply to you? Do you miss the Gmail feature that will alert you that it seems like you mention an attachment but there isn't one attached before it lets you send it? Let's make Emacs help us here. We will scan our emails for the word "attach", and if we see it, scan the email for evidence of an attachment. Then create a hook function that will prompt us if it appears we mention an attachment, but don't have one.
</p>

<p>
An attachment looks like this in my messages:
</p>
<pre class="example">
&lt;#part type="image/png" filename="~/Desktop/wordcloud.png" disposition=attachment&gt;
&lt;#/part&gt;
</pre>

<p>
So, probably finding "&lt;#part" in the buffer means I probably have an attachment. We will use the message-send-hook to run this function. Here is the code. Some brief testing from me seems to work fine! It is pretty simple, but probably good enough to save me from sending messages with no attachment, and not too intrusive for when no attachment is actually needed, e.g. in replies. Let me know if you have ideas for improvements.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #0000FF;">defun</span> <span style="color: #006699;">email-says-attach-p</span> ()
  <span style="color: #036A07;">"Return t if email suggests there could be an attachment."</span>
  (<span style="color: #0000FF;">save-excursion</span>
    (goto-char (point-min))
    (re-search-forward <span style="color: #008000;">"attach"</span> nil t)))

(<span style="color: #0000FF;">defun</span> <span style="color: #006699;">email-has-attachment-p</span> ()
  <span style="color: #036A07;">"Return t if the currently open email has an attachment"</span>
  (<span style="color: #0000FF;">save-excursion</span>
    (goto-char (point-min))
    (re-search-forward <span style="color: #008000;">"&lt;#part"</span> nil t)))

(<span style="color: #0000FF;">defun</span> <span style="color: #006699;">email-pre-send-check-attachment</span> ()
  (<span style="color: #0000FF;">when</span> (<span style="color: #0000FF;">and</span> (email-says-attach-p)
             (not (email-has-attachment-p)))
    (<span style="color: #0000FF;">unless</span>
        (y-or-n-p <span style="color: #008000;">"Your email suggests you need an attachment, but no attachment was found. Send anyway?"</span>)
      (<span style="color: #ff0000; font-weight: bold;">error</span> <span style="color: #008000;">"It seems an attachment is needed, but none was found. Aborting send."</span>))))

(add-hook 'message-send-hook 'email-pre-send-check-attachment)
</pre>
</div>
<p>Copyright (C) 2015 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2015/09/04/Checking-for-email-attachments-before-you-send-email.org">org-mode source</a><p><p>Org-mode version = 8.2.10</p>

    </div>
  </div>
</article>



<a href="https://twitter.com/share" class="twitter-share-button" data-via="johnkitchin">Tweet</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>

  <div class="after_post"><a href="http://jkitchin.github.io/blog/2015/09/04/Checking-for-email-attachments-before-you-send-email#disqus_thread">Read and Post Comments</a></div>
  <hr class="interblog" />
  





<article>
  <div class="blog_post">
    <header>
      <div id="A-highlight-annotation-mode-for-Emacs-using-font-lock"></div>
      <h2 class="blog_post_title"><a href="/blog/2015/07/28/A-highlight-annotation-mode-for-Emacs-using-font-lock/" rel="bookmark" title="Permanent Link to A highlight annotation mode for Emacs using font-lock">A highlight annotation mode for Emacs using font-lock</a></h2>
      <p><small><span class="blog_post_date">Posted July 28, 2015 at 10:57 AM</span> | categories:
        <span class="blog_post_categories"><a href='/blog/category/annotation/'>annotation</a>, <a href='/blog/category/emacs/'>emacs</a></span> | tags: 
        | <a href="http://jkitchin.github.io/blog/2015/07/28/A-highlight-annotation-mode-for-Emacs-using-font-lock#disqus_thread">View Comments</a>
      <p><small><span class="blog_post_date">Updated July 31, 2015 at 09:17 AM</span>
      </small></p>
    </header>
    <div class="post_prose">
      



<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#sec-1">1. Known limitations</a></li>
</ul>
</div>
</div>
<p>
One of my students asked about highlighting text in emacs for note-taking. I can see some advantages for doing it while teaching, for example, and for students studying, so here we we work it out.
</p>

<p>
You will definitely want to see the video on this one, the highlights do not show up in the published html. <a href="https://www.youtube.com/watch?v=Cvz2tiT12-I">https://www.youtube.com/watch?v=Cvz2tiT12-I</a> 
</p>

<p>
For temporary use, highlighting is pretty easy, you just set a property on a region, e.g. the background color. For example, we can do this:
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #8D8D84;">; </span><span style="color: #8D8D84; font-style: italic;">this seems to be necessary to get the tooltips to work.</span>
(<span style="color: #0000FF;">setq</span> font-lock-extra-managed-props (delq 'help-echo font-lock-extra-managed-props))

(<span style="color: #0000FF;">defun</span> <span style="color: #006699;">highlight-region</span> (beg end)
 (<span style="color: #0000FF;">interactive</span> <span style="color: #008000;">"r"</span>)
 (set-text-properties
  beg end
  '(font-lock-face (<span style="color: #006FE0;">:background</span> <span style="color: #008000;">"Light Salmon"</span>)
                   highlighted t
                   help-echo <span style="color: #008000;">"highlighted"</span>)))

(global-set-key (kbd <span style="color: #008000;">"s-h"</span>) 'highlight-region)
</pre>
</div>

<pre class="example">
highlight-region
</pre>

<p>
This sets the background color, and another property "highlighted" that we will use later. The trouble is this is transient. When I close the file, the highlights are lost. We can save them to a file though, and reload them later. As long as we are diligent about that we should be able to provide persistent highlights.
</p>

<p>
First we need a function to get all the highlights, their start and end, their color, and if there is a help-echo which provides a tooltip. We will see why later. Here we loop through the buffer collecting highlights, and return a list of them.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #0000FF;">defun</span> <span style="color: #006699;">highlight-get-highlights</span> ()
  <span style="color: #036A07;">"Scan buffer for list of highlighted regions.</span>
<span style="color: #036A07;">These are defined only by the highlighted property. That means</span>
<span style="color: #036A07;">adjacent highlighted regions will be merged into one region with</span>
<span style="color: #036A07;">the color of the first one."</span>
  (<span style="color: #0000FF;">save-excursion</span>
    (goto-char (point-min))
    (<span style="color: #0000FF;">let</span> ((highlights '())
          (p)
          (beg)
          (end)
          (note)
          (color))
      <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">corner case of first point being highlighted</span>
      (<span style="color: #0000FF;">when</span> (get-text-property (point) 'highlighted)
        (<span style="color: #0000FF;">setq</span> beg (point)
              end (next-single-property-change (point) 'highlighted)
              color (background-color-at-point)
              help-echo (get-text-property (point) 'help-echo))
        (add-to-list 'highlights (list beg end color help-echo) t)
        (goto-char end))

      <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Now the rest of the buffer</span>
      (<span style="color: #0000FF;">while</span> (<span style="color: #0000FF;">setq</span> p (next-single-property-change (point) 'highlighted))
        (<span style="color: #0000FF;">setq</span> beg (goto-char p))
        (<span style="color: #0000FF;">setq</span> color (background-color-at-point))
        (<span style="color: #0000FF;">setq</span> note (get-text-property (point) 'help-echo))
        (<span style="color: #0000FF;">setq</span> end (next-single-property-change (point) 'highlighted))
        (<span style="color: #0000FF;">when</span> (<span style="color: #0000FF;">and</span> beg end)
          (goto-char end)
          (add-to-list 'highlights (list beg
                                         end
                                         color
                                         note)
                       t)
          (goto-char end)))
      highlights)))

(highlight-get-highlights)
</pre>
</div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="right" />

<col  class="right" />

<col  class="left" />

<col  class="left" />
</colgroup>
<tbody>
<tr>
<td class="right">438</td>
<td class="right">454</td>
<td class="left">Light Salmon</td>
<td class="left">highlighted</td>
</tr>

<tr>
<td class="right">1014</td>
<td class="right">1031</td>
<td class="left">Light Salmon</td>
<td class="left">highlighted</td>
</tr>
</tbody>
</table>


<p>
Next, we generate a filename, and a function to save the highlights to disk. We make it a hook function that runs every time we save the buffer.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #0000FF;">defun</span> <span style="color: #006699;">highlight-save-filename</span> ()
  <span style="color: #036A07;">"Return name of file to save overlays in."</span>
  (<span style="color: #0000FF;">when</span> (buffer-file-name)
    (concat <span style="color: #008000;">"."</span> (file-name-nondirectory (buffer-file-name)) <span style="color: #008000;">".highlights"</span>)))

(<span style="color: #0000FF;">defun</span> <span style="color: #006699;">highlight-save</span> ()
  <span style="color: #036A07;">"Loop through buffer and save regions with property highlighted.</span>
<span style="color: #036A07;">Save beginning, end of each region, color and help-echo on the</span>
<span style="color: #036A07;">first character of the region. Delete highlight file if it is empty."</span>
  (<span style="color: #0000FF;">interactive</span>)
  (<span style="color: #0000FF;">let</span> ((fname (highlight-save-filename))
        (highlights (highlight-get-highlights)))
    (<span style="color: #0000FF;">if</span> (<span style="color: #0000FF;">and</span> fname highlights)
          (<span style="color: #0000FF;">with-temp-file</span> fname
            (print highlights (current-buffer)))
        <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">get rid of file if there are not highlights</span>
        (<span style="color: #0000FF;">when</span> (<span style="color: #0000FF;">and</span> fname (file-exists-p fname))
          (delete-file fname)))))

(add-hook 'after-save-hook 'highlight-save)
</pre>
</div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="left" />

<col  class="left" />
</colgroup>
<tbody>
<tr>
<td class="left">highlight-save</td>
<td class="left">helm-swoop&#x2013;clear-cache</td>
</tr>
</tbody>
</table>


<div class="org-src-container">

<pre class="src src-sh">cat .highlights.org.highlights
</pre>
</div>

<pre class="example">
((438 454 "Light Salmon" "highlighted") (1014 1031 "Light Salmon" "highlighted"))
</pre>

<p>
Here, we can read the contents and apply the highlights. We set this up on a hook for org-mode, so it will apply them on when we open org-files. You could make this more general if you plan to highlight in code files, for example.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #0000FF;">defun</span> <span style="color: #006699;">highlight-load</span> ()
  <span style="color: #036A07;">"Load and apply highlights."</span>
  (<span style="color: #0000FF;">interactive</span>)
  (<span style="color: #0000FF;">setq</span> font-lock-extra-managed-props (delq 'help-echo font-lock-extra-managed-props))
  (<span style="color: #0000FF;">let</span> ((fname (highlight-save-filename)))
    (<span style="color: #0000FF;">when</span> (<span style="color: #0000FF;">and</span> fname (file-exists-p fname))
      (mapcar
       (<span style="color: #0000FF;">lambda</span> (entry)
         (<span style="color: #0000FF;">let</span> ((beg (nth 0 entry))
               (end (nth 1 entry))
               (color (nth 2 entry))
               (help-echo (nth 3 entry)))
           (set-text-properties
            beg end
            `(font-lock-face (<span style="color: #006FE0;">:background</span> ,color)
                             help-echo ,help-echo
                             highlighted t))))
       (<span style="color: #0000FF;">with-temp-buffer</span> (insert-file-contents fname)
                         (read (current-buffer)))))))


(add-hook 'org-mode-hook 'highlight-load)
</pre>
</div>


<p>
Now, let's outdo ourselves in ridiculosity. We will add a helm-colors selector to give you unprecedented highlighting capability in multicolor magnificence. This function will highlight selected text, or update the color of an existing highlight.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #0000FF;">defun</span> <span style="color: #006699;">highlight</span> (beg end <span style="color: #6434A3;">&amp;optional</span> color)
  <span style="color: #036A07;">"Highlight region from BEG to END with COLOR.</span>
<span style="color: #036A07;">COLOR is selected from `</span><span style="color: #D0372D;">helm-colors</span><span style="color: #036A07;">' when run interactively."</span>
  (<span style="color: #0000FF;">interactive</span> <span style="color: #008000;">"r"</span>)
  (<span style="color: #0000FF;">unless</span> (<span style="color: #0000FF;">or</span> (get-text-property (point) 'highlighted)
              (region-active-p))
    (<span style="color: #ff0000; font-weight: bold;">error</span> <span style="color: #008000;">"No region selected or not on a highlight."</span>))
  (<span style="color: #0000FF;">unless</span> color
    (<span style="color: #0000FF;">setq</span> color (s-trim (helm-colors))))
  (<span style="color: #0000FF;">if</span> (get-text-property (point) 'highlighted)
      <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">update color</span>
      (<span style="color: #0000FF;">let</span> ((beg (previous-single-property-change (point) 'highlighted))
            (end (next-single-property-change (point) 'highlighted)))
        (set-text-properties
         beg end
         `(font-lock-face (<span style="color: #006FE0;">:background</span> ,color)
                          highlighted t)))
  (set-text-properties
   beg end
   `(font-lock-face (<span style="color: #006FE0;">:background</span> ,color)
                    highlighted t))))

<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">For convenience</span>
(global-set-key (kbd <span style="color: #008000;">"s-h"</span>) 'highlight)
</pre>
</div>
<pre class="example">
highlight
</pre>


<p>
Now, we can conveniently highlight text in whatever color we want. How about list your highlights? After we have highlighted a lot, it might be nice to see a list of these we can click on to find our highlights more quickly.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #0000FF;">defun</span> <span style="color: #006699;">highlight-list</span> ()
  <span style="color: #036A07;">"Make a list of highlighted text in another buffer. "</span>
  (<span style="color: #0000FF;">interactive</span>)
  (<span style="color: #0000FF;">let</span> ((cb (current-buffer))
        (fname (buffer-file-name))
        (hls (mapcar
              (<span style="color: #0000FF;">lambda</span> (entry)
                (list (nth 0 entry)
                      (buffer-substring (nth 0 entry) (nth 1 entry))))
              (highlight-get-highlights))))
    (<span style="color: #0000FF;">if</span> hls
        (<span style="color: #0000FF;">progn</span>
          (split-window-right)
          (switch-to-buffer-other-window <span style="color: #008000;">"*highlights*"</span>) (org-mode)
          (<span style="color: #0000FF;">setq</span> buffer-read-only nil)
          (erase-buffer)
          (insert <span style="color: #008000;">"Click on text to jump to the position.\n\n"</span>)

          (<span style="color: #0000FF;">dolist</span> (s hls)
            (<span style="color: #0000FF;">let</span> ((map (make-sparse-keymap)))
              (define-key map [mouse-1]
                `(<span style="color: #0000FF;">lambda</span> ()
                   (<span style="color: #0000FF;">interactive</span>)
                   (find-file ,fname)
                   (goto-char ,(nth 0 s))))
              (insert (propertize
                       (concat (nth 1 s) <span style="color: #008000;">"\n"</span>)
                       'local-map map))))
          (<span style="color: #0000FF;">setq</span> buffer-read-only t))
      (message <span style="color: #008000;">"No highlights found."</span>))))
</pre>
</div>

<pre class="example">
highlight-list
</pre>

<p>
You probably would like to just select some text with your mouse, and have it highlighted. That requires us to advise the mouse-set-region function.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #0000FF;">defun</span> <span style="color: #006699;">highlight-green</span> ()
  <span style="color: #036A07;">"Highlight region in green."</span>
  (<span style="color: #0000FF;">interactive</span>)
  (highlight (region-beginning) (region-end) <span style="color: #008000;">"Darkolivegreen1"</span>))

<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">create the advice for use later</span>
(<span style="color: #0000FF;">defadvice</span> <span style="color: #006699;">mouse-set-region</span> (after my-highlight () disable)
  <span style="color: #036A07;">"Highlight"</span>
  (highlight-green))

(<span style="color: #0000FF;">defun</span> <span style="color: #006699;">highlight-mouse-on</span> ()
  <span style="color: #036A07;">"Turn on mouse highlighting"</span>
  (<span style="color: #0000FF;">interactive</span>)
  (ad-enable-advice 'mouse-set-region 'after 'my-highlight)
  (ad-activate 'mouse-set-region))

(<span style="color: #0000FF;">defun</span> <span style="color: #006699;">highlight-mouse-off</span> ()
  (<span style="color: #0000FF;">interactive</span>)
  (ad-disable-advice 'mouse-set-region 'after 'my-highlight)
  (ad-deactivate 'mouse-set-region))
</pre>
</div>

<pre class="example">
highlight-mouse-off
</pre>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #0000FF;">defun</span> <span style="color: #006699;">highlight-picasso-blues</span> ()
 (<span style="color: #0000FF;">interactive</span>)
 (<span style="color: #0000FF;">save-excursion</span>
   (<span style="color: #0000FF;">let</span> ((colors '(<span style="color: #008000;">"PowderBlue"</span>
                   <span style="color: #008000;">"Lightskyblue1"</span>
                   <span style="color: #008000;">"Lightskyblue2"</span>
                   <span style="color: #008000;">"Lightskyblue3"</span>
                   <span style="color: #008000;">"Lightskyblue4"</span>))
         (beg (region-beginning))
         (end (region-end)))
     (goto-char beg)
     (<span style="color: #0000FF;">while</span> (&lt; (point) (- end 1))
       (highlight (point) (+ 1 (point))
                  (nth (mod (- (point) (region-beginning)) (length colors)) colors))
       (forward-char)))))

(<span style="color: #0000FF;">defun</span> <span style="color: #006699;">highlight-rainbow</span> ()
 (<span style="color: #0000FF;">interactive</span>)
 (<span style="color: #0000FF;">save-excursion</span>
   (<span style="color: #0000FF;">let</span> ((colors '(<span style="color: #008000;">"Red1"</span>
                   <span style="color: #008000;">"Orange1"</span>
                   <span style="color: #008000;">"Yellow1"</span>
                   <span style="color: #008000;">"Darkolivegreen1"</span>
                   <span style="color: #008000;">"Skyblue1"</span>
                   <span style="color: #008000;">"Blue1"</span>
                   <span style="color: #008000;">"DarkViolet"</span>))
         (beg (region-beginning))
         (end (region-end)))
     (goto-char beg)
     (<span style="color: #0000FF;">while</span> (&lt; (point) (- end 1))
       (highlight (point) (+ 1 (point))
                  (nth (mod (- (point) (region-beginning)) (length colors)) colors))
       (forward-char)))))
</pre>
</div>

<p>
=These look cool, but they don't get properly saved. The code that finds the highlights finds the region, but only saves the first color. That means that adjacent highlights of different color will also not be saved correctly.
</p>

<p>
How about a highlight with your own tooltip? In theory we can set the help-echo property to some text. In practice I have found this tricky because font-lock occasionally erases help-echo properties on re-fontifying. We remove help-echo from a list of properties that are affected by this, but another library may add it back, and there might be some unintended consequences of that. Here we design a function to highlight with a user-defined tooltip.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #0000FF;">defun</span> <span style="color: #006699;">highlight-note</span> (beg end color <span style="color: #6434A3;">&amp;optional</span> note)
  <span style="color: #036A07;">"Highlight selected text and add NOTE to it as a tooltip."</span>
  (<span style="color: #0000FF;">interactive</span>
   (list
    (region-beginning)
    (region-end)
    (s-trim (helm-colors))))
  (<span style="color: #0000FF;">unless</span> note (<span style="color: #0000FF;">setq</span> note (read-input <span style="color: #008000;">"Note: "</span>)))
  (<span style="color: #0000FF;">unless</span> (region-active-p)
    (<span style="color: #ff0000; font-weight: bold;">error</span> <span style="color: #008000;">"No region selected."</span>))
  (set-text-properties
   beg end
   `(help-echo ,note font-lock-face (<span style="color: #006FE0;">:background</span> ,color)
               highlighted t)))


(<span style="color: #0000FF;">defun</span> <span style="color: #006699;">highlight-note-edit</span> (new-note)
  <span style="color: #036A07;">"Set tooltip of highlight at point to NEW-NOTE."</span>
  (<span style="color: #0000FF;">interactive</span> (list (read-input <span style="color: #008000;">"Note: "</span> (get-text-property (point) 'help-echo))))
  (<span style="color: #0000FF;">let*</span> ((region (button-lock-find-extent (point) 'highlighted))
         (beg (car region))
         (end (cdr region)))
    (put-text-property beg end 'help-echo new-note)))
</pre>
</div>

<p>
=highlight-note-edit
==highlight-note-edit
==highlight-note-edit
==highlight-note-edit
=C
Want to get rid of the highlights? We may want to delete one or all. We make a function for each.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #0000FF;">defun</span> <span style="color: #006699;">highlight-clear</span> ()
  <span style="color: #036A07;">"Clear highlight at point."</span>
  (<span style="color: #0000FF;">interactive</span>)
  (<span style="color: #0000FF;">when</span> (get-text-property (point) 'highlighted)
    (set-text-properties
     (next-single-property-change (point) 'highlighted)
     (previous-single-property-change (point) 'highlighted)
     nil)))


(<span style="color: #0000FF;">defun</span> <span style="color: #006699;">highlight-clear-all</span> ()
  <span style="color: #036A07;">"Clear all highlights.</span>
<span style="color: #036A07;">They are really deleted when you save the buffer."</span>
  (<span style="color: #0000FF;">interactive</span>)
  (mapcar
   (<span style="color: #0000FF;">lambda</span> (entry)
     (<span style="color: #0000FF;">let</span> ((beg (nth 0 entry))
           (end (nth 1 entry)))
       (set-text-properties
        beg end nil)))
   (highlight-get-highlights))
  (<span style="color: #0000FF;">when</span> (get-buffer <span style="color: #008000;">"*highlights*"</span>)
    (kill-buffer <span style="color: #008000;">"*highlights*"</span>)))
</pre>
</div>
<pre class="example">
highlight-clear-all
</pre>

<p>
Let's define a few convenience functions for common colors, a hydra to quickly select them and bind it to a key for convenience.  While we are at it, we add a menu to Org too.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #0000FF;">defun</span> <span style="color: #006699;">highlight-yellow</span> ()
  <span style="color: #036A07;">"Highlight region in yellow."</span>
  (<span style="color: #0000FF;">interactive</span>)
  (highlight (region-beginning) (region-end) <span style="color: #008000;">"Yellow"</span>))

(<span style="color: #0000FF;">defun</span> <span style="color: #006699;">highlight-blue</span> ()
  <span style="color: #036A07;">"Highlight region in blue."</span>
  (<span style="color: #0000FF;">interactive</span>)
  (highlight (region-beginning) (region-end) <span style="color: #008000;">"LightBlue"</span>))

(<span style="color: #0000FF;">defun</span> <span style="color: #006699;">highlight-pink</span> ()
  <span style="color: #036A07;">"Highlight region in pink."</span>
  (<span style="color: #0000FF;">interactive</span>)
  (highlight (region-beginning) (region-end) <span style="color: #008000;">"Pink"</span>))

(<span style="color: #0000FF;">defun</span> <span style="color: #006699;">highlight-green</span> ()
  <span style="color: #036A07;">"Highlight region in green."</span>
  (<span style="color: #0000FF;">interactive</span>)
  (highlight (region-beginning) (region-end) <span style="color: #008000;">"Darkolivegreen1"</span>))


(<span style="color: #0000FF;">defhydra</span> highlighter (<span style="color: #006FE0;">:color</span> blue) <span style="color: #008000;">"highlighter"</span>
  (<span style="color: #008000;">"b"</span> highlight-blue <span style="color: #008000;">"blue"</span>)
  (<span style="color: #008000;">"g"</span> highlight-green <span style="color: #008000;">"Green"</span>)
  (<span style="color: #008000;">"p"</span> highlight-pink <span style="color: #008000;">"Pink"</span>)
  <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">define as many special colors as you like.</span>
  (<span style="color: #008000;">"s"</span> (highlight (region-beginning) (region-end) <span style="color: #008000;">"Lightsalmon1"</span>) <span style="color: #008000;">"Salmon"</span>)
  (<span style="color: #008000;">"y"</span> highlight-yellow <span style="color: #008000;">"yellow"</span>)
  (<span style="color: #008000;">"c"</span> highlight <span style="color: #008000;">"Choose color"</span>)
  (<span style="color: #008000;">"n"</span> (highlight-note (region-beginning) (region-end) <span style="color: #008000;">"Thistle"</span>) <span style="color: #008000;">"Note"</span>)
  (<span style="color: #008000;">"N"</span> highlight-note <span style="color: #008000;">"Note (c)"</span>)
  (<span style="color: #008000;">"m"</span> highlight-mouse-on <span style="color: #008000;">"Mouse"</span>)
  (<span style="color: #008000;">"M"</span> highlight-mouse-off <span style="color: #008000;">"Mouse off"</span>)
  (<span style="color: #008000;">"e"</span> highlight-note-edit <span style="color: #008000;">"Edit note"</span>)
  (<span style="color: #008000;">"l"</span> highlight-list <span style="color: #008000;">"List highlights"</span>)
  (<span style="color: #008000;">"r"</span> highlight-load <span style="color: #008000;">"Reload"</span>)
  (<span style="color: #008000;">"S"</span> highlight-save <span style="color: #008000;">"Save"</span>)
  (<span style="color: #008000;">"d"</span> highlight-clear <span style="color: #008000;">"Delete"</span>)
  (<span style="color: #008000;">"D"</span> highlight-clear-all <span style="color: #008000;">"Delete All"</span>))

(easy-menu-change
 '(<span style="color: #008000;">"Org"</span>) <span style="color: #008000;">"highlighter"</span>
 '([<span style="color: #008000;">"Highlight"</span> highlight]
   [<span style="color: #008000;">"Highlight (B)"</span> highlight-blue]
   [<span style="color: #008000;">"Highlight (G)"</span> highlight-green]
   [<span style="color: #008000;">"Highlight (P)"</span> highlight-pink]
   [<span style="color: #008000;">"Highlight (Y)"</span> highlight-yellow]
   [<span style="color: #008000;">"Highlight note"</span> highlight-note]
   [<span style="color: #008000;">"List highlights"</span> highlight-list]
   [<span style="color: #008000;">"Delete highlight"</span> highlight-clear]
   [<span style="color: #008000;">"Delete highlights"</span> highlight-clear-all])
 <span style="color: #008000;">"Show/Hide"</span>)


(global-set-key (kbd <span style="color: #008000;">"s-h"</span>) 'highlighter/body)
</pre>
</div>

<pre class="example">
highlighter/body
</pre>


<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1"><span class="section-number-2">1</span> Known limitations</h2>
<div class="outline-text-2" id="text-1">
<p>
The tooltips seem especially fragile, and if there is code that undoes the removal of help-echo from font-lock-extra-managed-props, it seems possible they would easily get lost. I wouldn't use them a lot without a lot of testing. You <i>have</i> to rely on the hook functions defined to keep the highlights synchronized between the buffer and the external highlight file. If you were to rename a file externally, e.g. in the OS, or with a shell command, then the highlights will be lost unless you also rename the external file.
</p>

<p>
Highlights are not robust enough to survive refiling an org-mode section from one file to another.  Personally I don't see these as too big a problem; I don't put a lot of value of highlights, but I can see it being pretty annoying to lose them!
</p>

<p>
Still, if you want to give this a try, you can use the code here: <a href="/media/2015-07-28-A-highlight-annotation-mode-for-Emacs-using-font-lock/highlights.el">highlights.el</a> . You should bind the functions to whatever keys you want. Also, it is setup to only work for org-mode. I am not sure what the best hook to use for any file might be. Maybe find-file-hook.
</p>
</div>
</div>
<p>Copyright (C) 2015 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2015/07/28/A-highlight-annotation-mode-for-Emacs-using-font-lock.org">org-mode source</a><p><p>Org-mode version = 8.2.10</p>

    </div>
  </div>
</article>



<a href="https://twitter.com/share" class="twitter-share-button" data-via="johnkitchin">Tweet</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>

  <div class="after_post"><a href="http://jkitchin.github.io/blog/2015/07/28/A-highlight-annotation-mode-for-Emacs-using-font-lock#disqus_thread">Read and Post Comments</a></div>
  <hr class="interblog" />
 <a href="/blog/category/emacs/12">« Previous Page</a>
  --  
 <a href="/blog/category/emacs/14">Next Page »</a>

          </div>
          <div id="sidebar" class="grid_4">
            <aside>
<section>
<script>
  (function() {
    var cx = '002533177287215655227:l7uvu35ssbc';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
        '//www.google.com/cse/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>
</section>

<section>
    <h1 class="post_header_gradient theme_font">Twitter</h1>
    <a class="twitter-timeline" href="https://twitter.com/johnkitchin" data-widget-id="545217643582881792">Tweets by @johnkitchin</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+"://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
</section>


  <section>
    <h1 class="post_header_gradient theme_font">Links</h1>
    <ul>
      <li><a href="https://www.continuum.io">Anaconda Python</a></li>
      <li><a href="/pycse">Pycse</a></li>
      <li><a href="/dft-book">DFT-book</a></li>
    </ul>
  </section>

  <section>
    <h1 class="post_header_gradient theme_font">Latest Posts</h1>
    <ul>
      <li><a href="/blog/2018/01/27/New-publication-in-Topics-in-Catalysis/">New publication in Topics in Catalysis</a></li>
      <li><a href="/blog/2018/01/03/New-publication-in-Molecular-Simulation/">New publication in Molecular Simulation</a></li>
      <li><a href="/blog/2017/12/31/2017-in-a-nutshell-for-the-Kitchin-Research-group/">2017 in a nutshell for the Kitchin Research group</a></li>
      <li><a href="/blog/2017/11/29/Solving-an-eigenvalue-differential-equation-with-a-neural-network/">Solving an eigenvalue differential equation with a neural network</a></li>
      <li><a href="/blog/2017/11/28/Solving-ODEs-with-a-neural-network-and-autograd/">Solving ODEs with a neural network and autograd</a></li>
    </ul>
  </section>

<section>
<h1 class="post_header_gradient theme_font">Latest GitHub Repos</h1>
  <a href="https://github.com/jkitchin">@jkitchin</a> on GitHub.
  <ul id="my-github-projects">
        <li class="loading">Status updating&#8230;</li>
  </ul>

</section>
</aside>

          </div>
          <div class="clear"></div>
        </div>
      </div>
      
<footer>
  <div id="footer" class="grid_12">
    <div class="grid_8">
      <p>
        <a href="/blog/feed/index.xml">RSS</a>
        <a href="http://kitchinresearchgroup.disqus.com/latest.rss">Comments RSS Feed</a>.
      </p>
    </div>
    <div class="grid_4" id="credits">
      <p>
        Copyright 2018
        John Kitchin
      </p>
      <p>
        Powered by <a href="http://www.blogofile.com">Blogofile</a>
      </p>
    </div>
  </div>
</footer>

    </div>
      <script src="//ajax.googleapis.com/ajax/libs/jquery/1.5.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="/js/libs/jquery-1.5.1.min.js"%3E%3C/script%3E'))</script>
  <script src="/js/plugins.js"></script>
  <script src="/js/script.js"></script>
  <script src="/js/jquery.tweet.js"></script>  
  <script src="/js/site.js"></script>
  <!--[if lt IE 7 ]>
  <script src="js/libs/dd_belatedpng.js"></script>
  <script> DD_belatedPNG.fix('img, .png_bg');</script>
  <![endif]-->
  <script>
      var _gaq=[['_setAccount','UA-35731398-1'],['_trackPageview']];
      (function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];g.async=1;
      g.src=('https:'==location.protocol?'//ssl':'//www')+'.google-analytics.com/ga.js';
      s.parentNode.insertBefore(g,s)}(document,'script'));
  </script>
  <script>
  (function() {
      var links = document.getElementsByTagName('a');
      var query = '?';
      for(var i = 0; i < links.length; i++) {
          if(links[i].href.indexOf('#disqus_thread') >= 0) {
              query += 'url' + i + '=' + encodeURIComponent(links[i].href) + '&';
          }
      }
      document.write('<script charset="utf-8" type="text/javascript" src="http://disqus.com/forums/kitchinresearchgroup/get_num_replies.js' + query + '"></' + 'script>');
  })();
  </script>

  </body>
</html>






<script src="http://ajax.microsoft.com/ajax/jquery/jquery-1.4.2.min.js" type="text/javascript"></script>
<script src="/js/git.js" type="text/javascript"></script>
<script type="text/javascript">
    $(function() {
     $("#my-github-projects").loadRepositories("jkitchin");
    });
</script>



