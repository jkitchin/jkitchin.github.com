

<!doctype html>
<!--[if lt IE 7 ]> <html lang="en" class="no-js ie6"> <![endif]-->
<!--[if IE 7 ]>    <html lang="en" class="no-js ie7"> <![endif]-->
<!--[if IE 8 ]>    <html lang="en" class="no-js ie8"> <![endif]-->
<!--[if IE 9 ]>    <html lang="en" class="no-js ie9"> <![endif]-->
<!--[if (gt IE 9)|!(IE)]><!--> <html lang="en" class="no-js"> <!--<![endif]-->
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>The Kitchin Research Group: emacs</title>
  <meta name="google-site-verification" content="CGcacJdHc2YoZyI0Vey9XRA5qwhhFDzThKJezbRFcJ4" />
  <meta name="description" content="Chemical Engineering at Carnegie Mellon University">
  <meta name="author" content="John Kitchin">
  <link rel="alternate" type="application/rss+xml" title="RSS 2.0" href="/blog/feed" />
  <link rel="alternate" type="application/atom+xml" title="Atom 1.0" href="/blog/feed/atom" />
  <link rel="shortcut icon" href="/favicon.ico">
  <link rel="apple-touch-icon" href="/img/apple-touch-icon.png">

  <link rel="stylesheet" href="/css/base.css?v=1">
  <link rel="stylesheet" href="/css/grid.css?v=1">
  <link rel="stylesheet" media="handheld" href="/css/handheld.css?v=1">
  <link rel="stylesheet" href="/css/pygments_murphy.css" type="text/css" />

  <script src="/js/libs/modernizr-1.7.min.js"></script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        displayAlign: "center",
        displayIndent: "0em",

        "HTML-CSS": { scale: 100,
                        linebreaks: { automatic: "false" },
                        webFont: "TeX"
                       },
        SVG: {scale: 100,
              linebreaks: { automatic: "false" },
              font: "TeX"},
        NativeMML: {scale: 100},
        TeX: { equationNumbers: {autoNumber: "AMS"},
               MultLineWidth: "85%",
               TagSide: "right",
               TagIndent: ".8em"
             }
});
</script>
<script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_HTML"></script>
  <link rel="stylesheet" href="/themes/theme1/style.css?v=1">
<link href='http://fonts.googleapis.com/css?family=Roboto' rel='stylesheet' type='text/css'>

</head>
  <body>
    <div id="container" class="container container_12">
      <div id="main" role="main">
        <div id="main_block">
          <header>
<div id="header" class="header_gradient theme_font">
<table><tr><td>
    <h1><a href="/">The Kitchin Research Group</a></h1>
    <h2>Chemical Engineering at Carnegie Mellon University</h2>
</td>
<td colspan=100%><div style="float:right;width:100%;text-align:right;"> <span id='badgeCont737515' style='width:126px'><script src='http://labs.researcherid.com/mashlets?el=badgeCont737515&mashlet=badge&showTitle=false&className=a&rid=A-2363-2010'></script></span></div>
</td></tr>
</table>
</div>
  <div id="navigation" class="grid_12">

    <ul class="theme_font">
      <li><a href="/blog"
             class="">Blog</a></li>

      <li><a href="/blog/archive"
             class="">Archives</a></li>

      <li><a href="/publications.html">Publications</a></li>

      <li><a href="/research.html"
             class="">Research</a></li>

      <li><a href="/categories.html"
             class="">Categories</a></li>

      <li><a href="/about.html"
             class="">About us</a></li>

      <li><a href="/subscribe.html">Subscribe</a></li>

    </ul>
  </div>
</header>

          <div id="prose_block" class="grid_8">
            
  





<article>
  <div class="blog_post">
    <header>
      <div id="A-cursor-goto-hydra-for-emacs"></div>
      <h2 class="blog_post_title"><a href="/blog/2015/09/28/A-cursor-goto-hydra-for-emacs/" rel="bookmark" title="Permanent Link to A cursor goto hydra for emacs">A cursor goto hydra for emacs</a></h2>
      <p><small><span class="blog_post_date">Posted September 28, 2015 at 04:38 PM</span> | categories:
        <span class="blog_post_categories"><a href='/blog/category/hydra/'>hydra</a>, <a href='/blog/category/emacs/'>emacs</a></span> | tags: 
      </small></p>
    </header>
    <div class="post_prose">
      




<p>
In the spirit of upping my navigation game, here we examine navigation by search like methods. You probably know about C-s with will search forward for a word, and C-r which will search backwards. This will get you to the start of a word pretty easily. It won't get you into a word though, you have to navigate to that, and it isn't too handy to get to a line, or window, or headline in an org-file. Each of these is an emacs command, which as with navigation I don't always remember. Today, we build a hydra to make this easy too.
</p>

<p>
We will use features from <a href="https://github.com/abo-abo/avy">avy</a> , and <a href="https://github.com/emacs-helm/helm">helm</a> , and some standard emacs features. <code>avy</code> is pretty neat. It provides an interface to jump to characters, words and subwords by pressing keys. To jump to a character that is visible on the screen, you invoke avy-goto-char and press the character you want to jump to. <code>avy</code> will overlay a sequence of keys you then type to jump to that character. It might be more convenient to jump to a pair of characters, which you do by invoking avy-goto-char-2. Similarly, there are commands to jump to the beginning of a word, and a subword, both with variations that allow you to specify the beginning letter of the word, or to get overlays on every word.
</p>

<p>
I spend most of my days in org-files, so I frequently want to jump to an org headline in the current buffer, or some headline in an org-file in my agenda. Helm provides a nice set of functions for this in helm-org-headlines and helm-org-agenda-files-headings. We can also use helm-multi-swoop-org to use the swoop search function in all open org-buffers with helm selection. Within a buffer, you might also use the search forward and backward capabilities, or the more advanced helm-occur or swiper-helm features.
Finally, I may want my cursor to go to another recent file, or open buffer.
</p>

<p>
The hydra we will develop here puts all of these commands a few keystrokes away, with a hint system to remind you what is possible. In addition to these "goto" commands, I add a character to switch to the navigation hydra we developed in the last <a href="http://kitchingroup.cheme.cmu.edu/blog/2015/09/27/Upping-my-Emacs-navigation-game/">post</a> so I can switch to navigation if I change my mind. I also put two commands to store the current position before the goto command, and to return to that stored position conveniently. I bind this hydra to super-g, because the super key isn't used much on my Mac, and g reminds of "goto". So, here is my hydra code:
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #0000FF;">defhydra</span> goto (<span style="color: #006FE0;">:color</span> blue <span style="color: #006FE0;">:hint</span> nil)
  <span style="color: #008000;">"</span>
<span style="color: #008000;">Goto:</span>
<span style="color: #008000;">^Char^              ^Word^                ^org^                    ^search^</span>
<span style="color: #008000;">^^^^^^^^---------------------------------------------------------------------------</span>
<span style="color: #008000;">_c_: 2 chars        _w_: word by char     _h_: headline in buffer  _o_: helm-occur</span>
<span style="color: #008000;">_C_: char           _W_: some word        _a_: heading in agenda   _p_: helm-swiper</span>
<span style="color: #008000;">_L_: char in line   _s_: subword by char  _q_: swoop org buffers   _f_: search forward</span>
<span style="color: #008000;">^  ^                _S_: some subword     ^ ^                      _b_: search backward</span>
<span style="color: #008000;">-----------------------------------------------------------------------------------</span>
<span style="color: #008000;">_B_: helm-buffers       _l_: avy-goto-line</span>
<span style="color: #008000;">_m_: helm-mini          _i_: ace-window</span>
<span style="color: #008000;">_R_: helm-recentf</span>

<span style="color: #008000;">_n_: Navigate           _._: mark position _/_: jump to mark</span>
<span style="color: #008000;">"</span>
  (<span style="color: #008000;">"c"</span> avy-goto-char-2)
  (<span style="color: #008000;">"C"</span> avy-goto-char)
  (<span style="color: #008000;">"L"</span> avy-goto-char-in-line)
  (<span style="color: #008000;">"w"</span> avy-goto-word-1)
  <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">jump to beginning of some word</span>
  (<span style="color: #008000;">"W"</span> avy-goto-word-0)
  <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">jump to subword starting with a char</span>
  (<span style="color: #008000;">"s"</span> avy-goto-subword-1)
  <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">jump to some subword</span>
  (<span style="color: #008000;">"S"</span> avy-goto-subword-0)

  (<span style="color: #008000;">"l"</span> avy-goto-line)
  (<span style="color: #008000;">"i"</span> ace-window)

  (<span style="color: #008000;">"h"</span> helm-org-headlines)
  (<span style="color: #008000;">"a"</span> helm-org-agenda-files-headings)
  (<span style="color: #008000;">"q"</span> helm-multi-swoop-org)

  (<span style="color: #008000;">"o"</span> helm-occur)
  (<span style="color: #008000;">"p"</span> swiper-helm)

  (<span style="color: #008000;">"f"</span> isearch-forward)
  (<span style="color: #008000;">"b"</span> isearch-backward)

  (<span style="color: #008000;">"."</span> org-mark-ring-push <span style="color: #006FE0;">:color</span> red)
  (<span style="color: #008000;">"/"</span> org-mark-ring-goto <span style="color: #006FE0;">:color</span> blue)
  (<span style="color: #008000;">"B"</span> helm-buffers-list)
  (<span style="color: #008000;">"m"</span> helm-mini)
  (<span style="color: #008000;">"R"</span> helm-recentf)
  (<span style="color: #008000;">"n"</span> hydra-navigate/body))

(global-set-key (kbd <span style="color: #008000;">"s-g"</span>) 'goto/body)
</pre>
</div>

<p>
As with the last navigation hydra, this is a pretty massive set of options and takes up some decent screen space at the bottom om my emacs. They are mostly here to remind me that there are better navigation options, and with practice I suspect muscle memory will provide fast navigation tools with more precision and fewer keystrokes than simple navigation.
</p>
<p>Copyright (C) 2015 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2015/09/28/A-cursor-goto-hydra-for-emacs.org">org-mode source</a><p><p>Org-mode version = 8.2.10</p>

    </div>
  </div>
</article>



<a href="https://twitter.com/share" class="twitter-share-button" data-via="johnkitchin">Share on Twitter</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>


<a href="https://twitter.com/search?q=https://kitchingroup.cheme.cmu.edu/blog/2015/09/28/A-cursor-goto-hydra-for-emacs">Discuss on Twitter</a>

  <hr class="interblog" />
  





<article>
  <div class="blog_post">
    <header>
      <div id="Upping-my-Emacs-navigation-game"></div>
      <h2 class="blog_post_title"><a href="/blog/2015/09/27/Upping-my-Emacs-navigation-game/" rel="bookmark" title="Permanent Link to Upping my Emacs navigation game">Upping my Emacs navigation game</a></h2>
      <p><small><span class="blog_post_date">Posted September 27, 2015 at 09:21 PM</span> | categories:
        <span class="blog_post_categories"><a href='/blog/category/hydra/'>hydra</a>, <a href='/blog/category/emacs/'>emacs</a></span> | tags: 
      </small></p>
    </header>
    <div class="post_prose">
      




<p>
I have been trying to up my navigation game in Emacs, by which I mean I want to get my cursor where I want it with a minimal number of keystrokes, and preferrably no mouse actions. There are lots of little and big navigations I do a lot:
</p>
<ol class="org-ol">
<li>forward/backward by a character
</li>
<li>forward/backward by a word/subword
</li>
<li>forward/backward by a sentence
</li>
<li>forward/backward by a line
</li>
<li>to the beginning and end of a line
</li>
<li>to the beginning and end of a sentence
</li>
<li>to the beginning and end of a paragraph
</li>
<li>to the beginning and end of a page
</li>
<li>to the beginning and end of a buffer
</li>
<li>scrolling up/down
</li>
<li>into another window
</li>
<li>back and forth to buffers
</li>
</ol>

<p>
Occasionally, I want to save a location so I can easily get back to it. Not all of these are strictly speaking navigation in the usual sense, but they are things I do often enough. There are Emacs commands for all these, and keyboard shortcuts for many of them, but I don't use them often, and as a result I don't remember them either.
</p>

<p>
Here I develop a <a href="https://github.com/abo-abo/hydra">hydra</a> that will provide these features. Hydra is a super amazing, menu prompting system that provides hints to remind you of what can be done, and to access it from a character. It is possible to pass numeric and universal arguments to the commands by typing -, a number, or C-u before pressing the character.
</p>

<p>
I want some commands to be repeatable, which we get with a "red" hydra, and some commands to exit on running, which we get with a "blue" head. So, here is an over-the-top hydra for navigation.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #0000FF;">defhydra</span> hydra-navigate (<span style="color: #006FE0;">:color</span> red
                          <span style="color: #006FE0;">:hint</span> nil)
  <span style="color: #008000;">"</span>
<span style="color: #008000;">_f_: forward-char       _w_: forward-word       _n_: next-line</span>
<span style="color: #008000;">_b_: backward-char      _W_: backward-word      _p_: previous-line</span>
<span style="color: #008000;">^ ^                     _o_: subword-right      _,_: beginning-of-line</span>
<span style="color: #008000;">^ ^                     _O_: subword-left       _._: end-of-line</span>

<span style="color: #008000;">_s_: forward sentence   _a_: forward paragraph  _g_: forward page</span>
<span style="color: #008000;">_S_: backward sentence  _A_: backward paragraph _G_: backward page</span>

<span style="color: #008000;">_h_: helm mini _B_: buffer list _i_: window</span>
<span style="color: #008000;">_&lt;left&gt;_: previous buffer   _&lt;right&gt;_: next buffer</span>
<span style="color: #008000;">_&lt;up&gt;_: scroll-up           _&lt;down&gt;_: scroll-down</span>

<span style="color: #008000;">_[_: backward-sexp _]_: forward-sexp</span>
<span style="color: #008000;">_&lt;_ beginning of buffer _&gt;_ end of buffer _m_: set mark _/_: jump to mark</span>
<span style="color: #008000;">"</span>
  (<span style="color: #008000;">"f"</span> forward-char)
  (<span style="color: #008000;">"b"</span> backward-char)
  (<span style="color: #008000;">"w"</span> forward-word)
  (<span style="color: #008000;">"W"</span> backward-word)
  (<span style="color: #008000;">"n"</span> next-line)
  (<span style="color: #008000;">"p"</span> previous-line)
  (<span style="color: #008000;">"o"</span> subword-right)
  (<span style="color: #008000;">"O"</span> subword-left)
  (<span style="color: #008000;">"s"</span> forward-sentence)
  (<span style="color: #008000;">"S"</span> backward-sentence)
  (<span style="color: #008000;">"a"</span> forward-paragraph)
  (<span style="color: #008000;">"A"</span> backward-paragraph)
  (<span style="color: #008000;">"g"</span> forward-page)
  (<span style="color: #008000;">"G"</span> backward-page)
  (<span style="color: #008000;">"&lt;right&gt;"</span> next-buffer)
  (<span style="color: #008000;">"&lt;left&gt;"</span> previous-buffer)
  (<span style="color: #008000;">"h"</span> helm-mini <span style="color: #006FE0;">:color</span> blue)
  (<span style="color: #008000;">"i"</span> ace-window <span style="color: #006FE0;">:color</span> blue)
  (<span style="color: #008000;">"m"</span> org-mark-ring-push)
  (<span style="color: #008000;">"/"</span> org-mark-ring-goto <span style="color: #006FE0;">:color</span> blue)
  (<span style="color: #008000;">"B"</span> helm-buffers-list)
  (<span style="color: #008000;">"&lt;up&gt;"</span> scroll-up)
  (<span style="color: #008000;">"&lt;down&gt;"</span> scroll-down)
  (<span style="color: #008000;">"&lt;"</span> beginning-of-buffer)
  (<span style="color: #008000;">"&gt;"</span> end-of-buffer)
  (<span style="color: #008000;">"."</span> end-of-line)
  (<span style="color: #008000;">"["</span> backward-sexp)
  (<span style="color: #008000;">"]"</span> forward-sexp)
  (<span style="color: #008000;">","</span> beginning-of-line)
  (<span style="color: #008000;">"q"</span> nil <span style="color: #008000;">"quit"</span> <span style="color: #006FE0;">:color</span> blue))

(global-set-key (kbd <span style="color: #008000;">"s-n"</span>) 'hydra-navigate/body)
</pre>
</div>

<pre class="example">
hydra-navigate/body
</pre>

<p>
I basically like it. The menu is a little on the large side, but it makes for easy modal navigation in a buffer, to other windows, and other buffers. On the whole for moderate cursor movements, this results in basically equal keystrokes. For example, to move 3 characters forward, we have C-f C-f C-f or C-u 3 C-f, or s-n 3 f. The advantage (I think) is a single interface to all these navigation commands with hints on what to do.
</p>

<p>
There is still another level of navigation, which is related to navigation by searching. That is a whole different level of navigation I will work on another day!
</p>
<p>Copyright (C) 2015 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2015/09/27/Upping-my-Emacs-navigation-game.org">org-mode source</a><p><p>Org-mode version = 8.2.10</p>

    </div>
  </div>
</article>



<a href="https://twitter.com/share" class="twitter-share-button" data-via="johnkitchin">Share on Twitter</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>


<a href="https://twitter.com/search?q=https://kitchingroup.cheme.cmu.edu/blog/2015/09/27/Upping-my-Emacs-navigation-game">Discuss on Twitter</a>

  <hr class="interblog" />
  





<article>
  <div class="blog_post">
    <header>
      <div id="Checking-for-email-attachments-before-you-send-email"></div>
      <h2 class="blog_post_title"><a href="/blog/2015/09/04/Checking-for-email-attachments-before-you-send-email/" rel="bookmark" title="Permanent Link to Checking for email attachments before you send email">Checking for email attachments before you send email</a></h2>
      <p><small><span class="blog_post_date">Posted September 04, 2015 at 07:03 PM</span> | categories:
        <span class="blog_post_categories"><a href='/blog/category/email/'>email</a>, <a href='/blog/category/emacs/'>emacs</a></span> | tags: 
      <p><small><span class="blog_post_date">Updated September 04, 2015 at 07:04 PM</span></small>
      </small></p>
    </header>
    <div class="post_prose">
      



<p>
Does this comic (<a href="http://www.phdcomics.com/comics/archive.php?comicid=1817">http://www.phdcomics.com/comics/archive.php?comicid=1817</a> ) apply to you? Do you miss the Gmail feature that will alert you that it seems like you mention an attachment but there isn't one attached before it lets you send it? Let's make Emacs help us here. We will scan our emails for the word "attach", and if we see it, scan the email for evidence of an attachment. Then create a hook function that will prompt us if it appears we mention an attachment, but don't have one.
</p>

<p>
An attachment looks like this in my messages:
</p>
<pre class="example">
&lt;#part type="image/png" filename="~/Desktop/wordcloud.png" disposition=attachment&gt;
&lt;#/part&gt;
</pre>

<p>
So, probably finding "&lt;#part" in the buffer means I probably have an attachment. We will use the message-send-hook to run this function. Here is the code. Some brief testing from me seems to work fine! It is pretty simple, but probably good enough to save me from sending messages with no attachment, and not too intrusive for when no attachment is actually needed, e.g. in replies. Let me know if you have ideas for improvements.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #0000FF;">defun</span> <span style="color: #006699;">email-says-attach-p</span> ()
  <span style="color: #036A07;">"Return t if email suggests there could be an attachment."</span>
  (<span style="color: #0000FF;">save-excursion</span>
    (goto-char (point-min))
    (re-search-forward <span style="color: #008000;">"attach"</span> nil t)))

(<span style="color: #0000FF;">defun</span> <span style="color: #006699;">email-has-attachment-p</span> ()
  <span style="color: #036A07;">"Return t if the currently open email has an attachment"</span>
  (<span style="color: #0000FF;">save-excursion</span>
    (goto-char (point-min))
    (re-search-forward <span style="color: #008000;">"&lt;#part"</span> nil t)))

(<span style="color: #0000FF;">defun</span> <span style="color: #006699;">email-pre-send-check-attachment</span> ()
  (<span style="color: #0000FF;">when</span> (<span style="color: #0000FF;">and</span> (email-says-attach-p)
             (not (email-has-attachment-p)))
    (<span style="color: #0000FF;">unless</span>
        (y-or-n-p <span style="color: #008000;">"Your email suggests you need an attachment, but no attachment was found. Send anyway?"</span>)
      (<span style="color: #ff0000; font-weight: bold;">error</span> <span style="color: #008000;">"It seems an attachment is needed, but none was found. Aborting send."</span>))))

(add-hook 'message-send-hook 'email-pre-send-check-attachment)
</pre>
</div>
<p>Copyright (C) 2015 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2015/09/04/Checking-for-email-attachments-before-you-send-email.org">org-mode source</a><p><p>Org-mode version = 8.2.10</p>

    </div>
  </div>
</article>



<a href="https://twitter.com/share" class="twitter-share-button" data-via="johnkitchin">Share on Twitter</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>


<a href="https://twitter.com/search?q=https://kitchingroup.cheme.cmu.edu/blog/2015/09/04/Checking-for-email-attachments-before-you-send-email">Discuss on Twitter</a>

  <hr class="interblog" />
  





<article>
  <div class="blog_post">
    <header>
      <div id="A-highlight-annotation-mode-for-Emacs-using-font-lock"></div>
      <h2 class="blog_post_title"><a href="/blog/2015/07/28/A-highlight-annotation-mode-for-Emacs-using-font-lock/" rel="bookmark" title="Permanent Link to A highlight annotation mode for Emacs using font-lock">A highlight annotation mode for Emacs using font-lock</a></h2>
      <p><small><span class="blog_post_date">Posted July 28, 2015 at 10:57 AM</span> | categories:
        <span class="blog_post_categories"><a href='/blog/category/emacs/'>emacs</a>, <a href='/blog/category/annotation/'>annotation</a></span> | tags: 
      <p><small><span class="blog_post_date">Updated July 31, 2015 at 09:17 AM</span></small>
      </small></p>
    </header>
    <div class="post_prose">
      



<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#sec-1">1. Known limitations</a></li>
</ul>
</div>
</div>
<p>
One of my students asked about highlighting text in emacs for note-taking. I can see some advantages for doing it while teaching, for example, and for students studying, so here we we work it out.
</p>

<p>
You will definitely want to see the video on this one, the highlights do not show up in the published html. <a href="https://www.youtube.com/watch?v=Cvz2tiT12-I">https://www.youtube.com/watch?v=Cvz2tiT12-I</a> 
</p>

<p>
For temporary use, highlighting is pretty easy, you just set a property on a region, e.g. the background color. For example, we can do this:
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #8D8D84;">; </span><span style="color: #8D8D84; font-style: italic;">this seems to be necessary to get the tooltips to work.</span>
(<span style="color: #0000FF;">setq</span> font-lock-extra-managed-props (delq 'help-echo font-lock-extra-managed-props))

(<span style="color: #0000FF;">defun</span> <span style="color: #006699;">highlight-region</span> (beg end)
 (<span style="color: #0000FF;">interactive</span> <span style="color: #008000;">"r"</span>)
 (set-text-properties
  beg end
  '(font-lock-face (<span style="color: #006FE0;">:background</span> <span style="color: #008000;">"Light Salmon"</span>)
                   highlighted t
                   help-echo <span style="color: #008000;">"highlighted"</span>)))

(global-set-key (kbd <span style="color: #008000;">"s-h"</span>) 'highlight-region)
</pre>
</div>

<pre class="example">
highlight-region
</pre>

<p>
This sets the background color, and another property "highlighted" that we will use later. The trouble is this is transient. When I close the file, the highlights are lost. We can save them to a file though, and reload them later. As long as we are diligent about that we should be able to provide persistent highlights.
</p>

<p>
First we need a function to get all the highlights, their start and end, their color, and if there is a help-echo which provides a tooltip. We will see why later. Here we loop through the buffer collecting highlights, and return a list of them.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #0000FF;">defun</span> <span style="color: #006699;">highlight-get-highlights</span> ()
  <span style="color: #036A07;">"Scan buffer for list of highlighted regions.</span>
<span style="color: #036A07;">These are defined only by the highlighted property. That means</span>
<span style="color: #036A07;">adjacent highlighted regions will be merged into one region with</span>
<span style="color: #036A07;">the color of the first one."</span>
  (<span style="color: #0000FF;">save-excursion</span>
    (goto-char (point-min))
    (<span style="color: #0000FF;">let</span> ((highlights '())
          (p)
          (beg)
          (end)
          (note)
          (color))
      <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">corner case of first point being highlighted</span>
      (<span style="color: #0000FF;">when</span> (get-text-property (point) 'highlighted)
        (<span style="color: #0000FF;">setq</span> beg (point)
              end (next-single-property-change (point) 'highlighted)
              color (background-color-at-point)
              help-echo (get-text-property (point) 'help-echo))
        (add-to-list 'highlights (list beg end color help-echo) t)
        (goto-char end))

      <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Now the rest of the buffer</span>
      (<span style="color: #0000FF;">while</span> (<span style="color: #0000FF;">setq</span> p (next-single-property-change (point) 'highlighted))
        (<span style="color: #0000FF;">setq</span> beg (goto-char p))
        (<span style="color: #0000FF;">setq</span> color (background-color-at-point))
        (<span style="color: #0000FF;">setq</span> note (get-text-property (point) 'help-echo))
        (<span style="color: #0000FF;">setq</span> end (next-single-property-change (point) 'highlighted))
        (<span style="color: #0000FF;">when</span> (<span style="color: #0000FF;">and</span> beg end)
          (goto-char end)
          (add-to-list 'highlights (list beg
                                         end
                                         color
                                         note)
                       t)
          (goto-char end)))
      highlights)))

(highlight-get-highlights)
</pre>
</div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="right" />

<col  class="right" />

<col  class="left" />

<col  class="left" />
</colgroup>
<tbody>
<tr>
<td class="right">438</td>
<td class="right">454</td>
<td class="left">Light Salmon</td>
<td class="left">highlighted</td>
</tr>

<tr>
<td class="right">1014</td>
<td class="right">1031</td>
<td class="left">Light Salmon</td>
<td class="left">highlighted</td>
</tr>
</tbody>
</table>


<p>
Next, we generate a filename, and a function to save the highlights to disk. We make it a hook function that runs every time we save the buffer.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #0000FF;">defun</span> <span style="color: #006699;">highlight-save-filename</span> ()
  <span style="color: #036A07;">"Return name of file to save overlays in."</span>
  (<span style="color: #0000FF;">when</span> (buffer-file-name)
    (concat <span style="color: #008000;">"."</span> (file-name-nondirectory (buffer-file-name)) <span style="color: #008000;">".highlights"</span>)))

(<span style="color: #0000FF;">defun</span> <span style="color: #006699;">highlight-save</span> ()
  <span style="color: #036A07;">"Loop through buffer and save regions with property highlighted.</span>
<span style="color: #036A07;">Save beginning, end of each region, color and help-echo on the</span>
<span style="color: #036A07;">first character of the region. Delete highlight file if it is empty."</span>
  (<span style="color: #0000FF;">interactive</span>)
  (<span style="color: #0000FF;">let</span> ((fname (highlight-save-filename))
        (highlights (highlight-get-highlights)))
    (<span style="color: #0000FF;">if</span> (<span style="color: #0000FF;">and</span> fname highlights)
          (<span style="color: #0000FF;">with-temp-file</span> fname
            (print highlights (current-buffer)))
        <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">get rid of file if there are not highlights</span>
        (<span style="color: #0000FF;">when</span> (<span style="color: #0000FF;">and</span> fname (file-exists-p fname))
          (delete-file fname)))))

(add-hook 'after-save-hook 'highlight-save)
</pre>
</div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="left" />

<col  class="left" />
</colgroup>
<tbody>
<tr>
<td class="left">highlight-save</td>
<td class="left">helm-swoop&#x2013;clear-cache</td>
</tr>
</tbody>
</table>


<div class="org-src-container">

<pre class="src src-sh">cat .highlights.org.highlights
</pre>
</div>

<pre class="example">
((438 454 "Light Salmon" "highlighted") (1014 1031 "Light Salmon" "highlighted"))
</pre>

<p>
Here, we can read the contents and apply the highlights. We set this up on a hook for org-mode, so it will apply them on when we open org-files. You could make this more general if you plan to highlight in code files, for example.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #0000FF;">defun</span> <span style="color: #006699;">highlight-load</span> ()
  <span style="color: #036A07;">"Load and apply highlights."</span>
  (<span style="color: #0000FF;">interactive</span>)
  (<span style="color: #0000FF;">setq</span> font-lock-extra-managed-props (delq 'help-echo font-lock-extra-managed-props))
  (<span style="color: #0000FF;">let</span> ((fname (highlight-save-filename)))
    (<span style="color: #0000FF;">when</span> (<span style="color: #0000FF;">and</span> fname (file-exists-p fname))
      (mapcar
       (<span style="color: #0000FF;">lambda</span> (entry)
         (<span style="color: #0000FF;">let</span> ((beg (nth 0 entry))
               (end (nth 1 entry))
               (color (nth 2 entry))
               (help-echo (nth 3 entry)))
           (set-text-properties
            beg end
            `(font-lock-face (<span style="color: #006FE0;">:background</span> ,color)
                             help-echo ,help-echo
                             highlighted t))))
       (<span style="color: #0000FF;">with-temp-buffer</span> (insert-file-contents fname)
                         (read (current-buffer)))))))


(add-hook 'org-mode-hook 'highlight-load)
</pre>
</div>


<p>
Now, let's outdo ourselves in ridiculosity. We will add a helm-colors selector to give you unprecedented highlighting capability in multicolor magnificence. This function will highlight selected text, or update the color of an existing highlight.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #0000FF;">defun</span> <span style="color: #006699;">highlight</span> (beg end <span style="color: #6434A3;">&amp;optional</span> color)
  <span style="color: #036A07;">"Highlight region from BEG to END with COLOR.</span>
<span style="color: #036A07;">COLOR is selected from `</span><span style="color: #D0372D;">helm-colors</span><span style="color: #036A07;">' when run interactively."</span>
  (<span style="color: #0000FF;">interactive</span> <span style="color: #008000;">"r"</span>)
  (<span style="color: #0000FF;">unless</span> (<span style="color: #0000FF;">or</span> (get-text-property (point) 'highlighted)
              (region-active-p))
    (<span style="color: #ff0000; font-weight: bold;">error</span> <span style="color: #008000;">"No region selected or not on a highlight."</span>))
  (<span style="color: #0000FF;">unless</span> color
    (<span style="color: #0000FF;">setq</span> color (s-trim (helm-colors))))
  (<span style="color: #0000FF;">if</span> (get-text-property (point) 'highlighted)
      <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">update color</span>
      (<span style="color: #0000FF;">let</span> ((beg (previous-single-property-change (point) 'highlighted))
            (end (next-single-property-change (point) 'highlighted)))
        (set-text-properties
         beg end
         `(font-lock-face (<span style="color: #006FE0;">:background</span> ,color)
                          highlighted t)))
  (set-text-properties
   beg end
   `(font-lock-face (<span style="color: #006FE0;">:background</span> ,color)
                    highlighted t))))

<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">For convenience</span>
(global-set-key (kbd <span style="color: #008000;">"s-h"</span>) 'highlight)
</pre>
</div>
<pre class="example">
highlight
</pre>


<p>
Now, we can conveniently highlight text in whatever color we want. How about list your highlights? After we have highlighted a lot, it might be nice to see a list of these we can click on to find our highlights more quickly.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #0000FF;">defun</span> <span style="color: #006699;">highlight-list</span> ()
  <span style="color: #036A07;">"Make a list of highlighted text in another buffer. "</span>
  (<span style="color: #0000FF;">interactive</span>)
  (<span style="color: #0000FF;">let</span> ((cb (current-buffer))
        (fname (buffer-file-name))
        (hls (mapcar
              (<span style="color: #0000FF;">lambda</span> (entry)
                (list (nth 0 entry)
                      (buffer-substring (nth 0 entry) (nth 1 entry))))
              (highlight-get-highlights))))
    (<span style="color: #0000FF;">if</span> hls
        (<span style="color: #0000FF;">progn</span>
          (split-window-right)
          (switch-to-buffer-other-window <span style="color: #008000;">"*highlights*"</span>) (org-mode)
          (<span style="color: #0000FF;">setq</span> buffer-read-only nil)
          (erase-buffer)
          (insert <span style="color: #008000;">"Click on text to jump to the position.\n\n"</span>)

          (<span style="color: #0000FF;">dolist</span> (s hls)
            (<span style="color: #0000FF;">let</span> ((map (make-sparse-keymap)))
              (define-key map [mouse-1]
                `(<span style="color: #0000FF;">lambda</span> ()
                   (<span style="color: #0000FF;">interactive</span>)
                   (find-file ,fname)
                   (goto-char ,(nth 0 s))))
              (insert (propertize
                       (concat (nth 1 s) <span style="color: #008000;">"\n"</span>)
                       'local-map map))))
          (<span style="color: #0000FF;">setq</span> buffer-read-only t))
      (message <span style="color: #008000;">"No highlights found."</span>))))
</pre>
</div>

<pre class="example">
highlight-list
</pre>

<p>
You probably would like to just select some text with your mouse, and have it highlighted. That requires us to advise the mouse-set-region function.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #0000FF;">defun</span> <span style="color: #006699;">highlight-green</span> ()
  <span style="color: #036A07;">"Highlight region in green."</span>
  (<span style="color: #0000FF;">interactive</span>)
  (highlight (region-beginning) (region-end) <span style="color: #008000;">"Darkolivegreen1"</span>))

<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">create the advice for use later</span>
(<span style="color: #0000FF;">defadvice</span> <span style="color: #006699;">mouse-set-region</span> (after my-highlight () disable)
  <span style="color: #036A07;">"Highlight"</span>
  (highlight-green))

(<span style="color: #0000FF;">defun</span> <span style="color: #006699;">highlight-mouse-on</span> ()
  <span style="color: #036A07;">"Turn on mouse highlighting"</span>
  (<span style="color: #0000FF;">interactive</span>)
  (ad-enable-advice 'mouse-set-region 'after 'my-highlight)
  (ad-activate 'mouse-set-region))

(<span style="color: #0000FF;">defun</span> <span style="color: #006699;">highlight-mouse-off</span> ()
  (<span style="color: #0000FF;">interactive</span>)
  (ad-disable-advice 'mouse-set-region 'after 'my-highlight)
  (ad-deactivate 'mouse-set-region))
</pre>
</div>

<pre class="example">
highlight-mouse-off
</pre>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #0000FF;">defun</span> <span style="color: #006699;">highlight-picasso-blues</span> ()
 (<span style="color: #0000FF;">interactive</span>)
 (<span style="color: #0000FF;">save-excursion</span>
   (<span style="color: #0000FF;">let</span> ((colors '(<span style="color: #008000;">"PowderBlue"</span>
                   <span style="color: #008000;">"Lightskyblue1"</span>
                   <span style="color: #008000;">"Lightskyblue2"</span>
                   <span style="color: #008000;">"Lightskyblue3"</span>
                   <span style="color: #008000;">"Lightskyblue4"</span>))
         (beg (region-beginning))
         (end (region-end)))
     (goto-char beg)
     (<span style="color: #0000FF;">while</span> (&lt; (point) (- end 1))
       (highlight (point) (+ 1 (point))
                  (nth (mod (- (point) (region-beginning)) (length colors)) colors))
       (forward-char)))))

(<span style="color: #0000FF;">defun</span> <span style="color: #006699;">highlight-rainbow</span> ()
 (<span style="color: #0000FF;">interactive</span>)
 (<span style="color: #0000FF;">save-excursion</span>
   (<span style="color: #0000FF;">let</span> ((colors '(<span style="color: #008000;">"Red1"</span>
                   <span style="color: #008000;">"Orange1"</span>
                   <span style="color: #008000;">"Yellow1"</span>
                   <span style="color: #008000;">"Darkolivegreen1"</span>
                   <span style="color: #008000;">"Skyblue1"</span>
                   <span style="color: #008000;">"Blue1"</span>
                   <span style="color: #008000;">"DarkViolet"</span>))
         (beg (region-beginning))
         (end (region-end)))
     (goto-char beg)
     (<span style="color: #0000FF;">while</span> (&lt; (point) (- end 1))
       (highlight (point) (+ 1 (point))
                  (nth (mod (- (point) (region-beginning)) (length colors)) colors))
       (forward-char)))))
</pre>
</div>

<p>
=These look cool, but they don't get properly saved. The code that finds the highlights finds the region, but only saves the first color. That means that adjacent highlights of different color will also not be saved correctly.
</p>

<p>
How about a highlight with your own tooltip? In theory we can set the help-echo property to some text. In practice I have found this tricky because font-lock occasionally erases help-echo properties on re-fontifying. We remove help-echo from a list of properties that are affected by this, but another library may add it back, and there might be some unintended consequences of that. Here we design a function to highlight with a user-defined tooltip.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #0000FF;">defun</span> <span style="color: #006699;">highlight-note</span> (beg end color <span style="color: #6434A3;">&amp;optional</span> note)
  <span style="color: #036A07;">"Highlight selected text and add NOTE to it as a tooltip."</span>
  (<span style="color: #0000FF;">interactive</span>
   (list
    (region-beginning)
    (region-end)
    (s-trim (helm-colors))))
  (<span style="color: #0000FF;">unless</span> note (<span style="color: #0000FF;">setq</span> note (read-input <span style="color: #008000;">"Note: "</span>)))
  (<span style="color: #0000FF;">unless</span> (region-active-p)
    (<span style="color: #ff0000; font-weight: bold;">error</span> <span style="color: #008000;">"No region selected."</span>))
  (set-text-properties
   beg end
   `(help-echo ,note font-lock-face (<span style="color: #006FE0;">:background</span> ,color)
               highlighted t)))


(<span style="color: #0000FF;">defun</span> <span style="color: #006699;">highlight-note-edit</span> (new-note)
  <span style="color: #036A07;">"Set tooltip of highlight at point to NEW-NOTE."</span>
  (<span style="color: #0000FF;">interactive</span> (list (read-input <span style="color: #008000;">"Note: "</span> (get-text-property (point) 'help-echo))))
  (<span style="color: #0000FF;">let*</span> ((region (button-lock-find-extent (point) 'highlighted))
         (beg (car region))
         (end (cdr region)))
    (put-text-property beg end 'help-echo new-note)))
</pre>
</div>

<p>
=highlight-note-edit
==highlight-note-edit
==highlight-note-edit
==highlight-note-edit
=C
Want to get rid of the highlights? We may want to delete one or all. We make a function for each.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #0000FF;">defun</span> <span style="color: #006699;">highlight-clear</span> ()
  <span style="color: #036A07;">"Clear highlight at point."</span>
  (<span style="color: #0000FF;">interactive</span>)
  (<span style="color: #0000FF;">when</span> (get-text-property (point) 'highlighted)
    (set-text-properties
     (next-single-property-change (point) 'highlighted)
     (previous-single-property-change (point) 'highlighted)
     nil)))


(<span style="color: #0000FF;">defun</span> <span style="color: #006699;">highlight-clear-all</span> ()
  <span style="color: #036A07;">"Clear all highlights.</span>
<span style="color: #036A07;">They are really deleted when you save the buffer."</span>
  (<span style="color: #0000FF;">interactive</span>)
  (mapcar
   (<span style="color: #0000FF;">lambda</span> (entry)
     (<span style="color: #0000FF;">let</span> ((beg (nth 0 entry))
           (end (nth 1 entry)))
       (set-text-properties
        beg end nil)))
   (highlight-get-highlights))
  (<span style="color: #0000FF;">when</span> (get-buffer <span style="color: #008000;">"*highlights*"</span>)
    (kill-buffer <span style="color: #008000;">"*highlights*"</span>)))
</pre>
</div>
<pre class="example">
highlight-clear-all
</pre>

<p>
Let's define a few convenience functions for common colors, a hydra to quickly select them and bind it to a key for convenience.  While we are at it, we add a menu to Org too.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #0000FF;">defun</span> <span style="color: #006699;">highlight-yellow</span> ()
  <span style="color: #036A07;">"Highlight region in yellow."</span>
  (<span style="color: #0000FF;">interactive</span>)
  (highlight (region-beginning) (region-end) <span style="color: #008000;">"Yellow"</span>))

(<span style="color: #0000FF;">defun</span> <span style="color: #006699;">highlight-blue</span> ()
  <span style="color: #036A07;">"Highlight region in blue."</span>
  (<span style="color: #0000FF;">interactive</span>)
  (highlight (region-beginning) (region-end) <span style="color: #008000;">"LightBlue"</span>))

(<span style="color: #0000FF;">defun</span> <span style="color: #006699;">highlight-pink</span> ()
  <span style="color: #036A07;">"Highlight region in pink."</span>
  (<span style="color: #0000FF;">interactive</span>)
  (highlight (region-beginning) (region-end) <span style="color: #008000;">"Pink"</span>))

(<span style="color: #0000FF;">defun</span> <span style="color: #006699;">highlight-green</span> ()
  <span style="color: #036A07;">"Highlight region in green."</span>
  (<span style="color: #0000FF;">interactive</span>)
  (highlight (region-beginning) (region-end) <span style="color: #008000;">"Darkolivegreen1"</span>))


(<span style="color: #0000FF;">defhydra</span> highlighter (<span style="color: #006FE0;">:color</span> blue) <span style="color: #008000;">"highlighter"</span>
  (<span style="color: #008000;">"b"</span> highlight-blue <span style="color: #008000;">"blue"</span>)
  (<span style="color: #008000;">"g"</span> highlight-green <span style="color: #008000;">"Green"</span>)
  (<span style="color: #008000;">"p"</span> highlight-pink <span style="color: #008000;">"Pink"</span>)
  <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">define as many special colors as you like.</span>
  (<span style="color: #008000;">"s"</span> (highlight (region-beginning) (region-end) <span style="color: #008000;">"Lightsalmon1"</span>) <span style="color: #008000;">"Salmon"</span>)
  (<span style="color: #008000;">"y"</span> highlight-yellow <span style="color: #008000;">"yellow"</span>)
  (<span style="color: #008000;">"c"</span> highlight <span style="color: #008000;">"Choose color"</span>)
  (<span style="color: #008000;">"n"</span> (highlight-note (region-beginning) (region-end) <span style="color: #008000;">"Thistle"</span>) <span style="color: #008000;">"Note"</span>)
  (<span style="color: #008000;">"N"</span> highlight-note <span style="color: #008000;">"Note (c)"</span>)
  (<span style="color: #008000;">"m"</span> highlight-mouse-on <span style="color: #008000;">"Mouse"</span>)
  (<span style="color: #008000;">"M"</span> highlight-mouse-off <span style="color: #008000;">"Mouse off"</span>)
  (<span style="color: #008000;">"e"</span> highlight-note-edit <span style="color: #008000;">"Edit note"</span>)
  (<span style="color: #008000;">"l"</span> highlight-list <span style="color: #008000;">"List highlights"</span>)
  (<span style="color: #008000;">"r"</span> highlight-load <span style="color: #008000;">"Reload"</span>)
  (<span style="color: #008000;">"S"</span> highlight-save <span style="color: #008000;">"Save"</span>)
  (<span style="color: #008000;">"d"</span> highlight-clear <span style="color: #008000;">"Delete"</span>)
  (<span style="color: #008000;">"D"</span> highlight-clear-all <span style="color: #008000;">"Delete All"</span>))

(easy-menu-change
 '(<span style="color: #008000;">"Org"</span>) <span style="color: #008000;">"highlighter"</span>
 '([<span style="color: #008000;">"Highlight"</span> highlight]
   [<span style="color: #008000;">"Highlight (B)"</span> highlight-blue]
   [<span style="color: #008000;">"Highlight (G)"</span> highlight-green]
   [<span style="color: #008000;">"Highlight (P)"</span> highlight-pink]
   [<span style="color: #008000;">"Highlight (Y)"</span> highlight-yellow]
   [<span style="color: #008000;">"Highlight note"</span> highlight-note]
   [<span style="color: #008000;">"List highlights"</span> highlight-list]
   [<span style="color: #008000;">"Delete highlight"</span> highlight-clear]
   [<span style="color: #008000;">"Delete highlights"</span> highlight-clear-all])
 <span style="color: #008000;">"Show/Hide"</span>)


(global-set-key (kbd <span style="color: #008000;">"s-h"</span>) 'highlighter/body)
</pre>
</div>

<pre class="example">
highlighter/body
</pre>


<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1"><span class="section-number-2">1</span> Known limitations</h2>
<div class="outline-text-2" id="text-1">
<p>
The tooltips seem especially fragile, and if there is code that undoes the removal of help-echo from font-lock-extra-managed-props, it seems possible they would easily get lost. I wouldn't use them a lot without a lot of testing. You <i>have</i> to rely on the hook functions defined to keep the highlights synchronized between the buffer and the external highlight file. If you were to rename a file externally, e.g. in the OS, or with a shell command, then the highlights will be lost unless you also rename the external file.
</p>

<p>
Highlights are not robust enough to survive refiling an org-mode section from one file to another.  Personally I don't see these as too big a problem; I don't put a lot of value of highlights, but I can see it being pretty annoying to lose them!
</p>

<p>
Still, if you want to give this a try, you can use the code here: <a href="/media/2015-07-28-A-highlight-annotation-mode-for-Emacs-using-font-lock/highlights.el">highlights.el</a> . You should bind the functions to whatever keys you want. Also, it is setup to only work for org-mode. I am not sure what the best hook to use for any file might be. Maybe find-file-hook.
</p>
</div>
</div>
<p>Copyright (C) 2015 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2015/07/28/A-highlight-annotation-mode-for-Emacs-using-font-lock.org">org-mode source</a><p><p>Org-mode version = 8.2.10</p>

    </div>
  </div>
</article>



<a href="https://twitter.com/share" class="twitter-share-button" data-via="johnkitchin">Share on Twitter</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>


<a href="https://twitter.com/search?q=https://kitchingroup.cheme.cmu.edu/blog/2015/07/28/A-highlight-annotation-mode-for-Emacs-using-font-lock">Discuss on Twitter</a>

  <hr class="interblog" />
  





<article>
  <div class="blog_post">
    <header>
      <div id="Running-scientific-instruments-in-Emacs-and-recording-the-results"></div>
      <h2 class="blog_post_title"><a href="/blog/2015/07/25/Running-scientific-instruments-in-Emacs-and-recording-the-results/" rel="bookmark" title="Permanent Link to Running scientific instruments in Emacs and recording the results">Running scientific instruments in Emacs and recording the results</a></h2>
      <p><small><span class="blog_post_date">Posted July 25, 2015 at 10:04 AM</span> | categories:
        <span class="blog_post_categories"><a href='/blog/category/emacs/'>emacs</a>, <a href='/blog/category/notebook/'>notebook</a>, <a href='/blog/category/orgmode/'>orgmode</a></span> | tags: 
      </small></p>
    </header>
    <div class="post_prose">
      




<p>
Today we look at running a scientific instrument via http requests from Emacs and org-mode. We will use a Gamry Ref600 potentiostat because Gamry has very nicely provide a COM interface we can access via Python. This will be only a proof of concept to see what it is like. We will not consider any issues of security, etc&#x2026;, only what is it like to do it.
</p>

<p>
The setup will look like this: we will run a flask web app that uses python to control the instrument via http requests. Why? Because I want to run the instrument from my Mac ;) and so far there are only Windows drivers for the instrument. So, we run the flask app on the Windows machine, and I run it from here on my Mac by sending requests. Flask takes care of converting requests to action using Python. You can see the <a href="#sec-2">Flask app here</a>.
</p>

<p>
Let's see what is online:
</p>
<div class="org-src-container">

<pre class="src src-sh">curl jkitchin-win.cheme.cmu.edu:5000/pstats
</pre>
</div>

<pre class="example">
(u'REF600-13089',)
</pre>

<p>
We have one potentiostat online with serial number 13089. I have a dummy cell connected to it which has a little resistor on it. So we can run a cyclic voltammogram and it should be a straight line. We have to know a bit about what is returned. We will get a json file back, and it will have the data in it. The data will be a list of lists. The data we want is in columns 1 and 3 (python indexing). Obviously you need some prior knowledge of what data comes back to use this. That would come from reading some documentation.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #0000FF;">import</span> requests
<span style="color: #0000FF;">import</span> numpy <span style="color: #0000FF;">as</span> np
<span style="color: #0000FF;">import</span> matplotlib.pyplot <span style="color: #0000FF;">as</span> plt

<span style="color: #BA36A5;">resp</span> = requests.get(<span style="color: #008000;">'http://jkitchin-win.cheme.cmu.edu:5000/cv?endv=0.25&amp;startv=-0.25'</span>)

<span style="color: #BA36A5;">dj</span> = resp.json()
<span style="color: #BA36A5;">data</span> = np.array(dj[<span style="color: #008000;">'data'</span>])

plt.plot(data[:, 1], data[:, 3])
plt.xlabel(<span style="color: #008000;">'Voltage (V)'</span>)
plt.ylabel(<span style="color: #008000;">'Current (A)'</span>)
plt.tight_layout()
plt.savefig(<span style="color: #008000;">'cv-1.png'</span>)
</pre>
</div>

<p>
<img src="/media/2015-07-25-Running-scientific-instruments-in-Emacs-and-recording-the-results/cv-1.png"> 
Well, there you have it. Possibly the first Gamry Ref600 to ever have been driven from a Mac ;) Let me be more explicit about that; I could <i>also</i> run this from Linux, an iPad, etc&#x2026; You could do this in a browser, or in an IPython notebook, or in Matlab, among many other possibilities. You could write a script in perl, shell, ruby, emacs-lisp, or any other language that supports http requests.
</p>

<p>
I am not sure why the graph is not perfectly linear, maybe there is some capacitive charging that starts out. The resistance based on the current at 0.2V is about 2000 ohms, which is in good agreement with what is listed on the board the dummy cell is on.
</p>

<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1"><span class="section-number-2">1</span> Summary thoughts</h2>
<div class="outline-text-2" id="text-1">
<p>
There are a host of interesting issues one eventually has to consider here including security, but also error management and debugging. I hacked something like an http api here by running flask on the windows machine running the instrument. That is a layer of abstraction on an abstraction to start with. I think later instruments are likely to run these webservers themselves on small dedicated computers, e.g. via a Raspberry pi or Arduino chipset. It is not obvious how sophisticated you can make this with respect to triggering different instruments, etc&#x2026;
</p>

<p>
In running this, my "notebook" was blocked while the experiment ran. It is possible to run things asynchronously, and sometimes that would make sense. In the example here, we have provided a very limited set of functions to "run" the potentiostat. It was only a proof of concept to get a sense for what it is like. In practice a fuller set of functions would be implemented. Another point to consider is how the data comes back from the potentiostat. We used json here because it is convenient, but we could just as well send files, and other sorts of data too.
</p>

<p>
This lays out the possibility to walk up to an instrument with an electronic notebook, setup and run the experiment, capture the results in the notebook and take it back to the office for analysis. Pretty cool.
</p>
</div>
</div>

<div id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2"><a id="ID-5EB72A19-B9D3-4ABA-975F-61ACE16E0D87" name="ID-5EB72A19-B9D3-4ABA-975F-61ACE16E0D87"></a><span class="section-number-2">2</span> Flask app</h2>
<div class="outline-text-2" id="text-2">

<p>
So, here is my flask app. We setup a few routes using get requests to do things like get a list of the potentiostats online, and to run a cyclic voltamogram. As a side note, after this post is over, I am turning off the app, so you won't be able to repeat the codes ;) This is not a beautiful, secure or error tolerant code. It works enough for a proof of concept of simple experiments.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #0000FF;">from</span> flask <span style="color: #0000FF;">import</span> Flask, request, jsonify
<span style="color: #0000FF;">import</span> time

<span style="color: #BA36A5;">app</span> = Flask(<span style="color: #006FE0;">__name__</span>)

<span style="color: #6434A3;">@app.route</span>(<span style="color: #008000;">'/'</span>)
<span style="color: #0000FF;">def</span> <span style="color: #006699;">hello_world</span>():
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #0000FF;">return</span> <span style="color: #008000;">'Hello World!'</span>

<span style="color: #6434A3;">@app.route</span>(<span style="color: #008000;">'/pstats'</span>)
<span style="color: #0000FF;">def</span> <span style="color: #006699;">get_pstats</span>():
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #0000FF;">import</span> win32com.client <span style="color: #0000FF;">as</span> client
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #BA36A5;">devices</span> = client.Dispatch(<span style="color: #008000;">'GamryCOM.GamryDeviceList'</span>)
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #BA36A5;">result</span> = <span style="color: #006FE0;">str</span>(devices.EnumSections())
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #0000FF;">return</span> result

<span style="color: #6434A3;">@app.route</span>(<span style="color: #008000;">'/close_pstat'</span>)
<span style="color: #0000FF;">def</span> <span style="color: #006699;">close</span>():
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #0000FF;">import</span> win32com.client <span style="color: #0000FF;">as</span> client
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #BA36A5;">devicelist</span> = client.Dispatch(<span style="color: #008000;">'GamryCOM.GamryDeviceList'</span>)

<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #BA36A5;">x</span> = devicelist.EnumSections()[0]
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #BA36A5;">pstat</span> = client.Dispatch(<span style="color: #008000;">'GamryCOM.GamryPstat'</span>)
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   pstat.Init(x)

<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   pstat.Close()


<span style="color: #0000FF;">def</span> <span style="color: #006699;">run_ramp</span>(Sinit,  <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">start value</span>
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #9B9B9B; background-color: #EDEDED;"> </span>    Sfinal, <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">end value</span>
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #9B9B9B; background-color: #EDEDED;"> </span>    ScanRate=1,
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #9B9B9B; background-color: #EDEDED;"> </span>    SampleRate=0.01,
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #9B9B9B; background-color: #EDEDED;"> </span>    CtrlMode=1,  <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">GamryCOM.PstatMode</span>
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #9B9B9B; background-color: #EDEDED;"> </span>    fname=<span style="color: #D0372D;">None</span>):
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #036A07;">'''We assume the first device is the one you want.</span>
<span style="color: #036A07;">    '''</span>
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #0000FF;">import</span> win32com.client <span style="color: #0000FF;">as</span> client
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #0000FF;">import</span> numpy <span style="color: #0000FF;">as</span> np
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #BA36A5;">devicelist</span> = client.Dispatch(<span style="color: #008000;">'GamryCOM.GamryDeviceList'</span>)

<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #BA36A5;">x</span> = devicelist.EnumSections()[0]

<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #BA36A5;">pstat</span> = client.Dispatch(<span style="color: #008000;">'GamryCOM.GamryPstat'</span>)
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   pstat.Init(x)

<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   pstat.Open()

<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #BA36A5;">dtaqcpiv</span>=client.Dispatch(<span style="color: #008000;">'GamryCOM.GamryDtaqCpiv'</span>)
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   dtaqcpiv.Init(pstat)

<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #BA36A5;">sigramp</span>=client.Dispatch(<span style="color: #008000;">'GamryCOM.GamrySignalRamp'</span>)
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   sigramp.Init(pstat, Sinit, Sfinal, ScanRate, SampleRate, CtrlMode)

<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   pstat.SetSignal(sigramp)
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   pstat.SetCell(1) <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">1 == GamryCOM.CellOn</span>

<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #0000FF;">try</span>:
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   dtaqcpiv.Run(<span style="color: #D0372D;">True</span>)
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #0000FF;">except</span> <span style="color: #6434A3;">Exception</span> <span style="color: #0000FF;">as</span> e:
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   pstat.Close()
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #0000FF;">raise</span>

<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">NOTE:  The comtypes example in this same directory illustrates the use of com</span>
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">notification events.  The comtypes package is recommended as an alternative</span>
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">to win32com.</span>
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   time.sleep(2) <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">just wait sufficiently long for the acquisition to complete.</span>

<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #BA36A5;">acquired_points</span> = []
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #BA36A5;">count</span> = 1
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #0000FF;">while</span> count &gt; 0:
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #BA36A5;">count</span>, <span style="color: #BA36A5;">points</span> = dtaqcpiv.Cook(10)
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">The columns exposed by GamryDtaq.Cook vary by dtaq and are</span>
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">documented in the Toolkit Reference Manual.</span>
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   acquired_points.extend(<span style="color: #006FE0;">zip</span>(*points))

<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #BA36A5;">acquired_points</span> = np.array(acquired_points)
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #0000FF;">if</span> fname <span style="color: #0000FF;">is</span> <span style="color: #0000FF;">not</span> <span style="color: #D0372D;">None</span>:
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   np.savetxt(fname, acquired_points)

<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   pstat.Close()
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #0000FF;">return</span> jsonify({<span style="color: #008000;">'data'</span>: acquired_points.tolist()})

<span style="color: #6434A3;">@app.route</span>(<span style="color: #008000;">'/cv'</span>)
<span style="color: #0000FF;">def</span> <span style="color: #006699;">run_cv</span>():
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #BA36A5;">result</span> = <span style="color: #006FE0;">str</span>(request.values)
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #BA36A5;">startv</span> = <span style="color: #006FE0;">float</span>(request.values.get(<span style="color: #008000;">'startv'</span>, -0.1))
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #BA36A5;">endv</span> = <span style="color: #006FE0;">float</span>(request.values.get(<span style="color: #008000;">'endv'</span>, 0.1))
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #BA36A5;">scanrate</span> = <span style="color: #006FE0;">float</span>(request.values.get(<span style="color: #008000;">'scanrate'</span>, 1.0))
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #BA36A5;">samplerate</span> = <span style="color: #006FE0;">float</span>(request.values.get(<span style="color: #008000;">'samplerate'</span>, 0.01))

<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #BA36A5;">data</span> = run_ramp(startv, endv, scanrate, samplerate)
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #0000FF;">return</span> data


<span style="color: #0000FF;">if</span> <span style="color: #006FE0;">__name__</span> == <span style="color: #008000;">'__main__'</span>:
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   app.run(host=<span style="color: #008000;">'jkitchin-win.cheme.cmu.edu'</span>, port=5000, debug=<span style="color: #D0372D;">True</span>)
</pre>
</div>
</div>
</div>
<p>Copyright (C) 2015 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2015/07/25/Running-scientific-instruments-in-Emacs-and-recording-the-results.org">org-mode source</a><p><p>Org-mode version = 8.2.10</p>

    </div>
  </div>
</article>



<a href="https://twitter.com/share" class="twitter-share-button" data-via="johnkitchin">Share on Twitter</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>


<a href="https://twitter.com/search?q=https://kitchingroup.cheme.cmu.edu/blog/2015/07/25/Running-scientific-instruments-in-Emacs-and-recording-the-results">Discuss on Twitter</a>

  <hr class="interblog" />
 <a href="/blog/category/emacs/13"> Previous Page</a>
  --  
 <a href="/blog/category/emacs/15">Next Page </a>

          </div>
          <div id="sidebar" class="grid_4">
            <aside>
<section>
<script>
  (function() {
    var cx = '002533177287215655227:l7uvu35ssbc';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
        '//www.google.com/cse/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>
</section>

<section>
    <h1 class="post_header_gradient theme_font">Twitter</h1>
    <a class="twitter-timeline" href="https://twitter.com/johnkitchin" data-widget-id="545217643582881792">Tweets by @johnkitchin</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+"://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
</section>


  <section>
    <h1 class="post_header_gradient theme_font">Links</h1>
    <ul>
      <li><a href="https://www.continuum.io">Anaconda Python</a></li>
      <li><a href="/pycse">Pycse</a></li>
      <li><a href="/dft-book">DFT-book</a></li>
    </ul>
  </section>

  <section>
    <h1 class="post_header_gradient theme_font">Latest Posts</h1>
    <ul>
      <li><a href="/blog/2023/02/01/Caching-expensive-function-calls-so-you-don-t-have-to-rerun-them/">Caching expensive function calls so you don't have to rerun them</a></li>
      <li><a href="/blog/2023/01/01/2022-in-a-nutshell/">2022 in a nutshell</a></li>
      <li><a href="/blog/2022/09/29/New-publication-Identifying-limitations-in-screening-high-throughput-photocatalytic-bimetallic-nanoparticles-with-machine-learned-hydrogen-adsorptions/">New publication - Identifying limitations in screening high-throughput photocatalytic bimetallic nanoparticles with machine-learned hydrogen adsorptions</a></li>
      <li><a href="/blog/2022/09/12/New-publication-Neural-network-embeddings-based-similarity-search-method-for-atomistic-systems/">New publication - Neural network embeddings based similarity search method for atomistic systems</a></li>
      <li><a href="/blog/2022/03/07/New-publication-Evaluation-of-the-Degree-of-Rate-Control-via-Automatic-Differentiation/">New publication - Evaluation of the Degree of Rate Control via Automatic Differentiation</a></li>
    </ul>
  </section>

<section>
<h1 class="post_header_gradient theme_font">Latest GitHub Repos</h1>
  <a href="https://github.com/jkitchin">@jkitchin</a> on GitHub.
  <ul id="my-github-projects">
        <li class="loading">Status updating&#8230;</li>
  </ul>

</section>
</aside>

          </div>
          <div class="clear"></div>
        </div>
      </div>
      
<footer>
  <div id="footer" class="grid_12">
    <div class="grid_8">
      <p>
        <a href="/blog/feed/index.xml">RSS</a>
      </p>
    </div>
    <div class="grid_4" id="credits">
      <p>
        Copyright 2023
        John Kitchin
      </p>
      <p>
        Powered by <a href="http://www.blogofile.com">Blogofile</a>
      </p>
    </div>
  </div>
</footer>

    </div>
      <script src="//ajax.googleapis.com/ajax/libs/jquery/1.5.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="/js/libs/jquery-1.5.1.min.js"%3E%3C/script%3E'))</script>
  <script src="/js/plugins.js"></script>
  <script src="/js/script.js"></script>
  <script src="/js/jquery.tweet.js"></script>  
  <script src="/js/site.js"></script>
  <!--[if lt IE 7 ]>
  <script src="js/libs/dd_belatedpng.js"></script>
  <script> DD_belatedPNG.fix('img, .png_bg');</script>
  <![endif]-->
  <script>
      var _gaq=[['_setAccount','UA-35731398-1'],['_trackPageview']];
      (function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];g.async=1;
      g.src=('https:'==location.protocol?'//ssl':'//www')+'.google-analytics.com/ga.js';
      s.parentNode.insertBefore(g,s)}(document,'script'));
  </script>

  </body>
</html>






<script src="http://ajax.microsoft.com/ajax/jquery/jquery-1.4.2.min.js" type="text/javascript"></script>
<script src="/js/git.js" type="text/javascript"></script>
<script type="text/javascript">
    $(function() {
     $("#my-github-projects").loadRepositories("jkitchin");
    });
</script>



