<?xml version="1.0" encoding="UTF-8"?>
<feed
  xmlns="http://www.w3.org/2005/Atom"
  xmlns:thr="http://purl.org/syndication/thread/1.0"
  xml:lang="en"
   >
  <title type="text">The Kitchin Research Group</title>
  <subtitle type="text">Chemical Engineering at Carnegie Mellon University</subtitle>

  <updated>2016-03-28T15:28:42Z</updated>
  <generator uri="http://blogofile.com/">Blogofile</generator>

  <link rel="alternate" type="text/html" href="http://jkitchin.github.io/blog" />
  <id>http://jkitchin.github.io/blog/feed/atom/</id>
  <link rel="self" type="application/atom+xml" href="http://jkitchin.github.io/blog/feed/atom/" />
  <entry>
    <author>
      <name></name>
      <uri>http://jkitchin.github.io/blog</uri>
    </author>
    <title type="html"><![CDATA[org-mode + Python + git in a graduate engineering course]]></title>
    <link rel="alternate" type="text/html" href="http://jkitchin.github.io/blog/2014/12/18/org-mode-+-Python-+-git-in-a-graduate-engineering-course" />
    <id>http://jkitchin.github.io/blog/2014/12/18/org-mode-+-Python-+-git-in-a-graduate-engineering-course</id>
    <updated>2014-12-19T11:19:51Z</updated>
    <published>2014-12-18T21:10:30Z</published>
    <category scheme="http://jkitchin.github.io/blog" term="orgmode" />
    <category scheme="http://jkitchin.github.io/blog" term="education" />
    <summary type="html"><![CDATA[org-mode + Python + git in a graduate engineering course]]></summary>
    <content type="html" xml:base="http://jkitchin.github.io/blog/2014/12/18/org-mode-+-Python-+-git-in-a-graduate-engineering-course"><![CDATA[



<p>
The Fall 2014 semester is over! I thought I would summarize here what we did. I taught a Master's course in Chemical Reaction Engineering for the second time. This time we had 58 students from around the world. What is remarkable about this course is that this time it was taught completely from Emacs. Every lecture was given from Emacs, every assignment completed in Emacs, turned in from Emacs, graded in Emacs, returned in Emacs. 
</p>

<p>
Students came to class, opened Emacs, and ran a command that downloaded the latest syllabus and opened it. They opened the day's lecture notes from a link in the syllabus. I lectured from the notes in Emacs, editing them on the screen live, running Python code to illustrate engineering concepts. Students did exercises in class in Emacs, and ran an Emacs command to "turn it in" which pushed their work to a git server. Later, I ran an Emacs command to collect and grade the work, then return it. Students could run a menu command in Emacs to see their grade report.
</p>

<p>
Techela provided a menu of commands to turn in assignments, check grade reports, send me feedback, open the syllabus, etc&#x2026; The notes were written in org-mode, and we used org-latex-fragments to see the equations. We used code-blocks to show Python examples of problem solving, every day in class.  It was awesome!
</p>

<p>
The way this worked is that most of my students got laptops as part of the MS program they enrolled in. I had my <a href="http://github.com/jkitchin/jmax">jmax</a> repo installed on those computers, along with git, TexLive and Canopy Python. jmax provided a starter-kit for emacs that gave it the functionality I use on a regular basis. In jmax, I created a package of code I call techela, which interfaces Emacs with git, and which provides commands to download and turn in assignments, and to control permissions on each repo. This enabled me to change repos to read-only after they were due, and to grant read access when I wanted students to see them. About 15% of the class had their own computer, and we had to help them get this software installed. This got done in the first week of class, thanks to the help of my teaching assistants.
</p>

<p>
I ran a <a href="http://gitolite.com/gitolite/index.html">gitolite</a> server that served the course materials, and a repo for each assignment for each student. When students first ran techela, it created a set of ssh keys which were used to authenticate each student in the gitolite server. Techela automates creation of the repos, and the permissions on each repo. Grading of assignments was done in Emacs. Every assignment turned in was an org-file, and we stored grades in the assignments as file tags.  Techela constructed a dynamic gradebook on demand, among other things.
</p>

<p>
Org-mode played a central role in the success of this course! It enabled the distribution of the notes in a readable, functional form. The programmable aspects of org-mode made it possible to create custom links for machine-gradable multiple choice questions, assignments, and solutions. It made it possible to use the assignments as a data storage source for grades, and later to pull the grades out for analysis.
</p>

<p>
Overall, the experience was just awesome. Techela has a few edges that need smoothed out, but I look forward to using it again this spring, this time on a course on Molecular Simulation!
</p>
<p>Copyright (C) 2014 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2014/12/18/org-mode-+-Python-+-git-in-a-graduate-engineering-course.org">org-mode source</a><p><p>Org-mode version = 8.2.10</p>]]></content>
  </entry>
  <entry>
    <author>
      <name></name>
      <uri>http://jkitchin.github.io/blog</uri>
    </author>
    <title type="html"><![CDATA[A database of quiz questions to generate quizzes and solutions]]></title>
    <link rel="alternate" type="text/html" href="http://jkitchin.github.io/blog/2014/11/28/A-database-of-quiz-questions-to-generate-quizzes-and-solutions" />
    <id>http://jkitchin.github.io/blog/2014/11/28/A-database-of-quiz-questions-to-generate-quizzes-and-solutions</id>
    <updated>2014-11-28T14:41:45Z</updated>
    <published>2014-11-28T14:41:45Z</published>
    <category scheme="http://jkitchin.github.io/blog" term="education" />
    <summary type="html"><![CDATA[A database of quiz questions to generate quizzes and solutions]]></summary>
    <content type="html" xml:base="http://jkitchin.github.io/blog/2014/11/28/A-database-of-quiz-questions-to-generate-quizzes-and-solutions"><![CDATA[


<p>
In this <a href="http://kitchingroup.cheme.cmu.edu/blog/2014/11/23/Machine-gradable-quizzes-in-emacs+org-modex/">post</a> I talked about a machine gradable quiz. One issue I have been trying to resolve is how to keep questions and solutions together. Currently, I have them separated, and that occasionally leads to them not being synchronized. One tricky part is if they are together, how do you create the quiz without answers in them? The answer is you have to "export" the quiz and selected problems, with selective content, and you want the elements of the question exported in some format, e.g. html or LaTeX.
</p>

<p>
I am going to explore representing a question as some data structure, not in org-mode for now. Then, we will use emacs-lisp to format the question the way we want it. The data we need about a question include the type of question, a unique id, the question, the choices, and the answer. For the choices, we might want some descriptive text for the solution. Here is one example of how we could represent a question as a struct in emacs-lisp. I do not claim here that this is the best or most complete way to represent it; it is simply a way that we could do it so we can discuss it later.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(defstruct question type id question choices)
</pre>
</div>

<pre class="example">
question
</pre>

<p>
The defstruct macro creates a constructor function "make-question" for us, and we create questions like this:
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(setq q1 (make-question
          <span style="color: #cd0000;">:type</span> 'multiple-choice
          <span style="color: #cd0000;">:id</span> <span style="color: #228b22;">"id:1"</span>
          <span style="color: #cd0000;">:question</span> <span style="color: #228b22;">"What is 2 + 2?"</span>
          <span style="color: #cd0000;">:choices</span> '(('choice 0 <span style="color: #228b22;">"Not correct"</span>)
                     ('choice 2 <span style="color: #228b22;">"Not correct"</span>)
                     ('choice 4 nil 'answer)
                     ('choice <span style="color: #228b22;">"None of the above"</span> <span style="color: #228b22;">"Not correct"</span>))))
</pre>
</div>

<pre class="example">
[cl-struct-question multiple-choice "id:1" "What is 2 + 2?" (((quote choice) 0 "Not correct") ((quote choice) 2 "Not correct") ((quote choice) 4 nil (quote answer)) ((quote choice) "None of the above" "Not correct"))]
</pre>

<p>
The defstruct macro also creates accessor functions to get the information stored in the question. These go by "question-SLOTNAME" and they make it pretty easy to get the data. We can convert this structure to an org-mode formatted question by using a formatted string, substituting values from the question object where we want them. I will make the headline contain the question, create some properties, and then make an org-link for each choice. The mc link is something I defined in the previous post.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(format <span style="color: #228b22;">"** %s</span>
<span style="color: #228b22;">  :PROPERTIES:</span>
<span style="color: #228b22;">  :ID: %s</span>
<span style="color: #228b22;">  :END:</span>
<span style="color: #228b22;">%s"</span> (question-question q1)
(question-id q1) 
(mapconcat 'identity (loop for i to (length (question-choices q1))
                           for choice in (question-choices q1)
                           collect
                           (format <span style="color: #228b22;">"[[mc:%s]] %s"</span> i (elt choice 1)))
           <span style="color: #228b22;">"\n"</span>))
</pre>
</div>

<pre class="example">
** What is 2 + 2?
  :PROPERTIES:
  :ID: id:1
  :END:
[[mc:0]] 0
[[mc:1]] 2
[[mc:2]] 4
[[mc:3]] None of the above
</pre>

<p>
To generate a quiz, we would just need to loop over several questions and insert the strings into a buffer then save it to a file. 
</p>

<p>
To generate the key, we use pretty similar code, and additionally find the choice that is the answer, and print any hints with the choices.
</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp">(format <span style="color: #228b22;">"** %s</span>
<span style="color: #228b22;">  :PROPERTIES:</span>
<span style="color: #228b22;">  :ID: %s</span>
<span style="color: #228b22;">  :CORRECT-ANSWER: %s</span>
<span style="color: #228b22;">  :END:</span>
<span style="color: #228b22;">%s"</span> (question-question q1)
    (question-id q1)
    ;; <span style="color: #ff0000; font-weight: bold;">here we loop through the choices looking for the answer </span>
    (loop for choice in (question-choices q1)
          until (-contains? choice '(quote answer))
          finally return (elt choice 1))
    (mapconcat 'identity (loop for i to (length (question-choices q1))
                               for choice in (question-choices q1)
                               collect
                               (format <span style="color: #228b22;">"[[mc:%s]] %s</span>
<span style="color: #228b22;">%s"</span> i (elt choice 1) (or (elt choice 2) <span style="color: #228b22;">""</span>)))
               <span style="color: #228b22;">"\n"</span>))
</pre>
</div>

<div class="org-src-container">

<pre class="src src-org"><span style="color: #8b008b;">** What is 2 + 2?</span>
<span style="color: #8b0000;">  :PROPERTIES:</span>
  <span style="color: #8b0000;">:ID:</span> id:1
  <span style="color: #8b0000;">:CORRECT-ANSWER:</span> 4
<span style="color: #8b0000;">  :END:</span>
<span style="color: #0000ff; font-weight: bold; text-decoration: underline;"><a href="mc:0">mc:0</a></span> 0
Not correct
<span style="color: #0000ff; font-weight: bold; text-decoration: underline;"><a href="mc:1">mc:1</a></span> 2
Not correct
<span style="color: #0000ff; font-weight: bold; text-decoration: underline;"><a href="mc:2">mc:2</a></span> 4

<span style="color: #0000ff; font-weight: bold; text-decoration: underline;"><a href="mc:3">mc:3</a></span> None of the above
Not correct
</pre>
</div>

<p>
It is a similar process to convert to LaTeX or HTML as well, just different syntax in the format statement. 
</p>

<p>
The next question is how to make authoring the questions pretty easy, i.e. with a minimal amount of syntax that represents the question data and is easy to transform. The lisp data structure is not too bad, but might be less familiar to many. Next we consider how to represent this question in org-mode. For example the question would be in a headline, and the ID and answer stored as properties. The choices might be stored as sub-headings that are tagged as choices. Then, constructing the question would entail going to the question headline, getting the information you want, and formatting it like I did above. The next section represents a question in org-mode. I think it actually takes more typing to do this, but some of it reuses some org-machinery I am familiar with. In any case, it is possible to store all the same kind of information using combinations of tags and properties. The next section is the question (only really visible in org-mode, not in the html post), and the section after that is how to use it.
</p>

<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1"><a id="ID-99D480BD-9651-4987-9646-4BE90BA6CAEC" name="ID-99D480BD-9651-4987-9646-4BE90BA6CAEC"></a><span class="section-number-2">1</span> What is 2 + 2?&#xa0;&#xa0;&#xa0;<span class="tag"><span class="multiple_choice">multiple_choice</span></span></h2>
<div class="outline-text-2" id="text-1">
</div>

<div id="outline-container-sec-1-1" class="outline-3">
<h3 id="sec-1-1"><span class="section-number-3">1.1</span> 0&#xa0;&#xa0;&#xa0;<span class="tag"><span class="choice">choice</span></span></h3>
<div class="outline-text-3" id="text-1-1">
<p>
Not correct, This is the answer to 2 - 2.
</p>
</div>
</div>

<div id="outline-container-sec-1-2" class="outline-3">
<h3 id="sec-1-2"><span class="section-number-3">1.2</span> 2&#xa0;&#xa0;&#xa0;<span class="tag"><span class="choice">choice</span></span></h3>
<div class="outline-text-3" id="text-1-2">
<p>
Not correct
</p>
</div>
</div>

<div id="outline-container-sec-1-3" class="outline-3">
<h3 id="sec-1-3"><span class="section-number-3">1.3</span> 4&#xa0;&#xa0;&#xa0;<span class="tag"><span class="choice">choice</span>&#xa0;<span class="answer">answer</span></span></h3>
<div class="outline-text-3" id="text-1-3">
<p>
Correct. 
</p>
</div>
</div>

<div id="outline-container-sec-1-4" class="outline-3">
<h3 id="sec-1-4"><span class="section-number-3">1.4</span> None of the above&#xa0;&#xa0;&#xa0;<span class="tag"><span class="choice">choice</span></span></h3>
<div class="outline-text-3" id="text-1-4">
<p>
This is not correct
</p>
</div>
</div>
</div>

<div id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2"><span class="section-number-2">2</span> Working with the org representation of a question</h2>
<div class="outline-text-2" id="text-2">
<p>
Now, we use the org-machinery to work with the question and represent it in different formats. Here we just get the choices for a question with a specific id. We jump to the question, find headings tagged choice, and collect them.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #8b0000;">save-excursion</span>
  (org-open-link-from-string <span style="color: #228b22;">"id:99D480BD-9651-4987-9646-4BE90BA6CAEC"</span>)
  (<span style="color: #8b0000;">save-restriction</span>
    (org-narrow-to-subtree)
    (<span style="color: #8b0000;">let</span> ((choices '()))
      (org-map-entries
       (<span style="color: #8b0000;">lambda</span> ()
         (add-to-list
          'choices
          (org-heading-components)
          t))
       <span style="color: #228b22;">"choice"</span>)
      choices)))
</pre>
</div>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="right" />

<col  class="right" />

<col  class="left" />

<col  class="left" />

<col  class="right" />

<col  class="left" />
</colgroup>
<tbody>
<tr>
<td class="right">3</td>
<td class="right">3</td>
<td class="left">nil</td>
<td class="left">nil</td>
<td class="right">0</td>
<td class="left">:choice:</td>
</tr>

<tr>
<td class="right">3</td>
<td class="right">3</td>
<td class="left">nil</td>
<td class="left">nil</td>
<td class="right">2</td>
<td class="left">:choice:</td>
</tr>

<tr>
<td class="right">3</td>
<td class="right">3</td>
<td class="left">nil</td>
<td class="left">nil</td>
<td class="right">4</td>
<td class="left">:choice:</td>
</tr>

<tr>
<td class="right">3</td>
<td class="right">3</td>
<td class="left">nil</td>
<td class="left">nil</td>
<td class="right">None of the above</td>
<td class="left">:choice:</td>
</tr>
</tbody>
</table>

<p>
You could use the headline for each choice to construct a question. For example, here we output some HTML to represent checkboxes in an HTML form.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #8b0000;">save-excursion</span>
  (org-open-link-from-string <span style="color: #228b22;">"id:99D480BD-9651-4987-9646-4BE90BA6CAEC"</span>)
  (<span style="color: #8b0000;">let</span> ((all-choices 
         (<span style="color: #8b0000;">save-restriction</span>
           (org-narrow-to-subtree)
           (<span style="color: #8b0000;">let</span> ((choices '()))
             (org-map-entries
              (<span style="color: #8b0000;">lambda</span> ()
                (add-to-list
                 'choices
                 (elt (org-heading-components) 4)
                 t))
              <span style="color: #228b22;">"choice"</span>)
             choices)))
        (question (elt (org-heading-components) 4))
        )
    (concat
     <span style="color: #228b22;">"&lt;html&gt;&lt;body&gt;\n"</span>
     <span style="color: #228b22;">"&lt;h1&gt;"</span> question <span style="color: #228b22;">"&lt;/h1&gt;\n"</span>
     <span style="color: #228b22;">"&lt;form action = \"\"&gt;"</span>
     (mapconcat
      'identity
      (loop for choice in all-choices
            collect       
            (format <span style="color: #228b22;">"  &lt;input type=\"checkbox\" name=\"choice\" value=\"%s\"&gt;%s&lt;br&gt;"</span>
                    choice choice))
      <span style="color: #228b22;">"\n"</span>)
     <span style="color: #228b22;">"\n&lt;/form&gt;\n"</span>
     <span style="color: #228b22;">"&lt;/body&gt;&lt;/html&gt;"</span>)))
</pre>
</div>
<html><body>
<h1>What is 2 + 2?</h1>
<form action = "">  <input type="checkbox" name="choice" value="0">0<br>
  <input type="checkbox" name="choice" value="2">2<br>
  <input type="checkbox" name="choice" value="4">4<br>
  <input type="checkbox" name="choice" value="None of the above">None of the above<br>
</form>
</body></html>

<p>
There is no action button to submit this answer, but you could add one if wanted. Clearly, you will have custom functions to export each format you want, with the information you want in it. The code for the org-mode representation is a little more verbose than the lisp data representation, but they accomplish basically the same thing. One thing that would be necessary to do is create some functions that take a list of question IDs and generate the quiz and solution in a buffer, and a helm interface for question selection would be pretty sweet.
</p>

<p>
I can see adding several other pieces of information about a problem, including categories or keywords, level of difficulty, how many points the problem is worth, last time it was assigned, relationship to course learning objectives, maybe information about who authored the problem, and a source if that is appropriate. These would allow you to consider machine grading, or correlating performance between problems, assessing how a class is doing on a problem, etc&#x2026; Lots of potential here.</p>
</div>
</div>
<p>Copyright (C) 2014 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2014/11/28/A-database-of-quiz-questions-to-generate-quizzes-and-solutions.org">org-mode source</a><p><p>Org-mode version = 8.2.7c</p>]]></content>
  </entry>
  <entry>
    <author>
      <name></name>
      <uri>http://jkitchin.github.io/blog</uri>
    </author>
    <title type="html"><![CDATA[Machine-gradable quizzes in emacs+org-modex]]></title>
    <link rel="alternate" type="text/html" href="http://jkitchin.github.io/blog/2014/11/23/Machine-gradable-quizzes-in-emacs+org-modex" />
    <id>http://jkitchin.github.io/blog/2014/11/23/Machine-gradable-quizzes-in-emacs+org-modex</id>
    <updated>2014-11-23T16:49:52Z</updated>
    <published>2014-11-23T16:49:52Z</published>
    <category scheme="http://jkitchin.github.io/blog" term="org" />
    <category scheme="http://jkitchin.github.io/blog" term="education" />
    <category scheme="http://jkitchin.github.io/blog" term="emacs" />
    <summary type="html"><![CDATA[Machine-gradable quizzes in emacs+org-modex]]></summary>
    <content type="html" xml:base="http://jkitchin.github.io/blog/2014/11/23/Machine-gradable-quizzes-in-emacs+org-modex"><![CDATA[



<p>
In a previous <a href="http://kitchingroup.cheme.cmu.edu/blog/2014/01/01/Interactive-quizzes-with-feedback-in-org-mode/">post</a> , we considered interactive quizzes in emacs and org-mode. Here we consider a variation of that idea with the aim of creating a machine-gradable quiz, i.e. a modern version of a scantron.
</p>

<p>
The idea is simple, we will let each question be represented by an org headline, and the choices will be clickable links that store the answer as a property in the headline. Each headline will have a unique id. The grading key will contain these ids and the correct answer, and a function will determine if the right answer was selected for each question.
</p>

<p>
Here is a simple link that will store the value of the link as a property. Note that the path must be at least two characters long to be recognized as a link, unless you wrap the link in double brackets. We will have the link insert a comment to indicate to the user what they chose. We do that because the PROPERTIES drawer is usually hidden, and it is not obvious it was changed.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(org-add-link-type 
 <span style="color: #228b22;">"mc"</span> 
 (<span style="color: #8b0000;">lambda</span> (link)
   (<span style="color: #8b0000;">save-restriction</span>
     (org-narrow-to-subtree)
     (goto-char (point-max))
     (insert (concat
              (<span style="color: #8b0000;">unless</span> (bolp) <span style="color: #228b22;">"\n"</span>)
              (format <span style="color: #228b22;">"# you chose %s"</span> link))))
       
   (org-entry-put (point) <span style="color: #228b22;">"ANSWER"</span> link)))
</pre>
</div>

<p>
Next, we add a subheading with some questions to test the link.
</p>
<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1"><span class="section-number-2">1</span> Some questions</h2>
<div class="outline-text-2" id="text-1">
</div><div id="outline-container-sec-1-1" class="outline-3">
<h3 id="sec-1-1"><a id="ID-19C7BA30-A761-4C94-9F3B-E6010E263949" name="ID-19C7BA30-A761-4C94-9F3B-E6010E263949"></a><span class="section-number-3">1.1</span> question 1</h3>
<div class="outline-text-3" id="text-1-1">
<p>
What is 2 + 2?
</p>

<p>
<a href="a">a</a> 1
</p>

<p>
<a href="b">b</a> 2
</p>

<p>
<a href="c">c</a> 4
</p>
</div>
</div>
<div id="outline-container-sec-1-2" class="outline-3">
<h3 id="sec-1-2"><a id="ID-38FCCF3D-7FC5-49BF-BB77-486BBAA17CD9" name="ID-38FCCF3D-7FC5-49BF-BB77-486BBAA17CD9"></a><span class="section-number-3">1.2</span> question 2</h3>
<div class="outline-text-3" id="text-1-2">
<p>
What is 2 - 2?
</p>

<p>
<a href="a">a</a> 0
</p>

<p>
<a href="b">b</a> 2
</p>

<p>
<a href="c">c</a> 4
</p>
</div>
</div>
</div>
<div id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2"><span class="section-number-2">2</span> Grading</h2>
<div class="outline-text-2" id="text-2">
<p>
We will store an alist of id and answer for each problem. To grade, we simple map over the alist, go to the section with the id, and compare the answers. When the answer is correct, we save a point, and when not, no point. We can use the org-mode machinery to jump to the problems and get the stored answer. We put some feedback at the end of the file to see what was right, and what was wrong.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #8b0000;">let*</span> ((key '((<span style="color: #228b22;">"19C7BA30-A761-4C94-9F3B-E6010E263949"</span> . <span style="color: #228b22;">"c"</span>)
              (<span style="color: #228b22;">"38FCCF3D-7FC5-49BF-BB77-486BBAA17CD9"</span> . <span style="color: #228b22;">"a"</span>)))
       (MAX (length key))
       (points 0)
       (answer))
  
  (<span style="color: #8b0000;">dolist</span> (tup key)
    (<span style="color: #8b0000;">save-excursion</span>
      (org-open-link-from-string
       (format <span style="color: #228b22;">"id:%s"</span> (car tup)))
      (setq answer (org-entry-get (point) <span style="color: #228b22;">"ANSWER"</span>))
      (<span style="color: #8b0000;">if</span> (string= answer (cdr tup))
          (<span style="color: #8b0000;">progn</span>
            (setq points (+ 1 points))
            (goto-char (point-max))
            (insert (format <span style="color: #228b22;">"# id:%s: %s correct\n"</span> (car tup) answer)))
        (goto-char (point-max))
        (insert (format <span style="color: #228b22;">"# id:%s: %s wrong (%s is correct)\n"</span>
                        (car tup)
                        answer
                        (cdr tup))))))
  (goto-char (point-max))
  (insert (format
           <span style="color: #228b22;">"#+GRADE: %s"</span> (/ (float points) (float MAX)))))
</pre>
</div>

<p>
That works pretty well. I need to think about how to codify the key, since this would usually be stored in some file. We would also need to wrap the code block in a function that we could call easily. The org-id key is easy, but not very readable. It would make it easy to keep a database of these problems though. 
</p>
<p>
Just for completeness, I want to save the key to a file, and use it. We simply write the alist in a file. Here are the contents, which are tangled to key.el. One alternative might be to have a solution copy of the quiz which has the answers in it, and we read the answers from the file.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">((<span style="color: #228b22;">"19C7BA30-A761-4C94-9F3B-E6010E263949"</span> . <span style="color: #228b22;">"c"</span>)
 (<span style="color: #228b22;">"38FCCF3D-7FC5-49BF-BB77-486BBAA17CD9"</span> . <span style="color: #228b22;">"a"</span>))
</pre>
</div>

<p>
Now, we read it in like this. The rest of the code is basically the same.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #8b0000;">let*</span> ((key (<span style="color: #8b0000;">with-temp-buffer</span> 
              (insert-file-contents <span style="color: #228b22;">"key.el"</span>)
              (read (current-buffer))))
       (MAX (length key))
       (points 0)
       (answer))
  
  (<span style="color: #8b0000;">dolist</span> (tup key)
    (<span style="color: #8b0000;">save-excursion</span>
      (org-open-link-from-string
       (format <span style="color: #228b22;">"id:%s"</span> (car tup)))
      (setq answer (org-entry-get (point) <span style="color: #228b22;">"ANSWER"</span>))
      (<span style="color: #8b0000;">if</span> (string= answer (cdr tup))
          (<span style="color: #8b0000;">progn</span>
            (setq points (+ 1 points))
            (goto-char (point-max))
            (insert (format <span style="color: #228b22;">"# id:%s: %s correct\n"</span> (car tup) answer)))
        (goto-char (point-max))
        (insert (format <span style="color: #228b22;">"# id:%s: %s wrong (%s is correct)\n"</span>
                        (car tup)
                        answer
                        (cdr tup))))))
  (goto-char (point-max))
  (insert (format
           <span style="color: #228b22;">"#+GRADE: %s"</span> (/ (float points) (float MAX)))))
</pre>
</div>

<p>
It is probably much easier to have a solution version of the quiz, and generate the key from it. For example, we can collect the ID and ANSWER from the problems in this file like this.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #8b0000;">let</span> ((key '()))
  (org-map-entries
   (<span style="color: #8b0000;">lambda</span> ()
     (<span style="color: #8b0000;">let</span> ((id) (ans))
       (<span style="color: #8b0000;">when</span> (and
              (setq id (org-entry-get (point) <span style="color: #228b22;">"ID"</span>))
              (setq ans (org-entry-get (point) <span style="color: #228b22;">"ANSWER"</span>)))
         (add-to-list 'key (cons id ans))))))
key)
</pre>
</div>

<div class="org-src-container">

<pre class="src src-emacs-lisp">((<span style="color: #228b22;">"38FCCF3D-7FC5-49BF-BB77-486BBAA17CD9"</span> . <span style="color: #228b22;">"a"</span>)
 (<span style="color: #228b22;">"19C7BA30-A761-4C94-9F3B-E6010E263949"</span> . <span style="color: #228b22;">"c"</span>))
</pre>
</div>

<p>
So, if we had a master solution file, we could read the key from there. That is the way to do this.
</p>
</div>
</div>
<p>Copyright (C) 2014 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2014/11/23/Machine-gradable-quizzes-in-emacs+org-modex.org">org-mode source</a><p><p>Org-mode version = 8.2.7c</p>]]></content>
  </entry>
</feed>
