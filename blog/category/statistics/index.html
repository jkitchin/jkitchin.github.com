

<!doctype html>
<!--[if lt IE 7 ]> <html lang="en" class="no-js ie6"> <![endif]-->
<!--[if IE 7 ]>    <html lang="en" class="no-js ie7"> <![endif]-->
<!--[if IE 8 ]>    <html lang="en" class="no-js ie8"> <![endif]-->
<!--[if IE 9 ]>    <html lang="en" class="no-js ie9"> <![endif]-->
<!--[if (gt IE 9)|!(IE)]><!--> <html lang="en" class="no-js"> <!--<![endif]-->
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>The Kitchin Research Group: statistics</title>
  <meta name="google-site-verification" content="CGcacJdHc2YoZyI0Vey9XRA5qwhhFDzThKJezbRFcJ4" />
  <meta name="description" content="Chemical Engineering at Carnegie Mellon University">
  <meta name="author" content="John Kitchin">
  <link rel="alternate" type="application/rss+xml" title="RSS 2.0" href="/blog/feed" />
  <link rel="alternate" type="application/atom+xml" title="Atom 1.0" href="/blog/feed/atom" />
  <link rel="shortcut icon" href="/favicon.ico">
  <link rel="apple-touch-icon" href="/img/apple-touch-icon.png">

  <link rel="stylesheet" href="/css/base.css?v=1">
  <link rel="stylesheet" href="/css/grid.css?v=1">
  <link rel="stylesheet" media="handheld" href="/css/handheld.css?v=1">
  <link rel="stylesheet" href="/css/pygments_murphy.css" type="text/css" />

  <script src="/js/libs/modernizr-1.7.min.js"></script>
<script type="text/javascript"
  src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
  <link rel="stylesheet" href="/themes/theme1/style.css?v=1">
<link href='http://fonts.googleapis.com/css?family=Roboto' rel='stylesheet' type='text/css'>

</head>
  <body>
    <div id="container" class="container container_12">
      <div id="main" role="main">
        <div id="main_block">
          <header>
<div id="header" class="header_gradient theme_font">
<table><tr><td>
    <h1><a href="/">The Kitchin Research Group</a></h1>
    <h2>Chemical Engineering at Carnegie Mellon University</h2>
</td>
<td colspan=100%><div style="float:right;width:100%;text-align:right;"> <span id='badgeCont737515' style='width:126px'><script src='http://labs.researcherid.com/mashlets?el=badgeCont737515&mashlet=badge&showTitle=false&className=a&rid=A-2363-2010'></script></span></div>
</td></tr>
</table>
</div>
  <div id="navigation" class="grid_12">

    <ul class="theme_font">
      <li><a href="/blog"
             class="">Blog</a></li>

      <li><a href="/blog/archive"
             class="">Archives</a></li>

      <li><a href="/publications.html">Publications</a></li>
      <li><a href="/group.html">Group</a></li>

      <li><a href="/research.html"
             class="">Research</a></li>

      <li><a href="/categories.html"
             class="">Categories</a></li>

      <li><a href="/about.html"
             class="">About us</a></li>

      <li><a href="/subscribe.html">Subscribe</a></li>

    </ul>
  </div>
</header>

          <div id="prose_block" class="grid_8">
            
  





<article>
  <div class="blog_post">
    <header>
      <div id="Uncertainty-in-implicit-functions"></div>
      <h2 class="blog_post_title"><a href="/blog/2013/03/08/Uncertainty-in-implicit-functions/" rel="bookmark" title="Permanent Link to Uncertainty in implicit functions">Uncertainty in implicit functions</a></h2>
      <p><small><span class="blog_post_date">Posted March 08, 2013 at 05:04 PM</span> | categories:
        <span class="blog_post_categories"><a href='/blog/category/statistics/'>statistics</a></span> | tags: 
        | <a href="http://jkitchin.github.io/blog/2013/03/08/Uncertainty-in-implicit-functions#disqus_thread">View Comments</a>
      <p><small><span class="blog_post_date">Updated March 14, 2013 at 03:34 PM</span>
      </small></p>
    </header>
    <div class="post_prose">
      



<p>
Suppose we have an equation \(y = e^{a y}\) that we want to solve, where \(a\) is a constant with some uncertainty. What is the uncertainty in the solution \(y\)?
</p>

<p>
Finding a solution is not difficult. The uncertainty in the solution, however, is not easy, since we do not have an explicit function to propagate errors through. Let us examine the solution first.
</p>
<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">import</span> numpy <span style="color: #8b0000;">as</span> np
<span style="color: #8b0000;">from</span> scipy.optimize <span style="color: #8b0000;">import</span> fsolve

a = 0.20

<span style="color: #8b0000;">def</span> <span style="color: #8b2323;">f</span>(y):
    <span style="color: #8b0000;">return</span> y - np.exp(a * y)

sol, = fsolve(f, 1)
<span style="color: #8b0000;">print</span> sol
</pre>
</div>

<pre class="example">
1.2958555091
</pre>

<p>
A way to estimate the uncertainty is by Monte Carlo simulation. We solve the equation many times, using values sampled from the uncertainty distribution. Here we assume that the \(a\) parameter is normally distributed  with an average of 0.2 and a std deviation of 0.02. We solve the equation 10000 times for different values of \(a\) sampled according to the normal distribution. That gives us a distribution of solutions that we can do statistical analysis of to get the average and std deviation.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">import</span> numpy <span style="color: #8b0000;">as</span> np
<span style="color: #8b0000;">from</span> scipy.optimize <span style="color: #8b0000;">import</span> fsolve
N = 10000

A = np.random.normal(0.2, 0.02, size=N)

sol = np.zeros(A.shape)

<span style="color: #8b0000;">for</span> i, a <span style="color: #8b0000;">in</span> <span style="color: #8b0000;">enumerate</span>(A):
    s, = fsolve(<span style="color: #8b0000;">lambda</span> y:y - np.exp(a * y), 1)
    sol[i] = s

ybar = np.mean(sol)
s_y = np.std(sol)

<span style="color: #8b0000;">print</span> ybar, s_y, s_y / ybar

<span style="color: #8b0000;">import</span> matplotlib.pyplot <span style="color: #8b0000;">as</span> plt
count, bins, ignored = plt.hist(sol)
plt.savefig(<span style="color: #228b22;">'images/implicit-uncertainty.png'</span>)
</pre>
</div>

<pre class="example">
1.29887470397 0.0465110111613 0.0358086973433
</pre>

<p>
We get approximately the same answer, and you can see here the distribution of solution values is not quite normal. We compute the standard deviation anyway, and find the standard deviation is about 3.6%. It would be nice to have some analytical method to estimate this uncertainty. So far I have not figured that out.
</p>

<p>
This method could have relevance in estimating the uncertainty in the friction factor for turbulent flow (\(Re > 2100\)). In that case we have the implicit equation \(\frac{1}{\sqrt{f_F}}=4.0 \log(Re \sqrt{f_F})-0.4\). Uncertainties in the Re number would lead to uncertainties in the friction factor. Whether those uncertainties are larger than the uncertainties from the original correlation would require some investigation.
</p>
<p>Copyright (C) 2013 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2013/03/08/Uncertainty-in-implicit-functions.org">org-mode source</a><p>

    </div>
  </div>
</article>



<a href="https://twitter.com/share" class="twitter-share-button" data-via="johnkitchin">Tweet</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>

  <div class="after_post"><a href="http://jkitchin.github.io/blog/2013/03/08/Uncertainty-in-implicit-functions#disqus_thread">Read and Post Comments</a></div>
  <hr class="interblog" />
  





<article>
  <div class="blog_post">
    <header>
      <div id="Another-approach-to-error-propagation"></div>
      <h2 class="blog_post_title"><a href="/blog/2013/03/07/Another-approach-to-error-propagation/" rel="bookmark" title="Permanent Link to Another approach to error propagation">Another approach to error propagation</a></h2>
      <p><small><span class="blog_post_date">Posted March 07, 2013 at 09:26 AM</span> | categories:
        <span class="blog_post_categories"><a href='/blog/category/statistics/'>statistics</a></span> | tags: 
        | <a href="http://jkitchin.github.io/blog/2013/03/07/Another-approach-to-error-propagation#disqus_thread">View Comments</a>
      <p><small><span class="blog_post_date">Updated April 23, 2013 at 09:28 PM</span>
      </small></p>
    </header>
    <div class="post_prose">
      



<p>
In the previous section we examined an analytical approach to error propagation, and a simulation based approach. There is another approach to error propagation, using the uncertainties module (<a href="https://pypi.python.org/pypi/uncertainties/" >https://pypi.python.org/pypi/uncertainties/</a>). You have to install this package, e.g. <code>pip install uncertainties</code>. After that, the module provides new classes of numbers and functions that incorporate uncertainty and propagate the uncertainty through the functions. In the examples that follow, we repeat the calculations from the previous section using the uncertainties module. 
</p>

<p>
<span style="text-decoration:underline;">Addition and subtraction</span>
</p>
<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">import</span> uncertainties <span style="color: #8b0000;">as</span> u

A = u.ufloat((2.5, 0.4))
B = u.ufloat((4.1, 0.3))
<span style="color: #8b0000;">print</span> A + B
<span style="color: #8b0000;">print</span> A - B
</pre>
</div>

<pre class="example">
&gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; 6.6+/-0.5
-1.6+/-0.5
</pre>

<p>
<span style="text-decoration:underline;">Multiplication and division</span>
</p>
<div class="org-src-container">

<pre class="src src-python">F = u.ufloat((25, 1))
x = u.ufloat((6.4, 0.4))

t = F * x
<span style="color: #8b0000;">print</span> t

d = F / x
<span style="color: #8b0000;">print</span> d
</pre>
</div>

<pre class="example">
&gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; 160.0+/-11.8726576637
&gt;&gt;&gt; &gt;&gt;&gt; 3.90625+/-0.289859806243
</pre>

<p>
<span style="text-decoration:underline;">Exponentiation</span>
</p>
<div class="org-src-container">

<pre class="src src-python">t = u.ufloat((2.03, 0.0203))
<span style="color: #8b0000;">print</span> t**5

<span style="color: #8b0000;">from</span> uncertainties.umath <span style="color: #8b0000;">import</span> sqrt
A = u.ufloat((16.07, 0.06))
<span style="color: #8b0000;">print</span> sqrt(A)
<span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">print np.sqrt(A) # this does not work</span>

<span style="color: #8b0000;">from</span> uncertainties <span style="color: #8b0000;">import</span> unumpy <span style="color: #8b0000;">as</span> unp
<span style="color: #8b0000;">print</span> unp.sqrt(A)
</pre>
</div>

<pre class="example">
34.4730881243+/-1.72365440621
&gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; 4.00874045057+/-0.00748364738749
... &gt;&gt;&gt; &gt;&gt;&gt; 4.00874045057+/-0.00748364738749
</pre>

<p>
Note in the last example, we had to either import a function from uncertainties.umath or import a special version of numpy that handles uncertainty. This may be a limitation of teh uncertainties package as not all functions in arbitrary modules can be covered. Note, however, that you can wrap a function to make it handle uncertainty like this.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">import</span> numpy <span style="color: #8b0000;">as</span> np

wrapped_sqrt = u.wrap(np.sqrt)
<span style="color: #8b0000;">print</span> wrapped_sqrt(A)
</pre>
</div>

<pre class="example">
&gt;&gt;&gt; &gt;&gt;&gt; 4.00874045057+/-0.00748364738774
</pre>

<p>
<span style="text-decoration:underline;">Propagation of errors in an integral</span>
</p>
<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">import</span> numpy <span style="color: #8b0000;">as</span> np
<span style="color: #8b0000;">import</span> uncertainties <span style="color: #8b0000;">as</span> u

x = np.array([u.ufloat((1, 0.01)), 
              u.ufloat((2, 0.1)),
              u.ufloat((3, 0.1))])

y = 2 * x

<span style="color: #8b0000;">print</span> np.trapz(x, y)
</pre>
</div>
<pre class="example">
&gt;&gt;&gt; &gt;&gt;&gt; ... ... &gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; 8.0+/-0.600333240792
</pre>

<p>
<span style="text-decoration:underline;">Chain rule in error propagation</span>
</p>
<div class="org-src-container">

<pre class="src src-python">v0 = u.ufloat((1.2, 0.02))
a = u.ufloat((3.0, 0.3))
t = u.ufloat((12.0, 0.12))

v = v0 + a * t
<span style="color: #8b0000;">print</span> v
</pre>
</div>

<pre class="example">
&gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; 37.2+/-3.61801050303
</pre>

<p>
<span style="text-decoration:underline;">A real example?</span>
This is what I would setup for a real working example. We try to compute the exit concentration from a CSTR. The idea is to wrap the &ldquo;external&rdquo; fsolve function using the <code>uncertainties.wrap</code> function, which handles the units. Unfortunately, it does not work, and it is not clear why. But see the following discussion for a fix. 
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">from</span> scipy.optimize <span style="color: #8b0000;">import</span> fsolve

Fa0 = u.ufloat((5.0, 0.05))
v0 = u.ufloat((10., 0.1))

V = u.ufloat((66000.0, 100))  <span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">reactor volume L^3</span>
k = u.ufloat((3.0, 0.2))      <span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">rate constant L/mol/h</span>

<span style="color: #8b0000;">def</span> <span style="color: #8b2323;">func</span>(Ca):
    <span style="color: #228b22;">"Mole balance for a CSTR. Solve this equation for func(Ca)=0"</span>
    Fa = v0 * Ca     <span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">exit molar flow of A</span>
    ra = -k * Ca**2  <span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">rate of reaction of A L/mol/h</span>
    <span style="color: #8b0000;">return</span> Fa0 - Fa + V * ra

<span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">CA guess that that 90 % is reacted away</span>
CA_guess = 0.1 * Fa0 / v0

wrapped_fsolve = u.wrap(fsolve)
CA_sol = wrapped_fsolve(func, CA_guess)

<span style="color: #8b0000;">print</span> <span style="color: #228b22;">'The exit concentration is {0} mol/L'</span>.format(CA_sol)
</pre>
</div>

<pre class="example">
&gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; ... ... ... ... ... &gt;&gt;&gt; ... &gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; &lt;function fsolve at 0x148f25f0&gt;
&gt;&gt;&gt; &gt;&gt;&gt; The exit concentration is NotImplemented mol/L
</pre>

<p>
I got a note from the author of the uncertainties package explaining the cryptic error above, and a solution for it. The error arises because fsolve does not know how to deal with uncertainties. The idea is to create a function that returns a float, when everything is given as a float. Then, we wrap the fsolve call, and finally wrap the wrapped fsolve call! 
</p>

<ul>
<li>Step 1. Write the function to solve with arguments for all unitted quantities. This function may be called with uncertainties, or with floats.
</li>

<li>Step 2. Wrap the call to fsolve in a function that takes all the parameters as arguments, and that returns the solution.
</li>

<li>Step 3. Use uncertainties.wrap to wrap the function in Step 2 to get the answer with uncertainties.
</li>
</ul>

<p>
Here is the code that does work:
</p>
<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">import</span> uncertainties <span style="color: #8b0000;">as</span> u
<span style="color: #8b0000;">from</span> scipy.optimize <span style="color: #8b0000;">import</span> fsolve

Fa0 = u.ufloat((5.0, 0.05))
v0 = u.ufloat((10., 0.1))

V = u.ufloat((66000.0, 100.0))  <span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">reactor volume L^3</span>
k = u.ufloat((3.0, 0.2))      <span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">rate constant L/mol/h</span>

<span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">Step 1</span>
<span style="color: #8b0000;">def</span> <span style="color: #8b2323;">func</span>(Ca, v0, k, Fa0, V):
    <span style="color: #228b22;">"Mole balance for a CSTR. Solve this equation for func(Ca)=0"</span>
    Fa = v0 * Ca     <span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">exit molar flow of A</span>
    ra = -k * Ca**2  <span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">rate of reaction of A L/mol/h</span>
    <span style="color: #8b0000;">return</span> Fa0 - Fa + V * ra

<span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">Step 2</span>
<span style="color: #8b0000;">def</span> <span style="color: #8b2323;">Ca_solve</span>(v0, k, Fa0, V): 
    <span style="color: #228b22;">'wrap fsolve to pass parameters as float or units'</span>
    <span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">this line is a little fragile. You must put [0] at the end or</span>
    <span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">you get the NotImplemented result</span>
    sol = fsolve(func, 0.1 * Fa0 / v0, args=(v0, k, Fa0, V))[0]
    <span style="color: #8b0000;">return</span> sol

<span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">Step 3</span>
<span style="color: #8b0000;">print</span> u.wrap(Ca_solve)(v0, k, Fa0, V)
</pre>
</div>

<pre class="example">
0.005+/-0.000167764327667
</pre>

<p>
It would take some practice to get used to this, but the payoff is that you have an &ldquo;automatic&rdquo; error propagation method.
</p>

<p>
Being ever the skeptic, let us compare the result above to the Monte Carlo approach to error estimation below.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">import</span> numpy <span style="color: #8b0000;">as</span> np
<span style="color: #8b0000;">from</span> scipy.optimize <span style="color: #8b0000;">import</span> fsolve

N = 10000
Fa0 = np.random.normal(5, 0.05, (1, N))
v0 = np.random.normal(10.0, 0.1, (1, N))
V =  np.random.normal(66000, 100, (1,N))
k = np.random.normal(3.0, 0.2, (1, N))

SOL = np.zeros((1, N))

<span style="color: #8b0000;">for</span> i <span style="color: #8b0000;">in</span> <span style="color: #8b0000;">range</span>(N):
    <span style="color: #8b0000;">def</span> <span style="color: #8b2323;">func</span>(Ca):
        <span style="color: #8b0000;">return</span> Fa0[0,i] - v0[0,i] * Ca + V[0,i] * (-k[0,i] * Ca**2)
    SOL[0,i] = fsolve(func, 0.1 * Fa0[0,i] / v0[0,i])[0]

<span style="color: #8b0000;">print</span> <span style="color: #228b22;">'Ca(exit) = {0}+/-{1}'</span>.format(np.mean(SOL), np.std(SOL))
</pre>
</div>

<pre class="example">
Ca(exit) = 0.00500829453185+/-0.000169103578901
</pre>

<p>
I am pretty content those are the same!
</p>

<div id="outline-container-1" class="outline-2">
<h2 id="sec-1"><span class="section-number-2">1</span> Summary</h2>
<div class="outline-text-2" id="text-1">
<p>
The uncertainties module is pretty amazing. It automatically propagates errors through a pretty broad range of computations. It is a little tricky for third-party packages, but it seems doable.
</p>

<p>
Read more about the package at <a href="http://pythonhosted.org/uncertainties/index.html" >http://pythonhosted.org/uncertainties/index.html</a>.
</p>
</div>
</div>
<p>Copyright (C) 2013 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2013/03/07/Another-approach-to-error-propagation.org">org-mode source</a><p>

    </div>
  </div>
</article>



<a href="https://twitter.com/share" class="twitter-share-button" data-via="johnkitchin">Tweet</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>

  <div class="after_post"><a href="http://jkitchin.github.io/blog/2013/03/07/Another-approach-to-error-propagation#disqus_thread">Read and Post Comments</a></div>
  <hr class="interblog" />
  





<article>
  <div class="blog_post">
    <header>
      <div id="Are-averages-different"></div>
      <h2 class="blog_post_title"><a href="/blog/2013/02/18/Are-averages-different/" rel="bookmark" title="Permanent Link to Are averages different">Are averages different</a></h2>
      <p><small><span class="blog_post_date">Posted February 18, 2013 at 09:00 AM</span> | categories:
        <span class="blog_post_categories"><a href='/blog/category/data-analysis/'>data analysis</a>, <a href='/blog/category/statistics/'>statistics</a></span> | tags: 
        | <a href="http://jkitchin.github.io/blog/2013/02/18/Are-averages-different#disqus_thread">View Comments</a>
      <p><small><span class="blog_post_date">Updated February 27, 2013 at 02:35 PM</span>
      </small></p>
    </header>
    <div class="post_prose">
      



<p>
<a href="http://matlab.cheme.cmu.edu/2012/01/28/are-two-averages-different/" >Matlab post</a>
</p>

<p>
Adapted from <a href="http://stattrek.com/ap-statistics-4/unpaired-means.aspx" >http://stattrek.com/ap-statistics-4/unpaired-means.aspx</a>
</p>

<p>
Class A had 30 students who received an average test score of 78, with standard deviation of 10. Class B had 25 students an average test score of 85, with a standard deviation of 15. We want to know if the difference in these averages is statistically relevant. Note that we only have estimates of the true average and standard deviation for each class, and there is uncertainty in those estimates. As a result, we are unsure if the averages are really different. It could have just been luck that a few students in class B did better.
</p>

<p>
The hypothesis:
</p>

<p>
the true averages are the same. We need to perform a two-sample t-test of the hypothesis that \(\mu_1 - \mu_2 = 0\) (this is often called the null hypothesis). we use a two-tailed test because we do not care if the difference is positive or negative, either way means the averages are not the same.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">import</span> numpy <span style="color: #8b0000;">as</span> np

n1 = 30  <span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">students in class A</span>
x1 = 78.0  <span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">average grade in class A</span>
s1 = 10.0  <span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">std dev of exam grade in class A</span>

n2 = 25  <span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">students in class B</span>
x2 = 85.0  <span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">average grade in class B</span>
s2 = 15.0  <span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">std dev of exam grade in class B</span>

<span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">the standard error of the difference between the two averages. </span>
SE = np.sqrt(s1**2 / n1 + s2**2 / n2)

<span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">compute DOF</span>
DF = (n1 - 1) + (n2 - 1)
</pre>
</div>

<p>
see the discussion at <a href="http://stattrek.com/Help/Glossary.aspx?Target=Two-sample%20t-test" >http://stattrek.com/Help/Glossary.aspx?Target=Two-sample%20t-test</a> for a more complex definition of degrees of freedom. Here we simply subtract one from each sample size to account for the estimation of the average of each sample.
</p>


<p>
compute the t-score for our data
</p>

<p>
The difference between two averages determined from small sample numbers follows the t-distribution. the t-score is the difference between the difference of the means and the hypothesized difference of the means, normalized by the standard error. we compute the absolute value of the t-score to make sure it is positive for convenience later.
</p>
<div class="org-src-container">

<pre class="src src-python">tscore = np.abs(((x1 - x2) - 0) / SE)
<span style="color: #8b0000;">print</span> tscore
</pre>
</div>

<pre class="example">
1.99323179108
</pre>

<p>
Interpretation
</p>

<p>
A way to approach determinining if the difference is significant or not is to ask, does our computed average fall within a confidence range of the hypothesized value (zero)? If it does, then we can attribute the difference to statistical variations at that confidence level. If it does not, we can say that statistical variations do not account for the difference at that confidence level, and hence the averages must be different.
</p>

<p>
Let us compute the t-value that corresponds to a 95% confidence level for a mean of zero with the degrees of freedom computed earlier. This means that 95% of the t-scores we expect to get will fall within \(\pm\) t95.
</p>


<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">from</span> scipy.stats.distributions <span style="color: #8b0000;">import</span>  t

ci = 0.95;
alpha = 1 - ci;
t95 = t.ppf(1.0 - alpha/2.0, DF)

<span style="color: #8b0000;">print</span> t95
</pre>
</div>

<pre class="example">
&gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; 2.00574599354
</pre>

<p>
since tscore &lt; t95, we conclude that at the 95% confidence level we cannot say these averages are statistically different because our computed t-score falls in the expected range of deviations. Note that our t-score is very close to the 95% limit. Let us consider a smaller confidence interval.
</p>

<div class="org-src-container">

<pre class="src src-python">ci = 0.94
alpha = 1 - ci;
t95 = t.ppf(1.0 - alpha/2.0, DF)

<span style="color: #8b0000;">print</span> t95
</pre>
</div>

<pre class="example">
&gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; 1.92191364181
</pre>

<p>
at the 94% confidence level, however, tscore &gt; t94, which means we can say with 94% confidence that the two averages are different; class B performed better than class A did. Alternatively, there is only about a 6% chance we are wrong about that statement.
another way to get there
</p>

<p>
An alternative way to get the confidence that the averages are different is to directly compute it from the cumulative t-distribution function. We compute the difference between all the t-values less than tscore and the t-values less than -tscore, which is the fraction of measurements that are between them. You can see here that we are practically 95% sure that the averages are different.
</p>

<div class="org-src-container">

<pre class="src src-python">f = t.cdf(tscore, DF) - t.cdf(-tscore, DF)
<span style="color: #8b0000;">print</span> f
</pre>
</div>

<pre class="example">
0.948605075732
</pre>
<p>Copyright (C) 2013 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2013/02/18/Are-averages-different.org">org-mode source</a><p>

    </div>
  </div>
</article>



<a href="https://twitter.com/share" class="twitter-share-button" data-via="johnkitchin">Tweet</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>

  <div class="after_post"><a href="http://jkitchin.github.io/blog/2013/02/18/Are-averages-different#disqus_thread">Read and Post Comments</a></div>
  <hr class="interblog" />
  





<article>
  <div class="blog_post">
    <header>
      <div id="Basic-statistics"></div>
      <h2 class="blog_post_title"><a href="/blog/2013/02/18/Basic-statistics/" rel="bookmark" title="Permanent Link to Basic statistics">Basic statistics</a></h2>
      <p><small><span class="blog_post_date">Posted February 18, 2013 at 09:00 AM</span> | categories:
        <span class="blog_post_categories"><a href='/blog/category/statistics/'>statistics</a></span> | tags: 
        | <a href="http://jkitchin.github.io/blog/2013/02/18/Basic-statistics#disqus_thread">View Comments</a>
      <p><small><span class="blog_post_date">Updated February 27, 2013 at 02:35 PM</span>
      </small></p>
    </header>
    <div class="post_prose">
      



<p>
Given several measurements of a single quantity, determine the average value of the measurements, the standard deviation of the measurements and the 95% confidence interval for the average.
</p>

<p>
This is a recipe for computing the confidence interval. The strategy is:
</p>
<ol>
<li>compute the average
</li>
<li>Compute the standard deviation of your data
</li>
<li>Define the confidence interval, e.g. 95% = 0.95
</li>
<li>compute the student-t multiplier. This is a function of the confidence
</li>
</ol>
<p>
interval you specify, and the number of data points you have minus 1. You
subtract 1 because one degree of freedom is lost from calculating the
average. The confidence interval is defined as
ybar +- T_multiplier*std/sqrt(n).
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">import</span> numpy <span style="color: #8b0000;">as</span> np
<span style="color: #8b0000;">from</span> scipy.stats.distributions <span style="color: #8b0000;">import</span>  t

y = [8.1, 8.0, 8.1]

ybar = np.mean(y)
s = np.std(y)

ci = 0.95
alpha = 1.0 - ci

n = <span style="color: #8b0000;">len</span>(y)
T_multiplier = t.ppf(1-alpha/2.0, n-1)

ci95 = T_multiplier * s / np.sqrt(n-1)

<span style="color: #8b0000;">print</span> [ybar - ci95, ybar + ci95]
</pre>
</div>

<pre class="example">
[7.9232449090029595, 8.210088424330376]
</pre>

<p>
We are 95% certain the next measurement will fall in the interval above.
</p>
<p>Copyright (C) 2013 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2013/02/18/Basic-statistics.org">org-mode source</a><p>

    </div>
  </div>
</article>



<a href="https://twitter.com/share" class="twitter-share-button" data-via="johnkitchin">Tweet</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>

  <div class="after_post"><a href="http://jkitchin.github.io/blog/2013/02/18/Basic-statistics#disqus_thread">Read and Post Comments</a></div>
  <hr class="interblog" />
  





<article>
  <div class="blog_post">
    <header>
      <div id="Introduction-to-statistical-data-analysis"></div>
      <h2 class="blog_post_title"><a href="/blog/2013/02/18/Introduction-to-statistical-data-analysis/" rel="bookmark" title="Permanent Link to Introduction to statistical data analysis">Introduction to statistical data analysis</a></h2>
      <p><small><span class="blog_post_date">Posted February 18, 2013 at 09:00 AM</span> | categories:
        <span class="blog_post_categories"><a href='/blog/category/statistics/'>statistics</a></span> | tags: 
        | <a href="http://jkitchin.github.io/blog/2013/02/18/Introduction-to-statistical-data-analysis#disqus_thread">View Comments</a>
      <p><small><span class="blog_post_date">Updated February 27, 2013 at 02:34 PM</span>
      </small></p>
    </header>
    <div class="post_prose">
      



<p>
<a href="http://matlab.cheme.cmu.edu/2011/08/27/introduction-to-statistical-data-analysis/" >Matlab post</a>
</p>

<p>
Given several measurements of a single quantity, determine the average value of the measurements, the standard deviation of the measurements and the 95% confidence interval for the average.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">import</span> numpy <span style="color: #8b0000;">as</span> np

y = [8.1, 8.0, 8.1]

ybar = np.mean(y)
s = np.std(y, ddof=1)

<span style="color: #8b0000;">print</span> ybar, s
</pre>
</div>

<pre class="example">
&gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; 8.06666666667 0.057735026919
</pre>

<p>
Interesting, we have to specify the divisor in numpy.std by the ddof argument. The default for this in Matlab is 1, the default for this function is 0.
</p>

<p>
Here is the principle of computing a confidence interval.
</p>

<ol>
<li>compute the average
</li>
<li>Compute the standard deviation of your data
</li>
<li>Define the confidence interval, e.g. 95% = 0.95
</li>
<li>compute the student-t multiplier. This is a function of the
confidence interval you specify, and the number of data points
you have minus 1. You subtract 1 because one degree of freedom
is lost from calculating the average.
</li>
</ol>

<p>
The confidence interval is defined as ybar +- T_multiplier*std/sqrt(n).
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">from</span> scipy.stats.distributions <span style="color: #8b0000;">import</span>  t
ci = 0.95
alpha = 1.0 - ci

n = <span style="color: #8b0000;">len</span>(y)
T_multiplier = t.ppf(1.0 - alpha / 2.0, n - 1)

ci95 = T_multiplier * s / np.sqrt(n)

<span style="color: #8b0000;">print</span> <span style="color: #228b22;">'T_multiplier = {0}'</span>.format(T_multiplier)
<span style="color: #8b0000;">print</span> <span style="color: #228b22;">'ci95 = {0}'</span>.format(ci95)
<span style="color: #8b0000;">print</span> <span style="color: #228b22;">'The true average is between {0} and {1} at a 95% confidence level'</span>.format(ybar - ci95, ybar + ci95)
</pre>
</div>

<pre class="example">
&gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; T_multiplier = 4.30265272991
ci95 = 0.143421757664
The true average is between 7.923244909 and 8.21008842433 at a 95% confidence level
</pre>
<p>Copyright (C) 2013 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2013/02/18/Introduction-to-statistical-data-analysis.org">org-mode source</a><p>

    </div>
  </div>
</article>



<a href="https://twitter.com/share" class="twitter-share-button" data-via="johnkitchin">Tweet</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>

  <div class="after_post"><a href="http://jkitchin.github.io/blog/2013/02/18/Introduction-to-statistical-data-analysis#disqus_thread">Read and Post Comments</a></div>
  <hr class="interblog" />
 <a href="/blog/category/statistics/2">Next Page »</a>

          </div>
          <div id="sidebar" class="grid_4">
            <aside>
<section>
<script>
  (function() {
    var cx = '002533177287215655227:l7uvu35ssbc';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
        '//www.google.com/cse/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>
</section>

<section>
    <h1 class="post_header_gradient theme_font">Twitter</h1>
    <a class="twitter-timeline" href="https://twitter.com/johnkitchin" data-widget-id="545217643582881792">Tweets by @johnkitchin</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+"://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
</section>


  <section>
    <h1 class="post_header_gradient theme_font">Links</h1>
    <ul>
      <li><a href="https://www.continuum.io">Anaconda Python</a></li>
      <li><a href="/pycse">Pycse</a></li>
      <li><a href="/dft-book">DFT-book</a></li>
    </ul>
  </section>

  <section>
    <h1 class="post_header_gradient theme_font">Latest Posts</h1>
    <ul>
      <li><a href="/blog/2018/01/27/New-publication-in-Topics-in-Catalysis/">New publication in Topics in Catalysis</a></li>
      <li><a href="/blog/2018/01/03/New-publication-in-Molecular-Simulation/">New publication in Molecular Simulation</a></li>
      <li><a href="/blog/2017/12/31/2017-in-a-nutshell-for-the-Kitchin-Research-group/">2017 in a nutshell for the Kitchin Research group</a></li>
      <li><a href="/blog/2017/11/29/Solving-an-eigenvalue-differential-equation-with-a-neural-network/">Solving an eigenvalue differential equation with a neural network</a></li>
      <li><a href="/blog/2017/11/28/Solving-ODEs-with-a-neural-network-and-autograd/">Solving ODEs with a neural network and autograd</a></li>
    </ul>
  </section>

<section>
<h1 class="post_header_gradient theme_font">Latest GitHub Repos</h1>
  <a href="https://github.com/jkitchin">@jkitchin</a> on GitHub.
  <ul id="my-github-projects">
        <li class="loading">Status updating&#8230;</li>
  </ul>

</section>
</aside>

          </div>
          <div class="clear"></div>
        </div>
      </div>
      
<footer>
  <div id="footer" class="grid_12">
    <div class="grid_8">
      <p>
        <a href="/blog/feed/index.xml">RSS</a>
        <a href="http://kitchinresearchgroup.disqus.com/latest.rss">Comments RSS Feed</a>.
      </p>
    </div>
    <div class="grid_4" id="credits">
      <p>
        Copyright 2018
        John Kitchin
      </p>
      <p>
        Powered by <a href="http://www.blogofile.com">Blogofile</a>
      </p>
    </div>
  </div>
</footer>

    </div>
      <script src="//ajax.googleapis.com/ajax/libs/jquery/1.5.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="/js/libs/jquery-1.5.1.min.js"%3E%3C/script%3E'))</script>
  <script src="/js/plugins.js"></script>
  <script src="/js/script.js"></script>
  <script src="/js/jquery.tweet.js"></script>  
  <script src="/js/site.js"></script>
  <!--[if lt IE 7 ]>
  <script src="js/libs/dd_belatedpng.js"></script>
  <script> DD_belatedPNG.fix('img, .png_bg');</script>
  <![endif]-->
  <script>
      var _gaq=[['_setAccount','UA-35731398-1'],['_trackPageview']];
      (function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];g.async=1;
      g.src=('https:'==location.protocol?'//ssl':'//www')+'.google-analytics.com/ga.js';
      s.parentNode.insertBefore(g,s)}(document,'script'));
  </script>
  <script>
  (function() {
      var links = document.getElementsByTagName('a');
      var query = '?';
      for(var i = 0; i < links.length; i++) {
          if(links[i].href.indexOf('#disqus_thread') >= 0) {
              query += 'url' + i + '=' + encodeURIComponent(links[i].href) + '&';
          }
      }
      document.write('<script charset="utf-8" type="text/javascript" src="http://disqus.com/forums/kitchinresearchgroup/get_num_replies.js' + query + '"></' + 'script>');
  })();
  </script>

  </body>
</html>






<script src="http://ajax.microsoft.com/ajax/jquery/jquery-1.4.2.min.js" type="text/javascript"></script>
<script src="/js/git.js" type="text/javascript"></script>
<script type="text/javascript">
    $(function() {
     $("#my-github-projects").loadRepositories("jkitchin");
    });
</script>



