

<!doctype html>
<!--[if lt IE 7 ]> <html lang="en" class="no-js ie6"> <![endif]-->
<!--[if IE 7 ]>    <html lang="en" class="no-js ie7"> <![endif]-->
<!--[if IE 8 ]>    <html lang="en" class="no-js ie8"> <![endif]-->
<!--[if IE 9 ]>    <html lang="en" class="no-js ie9"> <![endif]-->
<!--[if (gt IE 9)|!(IE)]><!--> <html lang="en" class="no-js"> <!--<![endif]-->
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>The Kitchin Research Group: bvp</title>
  <meta name="google-site-verification" content="CGcacJdHc2YoZyI0Vey9XRA5qwhhFDzThKJezbRFcJ4" />
  <meta name="description" content="Chemical Engineering at Carnegie Mellon University">
  <meta name="author" content="John Kitchin">
  <link rel="alternate" type="application/rss+xml" title="RSS 2.0" href="/blog/feed" />
  <link rel="alternate" type="application/atom+xml" title="Atom 1.0" href="/blog/feed/atom" />
  <link rel="shortcut icon" href="/favicon.ico">
  <link rel="apple-touch-icon" href="/img/apple-touch-icon.png">

  <link rel="stylesheet" href="/css/base.css?v=1">
  <link rel="stylesheet" href="/css/grid.css?v=1">
  <link rel="stylesheet" media="handheld" href="/css/handheld.css?v=1">
  <link rel="stylesheet" href="/css/pygments_murphy.css" type="text/css" />

  <script src="/js/libs/modernizr-1.7.min.js"></script>
<script type="text/javascript"
  src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
  <link rel="stylesheet" href="/themes/theme1/style.css?v=1">
<link href='http://fonts.googleapis.com/css?family=Roboto' rel='stylesheet' type='text/css'>

</head>
  <body>
    <div id="container" class="container container_12">
      <div id="main" role="main">
        <div id="main_block">
          <header>
<div id="header" class="header_gradient theme_font">
<table><tr><td>
    <h1><a href="/">The Kitchin Research Group</a></h1>
    <h2>Chemical Engineering at Carnegie Mellon University</h2>
</td>
<td colspan=100%><div style="float:right;width:100%;text-align:right;"> <span id='badgeCont737515' style='width:126px'><script src='http://labs.researcherid.com/mashlets?el=badgeCont737515&mashlet=badge&showTitle=false&className=a&rid=A-2363-2010'></script></span></div>
</td></tr>
</table>
</div>
  <div id="navigation" class="grid_12">

    <ul class="theme_font">
      <li><a href="/blog"
             class="">Blog</a></li>

      <li><a href="/blog/archive"
             class="">Archives</a></li>

      <li><a href="/publications.html">Publications</a></li>
      <li><a href="/group.html">Group</a></li>

      <li><a href="/research.html"
             class="">Research</a></li>

      <li><a href="/categories.html"
             class="">Categories</a></li>

      <li><a href="/about.html"
             class="">About us</a></li>

      <li><a href="/subscribe.html">Subscribe</a></li>

    </ul>
  </div>
</header>

          <div id="prose_block" class="grid_8">
            
  





<article>
  <div class="blog_post">
    <header>
      <div id="Numerically-calculating-an-effectiveness-factor-for-a-porous-catalyst-bead"></div>
      <h2 class="blog_post_title"><a href="/blog/2013/02/13/Numerically-calculating-an-effectiveness-factor-for-a-porous-catalyst-bead/" rel="bookmark" title="Permanent Link to Numerically calculating an effectiveness factor for a porous catalyst bead">Numerically calculating an effectiveness factor for a porous catalyst bead</a></h2>
      <p><small><span class="blog_post_date">Posted February 13, 2013 at 09:00 AM</span> | categories:
        <span class="blog_post_categories"><a href='/blog/category/bvp/'>bvp</a></span> | tags: <a href='/blog/tag/reaction-engineering/'>reaction engineering</a>
        | <a href="http://jkitchin.github.io/blog/2013/02/13/Numerically-calculating-an-effectiveness-factor-for-a-porous-catalyst-bead#disqus_thread">View Comments</a>
      <p><small><span class="blog_post_date">Updated January 05, 2015 at 09:59 AM</span>
      </small></p>
    </header>
    <div class="post_prose">
      



<p>
<a href="http://matlab.cheme.cmu.edu/2011/11/18/numerically-calculating-an-effectiveness-factor-for-a-porous-catalyst-bead/">Matlab post</a> 
</p>

<p>
If reaction rates are fast compared to diffusion in a porous catalyst pellet, then the observed kinetics will appear to be slower than they really are because not all of the catalyst surface area will be effectively used. For example, the reactants may all be consumed in the near surface area of a catalyst bead, and the inside of the bead will be unutilized because no reactants can get in due to the high reaction rates.
</p>

<p>
References: Ch 12. Elements of Chemical Reaction Engineering, Fogler, 4th edition.
</p>

<p>
A mole balance on the particle volume in spherical coordinates with a first order reaction leads to: <img src="ltxpng/pycse_583fc34e02e0dfd7da742eac8e08f28fed0361fb.png" alt="$\frac{d^2Ca}{dr^2} + \frac{2}{r}\frac{dCa}{dr}-\frac{k}{D_e}C_A=0$" /> with boundary conditions <img src="ltxpng/pycse_4866f4778622517d6c40909af5ddee8dd88e4e4b.png" alt="$C_A(R) = C_{As}$" /> and <img src="ltxpng/pycse_c6b9758ef2d8da94f97a02ad3267e4546ed89545.png" alt="$\frac{dCa}{dr}=0$" /> at <img src="ltxpng/pycse_bf76d476f1b6de028534649c02962bb23035ae13.png" alt="$r=0$" />. We convert this equation to a system of first order ODEs by letting <img src="ltxpng/pycse_cfb3bc1cb2bda6ef332c07d9817aeac44dea4a8b.png" alt="$W_A=\frac{dCa}{dr}$" />. Then, our two equations become:
</p>

<p>
<img src="ltxpng/pycse_2a2b847add5fa85ab01423d270fe3702f9eafe38.png" alt="\(\frac{dCa}{dr} = W_A\)" />
</p>

<p>
and
</p>

<p>
<img src="ltxpng/pycse_d57c97774a37a7ef56fbf47b93b687c9f5d6725e.png" alt="\(\frac{dW_A}{dr} = -\frac{2}{r} W_A + \frac{k}{D_E} C_A\)" />
</p>

<p>
We have a condition of no flux (<img src="ltxpng/pycse_f8e519b8e68d9b04fdd5ceee6a4c5b1ce76f1a7c.png" alt="$W_A=0$" />) at r=0 and Ca(R) = CAs, which makes this a boundary value problem. We use the shooting method here, and guess what Ca(0) is and iterate the guess to get Ca(R) = CAs.
</p>

<p>
The value of the second differential equation at r=0 is tricky because at this place we have a 0/0 term. We use L'Hopital's rule to evaluate it. The derivative of the top is <img src="ltxpng/pycse_092ea3e2d18ee85c9af99247db455c8cccce06d5.png" alt="$\frac{dW_A}{dr}$" /> and the derivative of the bottom is 1. So, we have 
<img src="ltxpng/pycse_5460cdb1bbc54e713c3a2f9bb18a2126a0575198.png" alt="\(\frac{dW_A}{dr} = -2\frac{dW_A}{dr} + \frac{k}{D_E} C_A\)" />
</p>

<p>
Which leads to:
</p>

<p>
<img src="ltxpng/pycse_195ccf4fd71c1883fbc31726cb636c64719b6ddf.png" alt="\(3 \frac{dW_A}{dr} =  \frac{k}{D_E} C_A\)" />
</p>

<p>
or <img src="ltxpng/pycse_2d1800a78e5c0ef322ba22f10481b52c3b6bc358.png" alt="\(\frac{dW_A}{dr} =  \frac{3k}{D_E} C_A\)" /> at <img src="ltxpng/pycse_bf76d476f1b6de028534649c02962bb23035ae13.png" alt="$r=0$" />.
</p>

<p>
Finally, we implement the equations in Python and solve.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #0000FF;">import</span> numpy <span style="color: #0000FF;">as</span> np
<span style="color: #0000FF;">from</span> scipy.integrate <span style="color: #0000FF;">import</span> odeint
<span style="color: #0000FF;">import</span> matplotlib.pyplot <span style="color: #0000FF;">as</span> plt

<span style="color: #333333; background-color: #FFFFFF; font-weight: bold;">De</span> = <span style="color: #333333; background-color: #FFFFFF; font-weight: bold;">0</span>.<span style="color: #333333; background-color: #FFFFFF; font-weight: bold;">1</span>    <span style="color: #8D8D84; font-weight: bold; font-style: italic;"># diffusivity cm^2/s</span>
<span style="color: #333333; background-color: #FFFFFF; font-weight: bold;">R</span> = <span style="color: #333333; background-color: #FFFFFF; font-weight: bold;">0</span>.<span style="color: #333333; background-color: #FFFFFF; font-weight: bold;">5</span>    <span style="color: #8D8D84; font-weight: bold; font-style: italic;"># particle radius, cm</span>
<span style="color: #333333; background-color: #FFFFFF; font-weight: bold;">k</span> = <span style="color: #333333; background-color: #FFFFFF; font-weight: bold;">6</span>.<span style="color: #333333; background-color: #FFFFFF; font-weight: bold;">4</span>    <span style="color: #8D8D84; font-weight: bold; font-style: italic;"># rate constant (1/s)</span>
<span style="color: #333333; background-color: #FFFFFF; font-weight: bold;">CAs</span> = <span style="color: #333333; background-color: #FFFFFF; font-weight: bold;">0</span>.<span style="color: #333333; background-color: #FFFFFF; font-weight: bold;">2</span>   <span style="color: #8D8D84; font-weight: bold; font-style: italic;"># concentration of A at outer radius of particle (mol/L)</span>


<span style="color: #0000FF;">def</span> <span style="color: #006699;">ode</span>(Y, r):
    <span style="color: #333333; background-color: #FFFFFF; font-weight: bold;">Wa</span> = Y[<span style="color: #333333; background-color: #FFFFFF; font-weight: bold;">0</span>]  <span style="color: #8D8D84; font-weight: bold; font-style: italic;"># molar rate of delivery of A to surface of particle</span>
    <span style="color: #333333; background-color: #FFFFFF; font-weight: bold;">Ca</span> = Y[<span style="color: #333333; background-color: #FFFFFF; font-weight: bold;">1</span>]  <span style="color: #8D8D84; font-weight: bold; font-style: italic;"># concentration of A in the particle at r</span>
    <span style="color: #8D8D84; font-weight: bold; font-style: italic;"># this solves the singularity at r = 0</span>
    <span style="color: #0000FF;">if</span> <span style="color: #333333; background-color: #FFFFFF; font-weight: bold;">r</span> == <span style="color: #333333; background-color: #FFFFFF; font-weight: bold;">0</span>:
        <span style="color: #333333; background-color: #FFFFFF; font-weight: bold;">dWadr</span> = k / <span style="color: #333333; background-color: #FFFFFF; font-weight: bold;">3</span>.<span style="color: #333333; background-color: #FFFFFF; font-weight: bold;">0</span> * De * Ca
    <span style="color: #0000FF;">else</span>:
        <span style="color: #333333; background-color: #FFFFFF; font-weight: bold;">dWadr</span> = -<span style="color: #333333; background-color: #FFFFFF; font-weight: bold;">2</span> * Wa / r + k / De * Ca
    <span style="color: #333333; background-color: #FFFFFF; font-weight: bold;">dCadr</span> = Wa
    <span style="color: #0000FF;">return</span> [dWadr, dCadr]

<span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-weight: bold; font-style: italic;">Initial conditions</span>
<span style="color: #333333; background-color: #FFFFFF; font-weight: bold;">Ca0</span> = <span style="color: #333333; background-color: #FFFFFF; font-weight: bold;">0</span>.<span style="color: #333333; background-color: #FFFFFF; font-weight: bold;">029315</span>  <span style="color: #8D8D84; font-weight: bold; font-style: italic;"># Ca(0) (mol/L) guessed to satisfy Ca(R) = CAs</span>
<span style="color: #333333; background-color: #FFFFFF; font-weight: bold;">Wa0</span> = <span style="color: #333333; background-color: #FFFFFF; font-weight: bold;">0</span>         <span style="color: #8D8D84; font-weight: bold; font-style: italic;"># no flux at r=0 (mol/m^2/s)</span>

<span style="color: #333333; background-color: #FFFFFF; font-weight: bold;">rspan</span> = np.linspace(<span style="color: #333333; background-color: #FFFFFF; font-weight: bold;">0</span>, R, <span style="color: #333333; background-color: #FFFFFF; font-weight: bold;">500</span>)

<span style="color: #333333; background-color: #FFFFFF; font-weight: bold;">Y</span> = odeint(ode, [Wa0, Ca0], rspan)

<span style="color: #333333; background-color: #FFFFFF; font-weight: bold;">Ca</span> = Y[:, <span style="color: #333333; background-color: #FFFFFF; font-weight: bold;">1</span>]

<span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-weight: bold; font-style: italic;">here we check that Ca(R) = Cas</span>
<span style="color: #0000FF;">print</span> <span style="color: #036A07;">'At r={0} Ca={1}'</span>.format(rspan[-<span style="color: #333333; background-color: #FFFFFF; font-weight: bold;">1</span>], Ca[-<span style="color: #333333; background-color: #FFFFFF; font-weight: bold;">1</span>])

plt.plot(rspan, Ca)
plt.xlabel(<span style="color: #036A07;">'Particle radius'</span>)
plt.ylabel(<span style="color: #036A07;">'$C_A$'</span>)
plt.savefig(<span style="color: #036A07;">'images/effectiveness-factor.png'</span>)

<span style="color: #333333; background-color: #FFFFFF; font-weight: bold;">r</span> = rspan
<span style="color: #333333; background-color: #FFFFFF; font-weight: bold;">eta_numerical</span> = (np.trapz(k * Ca * <span style="color: #333333; background-color: #FFFFFF; font-weight: bold;">4</span> * np.pi * (r**<span style="color: #333333; background-color: #FFFFFF; font-weight: bold;">2</span>), r)
                 / np.trapz(k * CAs * <span style="color: #333333; background-color: #FFFFFF; font-weight: bold;">4</span> * np.pi * (r**<span style="color: #333333; background-color: #FFFFFF; font-weight: bold;">2</span>), r))

<span style="color: #0000FF;">print</span>(eta_numerical)

<span style="color: #333333; background-color: #FFFFFF; font-weight: bold;">phi</span> = R * np.sqrt(k / De)
<span style="color: #333333; background-color: #FFFFFF; font-weight: bold;">eta_analytical</span> = (<span style="color: #333333; background-color: #FFFFFF; font-weight: bold;">3</span> / phi**<span style="color: #333333; background-color: #FFFFFF; font-weight: bold;">2</span>) * (phi * (<span style="color: #333333; background-color: #FFFFFF; font-weight: bold;">1</span>.<span style="color: #333333; background-color: #FFFFFF; font-weight: bold;">0</span> / np.tanh(phi)) - <span style="color: #333333; background-color: #FFFFFF; font-weight: bold;">1</span>)
<span style="color: #0000FF;">print</span>(eta_analytical)
</pre>
</div>

<pre class="example">
At r=0.5 Ca=0.200001488652
[&lt;matplotlib.lines.Line2D object at 0x114275550&gt;]
&lt;matplotlib.text.Text object at 0x10d5fe890&gt;
&lt;matplotlib.text.Text object at 0x10d5ff890&gt;
0.563011348314

0.563003362801
</pre>


<div class="figure">
<p><img src="/media/2013-02-13-Numerically-calculating-an-effectiveness-factor-for-a-porous-catalyst-bead/effectiveness-factor.png"> 
</p>
</div>

<p>
You can see the concentration of A inside the particle is significantly lower than outside the particle. That is because it is reacting away faster than it can diffuse into the particle. Hence, the overall reaction rate in the particle is lower than it would be without the diffusion limit.
</p>

<p>
The effectiveness factor is the ratio of the actual reaction rate in the particle with diffusion limitation to the ideal rate in the particle if there was no concentration gradient:
</p>

<p>
<img src="ltxpng/pycse_e4d91f15d6b5776f2048ac79e7be69f850f309e0.png" alt="$$\eta = \frac{\int_0^R k'' a C_A(r) 4 \pi r^2 dr}{\int_0^R k'' a C_{As} 4 \pi r^2 dr}$$" />
</p>

<p>
We will evaluate this numerically from our solution and compare it to the analytical solution. The results are in good agreement, and you can make the numerical estimate better by increasing the number of points in the solution so that the numerical integration is more accurate.
</p>

<p>
Why go through the numerical solution when an analytical solution exists? The analytical solution here is only good for 1st order kinetics in a sphere. What would you do for a complicated rate law? You might be able to find some limiting conditions where the analytical equation above is relevant, and if you are lucky, they are appropriate for your problem. If not, it is a good thing you can figure this out numerically!
</p>

<p>
Thanks to Radovan Omorjan for helping me figure out the ODE at r=0!
</p>
<p>Copyright (C) 2015 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2013/02/13/Numerically-calculating-an-effectiveness-factor-for-a-porous-catalyst-bead.org">org-mode source</a><p><p>Org-mode version = 8.2.10</p>

    </div>
  </div>
</article>



<a href="https://twitter.com/share" class="twitter-share-button" data-via="johnkitchin">Tweet</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>

  <div class="after_post"><a href="http://jkitchin.github.io/blog/2013/02/13/Numerically-calculating-an-effectiveness-factor-for-a-porous-catalyst-bead#disqus_thread">Read and Post Comments</a></div>
  <hr class="interblog" />
 <a href="/blog/category/bvp/1">Â« Previous Page</a>

          </div>
          <div id="sidebar" class="grid_4">
            <aside>
<section>
<script>
  (function() {
    var cx = '002533177287215655227:l7uvu35ssbc';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
        '//www.google.com/cse/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>
</section>

<section>
    <h1 class="post_header_gradient theme_font">Twitter</h1>
    <a class="twitter-timeline" href="https://twitter.com/johnkitchin" data-widget-id="545217643582881792">Tweets by @johnkitchin</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+"://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
</section>


  <section>
    <h1 class="post_header_gradient theme_font">Links</h1>
    <ul>
      <li><a href="https://www.continuum.io">Anaconda Python</a></li>
      <li><a href="/pycse">Pycse</a></li>
      <li><a href="/dft-book">DFT-book</a></li>
    </ul>
  </section>

  <section>
    <h1 class="post_header_gradient theme_font">Latest Posts</h1>
    <ul>
      <li><a href="/blog/2017/09/25/New-publication-in-J-Phys-Chem-Lett/">New publication in J. Phys. Chem. Lett.</a></li>
      <li><a href="/blog/2017/09/16/Finding-similar-bibtex-entries/">Finding similar bibtex entries</a></li>
      <li><a href="/blog/2017/08/06/New-publication-in-Journal-of-Physics-Condensed-Matter/">New publication in Journal of Physics Condensed Matter</a></li>
      <li><a href="/blog/2017/08/05/New-publication-in-Crystal-Growth-Design/">New publication in Crystal Growth & Design</a></li>
      <li><a href="/blog/2017/07/23/Overloading-mathematical-operators-in-elisp/">Overloading mathematical operators in elisp</a></li>
    </ul>
  </section>

<section>
<h1 class="post_header_gradient theme_font">Latest GitHub Repos</h1>
  <a href="https://github.com/jkitchin">@jkitchin</a> on GitHub.
  <ul id="my-github-projects">
        <li class="loading">Status updating&#8230;</li>
  </ul>

</section>
</aside>

          </div>
          <div class="clear"></div>
        </div>
      </div>
      
<footer>
  <div id="footer" class="grid_12">
    <div class="grid_8">
      <p>
        <a href="/blog/feed/index.xml">RSS</a>
        <a href="http://kitchinresearchgroup.disqus.com/latest.rss">Comments RSS Feed</a>.
      </p>
    </div>
    <div class="grid_4" id="credits">
      <p>
        Copyright 2017
        John Kitchin
      </p>
      <p>
        Powered by <a href="http://www.blogofile.com">Blogofile</a>
      </p>
    </div>
  </div>
</footer>

    </div>
      <script src="//ajax.googleapis.com/ajax/libs/jquery/1.5.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="/js/libs/jquery-1.5.1.min.js"%3E%3C/script%3E'))</script>
  <script src="/js/plugins.js"></script>
  <script src="/js/script.js"></script>
  <script src="/js/jquery.tweet.js"></script>  
  <script src="/js/site.js"></script>
  <!--[if lt IE 7 ]>
  <script src="js/libs/dd_belatedpng.js"></script>
  <script> DD_belatedPNG.fix('img, .png_bg');</script>
  <![endif]-->
  <script>
      var _gaq=[['_setAccount','UA-35731398-1'],['_trackPageview']];
      (function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];g.async=1;
      g.src=('https:'==location.protocol?'//ssl':'//www')+'.google-analytics.com/ga.js';
      s.parentNode.insertBefore(g,s)}(document,'script'));
  </script>
  <script>
  (function() {
      var links = document.getElementsByTagName('a');
      var query = '?';
      for(var i = 0; i < links.length; i++) {
          if(links[i].href.indexOf('#disqus_thread') >= 0) {
              query += 'url' + i + '=' + encodeURIComponent(links[i].href) + '&';
          }
      }
      document.write('<script charset="utf-8" type="text/javascript" src="http://disqus.com/forums/kitchinresearchgroup/get_num_replies.js' + query + '"></' + 'script>');
  })();
  </script>

  </body>
</html>






<script src="http://ajax.microsoft.com/ajax/jquery/jquery-1.4.2.min.js" type="text/javascript"></script>
<script src="/js/git.js" type="text/javascript"></script>
<script type="text/javascript">
    $(function() {
     $("#my-github-projects").loadRepositories("jkitchin");
    });
</script>



