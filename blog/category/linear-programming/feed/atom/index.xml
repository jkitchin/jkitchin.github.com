<?xml version="1.0" encoding="UTF-8"?>
<feed
  xmlns="http://www.w3.org/2005/Atom"
  xmlns:thr="http://purl.org/syndication/thread/1.0"
  xml:lang="en"
   >
  <title type="text">The Kitchin Research Group</title>
  <subtitle type="text">Chemical Engineering at Carnegie Mellon University</subtitle>

  <updated>2014-08-12T00:25:57Z</updated>
  <generator uri="http://blogofile.com/">Blogofile</generator>

  <link rel="alternate" type="text/html" href="http://jkitchin.github.io/blog" />
  <id>http://jkitchin.github.io/blog/feed/atom/</id>
  <link rel="self" type="application/atom+xml" href="http://jkitchin.github.io/blog/feed/atom/" />
  <entry>
    <author>
      <name></name>
      <uri>http://jkitchin.github.io/blog</uri>
    </author>
    <title type="html"><![CDATA[Linear programming example with inequality constraints]]></title>
    <link rel="alternate" type="text/html" href="http://jkitchin.github.io/blog/2013/01/31/Linear-programming-example-with-inequality-constraints" />
    <id>http://jkitchin.github.io/blog/2013/01/31/Linear-programming-example-with-inequality-constraints</id>
    <updated>2013-02-27T14:44:03Z</updated>
    <published>2013-01-31T09:00:00Z</published>
    <category scheme="http://jkitchin.github.io/blog" term="linear programming" />
    <category scheme="http://jkitchin.github.io/blog" term="optimization" />
    <summary type="html"><![CDATA[Linear programming example with inequality constraints]]></summary>
    <content type="html" xml:base="http://jkitchin.github.io/blog/2013/01/31/Linear-programming-example-with-inequality-constraints"><![CDATA[


<p>

<a href="http://matlab.cheme.cmu.edu/2011/10/21/linear-programming-example-with-inequality-constraints/" >Matlab post</a>
</p>

<p>
adapted from <a href="http://www.matrixlab-examples.com/linear-programming.html" >http://www.matrixlab-examples.com/linear-programming.html</a> which solves this problem with fminsearch.
</p>

<p>
Let us suppose that a merry farmer has 75 roods (4 roods = 1 acre) on which to plant two crops: wheat and corn. To produce these crops, it costs the farmer (for seed, water, fertilizer, etc. ) $120 per rood for the wheat, and $210 per rood for the corn. The farmer has $15,000 available for expenses, but after the harvest the farmer must store the crops while awaiting favorable or good market conditions. The farmer has storage space for 4,000 bushels. Each rood yields an average of 110 bushels of wheat or 30 bushels of corn. If the net profit per bushel of wheat (after all the expenses) is $1.30 and for corn is $2.00, how should the merry farmer plant the 75 roods to maximize profit?
</p>

<p>
Let \(x\) be the number of roods of wheat planted, and \(y\) be the number of roods of corn planted. The profit function is: \( P = (110)($1.3)x + (30)($2)y = 143x + 60y \)
</p>

<p>
There are some constraint inequalities, specified by the limits on expenses, storage and roodage. They are:
</p>

<p>
\(\$120x + \$210y <= \$15000\) (The total amount spent cannot exceed the amount the farm has)
</p>

<p>
\(110x + 30y <= 4000\) (The amount generated should not exceed storage space.)
</p>

<p>
\(x + y <= 75\) (We cannot plant more space than we have.)
</p>

<p>
\(0 <= x and 0 <= y \) (all amounts of planted land must be positive.)
</p>

<p>
To solve this problem, we cast it as a linear programming problem, which minimizes a function f(X) subject to some constraints. We create a proxy function for the negative of profit, which we seek to minimize.
</p>

<p>
f = -(143*x + 60*y)
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">from</span> scipy.optimize <span style="color: #8b0000;">import</span> fmin_cobyla

<span style="color: #8b0000;">def</span> <span style="color: #8b2323;">objective</span>(X):
    <span style="color: #228b22;">'''objective function to minimize. It is the negative of profit,</span>
<span style="color: #228b22;">    which we seek to maximize.'''</span>
    x, y = X
    <span style="color: #8b0000;">return</span> -(143*x + 60*y)

<span style="color: #8b0000;">def</span> <span style="color: #8b2323;">c1</span>(X):
    <span style="color: #228b22;">'Ensure 120x + 210y &lt;= 15000'</span>
    x,y = X
    <span style="color: #8b0000;">return</span> 15000 - 120 * x - 210*y

<span style="color: #8b0000;">def</span> <span style="color: #8b2323;">c2</span>(X):
    <span style="color: #228b22;">'ensure 110x + 30y &lt;= 4000'</span>
    x,y = X
    <span style="color: #8b0000;">return</span> 4000 - 110*x - 30 * y

<span style="color: #8b0000;">def</span> <span style="color: #8b2323;">c3</span>(X):
    <span style="color: #228b22;">'Ensure x + y is less than or equal to 75'</span>
    x,y = X
    <span style="color: #8b0000;">return</span> 75 - x - y

<span style="color: #8b0000;">def</span> <span style="color: #8b2323;">c4</span>(X):
    <span style="color: #228b22;">'Ensure x &gt;= 0'</span>
    <span style="color: #8b0000;">return</span> X[0]

<span style="color: #8b0000;">def</span> <span style="color: #8b2323;">c5</span>(X):
    <span style="color: #228b22;">'Ensure y &gt;= 0'</span>
    <span style="color: #8b0000;">return</span> X[1]

X = fmin_cobyla(objective, x0=[20, 30], cons=[c1, c2, c3, c4, c5])

<span style="color: #8b0000;">print</span> <span style="color: #228b22;">'We should plant {0:1.2f} roods of wheat.'</span>.format(X[0])
<span style="color: #8b0000;">print</span> <span style="color: #228b22;">'We should plant {0:1.2f} roods of corn'</span>.format(X[1])
<span style="color: #8b0000;">print</span> <span style="color: #228b22;">'The maximum profit we can earn is ${0:1.2f}.'</span>.format(-objective(X))
</pre>
</div>

<pre class="example">
   Normal return from subroutine COBYLA

   NFVALS =   40   F =-6.315625E+03    MAXCV = 4.547474E-13
   X = 2.187500E+01   5.312500E+01
We should plant 21.88 roods of wheat.
We should plant 53.12 roods of corn
The maximum profit we can earn is $6315.62.
</pre>

<p>
This code is not exactly the same as the original <a href="http://matlab.cheme.cmu.edu/2011/10/21/linear-programming-example-with-inequality-constraints/" >post</a>, but we get to the same answer. The linear programming capability in scipy is currently somewhat limited in 0.10. It is a little better in 0.11, but probably not as advanced as Matlab. There are some external libraries available:
</p>

<ol>
<li><a href="http://abel.ee.ucla.edu/cvxopt/" >http://abel.ee.ucla.edu/cvxopt/</a>
</li>
<li><a href="http://openopt.org/LP" >http://openopt.org/LP</a>
</li>
</ol>
<p>Copyright (C) 2013 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2013/01/31/Linear-programming-example-with-inequality-constraints.org">org-mode source</a><p>]]></content>
  </entry>
</feed>
