

<!doctype html>
<!--[if lt IE 7 ]> <html lang="en" class="no-js ie6"> <![endif]-->
<!--[if IE 7 ]>    <html lang="en" class="no-js ie7"> <![endif]-->
<!--[if IE 8 ]>    <html lang="en" class="no-js ie8"> <![endif]-->
<!--[if IE 9 ]>    <html lang="en" class="no-js ie9"> <![endif]-->
<!--[if (gt IE 9)|!(IE)]><!--> <html lang="en" class="no-js"> <!--<![endif]-->
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>The Kitchin Research Group</title>
  <meta name="google-site-verification" content="CGcacJdHc2YoZyI0Vey9XRA5qwhhFDzThKJezbRFcJ4" />
  <meta name="description" content="Chemical Engineering at Carnegie Mellon University">
  <meta name="author" content="John Kitchin">
  <link rel="alternate" type="application/rss+xml" title="RSS 2.0" href="/blog/feed" />
  <link rel="alternate" type="application/atom+xml" title="Atom 1.0" href="/blog/feed/atom" />
  <link rel="shortcut icon" href="/favicon.ico">
  <link rel="apple-touch-icon" href="/img/apple-touch-icon.png">

  <link rel="stylesheet" href="/css/base.css?v=1">
  <link rel="stylesheet" href="/css/grid.css?v=1">
  <link rel="stylesheet" media="handheld" href="/css/handheld.css?v=1">
  <link rel="stylesheet" href="/css/pygments_murphy.css" type="text/css" />

  <script src="/js/libs/modernizr-1.7.min.js"></script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        displayAlign: "center",
        displayIndent: "0em",

        "HTML-CSS": { scale: 100,
                        linebreaks: { automatic: "false" },
                        webFont: "TeX"
                       },
        SVG: {scale: 100,
              linebreaks: { automatic: "false" },
              font: "TeX"},
        NativeMML: {scale: 100},
        TeX: { equationNumbers: {autoNumber: "AMS"},
               MultLineWidth: "85%",
               TagSide: "right",
               TagIndent: ".8em"
             }
});
</script>
<script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_HTML"></script>
  <link rel="stylesheet" href="/themes/theme1/style.css?v=1">
<link href='http://fonts.googleapis.com/css?family=Roboto' rel='stylesheet' type='text/css'>

</head>
  <body>
    <div id="container" class="container container_12">
      <div id="main" role="main">
        <div id="main_block">
          <header>
<div id="header" class="header_gradient theme_font">
<table><tr><td>
    <h1><a href="/">The Kitchin Research Group</a></h1>
    <h2>Chemical Engineering at Carnegie Mellon University</h2>
</td>
<td colspan=100%><div style="float:right;width:100%;text-align:right;"> <span id='badgeCont737515' style='width:126px'><script src='http://labs.researcherid.com/mashlets?el=badgeCont737515&mashlet=badge&showTitle=false&className=a&rid=A-2363-2010'></script></span></div>
</td></tr>
</table>
</div>
  <div id="navigation" class="grid_12">

    <ul class="theme_font">
      <li><a href="/blog"
             class="">Blog</a></li>

      <li><a href="/blog/archive"
             class="">Archives</a></li>

      <li><a href="/publications.html">Publications</a></li>

      <li><a href="/research.html"
             class="">Research</a></li>

      <li><a href="/categories.html"
             class="">Categories</a></li>

      <li><a href="/about.html"
             class="">About us</a></li>

      <li><a href="/subscribe.html">Subscribe</a></li>

    </ul>
  </div>
</header>

          <div id="prose_block" class="grid_8">
            
  





<article>
  <div class="blog_post">
    <header>
      <div id="New-link-features-in-org-9"></div>
      <h2 class="blog_post_title"><a href="/blog/2016/11/04/New-link-features-in-org-9/" rel="bookmark" title="Permanent Link to New link features in org 9">New link features in org 9</a></h2>
      <p><small><span class="blog_post_date">Posted November 04, 2016 at 06:14 AM</span> | categories:
        <span class="blog_post_categories"><a href='/blog/category/orgmode/'>orgmode</a></span> | tags: 
      <p><small><span class="blog_post_date">Updated November 04, 2016 at 07:02 AM</span></small>
      </small></p>
    </header>
    <div class="post_prose">
      



<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org4d40e92">1. A colored link with a static tooltip.</a></li>
<li><a href="#org1bc1061">2. A colored link with a static tooltip and no folding.</a></li>
<li><a href="#org1c56ce9">3. A dynamic tooltip</a></li>
<li><a href="#orgc074278">4. A better file link</a></li>
<li><a href="#orgc12de23">5. A link with a new keymap.</a></li>
<li><a href="#org479a559">6. A completion example with a dynamic face for validation</a></li>
<li><a href="#org6b336b6">7. A store link example</a></li>
<li><a href="#org069cbfa">8. An activate-func example</a></li>
</ul>
</div>
</div>
<p>
Org 9.0 is finally out, and it comes with a totally overhauled link capability! This post documents some of those capabilities. These new capabilities include support for:
</p>

<ol class="org-ol">
<li>Custom link faces</li>
<li>Custom tooltips on links</li>
<li>More consistent interface for completion</li>
<li>Special keymaps on links</li>
<li>Customized folding of bracketed links</li>
</ol>

<p>
This post will make more sense with this video: <a href="https://www.youtube.com/watch?v=5haX95nk02E">https://www.youtube.com/watch?v=5haX95nk02E</a>
</p>

<iframe width="560" height="315" src="https://www.youtube.com/embed/5haX95nk02E" frameborder="0" allowfullscreen></iframe>

<div id="outline-container-org4d40e92" class="outline-2">
<h2 id="org4d40e92"><span class="section-number-2">1</span> A colored link with a static tooltip.</h2>
<div class="outline-text-2" id="text-1">
<p>
All links in elisp are now defined with org-link-set-parameters.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(org-link-set-parameters
 <span style="color: #008000;">"red"</span>
 <span style="color: #006FE0;">:follow</span> (<span style="color: #0000FF;">lambda</span> (path) (message <span style="color: #008000;">"You clicked me."</span>))
 <span style="color: #006FE0;">:export</span> (<span style="color: #0000FF;">lambda</span> (path desc backend)
           (<span style="color: #0000FF;">cond</span>
            ((eq 'html backend)
             (format <span style="color: #008000;">"&lt;font color=\"red\"&gt;%s&lt;/font&gt;"</span>
                     (<span style="color: #0000FF;">or</span> desc path)))))
 <span style="color: #006FE0;">:face</span> '(<span style="color: #006FE0;">:foreground</span> <span style="color: #008000;">"red"</span>)
 <span style="color: #006FE0;">:help-echo</span> <span style="color: #008000;">"Click me for a message."</span>)
</pre>
</div>

<p>
A <font color="red">link</font> that is colored red.  In bracketed form:  A <font color="red">link with a description</font>.
</p>

<p>
You can change a parameter like this.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(org-link-set-parameters
 <span style="color: #008000;">"red"</span>
 <span style="color: #006FE0;">:face</span> '(<span style="color: #006FE0;">:foreground</span> <span style="color: #008000;">"red"</span> <span style="color: #006FE0;">:underline</span> t))
</pre>
</div>

<p>
A <font color="red">link</font> that is colored red and underlined.
</p>

<p>
You can use any face for a link. Here we define one and use it.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #0000FF;">defface</span> <span style="color: #BA36A5;">org-link-green</span>
  '((t (<span style="color: #006FE0;">:inherit</span> org-link <span style="color: #006FE0;">:foreground</span> <span style="color: #008000;">"green"</span>)))
  <span style="color: #036A07;">"A green link."</span>)

(org-link-set-parameters
   <span style="color: #008000;">"green"</span>
   <span style="color: #006FE0;">:follow</span> (<span style="color: #0000FF;">lambda</span> (path) (message <span style="color: #008000;">"You clicked me."</span>))
   <span style="color: #006FE0;">:export</span> (<span style="color: #0000FF;">lambda</span> (path desc backend)
     (<span style="color: #0000FF;">cond</span>
      ((eq 'html backend)
       (format <span style="color: #008000;">"&lt;font color=\"green\"&gt;%s&lt;/font&gt;"</span>
               (<span style="color: #0000FF;">or</span> desc path)))))
   <span style="color: #006FE0;">:face</span> 'org-link-green
   <span style="color: #006FE0;">:help-echo</span> <span style="color: #008000;">"Click me for a message."</span>)
</pre>
</div>

<p>
A <font color="green">link</font> works.
</p>
</div>
</div>

<div id="outline-container-org1bc1061" class="outline-2">
<h2 id="org1bc1061"><span class="section-number-2">2</span> A colored link with a static tooltip and no folding.</h2>
<div class="outline-text-2" id="text-2">
<p>
This link will be shown in full unfolded form even when other links are folded in descriptive format.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(org-link-set-parameters
 <span style="color: #008000;">"red-full"</span>
 <span style="color: #006FE0;">:follow</span> (<span style="color: #0000FF;">lambda</span> (path) (message <span style="color: #008000;">"You clicked me."</span>))
 <span style="color: #006FE0;">:export</span> (<span style="color: #0000FF;">lambda</span> (path desc backend)
           (<span style="color: #0000FF;">cond</span>
            ((eq 'html backend)
             (format <span style="color: #008000;">"&lt;font color=\"red\"&gt;%s&lt;/font&gt;"</span>
                     (<span style="color: #0000FF;">or</span> desc path)))))
 <span style="color: #006FE0;">:face</span> '(<span style="color: #006FE0;">:foreground</span> <span style="color: #008000;">"red"</span>)
 <span style="color: #006FE0;">:display</span> 'full
 <span style="color: #006FE0;">:help-echo</span> <span style="color: #008000;">"Click me for a message."</span>)
</pre>
</div>

<p>
A <font color="red">link</font> that is colored red.  In bracketed form:  A <font color="red">link with a description</font>.  This regular <a href="https://doi.org/test">bracketed doi</a> is still folded.
</p>
</div>
</div>

<div id="outline-container-org1c56ce9" class="outline-2">
<h2 id="org1c56ce9"><span class="section-number-2">3</span> A dynamic tooltip</h2>
<div class="outline-text-2" id="text-3">
<p>
You can make tooltips dynamic. The function must take these arguments (window object position), and construct the tooltip from that information. Here we show what the cursor is on and the point that it is on. \(x^2\)
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #0000FF;">defun</span> <span style="color: #006699;">redd-tip</span> (window object position)
  (<span style="color: #0000FF;">save-excursion</span>
    (goto-char position)
    (goto-char (org-element-property <span style="color: #006FE0;">:begin</span> (org-element-context)))
    (<span style="color: #0000FF;">cond</span> ((looking-at org-plain-link-re)
           (format <span style="color: #008000;">"Looking at %s with mouse at %s"</span> (match-string 0) position))
          ((looking-at org-bracket-link-regexp)
           (format <span style="color: #008000;">"Looking at %s in a bracketed link with mouse at %s"</span>
                   (match-string 0) position))
          (t
           <span style="color: #008000;">"No match"</span>))))

(org-link-set-parameters
 <span style="color: #008000;">"redd"</span>
 <span style="color: #006FE0;">:face</span> '(<span style="color: #006FE0;">:underline</span> t)
 <span style="color: #006FE0;">:help-echo</span> 'redd-tip)
</pre>
</div>

<p>
A link with a dynamic tooltip: <a href="link">link</a> or this one <a href="another-link">another-link</a>     <a href="test">bracketed redd</a>
</p>
</div>
</div>

<div id="outline-container-orgc074278" class="outline-2">
<h2 id="orgc074278"><span class="section-number-2">4</span> A better file link</h2>
<div class="outline-text-2" id="text-4">
<p>
Say you want to get a menu of options for file links. For example to find the file, open it in dired, copy the link, etc&#x2026; We use helm here to make that happen.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(org-link-set-parameters
 <span style="color: #008000;">"file"</span>
 <span style="color: #006FE0;">:follow</span> (<span style="color: #0000FF;">lambda</span> (path)
           (funcall
            (helm <span style="color: #006FE0;">:sources</span>
                  `((name . <span style="color: #008000;">"Action"</span>)
                    (candidates . ,(append
                                    (<span style="color: #0000FF;">loop</span> for f in '(find-file
                                                     org-open-file)
                                          collect (cons (symbol-name f) f))
                                    '((<span style="color: #008000;">"dired"</span> . (<span style="color: #0000FF;">lambda</span> (path)
                                                   (dired (file-name-directory path))
                                                   (re-search-forward (file-name-nondirectory path))))
                                      (<span style="color: #008000;">"copy org link"</span> . (<span style="color: #0000FF;">lambda</span> (path)
                                                           (kill-new (format <span style="color: #008000;">"[[file:%s]]"</span> path)))))))
                    (action . identity)))
            path)))
</pre>
</div>

<p>
<img src="/media/hy-test.png">
</p>
</div>
</div>

<div id="outline-container-orgc12de23" class="outline-2">
<h2 id="orgc12de23"><span class="section-number-2">5</span> A link with a new keymap.</h2>
<div class="outline-text-2" id="text-5">
<p>
To get a special keymap, we have to create a new keymap. We can make a copy of org-mouse-map and add new keys to it that are specific to this link. With this link, you can use arrow-keys with a modifier key to jump between links. We define C-left and C-right to go to the previous and next links, and for fun a C-up and super-mouse-1 bindings that are in effect only on the links.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #0000FF;">defun</span> <span style="color: #006699;">prev-link</span> ()
  (<span style="color: #0000FF;">interactive</span>)
  (re-search-backward <span style="color: #008000;">"keym:"</span> nil t))

(<span style="color: #0000FF;">defun</span> <span style="color: #006699;">next-link</span> ()
  (<span style="color: #0000FF;">interactive</span>)
  (re-search-forward <span style="color: #008000;">"keym:"</span> nil t))

(org-link-set-parameters
 <span style="color: #008000;">"keym"</span>
 <span style="color: #006FE0;">:follow</span> (<span style="color: #0000FF;">lambda</span> (path)
           (<span style="color: #0000FF;">interactive</span>)
           (message <span style="color: #008000;">"You followed me."</span>))
 <span style="color: #006FE0;">:keymap</span> (<span style="color: #0000FF;">let</span> ((map (copy-keymap org-mouse-map)))
           (define-key map (kbd <span style="color: #008000;">"C-&lt;left&gt;"</span>) 'prev-link)
           (define-key map (kbd <span style="color: #008000;">"C-&lt;right&gt;"</span>) 'next-link)
           (define-key map (kbd <span style="color: #008000;">"C-&lt;up&gt;"</span>)
             (<span style="color: #0000FF;">lambda</span> ()
               (<span style="color: #0000FF;">interactive</span>)(message-box <span style="color: #008000;">"special C-up"</span>)))
           (define-key map [s-mouse-1]
             (<span style="color: #0000FF;">lambda</span> ()
               (<span style="color: #0000FF;">interactive</span>)
               (message-box <span style="color: #008000;">"s-Followed"</span>)))
           map))
</pre>
</div>


<p>
<a href="one">one</a>  then <a href="two">two</a> and finally <a href="three">three</a>
</p>
</div>
</div>

<div id="outline-container-org479a559" class="outline-2">
<h2 id="org479a559"><span class="section-number-2">6</span> A completion example with a dynamic face for validation</h2>
<div class="outline-text-2" id="text-6">
<p>
This example shows how to add a completion function, and use a dynamic face to show when a bad link has been made (in this case there are 4 allowed fruits, and anything else should be red.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #0000FF;">defun</span> <span style="color: #006699;">my-comp</span> (<span style="color: #6434A3;">&amp;optional</span> arg)
  (format <span style="color: #008000;">"fruit:%s"</span>
          (completing-read <span style="color: #008000;">"Choose a fruit: "</span> '(<span style="color: #008000;">"apple"</span> <span style="color: #008000;">"orange"</span> <span style="color: #008000;">"grapes"</span> <span style="color: #008000;">"kiwi"</span>))))

(<span style="color: #0000FF;">defun</span> <span style="color: #006699;">fruit-link-face</span> (path)
  (<span style="color: #0000FF;">if</span> (member path '(<span style="color: #008000;">"apple"</span> <span style="color: #008000;">"orange"</span> <span style="color: #008000;">"grapes"</span> <span style="color: #008000;">"kiwi"</span>))
      'org-link
    '(<span style="color: #006FE0;">:foreground</span> <span style="color: #008000;">"red"</span>)))

(<span style="color: #0000FF;">defun</span> <span style="color: #006699;">fruit-tooltip</span> (_win _obj position)
  (<span style="color: #0000FF;">save-match-data</span>
    (<span style="color: #0000FF;">save-excursion</span>
      (goto-char position)
      (<span style="color: #0000FF;">let</span> ((path (org-element-property <span style="color: #006FE0;">:path</span> (org-element-context))))
        (<span style="color: #0000FF;">if</span> (member path '(<span style="color: #008000;">"apple"</span> <span style="color: #008000;">"orange"</span> <span style="color: #008000;">"grapes"</span> <span style="color: #008000;">"kiwi"</span>))
            <span style="color: #008000;">"A fruit"</span>
          (format <span style="color: #008000;">"%s: Illegal value. Must be one of apple, orange, grapes or kiwi."</span>
                  path))))))

(org-link-set-parameters <span style="color: #008000;">"fruit"</span>
                         <span style="color: #006FE0;">:help-echo</span> 'fruit-tooltip
                         <span style="color: #006FE0;">:face</span> 'fruit-link-face
                         <span style="color: #006FE0;">:complete</span> 'my-comp)
</pre>
</div>


<p>
<a href="apple">apple</a>      <a href="orange">an orange in brackets</a>
</p>

<p>
a bad <a href="grapefruit">grapefruit</a>.        <a href="kiwi">kiwi</a>
</p>

<p>
<a href="kiwi">kiwi</a>
</p>
</div>
</div>

<div id="outline-container-org6b336b6" class="outline-2">
<h2 id="org6b336b6"><span class="section-number-2">7</span> A store link example</h2>
<div class="outline-text-2" id="text-7">
<p>
<a href="*A%20store%20link%20example">A store link example</a>
Put your  cursor on a headline, and type C-c l. Then move it and type C-c C-l to insert the link.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #0000FF;">defun</span> <span style="color: #006699;">store-my-headline</span> ()
  (<span style="color: #0000FF;">when</span> (<span style="color: #0000FF;">and</span> (eq major-mode 'org-mode)
             (org-at-heading-p))
    (org-store-link-props
     <span style="color: #006FE0;">:type</span> <span style="color: #008000;">"head"</span>
     <span style="color: #006FE0;">:link</span> (format <span style="color: #008000;">"head:*%s"</span> (nth 4 (org-heading-components)))
     <span style="color: #006FE0;">:description</span> (nth 4 (org-heading-components)))))

(<span style="color: #0000FF;">defun</span> <span style="color: #006699;">follow-head</span> (path)
  (org-open-link-from-string (format <span style="color: #008000;">"[[%s]]"</span> path)))

(org-link-set-parameters
 <span style="color: #008000;">"head"</span> <span style="color: #006FE0;">:follow</span> 'follow-head <span style="color: #006FE0;">:store</span> 'store-my-headline)
</pre>
</div>
</div>
</div>

<div id="outline-container-org069cbfa" class="outline-2">
<h2 id="org069cbfa"><span class="section-number-2">8</span> An activate-func example</h2>
<div class="outline-text-2" id="text-8">
<p>
You may want to do some additional things when a link is activated. For example, maybe it makes sense for different parts of the link to have different actions,  or colors. Here is an example where we make an rgb link of three numbers, and color each number, and make the link color dynamic.
</p>

<p>
We make a keymap so C-up increments a color, and C-down decrements a color.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #0000FF;">require</span> '<span style="color: #D0372D;">color</span>)

(<span style="color: #0000FF;">defun</span> <span style="color: #006699;">rgb-face</span> (path)
  (<span style="color: #0000FF;">let*</span> ((f (split-string path <span style="color: #008000;">","</span>))
         (red (/ (string-to-number (nth 0 f)) 255.0))
         (green (/ (string-to-number (nth 1 f)) 255.0))
         (blue (/ (string-to-number (nth 2 f)) 255.0))
         (hex (color-rgb-to-hex red green blue)))
    (list <span style="color: #006FE0;">:foreground</span> hex)))


(<span style="color: #0000FF;">defun</span> <span style="color: #006699;">rgb-func</span> (start end path bracketp)
  (<span style="color: #0000FF;">save-excursion</span>
    (goto-char start)
    (<span style="color: #0000FF;">save-match-data</span>
      (<span style="color: #0000FF;">cl-loop</span> for num in (split-string path <span style="color: #008000;">","</span>)
               for face in (list '(<span style="color: #006FE0;">:foreground</span> <span style="color: #008000;">"red"</span>)
                                 '(<span style="color: #006FE0;">:foreground</span> <span style="color: #008000;">"green"</span>)
                                 '(<span style="color: #006FE0;">:foreground</span> <span style="color: #008000;">"blue"</span>))
               do
               (<span style="color: #0000FF;">progn</span>
                 (re-search-forward num end t)
                 (add-text-properties
                  (match-beginning 0)
                  (match-end 0)
                  (list 'face face)))))))

(<span style="color: #0000FF;">defun</span> <span style="color: #006699;">ninc</span> ()
  (<span style="color: #0000FF;">interactive</span>)
  (skip-chars-backward <span style="color: #008000;">"0-9"</span>)
  (<span style="color: #0000FF;">or</span> (looking-at <span style="color: #008000;">"[0-9]+"</span>)
      (<span style="color: #ff0000; font-weight: bold;">error</span> <span style="color: #008000;">"No number at point"</span>))
  (replace-match (number-to-string (1+ (string-to-number (match-string 0))))))


(<span style="color: #0000FF;">defun</span> <span style="color: #006699;">NINC</span> ()
  (<span style="color: #0000FF;">interactive</span>)
  (<span style="color: #0000FF;">let*</span> ((link (org-element-context))
         (path (org-element-property <span style="color: #006FE0;">:path</span> link))
         (beg (org-element-property <span style="color: #006FE0;">:begin</span> link))
         (end (org-element-property <span style="color: #006FE0;">:end</span> link))
         (rgb (mapcar 'string-to-number (split-string path <span style="color: #008000;">","</span>))))
    (<span style="color: #0000FF;">setq</span> rgb (mapcar (<span style="color: #0000FF;">lambda</span> (x) (+ x 10)) rgb))
    (<span style="color: #0000FF;">setf</span> (buffer-substring beg end)
          (format <span style="color: #008000;">"rgb:%s"</span> (mapconcat 'identity (mapcar 'number-to-string rgb) <span style="color: #008000;">","</span>)))))

(<span style="color: #0000FF;">defun</span> <span style="color: #006699;">NDEC</span> ()
  (<span style="color: #0000FF;">interactive</span>)
  (<span style="color: #0000FF;">let*</span> ((link (org-element-context))
         (path (org-element-property <span style="color: #006FE0;">:path</span> link))
         (beg (org-element-property <span style="color: #006FE0;">:begin</span> link))
         (end (org-element-property <span style="color: #006FE0;">:end</span> link))
         (rgb (mapcar 'string-to-number (split-string path <span style="color: #008000;">","</span>))))
    (<span style="color: #0000FF;">setq</span> rgb (mapcar (<span style="color: #0000FF;">lambda</span> (x) (- x 10)) rgb))
    (<span style="color: #0000FF;">setf</span> (buffer-substring beg end)
          (format <span style="color: #008000;">"rgb:%s"</span> (mapconcat 'identity (mapcar 'number-to-string rgb) <span style="color: #008000;">","</span>)))))


(<span style="color: #0000FF;">defun</span> <span style="color: #006699;">ndec</span> ()
  (<span style="color: #0000FF;">interactive</span>)
  (skip-chars-backward <span style="color: #008000;">"0-9"</span>)
  (<span style="color: #0000FF;">or</span> (looking-at <span style="color: #008000;">"[0-9]+"</span>)
      (<span style="color: #ff0000; font-weight: bold;">error</span> <span style="color: #008000;">"No number at point"</span>))
  (replace-match (number-to-string (1- (string-to-number (match-string 0))))))

(org-link-set-parameters <span style="color: #008000;">"rgb"</span> <span style="color: #006FE0;">:face</span> 'rgb-face
                         <span style="color: #006FE0;">:activate-func</span> 'rgb-func
                         <span style="color: #006FE0;">:keymap</span> (<span style="color: #0000FF;">let</span> ((map (copy-keymap org-mouse-map)))
                                   (define-key map (kbd <span style="color: #008000;">"C-&lt;up&gt;"</span>) 'ninc)
                                   (define-key map (kbd <span style="color: #008000;">"C-&lt;down&gt;"</span>) 'ndec)
                                   (define-key map (kbd <span style="color: #008000;">"s-&lt;up&gt;"</span>) 'NINC)
                                   (define-key map (kbd <span style="color: #008000;">"s-&lt;down&gt;"</span>) 'NDEC)
                                   map))
</pre>
</div>


<p>
<a href="83,29,238">83,29,238</a>   This is a violet color.   <a href="112,17,19">112,17,19</a>
</p>

<p>
This is an rgb link with three comma separated numbers. We color each number accordingly, and set the rgb link to the color represented by the RGB pair.
</p>

<p>
<a href="225,225,225">225,225,225</a>  This is a light gray.
</p>

<p>
A subtle point in this example is the need to save-match-data. Some functions modify the match-data, and this will mess up the whole font-lock system. I learned that by trial and error.
</p>
</div>
</div>
<p>Copyright (C) 2016 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p>
<p><a href="/org/2016/11/04/New-link-features-in-org-9.org">org-mode source</a></p>
<p>Org-mode version = 9.0</p>


    </div>
  </div>
</article>



<a href="https://twitter.com/share" class="twitter-share-button" data-via="johnkitchin">Share on Twitter</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>


<a href="https://twitter.com/search?q=https://kitchingroup.cheme.cmu.edu/blog/2016/11/04/New-link-features-in-org-9">Discuss on Twitter</a>

  <hr class="interblog" />
 <a href="../1">« Previous Page</a>

          </div>
          <div id="sidebar" class="grid_4">
            <aside>
<section>
<script>
  (function() {
    var cx = '002533177287215655227:l7uvu35ssbc';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
        '//www.google.com/cse/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>
</section>

<section>
    <h1 class="post_header_gradient theme_font">Twitter</h1>
    <a class="twitter-timeline" href="https://twitter.com/johnkitchin" data-widget-id="545217643582881792">Tweets by @johnkitchin</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+"://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
</section>


  <section>
    <h1 class="post_header_gradient theme_font">Links</h1>
    <ul>
      <li><a href="https://www.continuum.io">Anaconda Python</a></li>
      <li><a href="/pycse">Pycse</a></li>
      <li><a href="/dft-book">DFT-book</a></li>
    </ul>
  </section>

  <section>
    <h1 class="post_header_gradient theme_font">Latest Posts</h1>
    <ul>
      <li><a href="/blog/2025/01/27/New-publication-Structure-Sensitive-Reaction-Kinetics-of-Chiral-Molecules-on-Intrinsically-Chiral-Surfaces/">New publication - Structure Sensitive Reaction Kinetics of Chiral Molecules on Intrinsically Chiral Surfaces</a></li>
      <li><a href="/blog/2024/07/04/10-years-ago-org-mode-is-awesome-video/">10 years ago - org mode is awesome video</a></li>
      <li><a href="/blog/2024/06/08/New-publication-Pourbaix-Machine-Learning-Framework-Identifies-Acidic-Water-Oxidation-Catalysts-Exhibiting-Suppressed-Ruthenium-Dissolution/">New publication - Pourbaix Machine Learning Framework Identifies Acidic Water Oxidation Catalysts Exhibiting Suppressed Ruthenium Dissolution</a></li>
      <li><a href="/blog/2024/06/06/New-publication-Surface-Segregation-Studies-in-Ternary-Noble-Metal-Alloys-Comparing-DFT-and-Machine-Learning-with-Experimental-Data/">New publication - Surface Segregation Studies in Ternary Noble Metal Alloys Comparing DFT and Machine Learning with Experimental Data</a></li>
      <li><a href="/blog/2024/05/23/New-publication-Cyclic-Steady-State-Simulation-and-Waveform-Design-for-Dynamic-Programmable-Catalysis/">New publication - Cyclic Steady-State Simulation and Waveform Design for Dynamic Programmable Catalysis</a></li>
    </ul>
  </section>

<section>
<h1 class="post_header_gradient theme_font">Latest GitHub Repos</h1>
  <a href="https://github.com/jkitchin">@jkitchin</a> on GitHub.
  <ul id="my-github-projects">
        <li class="loading">Status updating&#8230;</li>
  </ul>

</section>
</aside>

          </div>
          <div class="clear"></div>
        </div>
      </div>
      
<footer>
  <div id="footer" class="grid_12">
    <div class="grid_8">
      <p>
        <a href="/blog/feed/index.xml">RSS</a>
      </p>
    </div>
    <div class="grid_4" id="credits">
      <p>
        Copyright 2025
        John Kitchin
      </p>
      <p>
        Powered by <a href="http://www.blogofile.com">Blogofile</a>
      </p>
    </div>
  </div>
</footer>

    </div>
      <script src="//ajax.googleapis.com/ajax/libs/jquery/1.5.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="/js/libs/jquery-1.5.1.min.js"%3E%3C/script%3E'))</script>
  <script src="/js/plugins.js"></script>
  <script src="/js/script.js"></script>
  <script src="/js/jquery.tweet.js"></script>  
  <script src="/js/site.js"></script>
  <!--[if lt IE 7 ]>
  <script src="js/libs/dd_belatedpng.js"></script>
  <script> DD_belatedPNG.fix('img, .png_bg');</script>
  <![endif]-->
 
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-PH8NF4F0RE"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-PH8NF4F0RE');
</script>


  </body>
</html>






<script src="http://ajax.microsoft.com/ajax/jquery/jquery-1.4.2.min.js" type="text/javascript"></script>
<script src="/js/git.js" type="text/javascript"></script>
<script type="text/javascript">
    $(function() {
     $("#my-github-projects").loadRepositories("jkitchin");
    });
</script>



