

<!doctype html>
<!--[if lt IE 7 ]> <html lang="en" class="no-js ie6"> <![endif]-->
<!--[if IE 7 ]>    <html lang="en" class="no-js ie7"> <![endif]-->
<!--[if IE 8 ]>    <html lang="en" class="no-js ie8"> <![endif]-->
<!--[if IE 9 ]>    <html lang="en" class="no-js ie9"> <![endif]-->
<!--[if (gt IE 9)|!(IE)]><!--> <html lang="en" class="no-js"> <!--<![endif]-->
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>The Kitchin Research Group</title>
  <meta name="google-site-verification" content="CGcacJdHc2YoZyI0Vey9XRA5qwhhFDzThKJezbRFcJ4" />
  <meta name="description" content="Chemical Engineering at Carnegie Mellon University">
  <meta name="author" content="John Kitchin">
  <link rel="alternate" type="application/rss+xml" title="RSS 2.0" href="/blog/feed" />
  <link rel="alternate" type="application/atom+xml" title="Atom 1.0" href="/blog/feed/atom" />
  <link rel="shortcut icon" href="/favicon.ico">
  <link rel="apple-touch-icon" href="/img/apple-touch-icon.png">

  <link rel="stylesheet" href="/css/base.css?v=1">
  <link rel="stylesheet" href="/css/grid.css?v=1">
  <link rel="stylesheet" media="handheld" href="/css/handheld.css?v=1">
  <link rel="stylesheet" href="/css/pygments_murphy.css" type="text/css" />

  <script src="/js/libs/modernizr-1.7.min.js"></script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        displayAlign: "center",
        displayIndent: "0em",

        "HTML-CSS": { scale: 100,
                        linebreaks: { automatic: "false" },
                        webFont: "TeX"
                       },
        SVG: {scale: 100,
              linebreaks: { automatic: "false" },
              font: "TeX"},
        NativeMML: {scale: 100},
        TeX: { equationNumbers: {autoNumber: "AMS"},
               MultLineWidth: "85%",
               TagSide: "right",
               TagIndent: ".8em"
             }
});
</script>
<script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_HTML"></script>
  <link rel="stylesheet" href="/themes/theme1/style.css?v=1">
<link href='http://fonts.googleapis.com/css?family=Roboto' rel='stylesheet' type='text/css'>

</head>
  <body>
    <div id="container" class="container container_12">
      <div id="main" role="main">
        <div id="main_block">
          <header>
<div id="header" class="header_gradient theme_font">
<table><tr><td>
    <h1><a href="/">The Kitchin Research Group</a></h1>
    <h2>Chemical Engineering at Carnegie Mellon University</h2>
</td>
<td colspan=100%><div style="float:right;width:100%;text-align:right;"> <span id='badgeCont737515' style='width:126px'><script src='http://labs.researcherid.com/mashlets?el=badgeCont737515&mashlet=badge&showTitle=false&className=a&rid=A-2363-2010'></script></span></div>
</td></tr>
</table>
</div>
  <div id="navigation" class="grid_12">

    <ul class="theme_font">
      <li><a href="/blog"
             class="">Blog</a></li>

      <li><a href="/blog/archive"
             class="">Archives</a></li>

      <li><a href="/publications.html">Publications</a></li>

      <li><a href="/research.html"
             class="">Research</a></li>

      <li><a href="/categories.html"
             class="">Categories</a></li>

      <li><a href="/about.html"
             class="">About us</a></li>

      <li><a href="/subscribe.html">Subscribe</a></li>

    </ul>
  </div>
</header>

          <div id="prose_block" class="grid_8">
            
  





<article>
  <div class="blog_post">
    <header>
      <div id="Solving-nonlinear-algebra-problems-with-internal-state-information"></div>
      <h2 class="blog_post_title"><a href="/blog/2018/09/24/Solving-nonlinear-algebra-problems-with-internal-state-information/" rel="bookmark" title="Permanent Link to Solving nonlinear algebra problems with internal state information">Solving nonlinear algebra problems with internal state information</a></h2>
      <p><small><span class="blog_post_date">Posted September 24, 2018 at 03:25 PM</span> | categories:
        <span class="blog_post_categories"><a href='/blog/category/nonlinear-algebra/'>nonlinear algebra</a>, <a href='/blog/category/python/'>python</a></span> | tags: 
      </small></p>
    </header>
    <div class="post_prose">
      



<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org532d5ce">1. First approach</a></li>
<li><a href="#orga01a4af">2. Second approach - use a state dictionary as an arg in the objective function</a></li>
<li><a href="#orgc590864">3. third approach - a callable object</a></li>
<li><a href="#orgaef298d">4. Summary</a></li>
</ul>
</div>
</div>
<p>
In engineering, we often need to solve an equation in one variable, and then use the solution to compute other variables. For example, we might want the bubble point temperature of a mixture, and then to determine the composition of the vapor phase that has formed. In other words, we compute the temperature, and then have to use it in a subsequent step to get the composition. Here is a bubble point computation adapted from example 10.2 in Smith and van Ness, Introduction to Chemical Engineering Thermodynamics.
</p>

<p>
Given a solution of acetone (x<sub>1</sub>=0.3), acetonitrile (x<sub>2</sub>=0.45) and nitromethane (x<sub>3</sub>=0.25) at a total pressure of 80 kPa, compute the bubble point temperature and gas phase composition.
</p>

<p>
The key here is to find a temperature where the gas-phase mole fractions sum to one. The gas phase mole fractions are defined by:
</p>

<p>
\(y_i = x_i Pvap_i(T) / P\)
</p>

<p>
The typical way I would teach students how solve this looks like this. It uses the Antoine equation coded below to estimate the vapor pressure of each component as a function of temperature, and then uses fsolve to find a temperature where the gas-phase mole fractions sum to one.
</p>

<div class="org-src-container">
<pre class="src src-ipython"><span style="color: #0000FF;">import</span> numpy <span style="color: #0000FF;">as</span> np
<span style="color: #0000FF;">from</span> scipy.optimize <span style="color: #0000FF;">import</span> fsolve

<span style="color: #BA36A5;">acetone</span> = (14.5463, 2940.46, 237.22)
<span style="color: #BA36A5;">acetonitrile</span> = (14.2724, 2945.47,224)
<span style="color: #BA36A5;">nitromethane</span> = (14.2043, 2972.64, 209)

<span style="color: #0000FF;">def</span> <span style="color: #006699;">antoine</span>(T, A, B, C):
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #BA36A5;">T</span> = <span style="color: #006FE0;">float</span>(T) <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">there is some subtle issue that comes up when T is an array,</span>
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #9B9B9B; background-color: #EDEDED;"> </span><span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">as passed in from fsolve. It needs to be a float, or you get</span>
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #9B9B9B; background-color: #EDEDED;"> </span><span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">the wrong answer.</span>
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #0000FF;">return</span> np.exp(A - B / (T + C))

<span style="color: #BA36A5;">x</span> = np.array([0.3, 0.45, 0.25])
<span style="color: #BA36A5;">P</span> = 80

<span style="color: #0000FF;">def</span> <span style="color: #006699;">objective</span>(T):
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #BA36A5;">Pvap</span> = np.array([antoine(T, *pars) <span style="color: #0000FF;">for</span> pars <span style="color: #0000FF;">in</span> [acetone, acetonitrile, nitromethane]])
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #BA36A5;">y</span> = x * Pvap / P
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #0000FF;">return</span> 1 - y.<span style="color: #006FE0;">sum</span>()

Tans, = fsolve(objective, 70)

<span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">This is where we end up repeating code</span>
<span style="color: #BA36A5;">Pvap</span> = np.array([antoine(Tans, *pars) <span style="color: #0000FF;">for</span> pars <span style="color: #0000FF;">in</span> [acetone, acetonitrile, nitromethane]])
<span style="color: #BA36A5;">y</span> = x * Pvap / P

<span style="color: #0000FF;">print</span>(f<span style="color: #008000;">'The bubble point temperature is {Tans:1.2f} degC, and the gas phase compositions are {np.round(y, 4)}.'</span>)
</pre>
</div>

<pre class="example">
The bubble point temperature is 68.60 degC, and the gas phase compositions are [ 0.5196  0.3773  0.1031].


</pre>

<p>
This solution works fine, but there is in my opinion, an issue with the small amount of repeated code at the end that is required to get the composition of the gas-phase. This is a small problem here, but as the problems get bigger it is more and more tedious to correctly repeat all the code to see what the state of a system is at the solution, and it seems wasteful to have to repeat the computations; they were known in the objective function. In the following subsections, I explore some alternative approaches to reduce the repetition.
</p>

<div id="outline-container-org532d5ce" class="outline-2">
<h2 id="org532d5ce"><span class="section-number-2">1</span> First approach</h2>
<div class="outline-text-2" id="text-1">
<p>
There are two small chunks of repeated code in the example above. One way to minimize the amount of repeated code is to pull these out into reusable functions. Here, we do that, and only have to repeat one function call at the end to get the system composition out.
</p>

<div class="org-src-container">
<pre class="src src-ipython"><span style="color: #0000FF;">import</span> numpy <span style="color: #0000FF;">as</span> np
<span style="color: #0000FF;">from</span> scipy.optimize <span style="color: #0000FF;">import</span> fsolve

<span style="color: #BA36A5;">acetone</span> = (14.5463, 2940.46, 237.22)
<span style="color: #BA36A5;">acetonitrile</span> = (14.2724, 2945.47,224)
<span style="color: #BA36A5;">nitromethane</span> = (14.2043, 2972.64, 209)

<span style="color: #0000FF;">def</span> <span style="color: #006699;">antoine</span>(T, A, B, C):
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #BA36A5;">T</span> = <span style="color: #006FE0;">float</span>(T) <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">there is some subtle issue that comes up when T is an array,</span>
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #9B9B9B; background-color: #EDEDED;"> </span><span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">as passed in from fsolve. It needs to be a float, or you get</span>
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #9B9B9B; background-color: #EDEDED;"> </span><span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">the wrong answer.</span>
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #0000FF;">return</span> np.exp(A - B / (T + C))

<span style="color: #BA36A5;">x</span> = np.array([0.3, 0.45, 0.25])
<span style="color: #BA36A5;">P</span> = 80

<span style="color: #0000FF;">def</span> <span style="color: #006699;">Pvap</span>(T):
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #0000FF;">return</span> np.array([antoine(T, *pars) <span style="color: #0000FF;">for</span> pars <span style="color: #0000FF;">in</span> [acetone, acetonitrile, nitromethane]])

<span style="color: #0000FF;">def</span> <span style="color: #006699;">y</span>(T):
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #0000FF;">return</span> x * Pvap(T) / P

<span style="color: #0000FF;">def</span> <span style="color: #006699;">objective</span>(T):
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #0000FF;">return</span> 1 - y(T).<span style="color: #006FE0;">sum</span>()

Tans, = fsolve(objective, 70)

<span style="color: #BA36A5;">yans</span> = y(Tans) <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">minimal repetition of a calculation to get the composition state.</span>

<span style="color: #0000FF;">print</span>(f<span style="color: #008000;">'The bubble point temperature is {Tans:1.2f} degC, and the gas phase compositions are {np.round(yans, 4)}.'</span>)
</pre>
</div>

<pre class="example">
The bubble point temperature is 68.60 degC, and the gas phase compositions are [ 0.5196  0.3773  0.1031].


</pre>

<p>
That is a small improvement. The code is not much shorter, just reorganized for easier reuse. It would be easy in this case to also get the vapor pressures of each species at this temperature, just by calling the <code>Pvap</code> function. Still, it feels annoying we have to recalculate the answer to something you know must have already been known when the objective function was evaluated.
</p>
</div>
</div>

<div id="outline-container-orga01a4af" class="outline-2">
<h2 id="orga01a4af"><span class="section-number-2">2</span> Second approach - use a state dictionary as an arg in the objective function</h2>
<div class="outline-text-2" id="text-2">
<p>
In this approach, we will use a dictionary to store the state of the objective function. The dictionary will be in the global namespace, and we will just update it each time the objective function is called.
</p>

<div class="org-src-container">
<pre class="src src-ipython"><span style="color: #0000FF;">import</span> numpy <span style="color: #0000FF;">as</span> np
<span style="color: #0000FF;">from</span> scipy.optimize <span style="color: #0000FF;">import</span> fsolve

<span style="color: #BA36A5;">acetone</span> = (14.5463, 2940.46, 237.22)
<span style="color: #BA36A5;">acetonitrile</span> = (14.2724, 2945.47,224)
<span style="color: #BA36A5;">nitromethane</span> = (14.2043, 2972.64, 209)

<span style="color: #0000FF;">def</span> <span style="color: #006699;">antoine</span>(T, A, B, C):
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #0000FF;">return</span> np.exp(A - B / (T + C))

<span style="color: #BA36A5;">x</span> = np.array([0.3, 0.45, 0.25])

<span style="color: #BA36A5;">state</span> = {}

<span style="color: #BA36A5;">P</span> = 80


<span style="color: #0000FF;">def</span> <span style="color: #006699;">objective</span>(T, state):
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #BA36A5;">T</span> = <span style="color: #006FE0;">float</span>(T)
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #BA36A5;">Pvap</span> = np.array([antoine(T, *pars) <span style="color: #0000FF;">for</span> pars <span style="color: #0000FF;">in</span> [acetone, acetonitrile, nitromethane]])
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #BA36A5;">y</span> = x * Pvap / P
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   state.update({<span style="color: #008000;">'y'</span>: y,
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #9B9B9B; background-color: #EDEDED;"> </span> <span style="color: #008000;">'T'</span>:  T,
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #9B9B9B; background-color: #EDEDED;"> </span> <span style="color: #008000;">'Pvap'</span>: Pvap,
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #9B9B9B; background-color: #EDEDED;"> </span> <span style="color: #008000;">'z'</span>: 1 - y.<span style="color: #006FE0;">sum</span>()})
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #0000FF;">return</span> state[<span style="color: #008000;">'z'</span>]

Tans, = fsolve(objective, 70, args=(state,))

<span style="color: #0000FF;">print</span>(f<span style="color: #008000;">'The bubble point temperature is {Tans:1.2f} degC, and the gas phase compositions are {np.round(state["y"], 4)}.'</span>)
<span style="color: #0000FF;">print</span>(Tans- state[<span style="color: #008000;">'T'</span>]) <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">check to make sure last value from objective is the same as the solution</span>
state
</pre>
</div>

<pre class="example">
The bubble point temperature is 68.60 degC, and the gas phase compositions are [ 0.5196  0.3773  0.1031].
0.0


</pre>

<pre class="example">
{'Pvap': array([ 138.5620209 ,   67.07966082,   32.98218545]),
 'T': 68.60064626680659,
 'y': array([ 0.51960758,  0.37732309,  0.10306933]),
 'z': -3.4194869158454821e-14}

</pre>

<p>
What we see in the <code>state</code> dictionary is the result from the last time that the objective function was called. It appears that the list time it was called is also where the solution comes from, so the other variables stored here should be consistent. Now you can see we have access to both the Pvap and y composition data from the solution without needing any further computations. This approach could be easily extended to store any derived quantities that represent internal states you want. We don't store any history in this, but you could by appending to lists in the dictionary.
</p>

<p>
One <i>feature</i> of this is the state dictionary is updated by side effect, and you have to use the state dictionary as an argument parameter to the function.
</p>
</div>
</div>


<div id="outline-container-orgc590864" class="outline-2">
<h2 id="orgc590864"><span class="section-number-2">3</span> third approach - a callable object</h2>
<div class="outline-text-2" id="text-3">
<p>
A standard approach to tracking state data is to encapsulate it in a class. fsolve requires a callable function that returns zero at the solution. It is possible to make an object <i>act like a callable function</i> if we define a <code>__call__</code> method on it. Then, in this method, we can set attributes on the object to keep track of the state, similar to what we did with the dictionary. Since we have a class, we can define some other special dunder methods, e.g. to print the solution. Here is one implementation.
</p>

<div class="org-src-container">
<pre class="src src-ipython"><span style="color: #0000FF;">import</span> numpy <span style="color: #0000FF;">as</span> np
<span style="color: #0000FF;">from</span> scipy.optimize <span style="color: #0000FF;">import</span> fsolve

<span style="color: #0000FF;">class</span> <span style="color: #6434A3;">Objective</span>(<span style="color: #006FE0;">object</span>):
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #BA36A5;">acetone</span> = (14.5463, 2940.46, 237.22)
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #BA36A5;">acetonitrile</span> = (14.2724, 2945.47,224)
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #BA36A5;">nitromethane</span> = (14.2043, 2972.64, 209)

<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #0000FF;">def</span> <span style="color: #006699;">__init__</span>(<span style="color: #0000FF;">self</span>, x, P):
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #0000FF;">self</span>.x = np.array(x)
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #0000FF;">self</span>.P = P

<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #0000FF;">def</span> <span style="color: #006699;">antoine</span>(<span style="color: #0000FF;">self</span>, T, A, B, C):
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #0000FF;">return</span> np.exp(A - B / (T + C))

<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #0000FF;">def</span> <span style="color: #006699;">__str__</span>(<span style="color: #0000FF;">self</span>):
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #BA36A5;">s</span> = f<span style="color: #008000;">'The bubble point temperature is {self.T:1.2f} degC, and the gas phase compositions are {np.round(self.y, 4)}.'</span>
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #0000FF;">return</span> s

<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #0000FF;">def</span> <span style="color: #006699;">__call__</span>(<span style="color: #0000FF;">self</span>, T):
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #BA36A5;">T</span> = <span style="color: #006FE0;">float</span>(T)
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #0000FF;">self</span>.T = T
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #0000FF;">self</span>.Pvap = np.array([<span style="color: #0000FF;">self</span>.antoine(T, *pars) <span style="color: #0000FF;">for</span> pars <span style="color: #0000FF;">in</span> [<span style="color: #0000FF;">self</span>.acetone, <span style="color: #0000FF;">self</span>.acetonitrile, <span style="color: #0000FF;">self</span>.nitromethane]])
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #0000FF;">self</span>.y = <span style="color: #0000FF;">self</span>.x * <span style="color: #0000FF;">self</span>.Pvap / <span style="color: #0000FF;">self</span>.P
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #0000FF;">return</span> 1 - <span style="color: #0000FF;">self</span>.y.<span style="color: #006FE0;">sum</span>()

<span style="color: #BA36A5;">obj</span> = Objective(x=np.array([0.3, 0.45, 0.25]), P=80)
ans, = fsolve(obj, 60)

<span style="color: #0000FF;">print</span>(obj)
</pre>
</div>

<pre class="example">
The bubble point temperature is 68.60 degC, and the gas phase compositions are [ 0.5196  0.3773  0.1031].


</pre>


<p>
Similar to the state dictionary approach, there is no repeated code here, and no repeated evaluations to get to the state after the solution. This is a bit more advanced Python than the state dictionary. Note, this implementation doesn't have any checking in it, so if you try to print the object before calling fsolve, you will get an error because the attributes don't exist until <i>after</i> the object has been called. That is also an issue with the state dictionary above.
</p>

<p>
There are many choices you could make in constructing this example. Maybe this one has gone too far in encapsulating the antoine function as a method. That limits its reusability for another problem. On the other hand, you can reuse it for any other pressure or liquid composition of acetone, acetonitrile and nitromethane very readily.
</p>
</div>
</div>

<div id="outline-container-orgaef298d" class="outline-2">
<h2 id="orgaef298d"><span class="section-number-2">4</span> Summary</h2>
<div class="outline-text-2" id="text-4">
<p>
We looked at three ways to reduce having redundant code in the solution to problems involving nonlinear algebra. The first approach is conceptually simple; you break out as much as you can into reusable functions, and then at most have repeated function calls. These computations are usually not expensive, so repeating them is mostly tedious and provides opportunities for mistakes. This is probably what I will stick to for teaching students that are just seeing this for the first time.
</p>

<p>
The second approach used a dictionary (other data structures could work too) as an argument to the objective function, and internal states were kept in the dictionary so that after the problem was solved, you have immediate access to them. This is more advanced than the first approach because it requires understanding that the dictionary is modified as a side effect of solving the problem.
</p>

<p>
Finally,  we considered an object-oriented class encapsulation of the information we wanted. I consider this the most advanced Python solution, since it requires some understanding of classes, dunder methods and attributes, and how to make an instance of a class.
</p>

<p>
The last two methods seem like candidates for an advanced class in problem solving. Thoughts?
</p>
</div>
</div>
<p>Copyright (C) 2018 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p>
<p><a href="/org/2018/09/24/Solving-nonlinear-algebra-problems-with-internal-state-information.org">org-mode source</a></p>
<p>Org-mode version = 9.1.13</p>

    </div>
  </div>
</article>



<a href="https://twitter.com/share" class="twitter-share-button" data-via="johnkitchin">Share on Twitter</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>


<a href="https://twitter.com/search?q=https://kitchingroup.cheme.cmu.edu/blog/2018/09/24/Solving-nonlinear-algebra-problems-with-internal-state-information">Discuss on Twitter</a>

  <hr class="interblog" />
  





<article>
  <div class="blog_post">
    <header>
      <div id="Integration-of-the-heat-capacity"></div>
      <h2 class="blog_post_title"><a href="/blog/2018/09/05/Integration-of-the-heat-capacity/" rel="bookmark" title="Permanent Link to Integration of the heat capacity">Integration of the heat capacity</a></h2>
      <p><small><span class="blog_post_date">Posted September 05, 2018 at 01:48 PM</span> | categories:
        <span class="blog_post_categories"><a href='/blog/category/uncategorized/'>uncategorized</a></span> | tags: 
      </small></p>
    </header>
    <div class="post_prose">
      



<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#orgf41bb27">1. Integrate the heat capacity</a>
<ul>
<li><a href="#orgf021687">1.1. solution&#xa0;&#xa0;&#xa0;<span class="tag"><span class="solution">solution</span></span></a></li>
</ul>
</li>
<li><a href="#orgebff74a">2. Verify via &Delta; H</a>
<ul>
<li><a href="#orgb0cce22">2.1. solution&#xa0;&#xa0;&#xa0;<span class="tag"><span class="solution">solution</span></span></a></li>
</ul>
</li>
</ul>
</div>
</div>
<p>
From thermodynamics, the heat capacity is defined as \(C_p = \left(\frac{dH}{dT}\right)_P\). That means we can calculate the heat required to change the temperature of some material from the following integral:
</p>

<p>
\(H_2 - H_1 = Q = \int_{T_1}^{T_2} C_p(T) dT\)
</p>

<p>
In the range of 298-1200K, the heat capacity of CO<sub>2</sub> is given by a <a href="https://webbook.nist.gov/cgi/cbook.cgi?ID=C124389&amp;Units=SI&amp;Mask=1#Thermo-Gas">Shomate polynomial</a>:
</p>

<p>
\(C_p(t) = A + B t + C t^2 + D t^3 + E/t^2\) with units of J/mol/K.
</p>

<p>
where \(t = T / 1000\), and \(T\) is the temperature in K. The constants in the equation are
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">&#xa0;</th>
<th scope="col" class="org-right">value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">A</td>
<td class="org-right">24.99735</td>
</tr>

<tr>
<td class="org-left">B</td>
<td class="org-right">55.18696</td>
</tr>

<tr>
<td class="org-left">C</td>
<td class="org-right">-33.69137</td>
</tr>

<tr>
<td class="org-left">D</td>
<td class="org-right">7.948387</td>
</tr>

<tr>
<td class="org-left">E</td>
<td class="org-right">-0.136638</td>
</tr>

<tr>
<td class="org-left">F</td>
<td class="org-right">-403.6075</td>
</tr>

<tr>
<td class="org-left">G</td>
<td class="org-right">228.2431</td>
</tr>

<tr>
<td class="org-left">H</td>
<td class="org-right">-393.5224</td>
</tr>
</tbody>
</table>

<div id="outline-container-orgf41bb27" class="outline-2">
<h2 id="orgf41bb27"><span class="section-number-2">1</span> Integrate the heat capacity</h2>
<div class="outline-text-2" id="text-1">
<p>
Use this information to compute the energy (Q in kJ/mol) required to raise the temperature of CO<sub>2</sub> from 300K to 600K. You should use <code>scipy.integrate.quad</code> to perform the integration.
</p>

<div class="org-src-container">
<pre class="src src-ipython">
</pre>
</div>
</div>

<div id="outline-container-orgf021687" class="outline-3">
<h3 id="orgf021687"><span class="section-number-3">1.1</span> solution&#xa0;&#xa0;&#xa0;<span class="tag"><span class="solution">solution</span></span></h3>
<div class="outline-text-3" id="text-1-1">
<div class="org-src-container">
<pre class="src src-ipython"><span style="color: #BA36A5;">A</span> =  24.99735
<span style="color: #BA36A5;">B</span> =  55.18696
<span style="color: #BA36A5;">C</span> = -33.69137
<span style="color: #BA36A5;">D</span> =  7.948387
<span style="color: #BA36A5;">E</span> = -0.136638
<span style="color: #BA36A5;">F</span> = -403.6075
<span style="color: #BA36A5;">G</span> =  228.2431
<span style="color: #BA36A5;">H</span> = -393.5224

<span style="color: #0000FF;">def</span> <span style="color: #006699;">Cp</span>(T):
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #BA36A5;">t</span> = T / 1000
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #0000FF;">return</span> A + B*t + C*t**2 + D*t**3 + E / t**2

<span style="color: #0000FF;">from</span> scipy.integrate <span style="color: #0000FF;">import</span> quad

<span style="color: #BA36A5;">dH</span>, <span style="color: #BA36A5;">_</span> = quad(Cp, 300, 600)
<span style="color: #0000FF;">print</span>(f<span style="color: #008000;">'The change in enthalpy is {dH / 1000:1.3f} kJ/mol'</span>)
</pre>
</div>

<pre class="example">
The change in enthalpy is 12.841 kJ/mol


</pre>
</div>
</div>
</div>


<div id="outline-container-orgebff74a" class="outline-2">
<h2 id="orgebff74a"><span class="section-number-2">2</span> Verify via &Delta; H</h2>
<div class="outline-text-2" id="text-2">
<p>
The change in enthalpy (in kJ / mol) from standard state is
</p>

<p>
\(dH − dH_{298.15}= A t + B t^2/2 + C t^3/3 + D t^4/4 − E/t + F − H\)
</p>

<p>
again, \(t = T / 1000\).
</p>

<p>
Use this equation to compute the change in enthalpy when you increase the temperature from 300 K to 600 K.
</p>

<div class="org-src-container">
<pre class="src src-ipython">
</pre>
</div>
</div>


<div id="outline-container-orgb0cce22" class="outline-3">
<h3 id="orgb0cce22"><span class="section-number-3">2.1</span> solution&#xa0;&#xa0;&#xa0;<span class="tag"><span class="solution">solution</span></span></h3>
<div class="outline-text-3" id="text-2-1">
<div class="org-src-container">
<pre class="src src-ipython"><span style="color: #0000FF;">def</span> <span style="color: #006699;">dH</span>(T):
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #BA36A5;">t</span> = T / 1000
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #0000FF;">return</span> A * t + B*t**2 / 2 + C * t**3 / 3 + D * t**4 / 4 - E/t + F - H

<span style="color: #0000FF;">print</span>(f<span style="color: #008000;">'The change in enthalpy is {dH(600) - dH(300):1.3f} kJ/mol'</span>)
</pre>
</div>

<pre class="example">
The change in enthalpy is 12.841 kJ/mol


</pre>
</div>
</div>
</div>
<p>Copyright (C) 2018 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p>
<p><a href="/org/2018/09/05/Integration-of-the-heat-capacity.org">org-mode source</a></p>
<p>Org-mode version = 9.1.13</p>

    </div>
  </div>
</article>



<a href="https://twitter.com/share" class="twitter-share-button" data-via="johnkitchin">Share on Twitter</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>


<a href="https://twitter.com/search?q=https://kitchingroup.cheme.cmu.edu/blog/2018/09/05/Integration-of-the-heat-capacity">Discuss on Twitter</a>

  <hr class="interblog" />
  





<article>
  <div class="blog_post">
    <header>
      <div id="A-new-ode-integrator-function-in-scipy"></div>
      <h2 class="blog_post_title"><a href="/blog/2018/09/04/A-new-ode-integrator-function-in-scipy/" rel="bookmark" title="Permanent Link to A new ode integrator function in scipy">A new ode integrator function in scipy</a></h2>
      <p><small><span class="blog_post_date">Posted September 04, 2018 at 09:20 PM</span> | categories:
        <span class="blog_post_categories"><a href='/blog/category/ode/'>ode</a>, <a href='/blog/category/scipy/'>scipy</a></span> | tags: 
      </small></p>
    </header>
    <div class="post_prose">
      



<p>
I learned recently about a new way to solve ODEs in scipy: <a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.solve_ivp.html">scipy.integrate.solve_ivp</a>. This new function is recommended instead of <code>scipy.integrate.odeint</code> for new code. This function caught my eye because it added functionality that was previously missing, and that I had written into my pycse package. That functionality is events.
</p>

<p>
To explore how to use this new function, I will recreate an old <a href="http://kitchingroup.cheme.cmu.edu/blog/2013/01/28/Mimicking-ode-events-in-python/">blog post</a> where I used events to count the number of roots in a function. Spoiler alert: it may not be ready for production.
</p>

<p>
The question at hand is how many roots are there in \(f(x) = x^3 + 6x^2 - 4x - 24\), and what are they. Now, I know there are three roots and that you can use <code>np.roots</code> for this, but that
only works for polynomials. Here they are, so we know what we are looking for.
</p>

<div class="org-src-container">
<pre class="src src-ipython"><span style="color: #0000FF;">import</span> numpy <span style="color: #0000FF;">as</span> np
np.roots([1, 6, -4, -24])
</pre>
</div>

<pre class="example">
array([-6.,  2., -2.])

</pre>

<p>
The point of this is to find a more general way to count roots in an interval. We do it by integrating the derivative of the function, and using an event function to  count when the function is equal to zero. First, we define the derivative:
</p>

<p>
\(f'(x) = 3x^2 + 12x - 4\), and the value of our original function at some value that is the beginning of the range we want to consider, say \(f(-8) = -120\). Now, we have an ordinary differential equation that can be integrated. Our event function is simply, it is just the function value \(y\). In the next block, I include an optional t_eval arg so we can see the solution at more points.
</p>

<div class="org-src-container">
<pre class="src src-ipython"><span style="color: #0000FF;">def</span> <span style="color: #006699;">fprime</span>(x, y):
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #0000FF;">return</span> 3 * x**2 + 12 * x - 4

<span style="color: #0000FF;">def</span> <span style="color: #006699;">event</span>(x, y):
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #0000FF;">return</span> y

<span style="color: #0000FF;">import</span> numpy <span style="color: #0000FF;">as</span> np
<span style="color: #0000FF;">from</span> scipy.integrate <span style="color: #0000FF;">import</span> solve_ivp
<span style="color: #BA36A5;">sol</span> = solve_ivp(fprime, (-8, 4), np.array([-120]), t_eval=np.linspace(-8, 4, 10), events=[event])
sol
</pre>
</div>

<pre class="example">
 message: 'The solver successfully reached the interval end.'
    nfev: 26
    njev: 0
     nlu: 0
     sol: None
  status: 0
 success: True
       t: array([-8.        , -6.66666667, -5.33333333, -4.        , -2.66666667,
      -1.33333333,  0.        ,  1.33333333,  2.66666667,  4.        ])
t_events: [array([-6.])]
       y: array([[-120.        ,  -26.96296296,   16.2962963 ,   24.        ,
         10.37037037,  -10.37037037,  -24.        ,  -16.2962963 ,
         26.96296296,  120.        ]])

</pre>

<div class="org-src-container">
<pre class="src src-ipython">sol.t_events
</pre>
</div>

<pre class="example">
[array([-6.])]

</pre>

<p>
Huh. That is not what I expected. There should be three values in sol.t_events, but there is only one. Looking at sol.y, you can see there are three sign changes, which means three zeros. The graph here confirms that.
</p>

<div class="org-src-container">
<pre class="src src-ipython">%matplotlib inline
<span style="color: #0000FF;">import</span> matplotlib.pyplot <span style="color: #0000FF;">as</span> plt
plt.plot(sol.t, sol.y[0])
</pre>
</div>

<pre class="example">
[&lt;matplotlib.lines.Line2D at 0x151281d860&gt;]

</pre>



<p>
<img src="/media/e56c3df20f7d52f874861f0041da6fd5-18185E.png"> 
</p>

<p>
What appears to be happening is that the events are only called during the solver steps, which are <i>different</i> than the t_eval steps. It appears a workaround is to specify a max_step that can be taken by the solver to force the event functions to be evaluated more often. Adding this seems to create a new cryptic warning.
</p>

<div class="org-src-container">
<pre class="src src-ipython"><span style="color: #BA36A5;">sol</span> = solve_ivp(fprime, (-8, 4), np.array([-120]), events=[event], max_step=1.0)
sol
</pre>
</div>

<pre class="example">
/Users/jkitchin/anaconda/lib/python3.6/site-packages/scipy/integrate/_ivp/rk.py:145: RuntimeWarning: divide by zero encountered in double_scalars
  max(1, SAFETY * error_norm ** (-1 / (order + 1))))


</pre>

<pre class="example">
 message: 'The solver successfully reached the interval end.'
    nfev: 80
    njev: 0
     nlu: 0
     sol: None
  status: 0
 success: True
       t: array([-8.        , -7.89454203, -6.89454203, -5.89454203, -4.89454203,
      -3.89454203, -2.89454203, -1.89454203, -0.89454203,  0.10545797,
       1.10545797,  2.10545797,  3.10545797,  4.        ])
t_events: [array([-6., -2.,  2.])]
       y: array([[-120.        , -110.49687882,  -38.94362768,    3.24237128,
         22.06111806,   23.51261266,   13.59685508,   -1.68615468,
        -16.33641662,  -24.35393074,  -19.73869704,    3.50928448,
         51.39001383,  120.        ]])

</pre>

<div class="org-src-container">
<pre class="src src-ipython">sol.t_events
</pre>
</div>

<pre class="example">
[array([-6., -2.,  2.])]

</pre>

<p>
That is more like it. Here, I happen to know the answers, so we are safe setting a max_step of 1.0, but that feels awkward and unreliable. You don't want this max_step to be too small, because it probably makes for more computations. On the other hand, it can't be too large either because you might miss roots. It seems there is room for improvement on this.
</p>

<p>
It also seems odd that the solve_ivp only returns the t_events, and not also the corresponding solution values. I guess in this case, we know the solution values are zero at t_events, but, supposing you instead were looking for a maximum value by getting a derivative that was equal to zero, you might end up getting stuck solving for it some how.
</p>

<p>
Let's consider this parabola with a maximum at \(x=2\), where \(y=2\):
</p>

<div class="org-src-container">
<pre class="src src-ipython"><span style="color: #BA36A5;">x</span> = np.linspace(0, 4)
plt.plot(x, 2 - (x - 2)**2)
</pre>
</div>

<pre class="example">
[&lt;matplotlib.lines.Line2D at 0x1512dad9e8&gt;]

</pre>



<p>
<img src="/media/e56c3df20f7d52f874861f0041da6fd5-181K3p.png"> 
</p>

<p>
We can find the maximum like this.
</p>

<div class="org-src-container">
<pre class="src src-ipython"><span style="color: #0000FF;">def</span> <span style="color: #006699;">yprime</span>(x, y):
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #0000FF;">return</span> -2  * (x - 2)

<span style="color: #0000FF;">def</span> <span style="color: #006699;">maxevent</span>(x, y):
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #0000FF;">return</span> yprime(x, y)

<span style="color: #BA36A5;">sol</span> = solve_ivp(yprime, (0, 4), np.array([-2]), events=[maxevent])
sol
</pre>
</div>

<pre class="example">
/Users/jkitchin/anaconda/lib/python3.6/site-packages/scipy/integrate/_ivp/rk.py:145: RuntimeWarning: divide by zero encountered in double_scalars
  max(1, SAFETY * error_norm ** (-1 / (order + 1))))


</pre>

<pre class="example">
 message: 'The solver successfully reached the interval end.'
    nfev: 20
    njev: 0
     nlu: 0
     sol: None
  status: 0
 success: True
       t: array([ 0.        ,  0.08706376,  0.95770136,  4.        ])
t_events: [array([ 2.])]
       y: array([[-2.        , -1.65932506,  0.91361355, -2.        ]])

</pre>

<p>
Clearly, we found the maximum at x=2, but now what?  Re-solve the ODE and use t_eval with the t_events values? Use a fine t_eval array, and interpolate the solution? That doesn't seem smart. You could make the event terminal, so that it stops at the max, and then read off the last value, but this will not work if you want to count more than one maximum, for example.
</p>

<div class="org-src-container">
<pre class="src src-ipython"><span style="color: #BA36A5;">maxevent.terminal</span> = <span style="color: #D0372D;">True</span>
solve_ivp(yprime, (0, 4), (-2,), events=[maxevent])
</pre>
</div>

<pre class="example">
/Users/jkitchin/anaconda/lib/python3.6/site-packages/scipy/integrate/_ivp/rk.py:145: RuntimeWarning: divide by zero encountered in double_scalars
  max(1, SAFETY * error_norm ** (-1 / (order + 1))))


</pre>

<pre class="example">
 message: 'A termination event occurred.'
    nfev: 20
    njev: 0
     nlu: 0
     sol: None
  status: 1
 success: True
       t: array([ 0.        ,  0.08706376,  0.95770136,  2.        ])
t_events: [array([ 2.])]
       y: array([[-2.        , -1.65932506,  0.91361355,  2.        ]])

</pre>

<p>
Internet: am I missing something obvious here?
</p>
<p>Copyright (C) 2018 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p>
<p><a href="/org/2018/09/04/A-new-ode-integrator-function-in-scipy.org">org-mode source</a></p>
<p>Org-mode version = 9.1.13</p>

    </div>
  </div>
</article>



<a href="https://twitter.com/share" class="twitter-share-button" data-via="johnkitchin">Share on Twitter</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>


<a href="https://twitter.com/search?q=https://kitchingroup.cheme.cmu.edu/blog/2018/09/04/A-new-ode-integrator-function-in-scipy">Discuss on Twitter</a>

  <hr class="interblog" />

          </div>
          <div id="sidebar" class="grid_4">
            <aside>
<section>
<script>
  (function() {
    var cx = '002533177287215655227:l7uvu35ssbc';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
        '//www.google.com/cse/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>
</section>

<section>
    <h1 class="post_header_gradient theme_font">Twitter</h1>
    <a class="twitter-timeline" href="https://twitter.com/johnkitchin" data-widget-id="545217643582881792">Tweets by @johnkitchin</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+"://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
</section>


  <section>
    <h1 class="post_header_gradient theme_font">Links</h1>
    <ul>
      <li><a href="https://www.continuum.io">Anaconda Python</a></li>
      <li><a href="/pycse">Pycse</a></li>
      <li><a href="/dft-book">DFT-book</a></li>
    </ul>
  </section>

  <section>
    <h1 class="post_header_gradient theme_font">Latest Posts</h1>
    <ul>
      <li><a href="/blog/2025/06/17/New-Publication-Solving-an-inverse-problem-with-generative-models/">New Publication - Solving an inverse problem with generative models</a></li>
      <li><a href="/blog/2025/05/07/New-publication-The-Evolving-Role-of-Programming-and-Llms-in-the-Development-of-Self-Driving-Laboratories/">New publication - The Evolving Role of Programming and Llms in the Development of Self-Driving Laboratories</a></li>
      <li><a href="/blog/2025/04/11/New-publication-A-Classification-based-Methodology-for-the-Estimation-of-Binary-Surfactant-Critical-Micelle-Concentrations/">New publication - A Classification-based Methodology for the Estimation of Binary Surfactant Critical Micelle Concentrations</a></li>
      <li><a href="/blog/2025/03/17/New-publication-CatTsunami-Accelerating-Transition-State-Energy-Calculations-With-Pretrained-Graph-Neural-Networks/">New publication - CatTsunami Accelerating Transition State Energy Calculations With Pretrained Graph Neural Networks</a></li>
      <li><a href="/blog/2025/02/11/New-publication-Accessing-Numerical-Energy-Hessians-With-Graph-Neural-Network-Potentials-and-Their-Application-in-Heterogeneous-Catalysis/">New publication - Accessing Numerical Energy Hessians With Graph Neural Network Potentials and Their Application in Heterogeneous Catalysis</a></li>
    </ul>
  </section>

<section>
<h1 class="post_header_gradient theme_font">Latest GitHub Repos</h1>
  <a href="https://github.com/jkitchin">@jkitchin</a> on GitHub.
  <ul id="my-github-projects">
        <li class="loading">Status updating&#8230;</li>
  </ul>

</section>
</aside>

          </div>
          <div class="clear"></div>
        </div>
      </div>
      
<footer>
  <div id="footer" class="grid_12">
    <div class="grid_8">
      <p>
        <a href="/blog/feed/index.xml">RSS</a>
      </p>
    </div>
    <div class="grid_4" id="credits">
      <p>
        Copyright 2025
        John Kitchin
      </p>
      <p>
        Powered by <a href="http://www.blogofile.com">Blogofile</a>
      </p>
    </div>
  </div>
</footer>

    </div>
      <script src="//ajax.googleapis.com/ajax/libs/jquery/1.5.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="/js/libs/jquery-1.5.1.min.js"%3E%3C/script%3E'))</script>
  <script src="/js/plugins.js"></script>
  <script src="/js/script.js"></script>
  <script src="/js/jquery.tweet.js"></script>  
  <script src="/js/site.js"></script>
  <!--[if lt IE 7 ]>
  <script src="js/libs/dd_belatedpng.js"></script>
  <script> DD_belatedPNG.fix('img, .png_bg');</script>
  <![endif]-->
 
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-PH8NF4F0RE"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-PH8NF4F0RE');
</script>


  </body>
</html>






<script src="http://ajax.microsoft.com/ajax/jquery/jquery-1.4.2.min.js" type="text/javascript"></script>
<script src="/js/git.js" type="text/javascript"></script>
<script type="text/javascript">
    $(function() {
     $("#my-github-projects").loadRepositories("jkitchin");
    });
</script>



