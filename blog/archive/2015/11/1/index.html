

<!doctype html>
<!--[if lt IE 7 ]> <html lang="en" class="no-js ie6"> <![endif]-->
<!--[if IE 7 ]>    <html lang="en" class="no-js ie7"> <![endif]-->
<!--[if IE 8 ]>    <html lang="en" class="no-js ie8"> <![endif]-->
<!--[if IE 9 ]>    <html lang="en" class="no-js ie9"> <![endif]-->
<!--[if (gt IE 9)|!(IE)]><!--> <html lang="en" class="no-js"> <!--<![endif]-->
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>The Kitchin Research Group</title>
  <meta name="google-site-verification" content="CGcacJdHc2YoZyI0Vey9XRA5qwhhFDzThKJezbRFcJ4" />
  <meta name="description" content="Chemical Engineering at Carnegie Mellon University">
  <meta name="author" content="John Kitchin">
  <link rel="alternate" type="application/rss+xml" title="RSS 2.0" href="/blog/feed" />
  <link rel="alternate" type="application/atom+xml" title="Atom 1.0" href="/blog/feed/atom" />
  <link rel="shortcut icon" href="/favicon.ico">
  <link rel="apple-touch-icon" href="/img/apple-touch-icon.png">

  <link rel="stylesheet" href="/css/base.css?v=1">
  <link rel="stylesheet" href="/css/grid.css?v=1">
  <link rel="stylesheet" media="handheld" href="/css/handheld.css?v=1">
  <link rel="stylesheet" href="/css/pygments_murphy.css" type="text/css" />

  <script src="/js/libs/modernizr-1.7.min.js"></script>
<script type="text/javascript"
  src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
  <link rel="stylesheet" href="/themes/theme1/style.css?v=1">
<link href='http://fonts.googleapis.com/css?family=Roboto' rel='stylesheet' type='text/css'>

</head>
  <body>
    <div id="container" class="container container_12">
      <div id="main" role="main">
        <div id="main_block">
          <header>
<div id="header" class="header_gradient theme_font">
<table><tr><td>
    <h1><a href="/">The Kitchin Research Group</a></h1>
    <h2>Chemical Engineering at Carnegie Mellon University</h2>
</td>
<td colspan=100%><div style="float:right;width:100%;text-align:right;"> <span id='badgeCont737515' style='width:126px'><script src='http://labs.researcherid.com/mashlets?el=badgeCont737515&mashlet=badge&showTitle=false&className=a&rid=A-2363-2010'></script></span></div>
</td></tr>
</table>
</div>
  <div id="navigation" class="grid_12">

    <ul class="theme_font">
      <li><a href="/blog"
             class="">Blog</a></li>

      <li><a href="/blog/archive"
             class="">Archives</a></li>

      <li><a href="/publications.html">Publications</a></li>

      <li><a href="/research.html"
             class="">Research</a></li>

      <li><a href="/categories.html"
             class="">Categories</a></li>

      <li><a href="/about.html"
             class="">About us</a></li>

      <li><a href="/subscribe.html">Subscribe</a></li>

    </ul>
  </div>
</header>

          <div id="prose_block" class="grid_8">
            
  





<article>
  <div class="blog_post">
    <header>
      <div id="LDAP-lookups-from-Emacs"></div>
      <h2 class="blog_post_title"><a href="/blog/2015/11/25/LDAP-lookups-from-Emacs/" rel="bookmark" title="Permanent Link to LDAP lookups from Emacs">LDAP lookups from Emacs</a></h2>
      <p><small><span class="blog_post_date">Posted November 25, 2015 at 09:31 AM</span> | categories:
        <span class="blog_post_categories"><a href='/blog/category/helm/'>helm</a>, <a href='/blog/category/emacs/'>emacs</a></span> | tags: 
        | <a href="http://jkitchin.github.io/blog/2015/11/25/LDAP-lookups-from-Emacs#disqus_thread">View Comments</a>
      </small></p>
    </header>
    <div class="post_prose">
      




<p>
Now that I have email and Cisco Jabber totally integrated into Emacs it would be nice to tap into the CMU LDAP (Lightweight Directory Access Protocol) service  to find emails and phone numbers. We to use the ldapsearch command-line utility to query our LDAP service like this to find an email address.
</p>

<p>
You might like the video explanation here: <a href="https://www.youtube.com/watch?v=N7AaKHRd9uw">https://www.youtube.com/watch?v=N7AaKHRd9uw</a> 
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(shell-command-to-string <span style="color: #008000;">"ldapsearch -x -LLL -h ldap.andrew.cmu.edu -b ou=Person,dc=cmu,dc=edu cn=\"John Kitchin\""</span>)
</pre>
</div>

<pre class="example">
dn: guid=1976CCAA-B465-11D8-8000-080020CC75D3,ou=person,dc=cmu,dc=edu
objectClass: cmuPerson
eduPersonPrimaryAffiliation: Faculty
guid: 1976CCAA-B465-11D8-8000-080020CC75D3
cmuPrivate: homePostalAddress
cmuPrivate: homePhone
cn: John Kitchin
givenName: John
sn: Kitchin
cmuPrimaryCampus: Pittsburgh
cmuCampus: Pittsburgh
cmuAndrewId: jkitchin
cmueduId: jkitchin
cmuAndrewCommonNamespaceId: jkitchin
mail: jkitchin@cmu.edu
eduPersonSchoolCollegeName: CIT - Consolidated
cmuPersonPrincipalName: jkitchin@ANDREW.CMU.EDU
postalAddress: DH A207F
cmuDepartment: Chemical Engineering
cmuDepartment: MSE: Materials Science &amp; Engineering
cmuPersonAffiliation: Tenure-Track Faculty
eduPersonAffiliation: Faculty
cmuAccount: uid=jkitchin,ou=account,dc=andrew,dc=cmu,dc=edu
cmuAccount: uid=jkitchin,ou=account,dc=cmu,dc=edu
cmuActiveDN: uid=jkitchin,ou=account,dc=andrew,dc=cmu,dc=edu
cmuActiveDN: uid=jkitchin,ou=account,dc=cmu,dc=edu
title: Professor
telephoneNumber: +1 412 268 7803
</pre>

<p>
We actually get LDIF data from ldapsearch with a lot of details. Next we wrap the output in a function that converts each result from ldapsearch into a p-list that we will use later in a helm function to help us select a match.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #0000FF;">defun</span> <span style="color: #006699;">ldap-query</span> (query-string)
  <span style="color: #036A07;">"Send QUERY-STRING to our ldap server and parse results into a</span>
<span style="color: #036A07;">list of p-lists for each entry returned."</span>
  (<span style="color: #0000FF;">interactive</span> <span style="color: #008000;">"sLDAP query: "</span>)
  (<span style="color: #0000FF;">let</span> ((output (butlast (split-string
                          (shell-command-to-string
                           (format (concat  <span style="color: #008000;">"ldapsearch -x -LLL "</span>
                                            <span style="color: #008000;">"-h ldap.andrew.cmu.edu "</span>
                                            <span style="color: #008000;">"-b ou=Person,dc=cmu,dc=edu %s"</span>)
                                   query-string))
                          <span style="color: #008000;">"\n"</span>)))
        (lines '())
        (result '())
        (results '(())))
    <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">cleanup trailing lines and ignore initial lines</span>
    (<span style="color: #0000FF;">loop</span> for line in output
          do
          (<span style="color: #0000FF;">cond</span>
           <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">join lines that run over</span>
           ((s-starts-with? <span style="color: #008000;">" "</span> line)
            (<span style="color: #0000FF;">setf</span> (car (last lines))
                  (concat (car (last lines)) line)))
           <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">ignore this</span>
           ((string-match <span style="color: #008000;">"Size limit exceeded"</span> line)
            nil)
           (t
            (add-to-list 'lines line t))))

    <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">now we need to parse the lines. A new entry starts with a dn: line.</span>
    (<span style="color: #0000FF;">dolist</span> (line lines)
      (<span style="color: #0000FF;">cond</span>
       ((s-starts-with? <span style="color: #008000;">"dn:"</span> line)
        <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">add new entry</span>
        (add-to-list 'results `(<span style="color: #006FE0;">:dn</span> ,line)))
       ((string-match <span style="color: #008000;">":"</span> line)
        (<span style="color: #0000FF;">let*</span> ((s (split-string line <span style="color: #008000;">":"</span>))
               (prop (intern (concat <span style="color: #008000;">":"</span> (s-trim (car s)))))
               (val (s-trim (cadr s))))
          (<span style="color: #0000FF;">setf</span> (car results) (plist-put (car results) prop val))))))
    <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">last result seems to be nil so we drop it</span>
    (-filter (<span style="color: #0000FF;">lambda</span> (x) (not (null x))) results)))
</pre>
</div>

<pre class="example">
ldap-query
</pre>

<p>
Here is an example of that function:
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(ldap-query <span style="color: #008000;">"cn=\"John Kitchin\""</span>)
</pre>
</div>

<div class="org-src-container">

<pre class="src src-emacs-lisp">((<span style="color: #006FE0;">:dn</span> <span style="color: #008000;">"dn: guid=1976CCAA-B465-11D8-8000-080020CC75D3,ou=person,dc=cmu,dc=edu"</span> <span style="color: #006FE0;">:objectClass</span> <span style="color: #008000;">"cmuPerson"</span> <span style="color: #006FE0;">:eduPersonPrimaryAffiliation</span> <span style="color: #008000;">"Faculty"</span> <span style="color: #006FE0;">:guid</span> <span style="color: #008000;">"1976CCAA-B465-11D8-8000-080020CC75D3"</span> <span style="color: #006FE0;">:cmuPrivate</span> <span style="color: #008000;">"homePhone"</span> <span style="color: #006FE0;">:cn</span> <span style="color: #008000;">"John Kitchin"</span> <span style="color: #006FE0;">:givenName</span> <span style="color: #008000;">"John"</span> <span style="color: #006FE0;">:sn</span> <span style="color: #008000;">"Kitchin"</span> <span style="color: #006FE0;">:cmuPrimaryCampus</span> <span style="color: #008000;">"Pittsburgh"</span> <span style="color: #006FE0;">:cmuCampus</span> <span style="color: #008000;">"Pittsburgh"</span> <span style="color: #006FE0;">:cmuAndrewId</span> <span style="color: #008000;">"jkitchin"</span> <span style="color: #006FE0;">:cmueduId</span> <span style="color: #008000;">"jkitchin"</span> <span style="color: #006FE0;">:cmuAndrewCommonNamespaceId</span> <span style="color: #008000;">"jkitchin"</span> <span style="color: #006FE0;">:mail</span> <span style="color: #008000;">"jkitchin@cmu.edu"</span> <span style="color: #006FE0;">:eduPersonSchoolCollegeName</span> <span style="color: #008000;">"CIT - Consolidated"</span> <span style="color: #006FE0;">:cmuPersonPrincipalName</span> <span style="color: #008000;">"jkitchin@ANDREW.CMU.EDU"</span> <span style="color: #006FE0;">:postalAddress</span> <span style="color: #008000;">"DH A207F"</span> <span style="color: #006FE0;">:cmuDepartment</span> <span style="color: #008000;">"MSE"</span> <span style="color: #006FE0;">:cmuPersonAffiliation</span> <span style="color: #008000;">"Tenure-Track Faculty"</span> <span style="color: #006FE0;">:eduPersonAffiliation</span> <span style="color: #008000;">"Faculty"</span> <span style="color: #006FE0;">:cmuAccount</span> <span style="color: #008000;">"uid=jkitchin,ou=account,dc=cmu,dc=edu"</span> <span style="color: #006FE0;">:cmuActiveDN</span> <span style="color: #008000;">"uid=jkitchin,ou=account,dc=cmu,dc=edu"</span> <span style="color: #006FE0;">:title</span> <span style="color: #008000;">"Professor"</span> <span style="color: #006FE0;">:telephoneNumber</span> <span style="color: #008000;">"+1 412 268 7803"</span>))
</pre>
</div>


<p>
Now, we wrap a helm function around that to give us a nice menu to select entries from, and a few actions like sending an email, calling, copying the name and email, and seeing the information in a reasonable way. We also add a fallback method in case we don't find what we want and need to do a new search.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #0000FF;">defun</span> <span style="color: #006699;">helm-ldap</span> (query-string)
  (<span style="color: #0000FF;">interactive</span> <span style="color: #008000;">"sLDAP query: "</span>)
  (helm
   <span style="color: #006FE0;">:sources</span>
   `(((name . <span style="color: #008000;">"HELM ldap"</span>)
      (candidates . ,(mapcar
                      (<span style="color: #0000FF;">lambda</span> (x)
                        (cons
                         (format
                          <span style="color: #008000;">"%20s|%30s|%30s|%20s|%s"</span>
                          (s-truncate
                           20
                           (<span style="color: #0000FF;">or</span> (plist-get x <span style="color: #006FE0;">:title</span>) <span style="color: #008000;">" "</span>))
                          (plist-get x <span style="color: #006FE0;">:cn</span>)
                          (plist-get x <span style="color: #006FE0;">:mail</span>)
                          (plist-get x <span style="color: #006FE0;">:cmuDisplayAddress</span>)
                          (<span style="color: #0000FF;">or</span> (plist-get x <span style="color: #006FE0;">:telephoneNumber</span>) <span style="color: #008000;">" "</span>))
                         x))
                      (ldap-query
                       (<span style="color: #0000FF;">if</span> (string-match <span style="color: #008000;">"="</span> query-string)
                           query-string
                         (concat <span style="color: #008000;">"cn=*"</span> query-string <span style="color: #008000;">"*"</span>)))))
      (action . ((<span style="color: #008000;">"Email"</span> . (<span style="color: #0000FF;">lambda</span> (x)
                              (compose-mail)
                              (message-goto-to)
                              (insert (plist-get x <span style="color: #006FE0;">:mail</span>))
                              (message-goto-subject)))
                 (<span style="color: #008000;">"Call"</span> . (<span style="color: #0000FF;">lambda</span> (x)
                             (cisco-call
                              (plist-get x <span style="color: #006FE0;">:telephoneNumber</span>))))
                 (<span style="color: #008000;">"Copy Name and email address"</span> . (<span style="color: #0000FF;">lambda</span> (x)
                                                    (kill-new
                                                     (format
                                                      <span style="color: #008000;">"%s &lt;%s&gt;"</span>
                                                      (plist-get x <span style="color: #006FE0;">:cn</span>)
                                                      (plist-get x <span style="color: #006FE0;">:mail</span>)))))
                 (<span style="color: #008000;">"Information"</span> . (<span style="color: #0000FF;">lambda</span> (x)
                                    (switch-to-buffer
                                     (get-buffer-create <span style="color: #008000;">"*helm ldap*"</span>))
                                    (erase-buffer)
                                    (<span style="color: #0000FF;">dolist</span> (key (<span style="color: #0000FF;">cl-loop</span>
                                                  for key in x by #'cddr
                                                  collect key))
                                      (insert (format <span style="color: #008000;">"|%s | %s|\n"</span>
                                                      key (plist-get x key))))
                                    (org-mode)
                                    (goto-char 0)
                                    (org-ctrl-c-ctrl-c)
                                    (insert <span style="color: #008000;">"press q to quit.\n\n"</span>)
                                    (<span style="color: #0000FF;">setq</span> buffer-read-only t)
                                    (use-local-map (copy-keymap org-mode-map))
                                    (local-set-key <span style="color: #008000;">"q"</span>
                                                   #'(lambda ()
                                                       (<span style="color: #0000FF;">interactive</span>)
                                                       (quit-window t))))))))
     <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">fallback action</span>
     ((name . <span style="color: #008000;">"New search"</span>)
      (dummy)
      (action . (<span style="color: #0000FF;">lambda</span> (x) (helm-ldap x)))))))
</pre>
</div>

<pre class="example">
helm-ldap
</pre>

<p>
That is pretty convenient!
</p>

<p>
John Kitchin &lt;jkitchin@cmu.edu&gt;</p>
<p>Copyright (C) 2015 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2015/11/25/LDAP-lookups-from-Emacs.org">org-mode source</a><p><p>Org-mode version = 8.2.10</p>

    </div>
  </div>
</article>



<a href="https://twitter.com/share" class="twitter-share-button" data-via="johnkitchin">Tweet</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>

  <div class="after_post"><a href="http://jkitchin.github.io/blog/2015/11/25/LDAP-lookups-from-Emacs#disqus_thread">Read and Post Comments</a></div>
  <hr class="interblog" />
  





<article>
  <div class="blog_post">
    <header>
      <div id="Contextual-help-in-org-mode"></div>
      <h2 class="blog_post_title"><a href="/blog/2015/11/24/Contextual-help-in-org-mode/" rel="bookmark" title="Permanent Link to Contextual help in org-mode">Contextual help in org-mode</a></h2>
      <p><small><span class="blog_post_date">Posted November 24, 2015 at 10:08 AM</span> | categories:
        <span class="blog_post_categories"><a href='/blog/category/orgmode/'>orgmode</a>, <a href='/blog/category/emacs/'>emacs</a></span> | tags: 
        | <a href="http://jkitchin.github.io/blog/2015/11/24/Contextual-help-in-org-mode#disqus_thread">View Comments</a>
      </small></p>
    </header>
    <div class="post_prose">
      



<p>
org-mode is great, plain text and all, but it can be difficult to figure out all the things you can do at any particular place in the buffer. Here, we explore some ideas on making org-mode a bit more discoverable. One way to do this that we explore here is to create a help function that you run, and it tells you about the element that `org-element-context' knows about, then gives you some hints of what you can do there. To do this, we create a series of functions for each kind of element we provide help on.
</p>

<p>
You may want to see the video: <a href="https://www.youtube.com/watch?v=99uxJWqZGzA">https://www.youtube.com/watch?v=99uxJWqZGzA</a> 
</p>

<p>
The kind of help we want is a description of the element, some commands we can run on the element and what they do, and if there are some key-bindings. We also want to make sure if the user has changed the key-bindings, the right values get shown. Finally, it would be nice to allow users to add their own documentation if they want.
</p>

<p>
So, here is the lengthy block of code we use for this purpose. We create a function for each element type that we provide documentation for. We also provide a mechanism for users to add their own notes for future reference. I leverage the help-buffer here to simplify some functional text, e.g. the key commands and clickable functions, as well as history navigation. I could also do most of that in org-mode buffers, with different functionality, but I save that for another day.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #0000FF;">defvar</span> <span style="color: #BA36A5;">ore-user-directory</span> <span style="color: #008000;">"~/.emacs.d/ore/"</span>
  <span style="color: #036A07;">"Directory to store user additions to the notes."</span>)


(<span style="color: #0000FF;">defun</span> <span style="color: #006699;">ore-user-documentation</span> (type)
  <span style="color: #036A07;">"Return user documentation for org element TYPE if it exists.</span>
<span style="color: #036A07;">Notes are returned as plain text, and will be rendered in `</span><span style="color: #D0372D;">help-mode</span><span style="color: #036A07;">'."</span>
  (<span style="color: #0000FF;">let</span> ((fname (expand-file-name (format <span style="color: #008000;">"%s.org"</span> type) ore-user-directory)))
    (concat
     <span style="color: #008000;">"User documentation:\n"</span>
     (<span style="color: #0000FF;">if</span> (file-exists-p fname)
         (<span style="color: #0000FF;">with-temp-buffer</span>
           (insert <span style="color: #008000;">"\n"</span>)
           (insert-file-contents fname)
           (indent-rigidly (point-min) (point-max) 5)
           (buffer-string))
       <span style="color: #008000;">"None defined."</span>)
     (format  <span style="color: #008000;">"\n\nEdit [[file:%s]]"</span> fname))))


(<span style="color: #0000FF;">defun</span> <span style="color: #006699;">ore-latex</span> (element)
  <span style="color: #036A07;">"`</span><span style="color: #D0372D;">ore</span><span style="color: #036A07;">' documentation for latex fragment."</span>
  (concat
   (substitute-command-keys <span style="color: #008000;">"You are on a LaTeX fragment or environment.</span>

<span style="color: #008000;">\\[</span><span style="color: #D0372D;">org-toggle-latex-overlays</span><span style="color: #008000;">] or `</span><span style="color: #D0372D;">org-toggle-latex-overlays</span><span style="color: #008000;">' to toggle LaTeX images on it.</span>

<span style="color: #008000;">"</span>)
   (format  <span style="color: #008000;">"\nClick for details on the face [[face:%s]]\n"</span> (face-at-point))
   (ore-user-documentation 'latex)))


(<span style="color: #0000FF;">defun</span> <span style="color: #006699;">ore-link</span> (element)
  <span style="color: #036A07;">"`</span><span style="color: #D0372D;">ore</span><span style="color: #036A07;">' documentation for org links."</span>
  (<span style="color: #0000FF;">let*</span> ((link (org-element-context))
         (type (org-element-property <span style="color: #006FE0;">:type</span> link))
         (protocols (assoc type org-link-protocols))
         (follow-func (cadr protocols))
         (export-func (caddr protocols)))
    (concat
     (format
      (substitute-command-keys <span style="color: #008000;">"You are on a %s link.</span>

<span style="color: #008000;">Link path: %s</span>
<span style="color: #008000;">%s</span>

<span style="color: #008000;">Clicking on the link will run `</span><span style="color: #D0372D;">%s</span><span style="color: #008000;">'.</span>

<span style="color: #008000;">This link uses this function for export: `</span><span style="color: #D0372D;">%s</span><span style="color: #008000;">'</span>

<span style="color: #008000;">If you are on an image link, you can toggle it with \\[</span><span style="color: #D0372D;">org-toggle-inline-images</span><span style="color: #008000;">] or `</span><span style="color: #D0372D;">org-toggle-inline-images</span><span style="color: #008000;">'.</span>

<span style="color: #008000;">You can toggle the link display with `</span><span style="color: #D0372D;">org-toggle-link-display</span><span style="color: #008000;">'.</span>

<span style="color: #008000;">See Info node `(org) Hyperlinks'.</span>

<span style="color: #008000;">%s</span>

<span style="color: #008000;">%s\n\n"</span>)
      type
      (org-element-property <span style="color: #006FE0;">:path</span> link)
      (format <span style="color: #008000;">"Whole link: %s"</span> (buffer-substring
                                (org-element-property <span style="color: #006FE0;">:begin</span> link)
                                (org-element-property <span style="color: #006FE0;">:end</span> link)))
      (pp-to-string follow-func)
      (pp-to-string export-func)
      (format  <span style="color: #008000;">"\nClick for details on the face [[face:%s]]\n"</span> (face-at-point))
      (ore-user-documentation 'link)))))


(<span style="color: #0000FF;">defun</span> <span style="color: #006699;">ore-src-block-header-p</span> (element)
  <span style="color: #036A07;">"Return whether point is in a src-block header."</span>
  (<span style="color: #0000FF;">and</span> (eq 'src-block (car element))
       (<span style="color: #0000FF;">save-excursion</span>
         (<span style="color: #0000FF;">let</span> ((cp (point))
               (lp (line-number-at-pos)))
           (goto-char (org-element-property <span style="color: #006FE0;">:begin</span> element))
           (= lp (line-number-at-pos))))))


(<span style="color: #0000FF;">defun</span> <span style="color: #006699;">ore-src-block-header</span> (element)
  <span style="color: #036A07;">"`</span><span style="color: #D0372D;">ore</span><span style="color: #036A07;">' documentation for src-block header."</span>
  (concat
   <span style="color: #008000;">"You are in a src-block header.</span>

<span style="color: #008000;">This line tells org-mode that</span>
<span style="color: #008000;">it is a src-block, and language of the src-block. There are</span>
<span style="color: #008000;">also optional header arguments. See Info node `(org) Header arguments'</span>

<span style="color: #008000;">"</span>
   (format <span style="color: #008000;">"The default headers are described here: `</span><span style="color: #D0372D;">org-babel-default-header-args:%s</span><span style="color: #008000;">'</span>

<span style="color: #008000;">"</span> (org-element-property <span style="color: #006FE0;">:language</span> element))
   (format  <span style="color: #008000;">"\nClick for details on the face [[face:%s]]\n"</span> (face-at-point))
   (ore-user-documentation 'src-block-header)))


(<span style="color: #0000FF;">defun</span> <span style="color: #006699;">ore-src-block</span> (element)
  <span style="color: #036A07;">"`</span><span style="color: #D0372D;">ore</span><span style="color: #036A07;">' documentation for a src-block."</span>
  (concat
   (substitute-command-keys <span style="color: #008000;">"You are in a src-block.</span>

<span style="color: #008000;">C-c C-c to execute this block.</span>
<span style="color: #008000;">\\[</span><span style="color: #D0372D;">org-babel-tangle</span><span style="color: #008000;">]  org-babel-tangle</span>

<span style="color: #008000;">You can edit the block with \\[</span><span style="color: #D0372D;">org-edit-special</span><span style="color: #008000;">] or `</span><span style="color: #D0372D;">org-edit-special</span><span style="color: #008000;">'.</span>

<span style="color: #008000;">See Info node `(org) Working with source code' for more details.\n\n"</span>)
   (format  <span style="color: #008000;">"\nClick for details on the face [[face:%s]]\n"</span> (face-at-point))
   (ore-user-documentation 'src-block)))


(<span style="color: #0000FF;">defun</span> <span style="color: #006699;">ore-headline</span> (element)
  <span style="color: #036A07;">"`</span><span style="color: #D0372D;">ore</span><span style="color: #036A07;">' documentation for a headline."</span>
  (concat
   (<span style="color: #0000FF;">when</span> (bolp)
     (format  <span style="color: #008000;">"You are at the beginning of a headline.</span>

<span style="color: #008000;">\\[</span><span style="color: #D0372D;">org-cycle</span><span style="color: #008000;">] to cycle Info node `(org) Global and local cycling'.</span>

<span style="color: #008000;">Check `</span><span style="color: #D0372D;">org-use-speed-commands</span><span style="color: #008000;">'\n\n"</span>))

   <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">in a headline</span>
   (substitute-command-keys
    <span style="color: #008000;">"You are in a headline. You can change:</span>

<span style="color: #008000;"> Visibility with \\[</span><span style="color: #D0372D;">org-cycle</span><span style="color: #008000;">]</span>

<span style="color: #008000;"> TODO state \\[</span><span style="color: #D0372D;">org-shiftleft</span><span style="color: #008000;">] and \\[</span><span style="color: #D0372D;">org-shiftright</span><span style="color: #008000;">] or</span>
<span style="color: #008000;"> `</span><span style="color: #D0372D;">org-todo</span><span style="color: #008000;">'.</span>

<span style="color: #008000;"> Your current todo sets can be found in `</span><span style="color: #D0372D;">org-todo-sets</span><span style="color: #008000;">'.</span>

<span style="color: #008000;"> Priority \\[</span><span style="color: #D0372D;">org-shiftup</span><span style="color: #008000;">] (`</span><span style="color: #D0372D;">org-priority-up</span><span style="color: #008000;">') and</span>
<span style="color: #008000;"> \\[</span><span style="color: #D0372D;">org-shiftdown</span><span style="color: #008000;">] (`</span><span style="color: #D0372D;">org-priority-down</span><span style="color: #008000;">')</span>

<span style="color: #008000;"> Tags  \\[</span><span style="color: #D0372D;">org-ctrl-c-ctrl-c</span><span style="color: #008000;">] or `</span><span style="color: #D0372D;">org-set-tags</span><span style="color: #008000;">'</span>

<span style="color: #008000;"> Set a property with \\[</span><span style="color: #D0372D;">org-set-property</span><span style="color: #008000;">] `</span><span style="color: #D0372D;">org-set-property</span><span style="color: #008000;">'.</span>

<span style="color: #008000;"> Delete a property with \\[</span><span style="color: #D0372D;">org-delete-property</span><span style="color: #008000;">] or `</span><span style="color: #D0372D;">org-delete-property</span><span style="color: #008000;">'.</span>

<span style="color: #008000;">"</span>)
   (format  <span style="color: #008000;">"\nClick for details on the face [[face:%s]]\n"</span> (face-at-point))
   (ore-user-documentation 'headline)))


<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">timestamp</span>
(<span style="color: #0000FF;">defun</span> <span style="color: #006699;">ore-timestamp</span> (element)
  <span style="color: #036A07;">"`</span><span style="color: #D0372D;">ore</span><span style="color: #036A07;">' documentation for timestamps."</span>
  (concat
   (substitute-command-keys <span style="color: #008000;">"You are on a timestamp.</span>

<span style="color: #008000;">If you click on it, you will see the date in the agenda. With the</span>
<span style="color: #008000;">cursor on the &lt;&gt; or [] \\[</span><span style="color: #D0372D;">org-shiftup</span><span style="color: #008000;">] and \\[</span><span style="color: #D0372D;">org-shiftdown</span><span style="color: #008000;">] will</span>
<span style="color: #008000;">switch from active to inactive timestamps.</span>

<span style="color: #008000;">You can change the date by putting the cursor on a date part and</span>
<span style="color: #008000;">using \\[</span><span style="color: #D0372D;">org-shiftup</span><span style="color: #008000;">] and \\[</span><span style="color: #D0372D;">org-shiftdown</span><span style="color: #008000;">] or \\[</span><span style="color: #D0372D;">org-shiftleft</span><span style="color: #008000;">]</span>
<span style="color: #008000;">and \\[</span><span style="color: #D0372D;">org-shiftright</span><span style="color: #008000;">]</span>

<span style="color: #008000;">See Info node `(org) Dates and times'.</span>

<span style="color: #008000;">"</span>)
   (format  <span style="color: #008000;">"\nClick for details on the face [[face:%s]]\n"</span> (face-at-point))
   (ore-user-documentation 'timestamp)))


<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">table table-row table-cell</span>
(<span style="color: #0000FF;">defun</span> <span style="color: #006699;">ore-table</span> (element)
  <span style="color: #036A07;">"`</span><span style="color: #D0372D;">ore</span><span style="color: #036A07;">' documentation for tables."</span>
  (concat
   <span style="color: #008000;">"You are in a table.</span>

<span style="color: #008000;">Move cell to cell with [TAB]. When you are in the last cell, TAB adds a new row.</span>

<span style="color: #008000;">Move rows up and down with \\[</span><span style="color: #D0372D;">org-metaup</span><span style="color: #008000;">] and \\[</span><span style="color: #D0372D;">org-metadown</span><span style="color: #008000;">].</span>
<span style="color: #008000;">Move columns left and right with \\[</span><span style="color: #D0372D;">org-metaleft</span><span style="color: #008000;">] and \\[</span><span style="color: #D0372D;">org-metaright</span><span style="color: #008000;">].</span>

<span style="color: #008000;">Sort a column with \\[</span><span style="color: #D0372D;">org-sort</span><span style="color: #008000;">] `</span><span style="color: #D0372D;">org-sort</span><span style="color: #008000;">'.</span>

<span style="color: #008000;">Insert a row with `</span><span style="color: #D0372D;">org-table-insert-row</span><span style="color: #008000;">'.</span>
<span style="color: #008000;">Delete a row with `</span><span style="color: #D0372D;">org-table-kill-row</span><span style="color: #008000;">'.</span>

<span style="color: #008000;">Insert a column with `</span><span style="color: #D0372D;">org-table-insert-column</span><span style="color: #008000;">'.</span>
<span style="color: #008000;">Delete a column with `</span><span style="color: #D0372D;">org-table-delete-column</span><span style="color: #008000;">'.</span>

<span style="color: #008000;">`C-c -     (`</span><span style="color: #D0372D;">org-table-insert-hline</span><span style="color: #008000;">')'</span>
<span style="color: #008000;">     Insert a horizontal line below current row.  With a prefix</span>
<span style="color: #008000;">     argument, the line is created above the current line.</span>

<span style="color: #008000;">`C-c &lt;RET&gt;     (`</span><span style="color: #D0372D;">org-table-hline-and-move</span><span style="color: #008000;">')'</span>
<span style="color: #008000;">     Insert a horizontal line below current row, and move the cursor</span>
<span style="color: #008000;">     into the row below that line.</span>

<span style="color: #008000;">You can transpose a table with `</span><span style="color: #D0372D;">org-table-transpose-table-at-point</span><span style="color: #008000;">'.</span>

<span style="color: #008000;">Info node `(org) Tables'.</span>

<span style="color: #008000;">"</span>
   (format  <span style="color: #008000;">"\nClick for details on the face [[face:%s]]\n"</span> (face-at-point))
   (ore-user-documentation 'table)))


(<span style="color: #0000FF;">defun</span> <span style="color: #006699;">ore-plain-list</span> (element)
  <span style="color: #036A07;">"`</span><span style="color: #D0372D;">ore</span><span style="color: #036A07;">' doucmentation for plain lists."</span>
  (concat
   (substitute-command-keys
    <span style="color: #008000;">"You are on a plain list.</span>
<span style="color: #008000;">See Info node `(org) Plain lists'.</span>

<span style="color: #008000;">"</span>)
   (format  <span style="color: #008000;">"\nClick for details on the face [[face:%s]]\n"</span> (face-at-point))
   (ore-user-documentation 'plain-list)))


(<span style="color: #0000FF;">defun</span> <span style="color: #006699;">ore-item</span> (element)
  <span style="color: #036A07;">"`</span><span style="color: #D0372D;">ore</span><span style="color: #036A07;">' documentation for items in a list"</span>
  (concat
   (substitute-command-keys
    <span style="color: #008000;">"You are on an item in a list.</span>

<span style="color: #008000;">You can move items up and down with \\[</span><span style="color: #D0372D;">org-metaup</span><span style="color: #008000;">] or `</span><span style="color: #D0372D;">org-metaup</span><span style="color: #008000;">' and \\[</span><span style="color: #D0372D;">org-meta-down</span><span style="color: #008000;">] or `</span><span style="color: #D0372D;">org-metadown</span><span style="color: #008000;">'.</span>

<span style="color: #008000;">You can add a new item with \\[</span><span style="color: #D0372D;">org-meta-return</span><span style="color: #008000;">] or `</span><span style="color: #D0372D;">org-meta-return</span><span style="color: #008000;">'.</span>

<span style="color: #008000;">You can change the indentation of an item with  \\[</span><span style="color: #D0372D;">org-metaleft</span><span style="color: #008000;">] or `</span><span style="color: #D0372D;">org-metaleft</span><span style="color: #008000;">' and \\[</span><span style="color: #D0372D;">org-meta-right</span><span style="color: #008000;">] or `</span><span style="color: #D0372D;">org-meta-right</span><span style="color: #008000;">'.</span>

<span style="color: #008000;">You can change the bullet of the item with  \\[</span><span style="color: #D0372D;">org-shiftleft</span><span style="color: #008000;">] or `</span><span style="color: #D0372D;">org-shiftleft</span><span style="color: #008000;">' and \\[</span><span style="color: #D0372D;">org-shiftright</span><span style="color: #008000;">] or `</span><span style="color: #D0372D;">org-shiftright</span><span style="color: #008000;">'.</span>

<span style="color: #008000;">See Info node `(org) Plain lists' for other things like sorting, cycling, checkboxes, etc...</span>

<span style="color: #008000;">"</span>)
   (format  <span style="color: #008000;">"\nClick for details on the face [[face:%s]]\n"</span> (face-at-point))
   (ore-user-documentation 'item)))


(<span style="color: #0000FF;">defun</span> <span style="color: #006699;">ore-keyword</span> (element)
  <span style="color: #036A07;">"`</span><span style="color: #D0372D;">ore</span><span style="color: #036A07;">' documentation for a keyword."</span>
  (concat
   (substitute-command-keys
    <span style="color: #008000;">"You are on a keyword.</span>

<span style="color: #008000;">You may need to run \\[</span><span style="color: #D0372D;">org-ctrl-c-ctrl-c</span><span style="color: #008000;">] or `</span><span style="color: #D0372D;">org-ctrl-c-ctrl-c</span><span style="color: #008000;">' to refresh its value if you change it.</span>

<span style="color: #008000;">You can move keywords up and down with \\[</span><span style="color: #D0372D;">org-metaup</span><span style="color: #008000;">] or `</span><span style="color: #D0372D;">org-metaup</span><span style="color: #008000;">' and \\[</span><span style="color: #D0372D;">org-metadown</span><span style="color: #008000;">] or `</span><span style="color: #D0372D;">org-metadown</span><span style="color: #008000;">'.</span>

<span style="color: #008000;">"</span>)
   (format  <span style="color: #008000;">"\nClick for details on the face [[face:%s]]\n"</span> (face-at-point))
   (ore-user-documentation 'keyword)))


(<span style="color: #0000FF;">defun</span> <span style="color: #006699;">ore-paragraph</span> (element)
  <span style="color: #036A07;">"`</span><span style="color: #D0372D;">ore</span><span style="color: #036A07;">' documentation for a paragraph."</span>
  (concat
   (substitute-command-keys
    <span style="color: #008000;">"You are in a paragraph.</span>

<span style="color: #008000;">You can move a paragraph up with \\[</span><span style="color: #D0372D;">org-metaup</span><span style="color: #008000;">] or `</span><span style="color: #D0372D;">org-metaup</span><span style="color: #008000;">'.</span>

<span style="color: #008000;">You can move a paragraph up with \\[</span><span style="color: #D0372D;">org-metadown</span><span style="color: #008000;">] or `</span><span style="color: #D0372D;">org-metadown</span><span style="color: #008000;">'.</span>

<span style="color: #008000;">You can mark the paragraph with `</span><span style="color: #D0372D;">mark-paragraph</span><span style="color: #008000;">'.</span>


<span style="color: #008000;">"</span>)
   (format  <span style="color: #008000;">"\nClick for details on the face [[face:%s]]\n"</span> (face-at-point))
   (ore-user-documentation 'paragraph)))


(<span style="color: #0000FF;">defun</span> <span style="color: #006699;">ore</span> ()
  <span style="color: #036A07;">"Help function for the org-mode element at point."</span>
  (<span style="color: #0000FF;">interactive</span>)
  (<span style="color: #0000FF;">with-help-window</span>
      (help-buffer)
    (<span style="color: #0000FF;">let*</span> ((oeap (org-element-context))
           (ore-func (intern (format <span style="color: #008000;">"ore-%s"</span> (car oeap))))
           (s (<span style="color: #0000FF;">if</span> (fboundp ore-func)
                  (funcall ore-func oeap)
                (format
                 <span style="color: #008000;">"No documentation found for %s.</span>

<span style="color: #008000;">%s"</span>
                 (car oeap)
                 (ore-user-documentation (car oeap))))))
      <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">There are some special cases.</span>
      (<span style="color: #0000FF;">cond</span>
       ((<span style="color: #0000FF;">and</span>  (eq 'src-block (car oeap))
              (ore-src-block-header-p oeap))
        (<span style="color: #0000FF;">setq</span> s (ore-src-block-header oeap)))

       ((<span style="color: #0000FF;">or</span> (eq 'table (car oeap))
            (eq 'table-row (car oeap))
            (eq 'table-cell (car oeap)))
        (<span style="color: #0000FF;">setq</span> s (ore-table oeap)))

       ((<span style="color: #0000FF;">or</span> (eq 'latex-fragment (car oeap))
            (eq 'latex-environment (car oeap)))
        (<span style="color: #0000FF;">setq</span> s (ore-latex oeap))))

      (princ s)
      (princ <span style="color: #008000;">"\n\nHere is how org-mode sees the element.\n\n"</span>)
      (pp oeap))))


(<span style="color: #0000FF;">defun</span> <span style="color: #006699;">match-next-ore-file</span> (<span style="color: #6434A3;">&amp;optional</span> limit)
  <span style="color: #036A07;">"Font-lock function to make file links clickable in help-mode."</span>
  (<span style="color: #0000FF;">when</span>  (re-search-forward <span style="color: #008000;">"\\[\\[file:</span><span style="color: #008000; font-weight: bold;">\\</span><span style="color: #008000; font-weight: bold;">(</span><span style="color: #008000;">[</span><span style="color: #008000;">^</span><span style="color: #008000;">]]*</span><span style="color: #008000; font-weight: bold;">\\</span><span style="color: #008000; font-weight: bold;">)</span><span style="color: #008000;">\\]\\]"</span> limit t)
    (<span style="color: #0000FF;">let*</span> ((fname (expand-file-name
                   (match-string 1)
                   ore-user-directory))
           (beg (match-beginning 0))
           (end (match-end 0))
           (find-func `(<span style="color: #0000FF;">lambda</span> ()
                         (<span style="color: #0000FF;">interactive</span>)
                         (find-file ,fname))))

      (add-text-properties
       beg
       end
       `(mouse-face
         highlight
         display <span style="color: #008000;">"User documentation"</span>
         local-map ,(<span style="color: #0000FF;">let</span> ((map (copy-keymap help-mode-map)))
                      (define-key map [mouse-1] find-func)
                      map)
         help-echo (format
                    <span style="color: #008000;">"Click to edit User documentation.\n%s"</span>
                    fname))))))

(<span style="color: #0000FF;">defun</span> <span style="color: #006699;">match-next-ore-face</span> (<span style="color: #6434A3;">&amp;optional</span> limit)
  <span style="color: #036A07;">"Font-lock function to make face links clickable in help-mode."</span>
  (<span style="color: #0000FF;">when</span>  (re-search-forward <span style="color: #008000;">"\\[\\[face:</span><span style="color: #008000; font-weight: bold;">\\</span><span style="color: #008000; font-weight: bold;">(</span><span style="color: #008000;">[</span><span style="color: #008000;">^</span><span style="color: #008000;">]]*</span><span style="color: #008000; font-weight: bold;">\\</span><span style="color: #008000; font-weight: bold;">)</span><span style="color: #008000;">\\]\\]"</span> limit t)
    (<span style="color: #0000FF;">let*</span> ((face (match-string 1))
           (beg (match-beginning 0))
           (end (match-end 0))
           (func `(<span style="color: #0000FF;">lambda</span> ()
                    (<span style="color: #0000FF;">interactive</span>)
                    (describe-face ,face))))

      (add-text-properties
       beg
       end
       `(mouse-face
         highlight
         local-map ,(<span style="color: #0000FF;">let</span> ((map (copy-keymap help-mode-map)))
                      (define-key map [mouse-1] func)
                      map)
         display ,face
         help-echo (format
                    <span style="color: #008000;">"Click to show face information.\n%s"</span>
                    face))))))

(add-hook 'help-mode-hook
          (<span style="color: #0000FF;">lambda</span> ()
            (font-lock-add-keywords
             nil
             '((match-next-ore-file . font-lock-keyword-face)
               (match-next-ore-face . font-lock-keyword-face)))))


<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Let's add to the org menu for "Help at point"</span>
(easy-menu-change
 '(<span style="color: #008000;">"Org"</span>)
 <span style="color: #008000;">"Help"</span>
 '([<span style="color: #008000;">"Help at point"</span> ore])
 <span style="color: #008000;">"Show/Hide"</span>)
</pre>
</div>

<p>
<a class='org-ref-reference' href="#xu-suppor">xu-suppor</a>   \(e^x\)
</p>

<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1"><span class="section-number-2">1</span> <span class="todo TODO">TODO</span> elements</h2>
<div class="outline-text-2" id="text-1">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="right" />

<col  class="right" />
</colgroup>
<tbody>
<tr>
<td class="right">a</td>
<td class="right">b</td>
</tr>

<tr>
<td class="right">3</td>
<td class="right">4</td>
</tr>
</tbody>
</table>

<p>
list (plain/numbered)
</p>
<ul class="org-ul">
<li>add element
<ul class="org-ul">
<li>move elements (up/down indent/outdent)
</li>
</ul>
</li>
<li>
</li>

<li>item 1
</li>
<li>item 2
</li>
<li>item 3
</li>
</ul>

<p>
checkbox
</p>
<ul class="org-ul">
<li><code>[&#xa0;]</code> check it
</li>
</ul>


<div class="figure">
<p><img src="/media/2015-11-24-Contextual-help-in-org-mode/11-eos.png"> 
</p>
</div>

<p>
<a href="org#External links">org#External links</a>
</p>

<p>
<a class='org-ref-reference' href="#lizzit-2001-surfac-ru">lizzit-2001-surfac-ru</a>
</p>


<p>

</p>

<p>
\(latex_fragment\)
</p>

<p>
\(latex fragment\)
</p>

\begin{equation}
2-3
\end{equation}

<div class="org-src-container">

<pre class="src src-emacs-lisp">(+ 3 4 5)
</pre>
</div>

<pre class="example">
12
</pre>

<p>
<span class="timestamp-wrapper"><span class="timestamp">&lt;2015-10-18 Sun&gt;</span></span>   <span class="timestamp-wrapper"><span class="timestamp">[2015-10-18 Sun]</span></span></p>
</div>
</div>
<p>Copyright (C) 2015 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2015/11/24/Contextual-help-in-org-mode.org">org-mode source</a><p><p>Org-mode version = 8.2.10</p>

    </div>
  </div>
</article>



<a href="https://twitter.com/share" class="twitter-share-button" data-via="johnkitchin">Tweet</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>

  <div class="after_post"><a href="http://jkitchin.github.io/blog/2015/11/24/Contextual-help-in-org-mode#disqus_thread">Read and Post Comments</a></div>
  <hr class="interblog" />
  





<article>
  <div class="blog_post">
    <header>
      <div id="Improving-org-ref-cite-links-with-tooltips"></div>
      <h2 class="blog_post_title"><a href="/blog/2015/11/23/Improving-org-ref-cite-links-with-tooltips/" rel="bookmark" title="Permanent Link to Improving org-ref cite links with tooltips">Improving org-ref cite links with tooltips</a></h2>
      <p><small><span class="blog_post_date">Posted November 23, 2015 at 07:03 AM</span> | categories:
        <span class="blog_post_categories"><a href='/blog/category/orgmode/'>orgmode</a>, <a href='/blog/category/orgref/'>orgref</a>, <a href='/blog/category/emacs/'>emacs</a></span> | tags: 
        | <a href="http://jkitchin.github.io/blog/2015/11/23/Improving-org-ref-cite-links-with-tooltips#disqus_thread">View Comments</a>
      </small></p>
    </header>
    <div class="post_prose">
      



<p>
Org-ref uses timers to give you messages about the cite link at point. I am not so crazy about the timer, there is always a (short) delay, and I have had trouble debugging timers in the past, and you have to put the point on the link. Since I wrote that code, I have learned some new things about Emacs, including dynamic tooltips. This will allow me to use the mouse to see what a cite link refers to. While reading documents, I am more likely to use a mouse than when typing a document, and getting a tooltip by hovering sounds like a good idea.
</p>

<p>
Here, we explore using dynamic tooltips on cite links. The idea is pretty simple, we tie into font-lock to add a function to the :help-echo property of a cite link. The function will go to point, and compute the citation string at point, which will be displayed as a tooltip when the mouse hovers over the citation.
</p>

<p>
Font-lock allows you to specify a function that sets match-data and that can have other side-effects, e.g. setting text properties. Org-ref has a regexp that defines cite links, which we use here, and a function that gets the citation string at point. We just go to the mouse position, and get that string, wrapped in a save-excursion macro so that point does not actually move. Then, we add the function to font-lock keywords, and we are done!
</p>

<p>
Here are some papers we wrote on using org-mode
<a class='org-ref-reference' href="#kitchin-2015-examp">kitchin-2015-examp</a>,<a class='org-ref-reference' href="#kitchin-2015-data-surfac-scien">kitchin-2015-data-surfac-scien</a> and some other references
in my bibliography <a class='org-ref-reference' href="#zou-2014-cobal-embed">zou-2014-cobal-embed</a>,<a class='org-ref-reference' href="#zlotea-2014-nanoal">zlotea-2014-nanoal</a> and one final
example <a class='org-ref-reference' href="#zhu-2015">zhu-2015</a>.
</p>


<p>
Here is the short code required to do this. You can see the tooltips in action here: <a href="https://www.youtube.com/watch?v=ifSmlId2rk0">https://www.youtube.com/watch?v=ifSmlId2rk0</a> 
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #0000FF;">defun</span> <span style="color: #006699;">org-ref-match-next-cite-link</span> (<span style="color: #6434A3;">&amp;optional</span> limit)
  (<span style="color: #0000FF;">when</span> (re-search-forward org-ref-cite-re limit t)
    (add-text-properties
     (match-beginning 0) (match-end 0)
     (list
      'help-echo (<span style="color: #0000FF;">lambda</span> (window object position)
                   (<span style="color: #0000FF;">save-excursion</span>
                     (goto-char position)
                     (<span style="color: #0000FF;">let</span> ((s (org-ref-get-citation-string-at-point)))
                       (<span style="color: #0000FF;">with-temp-buffer</span>
                         (insert s)
                         (fill-paragraph)
                         (buffer-string)))))))))

<span style="color: #8D8D84;">; </span><span style="color: #8D8D84; font-style: italic;">do this for this buffer</span>
(font-lock-add-keywords
    nil
    '((org-ref-match-next-cite-link (0  'org-ref-cite-face t)))
    t)
(font-lock-fontify-buffer)

<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">do this for every org file</span>
(add-hook
 'org-mode-hook
 (<span style="color: #0000FF;">lambda</span> ()
   (font-lock-add-keywords
    nil
    '((org-ref-match-next-cite-link (0  'org-ref-cite-face t)))
    t)))
</pre>
</div>


<p>
<h1 class='org-ref-bib-h1'>Bibliography</h1>
<ul class='org-ref-bib'><li><a id="kitchin-2015-data-surfac-scien">[kitchin-2015-data-surfac-scien] "John Kitchin", Data Sharing in Surface Science, <i>"Surface Science "</i>, <b>(0)</b>,  -  (2015). <a href="http://www.sciencedirect.com/science/article/pii/S0039602815001326">link</a>. <a href="http://dx.doi.org/10.1016/j.susc.2015.05.007">doi</a>.</a></li>
<li><a id="kitchin-2015-examp">[kitchin-2015-examp] Kitchin, Examples of Effective Data Sharing in Scientific Publishing, <i>ACS Catalysis</i>, <b>5(6)</b>, 3894-3899 (2015). <a href=" http://dx.doi.org/10.1021/acscatal.5b00538 ">link</a>. <a href="http://dx.doi.org/10.1021/acscatal.5b00538">doi</a>.</a></li>
<li><a id="zhu-2015">[zhu-2015] Yinlong Zhu, Wei Zhou, Zhi-Gang Chen, Yubo Chen, , Chao Su, Moses Tad\'e & Zongping Shao, \ceSrNb_0.1Co_0.7Fe_0.2 O_3-$\delta$ Perovskite As a  Next-Generation Electrocatalyst for Oxygen Evolution in  Alkaline Solution, <i>Angew. Chem. Int. Ed.</i>, <b>54(13)</b>, 3897-3901 (2015). <a href="http://dx.doi.org/10.1002/anie.201408998">link</a>. <a href="http://dx.doi.org/10.1002/anie.201408998">doi</a>.</a></li>
<li><a id="zlotea-2014-nanoal">[zlotea-2014-nanoal] Zlotea, Morfin, Nguyen, Nguyen, , Nelayah, Ricolleau, Latroche & Piccolo, Nanoalloying Bulk-Immiscible Iridium and Palladium Inhibits  Hydride Formation and Promotes Catalytic Performances, <i>Nanoscale</i>, <b>6(17)</b>, 9955 (2014). <a href="http://dx.doi.org/10.1039/C4NR02836H">link</a>. <a href="http://dx.doi.org/10.1039/c4nr02836h">doi</a>.</a></li>
<li><a id="zou-2014-cobal-embed">[zou-2014-cobal-embed] Zou, Huang, Goswami, , Silva, Sathe, Mikmekov\'a, ska & Asefa, Cobalt-Embedded Nitrogen-Rich Carbon Nanotubes Efficiently  Catalyze Hydrogen Evolution Reaction At All pH Values, <i>Angewandte Chemie</i>, <b></b>, 4461-4465 (2014). <a href="http://dx.doi.org/10.1002/ange.201311111">link</a>. <a href="http://dx.doi.org/10.1002/ange.201311111">doi</a>.</a></li>
</ul>
</p>
<p>Copyright (C) 2015 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2015/11/23/Improving-org-ref-cite-links-with-tooltips.org">org-mode source</a><p><p>Org-mode version = 8.2.10</p>

    </div>
  </div>
</article>



<a href="https://twitter.com/share" class="twitter-share-button" data-via="johnkitchin">Tweet</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>

  <div class="after_post"><a href="http://jkitchin.github.io/blog/2015/11/23/Improving-org-ref-cite-links-with-tooltips#disqus_thread">Read and Post Comments</a></div>
  <hr class="interblog" />
  





<article>
  <div class="blog_post">
    <header>
      <div id="Adding-emacs-command-key-bindings-and-help-functionality-to-org-mode"></div>
      <h2 class="blog_post_title"><a href="/blog/2015/11/22/Adding-emacs-command-key-bindings-and-help-functionality-to-org-mode/" rel="bookmark" title="Permanent Link to Adding emacs command key-bindings and help functionality to org-mode">Adding emacs command key-bindings and help functionality to org-mode</a></h2>
      <p><small><span class="blog_post_date">Posted November 22, 2015 at 10:08 AM</span> | categories:
        <span class="blog_post_categories"><a href='/blog/category/orgmode/'>orgmode</a>, <a href='/blog/category/emacs/'>emacs</a></span> | tags: 
        | <a href="http://jkitchin.github.io/blog/2015/11/22/Adding-emacs-command-key-bindings-and-help-functionality-to-org-mode#disqus_thread">View Comments</a>
      </small></p>
    </header>
    <div class="post_prose">
      



<p>
The documentation of functions in emacs allows you to put some light markup into function doc strings that will render as the key sequence required to run the command when you look up the help on the function. I would like to have something like that in org-mode. You can look up the key-binding to a command like this:
</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp">(substitute-command-keys <span style="color: #008000;">"\\[</span><span style="color: #D0372D;">org-agenda</span><span style="color: #008000;">]"</span>)
</pre>
</div>

<pre class="example">
C-c a
</pre>

<p>
We are going to explore a way to recognize the syntax shown above, change its appearance to alert us that we are looking at an emacs command, add a tooltip, and make it clickable to open the documentation, and s (super) clickable to find the function code. Font lock is the tool we will use for this. Basically, we need a regular expression to match the syntax, and a function to find the next instance, and put some properties on the matched text.
</p>

<p>
I made a video (<a href="https://www.youtube.com/watch?v=VLUMW0sR4Vk">https://www.youtube.com/watch?v=VLUMW0sR4Vk</a> ) showing what this post is all about. It isn't easy to see in the post .
</p>

<p>
Here we use the `rx' library to build up a regular expression for this. It is a bit easier to document than a raw regexp. Since we are matching \ in the pattern, there are some obligatory escaping \ characters in there too. All we need is to integrate this into font-lock. We define a function that will move the point to the end of the next match, and put properties on the match. We will go ahead and make the text clickable so we can access documentation and code easily. The tooltip will show the key-binding to run the command.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #0000FF;">require</span> '<span style="color: #D0372D;">rx</span>)

(<span style="color: #0000FF;">defvar</span> <span style="color: #BA36A5;">elisp-symbol-keybinding-re</span>
  (<span style="color: #0000FF;">rx</span>
   <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">opening \\[</span>
   (eval <span style="color: #008000;">"\\["</span>)
   <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">one or more characters that are not ]</span>
   (group (one-or-more (not (any <span style="color: #008000;">"]"</span>))))
   <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">The closing ]</span>
   <span style="color: #008000;">"]"</span>)
<span style="color: #036A07;">"Regexp for an elisp command keybinding syntax. \\[</span><span style="color: #D0372D;">some-command</span><span style="color: #036A07;">]</span>
<span style="color: #036A07;">Regexp group 1 matches `</span><span style="color: #D0372D;">some-command</span><span style="color: #036A07;">'."</span>)

(<span style="color: #0000FF;">defun</span> <span style="color: #006699;">match-next-keybinding</span> (<span style="color: #6434A3;">&amp;optional</span> limit)
  <span style="color: #036A07;">"Move point to the end of the next expression matching</span>
<span style="color: #036A07;">`</span><span style="color: #D0372D;">elisp-symbol-keybinding-re</span><span style="color: #036A07;">', and put properties on the match</span>
<span style="color: #036A07;">that shows the key sequence. Non-bound commands are not</span>
<span style="color: #036A07;">fontified."</span>
  (<span style="color: #0000FF;">when</span> (<span style="color: #0000FF;">and</span> (re-search-forward
              elisp-symbol-keybinding-re
              limit t)
             (fboundp (intern (match-string 1))))
    (<span style="color: #0000FF;">let*</span> ((beg (match-beginning 0))
           (end (match-end 0))
           (s (match-string 0))
           (command (match-string 1))
           (describe-func `(<span style="color: #0000FF;">lambda</span> ()
                    <span style="color: #036A07;">"Run `</span><span style="color: #D0372D;">describe-function</span><span style="color: #036A07;">' on the command."</span>
                    (<span style="color: #0000FF;">interactive</span>)
                    (describe-function (intern ,command))))
           (find-func `(<span style="color: #0000FF;">lambda</span> ()
                     <span style="color: #036A07;">"Run `</span><span style="color: #D0372D;">find-function</span><span style="color: #036A07;">' on the command."</span>
                     (<span style="color: #0000FF;">interactive</span>)
                     (find-function (intern ,command))))
           (map (make-sparse-keymap)))

      <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">this is what gets run when you click on it.</span>
      (define-key map [mouse-1] describe-func)
      (define-key map [s-mouse-1] find-func)
      <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Here we define the text properties</span>
      (add-text-properties
       beg end
       `(local-map ,map
         mouse-face highlight
         help-echo ,(format
                     <span style="color: #008000;">"%s\n\nClick for documentation.\ns-mouse-1 to find function."</span>
                     (substitute-command-keys s))
         keybinding t)))))
</pre>
</div>

<p>
Let's go ahead and make syntax for `some-command' too. This one seems simple enough we just write a regexp for it.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #0000FF;">defun</span> <span style="color: #006699;">match-next-emacs-command</span> (<span style="color: #6434A3;">&amp;optional</span> limit)
  <span style="color: #036A07;">"Move point to the end of the next expression matching</span>
<span style="color: #036A07;">`</span><span style="color: #D0372D;">this-syntax</span><span style="color: #036A07;">', and put a tooltip on the match</span>
<span style="color: #036A07;">that shows the key sequence. Works on commands and variables."</span>
  (<span style="color: #0000FF;">when</span> (<span style="color: #0000FF;">and</span> (re-search-forward
              <span style="color: #008000;">"`</span><span style="color: #008000; font-weight: bold;">\\</span><span style="color: #008000; font-weight: bold;">(</span><span style="color: #008000;">[</span><span style="color: #008000;">^</span><span style="color: #008000;">']+</span><span style="color: #008000; font-weight: bold;">\\</span><span style="color: #008000; font-weight: bold;">)</span><span style="color: #008000;">'"</span>
              limit t)
             (<span style="color: #0000FF;">or</span> (boundp (intern (match-string 1)))
                 (fboundp (intern (match-string 1)))))
    (<span style="color: #0000FF;">let*</span> ((beg (match-beginning 0))
           (end (match-end 0))
           (s (match-string 0))
           (command (match-string 1))
           (describe-func
            `(<span style="color: #0000FF;">lambda</span> ()
               <span style="color: #036A07;">"Run `</span><span style="color: #D0372D;">describe-function/variable</span><span style="color: #036A07;">' on the command."</span>
               (<span style="color: #0000FF;">interactive</span>)
               (<span style="color: #0000FF;">cond</span> ((fboundp (intern ,command))
                      (describe-function (intern ,command)))
                     ((boundp (intern ,command))
                      (describe-variable (intern ,command))))))
           (find-func `(<span style="color: #0000FF;">lambda</span> ()
                     <span style="color: #036A07;">"Run `</span><span style="color: #D0372D;">find-function</span><span style="color: #036A07;">' on the command."</span>
                     (<span style="color: #0000FF;">interactive</span>)
                     (find-function (intern ,command))))
           (map (make-sparse-keymap)))

      <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">this is what gets run when you click on it.</span>
      (define-key map [mouse-1] describe-func)
      (define-key map [s-mouse-1] find-func)
      <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Here we define the text properties</span>
      (add-text-properties
       beg end
       `(local-map ,map
         mouse-face highlight
         help-echo ,(format
                     <span style="color: #008000;">"%s\n\nClick for documentation.%s"</span>
                     (<span style="color: #0000FF;">if</span> (fboundp (intern command))
                         (substitute-command-keys (format <span style="color: #008000;">"\\[</span><span style="color: #D0372D;">%s</span><span style="color: #008000;">]"</span> command))
                       <span style="color: #008000;">"Variable"</span>)
                     (<span style="color: #0000FF;">if</span> (fboundp (intern command))
                         <span style="color: #008000;">"\ns-mouse-1 to find function."</span>
                       <span style="color: #008000;">""</span>))
         keybinding t)))))
</pre>
</div>

<p>
Now we need a way to turn them on and off. We do that here with a minor mode.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #0000FF;">define-minor-mode</span> <span style="color: #006699;">emacs-keybinding-command-tooltip-mode</span>
  <span style="color: #036A07;">"Fontify on emacs keybinding syntax. Adds a tooltip for</span>
<span style="color: #036A07;">keybinding, and make the command clickable to get to the</span>
<span style="color: #036A07;">documentation."</span>
  <span style="color: #006FE0;">:lighter</span> <span style="color: #008000;">" KB"</span>
  (<span style="color: #0000FF;">if</span> emacs-keybinding-command-tooltip-mode
      <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">turn them on</span>
      (font-lock-add-keywords
       nil
       '((match-next-keybinding 1 font-lock-constant-face)
         (match-next-emacs-command 1 font-lock-constant-face)))
    <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">turn them off</span>
    (font-lock-remove-keywords
     nil
     '((match-next-keybinding 1 font-lock-constant-face)
       (match-next-emacs-command 1 font-lock-constant-face))))
  (font-lock-fontify-buffer))
</pre>
</div>

<p>
Here we turn it on:
</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp">(emacs-keybinding-command-tooltip-mode -1)
</pre>
</div>

<p>
Here are some sample uses. You can use  \\[org-toggle-latex-overlays] to toggle latex overlays.
</p>

<p>
You can use \\[org-ref-helm-insert-cite-link]  to insert citations.
</p>

<p>
That more or less does it! I don't know if this is the canonical way to do this, but it works nicely here. You can also use overlays, but I found them a little confusing because they are not editable, and you have to toggle the minor mode to see them. Here we have unobtrusive tooltips. One downside is these won't export in any fashion in org-mode since it is not part of the syntax. It might be a good idea to adjust `font-lock-extra-managed-props' for this
</p>

<p>
It works for this syntax too: `helm', which is also commonly used in doc strings. This should be pretty handy in org-mode documents about Emacs!
</p>
<p>Copyright (C) 2015 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2015/11/22/Adding-emacs-command-key-bindings-and-help-functionality-to-org-mode.org">org-mode source</a><p><p>Org-mode version = 8.2.10</p>

    </div>
  </div>
</article>



<a href="https://twitter.com/share" class="twitter-share-button" data-via="johnkitchin">Tweet</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>

  <div class="after_post"><a href="http://jkitchin.github.io/blog/2015/11/22/Adding-emacs-command-key-bindings-and-help-functionality-to-org-mode#disqus_thread">Read and Post Comments</a></div>
  <hr class="interblog" />
  





<article>
  <div class="blog_post">
    <header>
      <div id="Insert-org-entities-into-org-mode-with-helm"></div>
      <h2 class="blog_post_title"><a href="/blog/2015/11/21/Insert-org-entities-into-org-mode-with-helm/" rel="bookmark" title="Permanent Link to Insert org-entities into org-mode with helm">Insert org-entities into org-mode with helm</a></h2>
      <p><small><span class="blog_post_date">Posted November 21, 2015 at 11:37 AM</span> | categories:
        <span class="blog_post_categories"><a href='/blog/category/helm/'>helm</a>, <a href='/blog/category/orgmode/'>orgmode</a>, <a href='/blog/category/emacs/'>emacs</a></span> | tags: 
        | <a href="http://jkitchin.github.io/blog/2015/11/21/Insert-org-entities-into-org-mode-with-helm#disqus_thread">View Comments</a>
      </small></p>
    </header>
    <div class="post_prose">
      



<p>
org-mode has a lot of pre-defined entities (see <a href="http://kitchingroup.cheme.cmu.edu/blog/2013/10/03/Exporting-accented-characters-to-latex-from-org-mode/">http://kitchingroup.cheme.cmu.edu/blog/2013/10/03/Exporting-accented-characters-to-latex-from-org-mode/</a> ), otherwise known to me as non-ascii characters. I rarely remember what these are, and occasionally want to insert the LaTeX or HTML code, so here we build a helm command to show them to me, and allow me to select one for insertion. We generate the helm sources from org-entities below. It works pretty well!
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #0000FF;">defun</span> <span style="color: #006699;">helm-insert-org-entity</span> ()
  <span style="color: #036A07;">"Helm interface to insert an entity from `</span><span style="color: #D0372D;">org-entities</span><span style="color: #036A07;">'.</span>
<span style="color: #036A07;">F1 inserts utf-8 character</span>
<span style="color: #036A07;">F2 inserts entity code</span>
<span style="color: #036A07;">F3 inserts LaTeX code (does not wrap in math-mode)</span>
<span style="color: #036A07;">F4 inserts HTML code"</span>
  (<span style="color: #0000FF;">interactive</span>)
  (helm <span style="color: #006FE0;">:sources</span> (reverse
                  (<span style="color: #0000FF;">let</span> ((sources '())
                        toplevel
                        secondlevel)
                    (<span style="color: #0000FF;">dolist</span> (element (append
                                      '(<span style="color: #008000;">"* User"</span> <span style="color: #008000;">"** User entities"</span>)
                                      org-entities-user org-entities))
                      (<span style="color: #0000FF;">when</span> (<span style="color: #0000FF;">and</span> (stringp element)
                                 (s-starts-with? <span style="color: #008000;">"* "</span> element))
                        (<span style="color: #0000FF;">setq</span> toplevel element))
                      (<span style="color: #0000FF;">when</span> (<span style="color: #0000FF;">and</span> (stringp element)
                                 (s-starts-with? <span style="color: #008000;">"** "</span> element))
                        (<span style="color: #0000FF;">setq</span> secondlevel element)
                        (add-to-list
                         'sources
                         `((name . ,(concat
                                     toplevel
                                     (replace-regexp-in-string
                                      <span style="color: #008000;">"\\*\\*"</span> <span style="color: #008000;">" - "</span> secondlevel)))
                           (candidates . nil)
                           (action . ((<span style="color: #008000;">"insert utf-8 char"</span> . (<span style="color: #0000FF;">lambda</span> (candidate)
                                                               (insert (nth 6 candidate))))
                                      (<span style="color: #008000;">"insert org entity"</span> . (<span style="color: #0000FF;">lambda</span> (candidate)
                                                           (insert (concat <span style="color: #008000;">"\\"</span> (car candidate)))))
                                      (<span style="color: #008000;">"insert latex"</span> . (<span style="color: #0000FF;">lambda</span> (candidate)
                                                          (insert (nth 1 candidate))))
                                      (<span style="color: #008000;">"insert html"</span> . (<span style="color: #0000FF;">lambda</span> (candidate)
                                                         (insert (nth 3 candidate)))))))))
                      (<span style="color: #0000FF;">when</span> (<span style="color: #0000FF;">and</span> element (listp element))
                        (<span style="color: #0000FF;">setf</span> (cdr (assoc 'candidates (car sources)))
                              (append
                               (cdr (assoc 'candidates (car sources)))
                               (list (cons
                                      (format <span style="color: #008000;">"%10s %s"</span> (nth 6 element) element)
                                      element))))))
                    sources))))
</pre>
</div>

<pre class="example">
helm-insert-org-entity
</pre>

<p>
Now I can write things like the particle was 60  in diameter at a temperature of 600C, leading to an expansion coefficient of =0.2  0.01. It isn't quite as fast as knowing the keyboard shortcuts for those symbols, but a lot faster than looking them up then copy and pasting them. So far it seems like these export to HTML and LaTeX just fine, and they are more convenient and better looking than using the org-entities codes. This will make its way into jmax soon.
</p>
<p>Copyright (C) 2015 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2015/11/21/Insert-org-entities-into-org-mode-with-helm.org">org-mode source</a><p><p>Org-mode version = 8.2.10</p>

    </div>
  </div>
</article>



<a href="https://twitter.com/share" class="twitter-share-button" data-via="johnkitchin">Tweet</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>

  <div class="after_post"><a href="http://jkitchin.github.io/blog/2015/11/21/Insert-org-entities-into-org-mode-with-helm#disqus_thread">Read and Post Comments</a></div>
  <hr class="interblog" />
 <a href="../2">Next Page </a>

          </div>
          <div id="sidebar" class="grid_4">
            <aside>
<section>
<script>
  (function() {
    var cx = '002533177287215655227:l7uvu35ssbc';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
        '//www.google.com/cse/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>
</section>

<section>
    <h1 class="post_header_gradient theme_font">Twitter</h1>
    <a class="twitter-timeline" href="https://twitter.com/johnkitchin" data-widget-id="545217643582881792">Tweets by @johnkitchin</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+"://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
</section>


  <section>
    <h1 class="post_header_gradient theme_font">Links</h1>
    <ul>
    <li><a href="http://enthought.com">Enthought Python</a></li>
    <li><a href="/pycse">Pycse</a></li>
    <li><a href="/dft-book">DFT-book</a></li>
    </ul>
  </section>

  <section>
    <h1 class="post_header_gradient theme_font">Latest Posts</h1>
    <ul>
      <li><a href="/blog/2015/12/11/A-short-example/">A short example</a></li>
      <li><a href="/blog/2015/12/03/Exporting-numbered-citations-in-html-with-unsorted-numbered-bibliography/">Exporting numbered citations in html with unsorted numbered bibliography</a></li>
      <li><a href="/blog/2015/12/01/Post-processing-an-org-buffer-on-export/">Post-processing an org-buffer on export</a></li>
      <li><a href="/blog/2015/11/25/LDAP-lookups-from-Emacs/">LDAP lookups from Emacs</a></li>
      <li><a href="/blog/2015/11/24/Contextual-help-in-org-mode/">Contextual help in org-mode</a></li>
    </ul>
  </section>

<section>
<h1 class="post_header_gradient theme_font">Latest GitHub Repos</h1>
  <a href="https://github.com/jkitchin">@jkitchin</a> on GitHub.
  <ul id="my-github-projects">
        <li class="loading">Status updating&#8230;</li>
  </ul>

</section>
</aside>

          </div>
          <div class="clear"></div>
        </div>
      </div>
      
<footer>
  <div id="footer" class="grid_12">
    <div class="grid_8">
      <p>
        <a href="/blog/feed/index.xml">RSS</a>
        <a href="http://kitchinresearchgroup.disqus.com/latest.rss">Comments RSS Feed</a>.
      </p>
    </div>
    <div class="grid_4" id="credits">
      <p>
        Copyright 2015
        John Kitchin
      </p>
      <p>
        Powered by <a href="http://www.blogofile.com">Blogofile</a>
      </p>
    </div>
  </div>
</footer>

    </div>
      <script src="//ajax.googleapis.com/ajax/libs/jquery/1.5.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="/js/libs/jquery-1.5.1.min.js"%3E%3C/script%3E'))</script>
  <script src="/js/plugins.js"></script>
  <script src="/js/script.js"></script>
  <script src="/js/jquery.tweet.js"></script>  
  <script src="/js/site.js"></script>
  <!--[if lt IE 7 ]>
  <script src="js/libs/dd_belatedpng.js"></script>
  <script> DD_belatedPNG.fix('img, .png_bg');</script>
  <![endif]-->
  <script>
      var _gaq=[['_setAccount','UA-35731398-1'],['_trackPageview']];
      (function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];g.async=1;
      g.src=('https:'==location.protocol?'//ssl':'//www')+'.google-analytics.com/ga.js';
      s.parentNode.insertBefore(g,s)}(document,'script'));
  </script>
  <script>
  (function() {
      var links = document.getElementsByTagName('a');
      var query = '?';
      for(var i = 0; i < links.length; i++) {
          if(links[i].href.indexOf('#disqus_thread') >= 0) {
              query += 'url' + i + '=' + encodeURIComponent(links[i].href) + '&';
          }
      }
      document.write('<script charset="utf-8" type="text/javascript" src="http://disqus.com/forums/kitchinresearchgroup/get_num_replies.js' + query + '"></' + 'script>');
  })();
  </script>

  </body>
</html>






<script src="http://ajax.microsoft.com/ajax/jquery/jquery-1.4.2.min.js" type="text/javascript"></script>
<script src="/js/git.js" type="text/javascript"></script>
<script type="text/javascript">
    $(function() {
     $("#my-github-projects").loadRepositories("jkitchin");
    });
</script>



