

<!doctype html>
<!--[if lt IE 7 ]> <html lang="en" class="no-js ie6"> <![endif]-->
<!--[if IE 7 ]>    <html lang="en" class="no-js ie7"> <![endif]-->
<!--[if IE 8 ]>    <html lang="en" class="no-js ie8"> <![endif]-->
<!--[if IE 9 ]>    <html lang="en" class="no-js ie9"> <![endif]-->
<!--[if (gt IE 9)|!(IE)]><!--> <html lang="en" class="no-js"> <!--<![endif]-->
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>The Kitchin Research Group</title>
  <meta name="google-site-verification" content="CGcacJdHc2YoZyI0Vey9XRA5qwhhFDzThKJezbRFcJ4" />
  <meta name="description" content="Chemical Engineering at Carnegie Mellon University">
  <meta name="author" content="John Kitchin">
  <link rel="alternate" type="application/rss+xml" title="RSS 2.0" href="/blog/feed" />
  <link rel="alternate" type="application/atom+xml" title="Atom 1.0" href="/blog/feed/atom" />
  <link rel="shortcut icon" href="/favicon.ico">
  <link rel="apple-touch-icon" href="/img/apple-touch-icon.png">

  <link rel="stylesheet" href="/css/base.css?v=1">
  <link rel="stylesheet" href="/css/grid.css?v=1">
  <link rel="stylesheet" media="handheld" href="/css/handheld.css?v=1">
  <link rel="stylesheet" href="/css/pygments_murphy.css" type="text/css" />

  <script src="/js/libs/modernizr-1.7.min.js"></script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        displayAlign: "center",
        displayIndent: "0em",

        "HTML-CSS": { scale: 100,
                        linebreaks: { automatic: "false" },
                        webFont: "TeX"
                       },
        SVG: {scale: 100,
              linebreaks: { automatic: "false" },
              font: "TeX"},
        NativeMML: {scale: 100},
        TeX: { equationNumbers: {autoNumber: "AMS"},
               MultLineWidth: "85%",
               TagSide: "right",
               TagIndent: ".8em"
             }
});
</script>
<script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_HTML"></script>
  <link rel="stylesheet" href="/themes/theme1/style.css?v=1">
<link href='http://fonts.googleapis.com/css?family=Roboto' rel='stylesheet' type='text/css'>

</head>
  <body>
    <div id="container" class="container container_12">
      <div id="main" role="main">
        <div id="main_block">
          <header>
<div id="header" class="header_gradient theme_font">
<table><tr><td>
    <h1><a href="/">The Kitchin Research Group</a></h1>
    <h2>Chemical Engineering at Carnegie Mellon University</h2>
</td>
<td colspan=100%><div style="float:right;width:100%;text-align:right;"> <span id='badgeCont737515' style='width:126px'><script src='http://labs.researcherid.com/mashlets?el=badgeCont737515&mashlet=badge&showTitle=false&className=a&rid=A-2363-2010'></script></span></div>
</td></tr>
</table>
</div>
  <div id="navigation" class="grid_12">

    <ul class="theme_font">
      <li><a href="/blog"
             class="">Blog</a></li>

      <li><a href="/blog/archive"
             class="">Archives</a></li>

      <li><a href="/publications.html">Publications</a></li>

      <li><a href="/research.html"
             class="">Research</a></li>

      <li><a href="/categories.html"
             class="">Categories</a></li>

      <li><a href="/about.html"
             class="">About us</a></li>

      <li><a href="/subscribe.html">Subscribe</a></li>

    </ul>
  </div>
</header>

          <div id="prose_block" class="grid_8">
            
  





<article>
  <div class="blog_post">
    <header>
      <div id="Polynomials-in-python"></div>
      <h2 class="blog_post_title"><a href="/blog/2013/01/22/Polynomials-in-python/" rel="bookmark" title="Permanent Link to Polynomials in python">Polynomials in python</a></h2>
      <p><small><span class="blog_post_date">Posted January 22, 2013 at 09:00 AM</span> | categories:
        <span class="blog_post_categories"><a href='/blog/category/math/'>math</a>, <a href='/blog/category/polynomials/'>polynomials</a></span> | tags: 
      <p><small><span class="blog_post_date">Updated February 27, 2013 at 02:53 PM</span></small>
      </small></p>
    </header>
    <div class="post_prose">
      



<p>
<a href="http://matlab.cheme.cmu.edu/2011/08/01/polynomials-in-matlab/" >Matlab post</a>
</p>

<p>
Polynomials can be represented as a list of coefficients. For example, the polynomial \(4*x^3 + 3*x^2 -2*x + 10 = 0\) can be represented as [4, 3, -2, 10]. Here are some ways to create a polynomial object, and evaluate it.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">import</span> numpy <span style="color: #8b0000;">as</span> np

ppar = [4, 3, -2, 10]
p = np.poly1d(ppar)

<span style="color: #8b0000;">print</span> p(3)
<span style="color: #8b0000;">print</span> np.polyval(ppar, 3)

x = 3
<span style="color: #8b0000;">print</span> 4*x**3 + 3*x**2 -2*x + 10
</pre>
</div>

<pre class="example">
139
139
139
</pre>

<p>
numpy makes it easy to get the derivative and integral of a polynomial.
</p>

<p>
Consider: \(y = 2x^2 - 1\). We know the derivative is \(4x\). Here we compute the derivative and evaluate it at x=4.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">import</span> numpy <span style="color: #8b0000;">as</span> np

p = np.poly1d([2, 0, -1])
p2 = np.polyder(p)
<span style="color: #8b0000;">print</span> p2
<span style="color: #8b0000;">print</span> p2(4)
</pre>
</div>

<pre class="example">
 
4 x
16
</pre>

<p>
The integral of the previous polynomial is \(\frac{2}{3} x^3 - x + c\). We assume \(C=0\). Let us compute the integral \(\int_2^4 2x^2 - 1 dx\).
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">import</span> numpy <span style="color: #8b0000;">as</span> np

p = np.poly1d([2, 0, -1])
p2 = np.polyint(p)
<span style="color: #8b0000;">print</span> p2
<span style="color: #8b0000;">print</span> p2(4) - p2(2)
</pre>
</div>

<pre class="example">
        3
0.6667 x - 1 x
35.3333333333
</pre>

<p>
One reason to use polynomials is the ease of finding all of the roots using numpy.roots. 
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">import</span> numpy <span style="color: #8b0000;">as</span> np
<span style="color: #8b0000;">print</span> np.roots([2, 0, -1]) <span style="color: #ff0000; font-weight: bold;"># roots are +- sqrt(2)</span>

<span style="color: #ff0000; font-weight: bold;"># note that imaginary roots exist, e.g. x^2 + 1 = 0 has two roots, +-i</span>
p = np.poly1d([1, 0, 1])
<span style="color: #8b0000;">print</span> np.roots(p)
</pre>
</div>

<pre class="example">
[ 0.70710678 -0.70710678]
[ 0.+1.j  0.-1.j]
</pre>

<p>
There are applications of polynomials in thermodynamics. The van der waal equation is a cubic polynomial \(f(V) = V^3 - \frac{p n b + n R T}{p} V^2 + \frac{n^2 a}{p}V - \frac{n^3 a b}{p} = 0\), where \(a\) and \(b\) are constants, \(p\) is the pressure, \(R\) is the gas constant, \(T\) is an absolute temperature and \(n\) is the number of moles. The roots of this equation tell you the volume of the gas at those conditions.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">import</span> numpy <span style="color: #8b0000;">as</span> np
<span style="color: #ff0000; font-weight: bold;"># numerical values of the constants</span>
a = 3.49e4
b = 1.45
p = 679.7   <span style="color: #ff0000; font-weight: bold;"># pressure in psi</span>
T = 683     <span style="color: #ff0000; font-weight: bold;"># T in Rankine</span>
n = 1.136   <span style="color: #ff0000; font-weight: bold;"># lb-moles</span>
R = 10.73       <span style="color: #ff0000; font-weight: bold;"># ft^3 * psi /R / lb-mol</span>

ppar = [1.0, -(p*n*b+n*R*T)/p, n**2*a/p,  -n**3*a*b/p];
<span style="color: #8b0000;">print</span> np.roots(ppar)
</pre>
</div>

<pre class="example">
[ 5.09432376+0.j          4.40066810+1.43502848j  4.40066810-1.43502848j]
</pre>

<p>
Note that only one root is real (and even then, we have to interpet 0.j as not being imaginary. Also, in a cubic polynomial, there can only be two imaginary roots). In this case that means there is only one phase present.
</p>

<div id="outline-container-1" class="outline-2">
<h2 id="sec-1"><span class="section-number-2">1</span> Summary</h2>
<div class="outline-text-2" id="text-1">
<p>
Polynomials in numpy are even better than in Matlab, because you get a polynomial object that acts just like a function. Otherwise, they are functionally equivalent.</p>
</div>
</div>
<p>Copyright (C) 2013 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2013/01/22/Polynomials-in-python.org">org-mode source</a><p>

    </div>
  </div>
</article>



<a href="https://twitter.com/share" class="twitter-share-button" data-via="johnkitchin">Share on Twitter</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>


<a href="https://twitter.com/search?q=https://kitchingroup.cheme.cmu.edu/blog/2013/01/22/Polynomials-in-python">Discuss on Twitter</a>

  <hr class="interblog" />
  





<article>
  <div class="blog_post">
    <header>
      <div id="Controlling-the-format-of-printed-variables"></div>
      <h2 class="blog_post_title"><a href="/blog/2013/01/21/Controlling-the-format-of-printed-variables/" rel="bookmark" title="Permanent Link to Controlling the format of printed variables">Controlling the format of printed variables</a></h2>
      <p><small><span class="blog_post_date">Posted January 21, 2013 at 09:00 AM</span> | categories:
        <span class="blog_post_categories"><a href='/blog/category/python/'>python</a></span> | tags: 
      <p><small><span class="blog_post_date">Updated February 27, 2013 at 02:50 PM</span></small>
      </small></p>
    </header>
    <div class="post_prose">
      



<p>
This was first worked out in this <a href="http://matlab.cheme.cmu.edu/2011/10/06/sprintfing-to-the-finish/" >original Matlab post</a>.
</p>

<p>
Often you will want to control the way a variable is printed. You may want to only show a few decimal places, or print in scientific notation, or embed the result in a string. Here are some examples of printing with no control over the format.
</p>

<div class="org-src-container">

<pre class="src src-python">a = 2./3
<span style="color: #8b0000;">print</span> a
<span style="color: #8b0000;">print</span> 1/3
<span style="color: #8b0000;">print</span> 1./3.
<span style="color: #8b0000;">print</span> 10.1
<span style="color: #8b0000;">print</span> <span style="color: #228b22;">"Avogadro's number is "</span>, 6.022e23,<span style="color: #228b22;">'.'</span>
</pre>
</div>

<pre class="example">
0.666666666667
0
0.333333333333
10.1
Avogadro's number is  6.022e+23 .
</pre>

<p>
There is no control over the number of decimals, or spaces around a printed number. 
</p>

<p>
In python, we use the format function to control how variables are printed. With the format function you use codes like {<i>n</i>:format specifier} to indicate that a formatted string should be used. <i>n</i> is the <i>n^{th}</i> argument passed to format, and there are a variety of format specifiers. Here we examine how to format float numbers. The specifier has the general form &ldquo;w.df&rdquo; where w is the width of the field, and d is the number of decimals, and f indicates a float number. &ldquo;1.3f&rdquo; means to print a float number with 3 decimal places. Here is an example.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">print</span> <span style="color: #228b22;">'The value of 1/3 to 3 decimal places is {0:1.3f}'</span>.format(1./3.)
</pre>
</div>

<pre class="example">
The value of 1/3 to 3 decimal places is 0.333
</pre>

<p>
In that example, the 0 in {0:1.3f} refers to the first (and only) argument to the format function. If there is more than one argument, we can refer to them like this:
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">print</span> <span style="color: #228b22;">'Value 0 = {0:1.3f}, value 1 = {1:1.3f}, value 0 = {0:1.3f}'</span>.format(1./3., 1./6.)
</pre>
</div>

<pre class="example">
Value 0 = 0.333, value 1 = 0.167, value 0 = 0.333
</pre>

<p>
Note you can refer to the same argument more than once, and in arbitrary order within the string.
</p>

<p>
Suppose you have a list of numbers you want to print out, like this:
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">for</span> x <span style="color: #8b0000;">in</span> [1./3., 1./6., 1./9.]:
    <span style="color: #8b0000;">print</span> <span style="color: #228b22;">'The answer is {0:1.2f}'</span>.format(x)
</pre>
</div>

<pre class="example">
The answer is 0.33
The answer is 0.17
The answer is 0.11
</pre>

<p>
The &ldquo;g&rdquo; format specifier is a general format that can be used to indicate a precision, or to indicate significant digits. To print a number with a specific number of significant digits we do this:
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">print</span> <span style="color: #228b22;">'{0:1.3g}'</span>.format(1./3.)
<span style="color: #8b0000;">print</span> <span style="color: #228b22;">'{0:1.3g}'</span>.format(4./3.)
</pre>
</div>

<pre class="example">
0.333
1.33
</pre>

<p>
We can also specify plus or minus signs. Compare the next two outputs.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">for</span> x <span style="color: #8b0000;">in</span> [-1., 1.]: 
    <span style="color: #8b0000;">print</span> <span style="color: #228b22;">'{0:1.2f}'</span>.format(x)
</pre>
</div>

<pre class="example">
-1.00
1.00
</pre>

<p>
You can see the decimals do not align. That is because there is a minus sign in front of one number. We can specify to show the sign for positive and negative numbers, or to pad positive numbers to leave space for positive numbers.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">for</span> x <span style="color: #8b0000;">in</span> [-1., 1.]: 
    <span style="color: #8b0000;">print</span> <span style="color: #228b22;">'{0:+1.2f}'</span>.format(x) <span style="color: #ff0000; font-weight: bold;"># explicit sign</span>

<span style="color: #8b0000;">for</span> x <span style="color: #8b0000;">in</span> [-1., 1.]: 
    <span style="color: #8b0000;">print</span> <span style="color: #228b22;">'{0: 1.2f}'</span>.format(x) <span style="color: #ff0000; font-weight: bold;"># pad positive numbers</span>
</pre>
</div>

<pre class="example">
-1.00
+1.00
-1.00
 1.00
</pre>

<p>
We use the &ldquo;e&rdquo; or &ldquo;E&rdquo; format modifier to specify scientific notation.
</p>
<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">import</span> numpy <span style="color: #8b0000;">as</span> np
eps = np.finfo(np.double).eps
<span style="color: #8b0000;">print</span> eps
<span style="color: #8b0000;">print</span> <span style="color: #228b22;">'{0}'</span>.format(eps)
<span style="color: #8b0000;">print</span> <span style="color: #228b22;">'{0:1.2f}'</span>.format(eps)
<span style="color: #8b0000;">print</span> <span style="color: #228b22;">'{0:1.2e}'</span>.format(eps)  <span style="color: #ff0000; font-weight: bold;">#exponential notation</span>
<span style="color: #8b0000;">print</span> <span style="color: #228b22;">'{0:1.2E}'</span>.format(eps)  <span style="color: #ff0000; font-weight: bold;">#exponential notation with capital E</span>
</pre>
</div>

<pre class="example">
2.22044604925e-16
2.22044604925e-16
0.00
2.22e-16
2.2E-16
</pre>

<p>
As a float with 2 decimal places, that very small number is practically equal to 0.
</p>

<p>
We can even format percentages. Note you do not need to put the % in your string.
</p>
<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">print</span> <span style="color: #228b22;">'the fraction {0} corresponds to {0:1.0%}'</span>.format(0.78)
</pre>
</div>

<pre class="example">
the fraction 0.78 corresponds to 78%
</pre>

<p>
There are many other options for formatting strings. See <a href="http://docs.python.org/2/library/string.html#formatstrings" >http://docs.python.org/2/library/string.html#formatstrings</a> for a full specification of the options.
</p>
<p>Copyright (C) 2013 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2013/01/21/Controlling-the-format-of-printed-variables.org">org-mode source</a><p>

    </div>
  </div>
</article>



<a href="https://twitter.com/share" class="twitter-share-button" data-via="johnkitchin">Share on Twitter</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>


<a href="https://twitter.com/search?q=https://kitchingroup.cheme.cmu.edu/blog/2013/01/21/Controlling-the-format-of-printed-variables">Discuss on Twitter</a>

  <hr class="interblog" />
  





<article>
  <div class="blog_post">
    <header>
      <div id="Integrating-equations-in-python"></div>
      <h2 class="blog_post_title"><a href="/blog/2013/01/20/Integrating-equations-in-python/" rel="bookmark" title="Permanent Link to Integrating equations in python">Integrating equations in python</a></h2>
      <p><small><span class="blog_post_date">Posted January 20, 2013 at 09:00 AM</span> | categories:
        <span class="blog_post_categories"><a href='/blog/category/python/'>python</a>, <a href='/blog/category/integration/'>integration</a></span> | tags: 
      <p><small><span class="blog_post_date">Updated February 27, 2013 at 02:54 PM</span></small>
      </small></p>
    </header>
    <div class="post_prose">
      




<p>
A common need in engineering calculations is to integrate an equation over some range to determine the total change. For example, say we know the volumetric flow changes with time according to \(d\nu/dt = \alpha t\), where \(\alpha = 1\) L/min and we want to know how much liquid flows into a tank over 10 minutes if the volumetric flowrate is \(\nu_0 = 5\) L/min at \(t=0\). The answer to that question is the value of this integral: \(V = \int_0^{10} \nu_0 + \alpha t dt\). 
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">import</span> scipy
<span style="color: #8b0000;">from</span> scipy.integrate <span style="color: #8b0000;">import</span> quad

nu0 = 5     <span style="color: #ff0000; font-weight: bold;"># L/min</span>
alpha = 1.0 <span style="color: #ff0000; font-weight: bold;"># L/min</span>
<span style="color: #8b0000;">def</span> <span style="color: #8b2323;">integrand</span>(t):
    <span style="color: #8b0000;">return</span> nu0 + alpha * t

t0 = 0.0
tfinal = 10.0
V, estimated_error = quad(integrand, t0, tfinal)
<span style="color: #8b0000;">print</span>(<span style="color: #228b22;">'{0:1.2f} L flowed into the tank over 10 minutes'</span>.format(V))
</pre>
</div>

<pre class="example">
100.00 L flowed into the tank over 10 minutes
</pre>

<p>
That is all there is too it!</p>
<p>Copyright (C) 2013 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2013/01/20/Integrating-equations-in-python.org">org-mode source</a><p>

    </div>
  </div>
</article>



<a href="https://twitter.com/share" class="twitter-share-button" data-via="johnkitchin">Share on Twitter</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>


<a href="https://twitter.com/search?q=https://kitchingroup.cheme.cmu.edu/blog/2013/01/20/Integrating-equations-in-python">Discuss on Twitter</a>

  <hr class="interblog" />
  





<article>
  <div class="blog_post">
    <header>
      <div id="Using-units-in-python"></div>
      <h2 class="blog_post_title"><a href="/blog/2013/01/19/Using-units-in-python/" rel="bookmark" title="Permanent Link to Using units in python">Using units in python</a></h2>
      <p><small><span class="blog_post_date">Posted January 19, 2013 at 09:00 AM</span> | categories:
        <span class="blog_post_categories"><a href='/blog/category/python/'>python</a>, <a href='/blog/category/units/'>units</a></span> | tags: 
      <p><small><span class="blog_post_date">Updated March 23, 2013 at 09:45 AM</span></small>
      </small></p>
    </header>
    <div class="post_prose">
      



<p>
<a href="http://matlab.cheme.cmu.edu/2011/08/05/using-cmu-units-in-matlab-for-basic-calculations/" >Units in Matlab</a>
</p>

<p>
I think an essential feature in an engineering computational environment is properly handling units and unit conversions. Mathcad supports that pretty well. I wrote a <a href="https://github.com/jkitchin/matlab-cmu" >package</a> for doing it in Matlab. Today I am going to explore units in python. Here are some of the packages that I have found which support units to some extent
</p>

<ol>
<li><a href="http://pypi.python.org/pypi/units/" >http://pypi.python.org/pypi/units/</a>
</li>
<li><a href="http://packages.python.org/quantities/user/tutorial.html" >http://packages.python.org/quantities/user/tutorial.html</a>
</li>
<li><a href="http://dirac.cnrs-orleans.fr/ScientificPython/ScientificPythonManual/Scientific.Physics.PhysicalQuantities-module.html" >http://dirac.cnrs-orleans.fr/ScientificPython/ScientificPythonManual/Scientific.Physics.PhysicalQuantities-module.html</a>
</li>
<li><a href="http://home.scarlet.be/be052320/Unum.html" >http://home.scarlet.be/be052320/Unum.html</a>
</li>
<li><a href="https://simtk.org/home/python_units" >https://simtk.org/home/python_units</a>
</li>
<li><a href="http://docs.enthought.com/scimath/units/intro.html" >http://docs.enthought.com/scimath/units/intro.html</a>
</li>
</ol>

<p>
The last one looks most promising.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">import</span> numpy <span style="color: #8b0000;">as</span> np
<span style="color: #8b0000;">from</span> scimath.units.volume <span style="color: #8b0000;">import</span> liter
<span style="color: #8b0000;">from</span> scimath.units.substance <span style="color: #8b0000;">import</span> mol

q = np.array([1, 2, 3]) * mol
<span style="color: #8b0000;">print</span> q

P = q / liter
<span style="color: #8b0000;">print</span> P
</pre>
</div>

<pre class="example">
[1.0*mol 2.0*mol 3.0*mol]
[1000.0*m**-3*mol 2000.0*m**-3*mol 3000.0*m**-3*mol]
</pre>

<p>
That doesn't look too bad. It is a little clunky to have to import every unit, and it is clear the package is saving everything in SI units by default. Let us try to solve an equation.
</p>

<p>
Find the time that solves this equation. 
</p>

<p>
\(0.01 = C_{A0} e^{-kt}\)
</p>

<p>
First we solve without units. That way we know the answer.
</p>
<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">import</span> numpy <span style="color: #8b0000;">as</span> np
<span style="color: #8b0000;">from</span> scipy.optimize <span style="color: #8b0000;">import</span> fsolve

CA0 = 1.0  <span style="color: #ff0000; font-weight: bold;"># mol/L</span>
CA = 0.01  <span style="color: #ff0000; font-weight: bold;"># mol/L</span>
k = 1.0    <span style="color: #ff0000; font-weight: bold;"># 1/s</span>

<span style="color: #8b0000;">def</span> <span style="color: #8b2323;">func</span>(t):
    z = CA - CA0 * np.exp(-k*t)
    <span style="color: #8b0000;">return</span> z

t0 = 2.3

t, = fsolve(func, t0)
<span style="color: #8b0000;">print</span> <span style="color: #228b22;">'t = {0:1.2f} seconds'</span>.format(t)
</pre>
</div>

<pre class="example">
t = 4.61 seconds
</pre>


<p>
Now, with units. I note here that I tried the obvious thing of just importing the units, and adding them on, but the package is unable to work with floats that have units. For some functions, there must be an ndarray with units which is practically what the UnitScalar code below does. 
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">import</span> numpy <span style="color: #8b0000;">as</span> np
<span style="color: #8b0000;">from</span> scipy.optimize <span style="color: #8b0000;">import</span> fsolve
<span style="color: #8b0000;">from</span> scimath.units.volume <span style="color: #8b0000;">import</span> liter
<span style="color: #8b0000;">from</span> scimath.units.substance <span style="color: #8b0000;">import</span> mol
<span style="color: #8b0000;">from</span> scimath.units.time <span style="color: #8b0000;">import</span> second
<span style="color: #8b0000;">from</span> scimath.units.api <span style="color: #8b0000;">import</span> has_units, UnitScalar

CA0 = UnitScalar(1.0, units = mol / liter)
CA = UnitScalar(0.01, units = mol / liter)
k = UnitScalar(1.0, units = 1 / second)

<span style="color: #8b0000;">@has_units</span>(inputs=<span style="color: #228b22;">"t::units=s"</span>,
           outputs=<span style="color: #228b22;">"result::units=mol/liter"</span>)
<span style="color: #8b0000;">def</span> <span style="color: #8b2323;">func</span>(t):
    z = CA - CA0 * <span style="color: #8b0000;">float</span>(np.exp(-k*t))
    <span style="color: #8b0000;">return</span> z

t0 = UnitScalar(2.3, units = second)

t, = fsolve(func, t0)
<span style="color: #8b0000;">print</span> <span style="color: #228b22;">'t = {0:1.2f} seconds'</span>.format(t)
<span style="color: #8b0000;">print</span> type(t)
</pre>
</div>

<pre class="example">
t = 4.61 seconds
&lt;type 'numpy.float64'&gt;
</pre>

<p>
This is some heavy syntax that in the end does not preserve the units. In my Matlab package, we had to &ldquo;wrap&rdquo; many functions like fsolve so they would preserve units. Clearly this package will need that as well. Overall, in its current implementation this package does not do what I would expect all the time.<sup><a id="fnr.1" name="fnr.1" class="footref" href="#fn.1">1</a></sup>
</p>
<p>Copyright (C) 2013 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2013/01/19/Using-units-in-python.org">org-mode source</a><p>

    </div>
  </div>
</article>



<a href="https://twitter.com/share" class="twitter-share-button" data-via="johnkitchin">Share on Twitter</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>


<a href="https://twitter.com/search?q=https://kitchingroup.cheme.cmu.edu/blog/2013/01/19/Using-units-in-python">Discuss on Twitter</a>

  <hr class="interblog" />
  





<article>
  <div class="blog_post">
    <header>
      <div id="Integrating-a-batch-reactor-design-equation"></div>
      <h2 class="blog_post_title"><a href="/blog/2013/01/06/Integrating-a-batch-reactor-design-equation/" rel="bookmark" title="Permanent Link to Integrating a batch reactor design equation">Integrating a batch reactor design equation</a></h2>
      <p><small><span class="blog_post_date">Posted January 06, 2013 at 09:00 AM</span> | categories:
        <span class="blog_post_categories"><a href='/blog/category/integration/'>integration</a></span> | tags: <a href='/blog/tag/reaction-engineering/'>reaction engineering</a>
      <p><small><span class="blog_post_date">Updated March 06, 2013 at 04:30 PM</span></small>
      </small></p>
    </header>
    <div class="post_prose">
      



<p>
For a constant volume batch reactor where \(A \rightarrow B\) at a rate of \(-r_A = k C_A^2\), we derive the following design equation for the length of time required to achieve a particular level of conversion :
</p>

<p>
\(t(X) = \frac{1}{k C_{A0}} \int_{X=0}^X \frac{dX}{(1-X)^2}\)
</p>

<p>
if \(k = 10^{-3}\) L/mol/s and \(C_{A0}\) = 1 mol/L, estimate the time to achieve 90% conversion.
</p>

<p>
We could analytically solve the integral and evaluate it, but instead we will numerically evaluate it using scipy.integrate.quad. This function returns two values: the evaluated integral, and an estimate of the absolute error in the answer.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">from</span> scipy.integrate <span style="color: #8b0000;">import</span> quad

<span style="color: #8b0000;">def</span> <span style="color: #8b2323;">integrand</span>(X):
    k = 1.0e-3
    Ca0 = 1.0  <span style="color: #ff0000; font-weight: bold;"># mol/L</span>
    <span style="color: #8b0000;">return</span> 1./(k*Ca0)*(1./(1-X)**2)

sol, abserr = quad(integrand, 0, 0.9)
<span style="color: #8b0000;">print</span> <span style="color: #228b22;">'t = {0} seconds ({1} hours)'</span>.format(sol, sol/3600)
<span style="color: #8b0000;">print</span> <span style="color: #228b22;">'Estimated absolute error = {0}'</span>.format(abserr)
</pre>
</div>

<pre class="example">
t = 9000.0 seconds (2.5 hours)
Estimated absolute error = 2.12203274482e-07
</pre>


<p>
You can see the estimate error is very small compared to the solution.
</p>
<p>Copyright (C) 2013 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2013/01/06/Integrating-a-batch-reactor-design-equation.org">org-mode source</a><p>

    </div>
  </div>
</article>



<a href="https://twitter.com/share" class="twitter-share-button" data-via="johnkitchin">Share on Twitter</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>


<a href="https://twitter.com/search?q=https://kitchingroup.cheme.cmu.edu/blog/2013/01/06/Integrating-a-batch-reactor-design-equation">Discuss on Twitter</a>

  <hr class="interblog" />
 <a href="../1">« Previous Page</a>
  --  
 <a href="../3">Next Page »</a>

          </div>
          <div id="sidebar" class="grid_4">
            <aside>
<section>
<script>
  (function() {
    var cx = '002533177287215655227:l7uvu35ssbc';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
        '//www.google.com/cse/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>
</section>

<section>
    <h1 class="post_header_gradient theme_font">Twitter</h1>
    <a class="twitter-timeline" href="https://twitter.com/johnkitchin" data-widget-id="545217643582881792">Tweets by @johnkitchin</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+"://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
</section>


  <section>
    <h1 class="post_header_gradient theme_font">Links</h1>
    <ul>
      <li><a href="https://www.continuum.io">Anaconda Python</a></li>
      <li><a href="/pycse">Pycse</a></li>
      <li><a href="/dft-book">DFT-book</a></li>
    </ul>
  </section>

  <section>
    <h1 class="post_header_gradient theme_font">Latest Posts</h1>
    <ul>
      <li><a href="/blog/2021/06/21/New-publication-Machine-learning-accelerated-geometry-optimization-in-molecular-simulation/">New publication "Machine-learning accelerated geometry optimization in molecular simulation"</a></li>
      <li><a href="/blog/2021/03/07/New-publication-Semi-grand-Canonical-Monte-Carlo-Simulation-of-the-Acrolein-induced-Surface-Segregation-and-Aggregation-of-AgPd-with-Machine-Learning-Surrogate-Models/">New publication - Semi-grand Canonical Monte Carlo Simulation of the Acrolein induced Surface Segregation and Aggregation of AgPd with Machine Learning Surrogate Models</a></li>
      <li><a href="/blog/2020/07/09/New-publication-SingleNN-Modified-Behler-Parrinello-Neural-Network-with-Shared-Weights-for-Atomistic-Simulations-with-Transferability/">New publication SingleNN - Modified Behler–Parrinello Neural Network with Shared Weights for Atomistic Simulations with Transferability</a></li>
      <li><a href="/blog/2020/03/10/New-publication-Parallelized-Screening-of-Characterized-and-DFT-Modelled-Bimetallic-Colloidal-Co-Catalysts-for-Photocatalytic-Hydrogen-Evolution/">New publication - Parallelized Screening of Characterized and DFT-Modelled Bimetallic Colloidal Co-Catalysts for Photocatalytic Hydrogen Evolution</a></li>
      <li><a href="/blog/2019/10/02/Using-autograd-to-plot-implicit-functions/">Using autograd to plot implicit functions</a></li>
    </ul>
  </section>

<section>
<h1 class="post_header_gradient theme_font">Latest GitHub Repos</h1>
  <a href="https://github.com/jkitchin">@jkitchin</a> on GitHub.
  <ul id="my-github-projects">
        <li class="loading">Status updating&#8230;</li>
  </ul>

</section>
</aside>

          </div>
          <div class="clear"></div>
        </div>
      </div>
      
<footer>
  <div id="footer" class="grid_12">
    <div class="grid_8">
      <p>
        <a href="/blog/feed/index.xml">RSS</a>
      </p>
    </div>
    <div class="grid_4" id="credits">
      <p>
        Copyright 2021
        John Kitchin
      </p>
      <p>
        Powered by <a href="http://www.blogofile.com">Blogofile</a>
      </p>
    </div>
  </div>
</footer>

    </div>
      <script src="//ajax.googleapis.com/ajax/libs/jquery/1.5.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="/js/libs/jquery-1.5.1.min.js"%3E%3C/script%3E'))</script>
  <script src="/js/plugins.js"></script>
  <script src="/js/script.js"></script>
  <script src="/js/jquery.tweet.js"></script>  
  <script src="/js/site.js"></script>
  <!--[if lt IE 7 ]>
  <script src="js/libs/dd_belatedpng.js"></script>
  <script> DD_belatedPNG.fix('img, .png_bg');</script>
  <![endif]-->
  <script>
      var _gaq=[['_setAccount','UA-35731398-1'],['_trackPageview']];
      (function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];g.async=1;
      g.src=('https:'==location.protocol?'//ssl':'//www')+'.google-analytics.com/ga.js';
      s.parentNode.insertBefore(g,s)}(document,'script'));
  </script>

  </body>
</html>






<script src="http://ajax.microsoft.com/ajax/jquery/jquery-1.4.2.min.js" type="text/javascript"></script>
<script src="/js/git.js" type="text/javascript"></script>
<script type="text/javascript">
    $(function() {
     $("#my-github-projects").loadRepositories("jkitchin");
    });
</script>



