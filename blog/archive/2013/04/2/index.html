

<!doctype html>
<!--[if lt IE 7 ]> <html lang="en" class="no-js ie6"> <![endif]-->
<!--[if IE 7 ]>    <html lang="en" class="no-js ie7"> <![endif]-->
<!--[if IE 8 ]>    <html lang="en" class="no-js ie8"> <![endif]-->
<!--[if IE 9 ]>    <html lang="en" class="no-js ie9"> <![endif]-->
<!--[if (gt IE 9)|!(IE)]><!--> <html lang="en" class="no-js"> <!--<![endif]-->
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>The Kitchin Research Group</title>
  <meta name="google-site-verification" content="CGcacJdHc2YoZyI0Vey9XRA5qwhhFDzThKJezbRFcJ4" />
  <meta name="description" content="Chemical Engineering at Carnegie Mellon University">
  <meta name="author" content="John Kitchin">
  <link rel="alternate" type="application/rss+xml" title="RSS 2.0" href="/blog/feed" />
  <link rel="alternate" type="application/atom+xml" title="Atom 1.0" href="/blog/feed/atom" />
  <link rel="shortcut icon" href="/favicon.ico">
  <link rel="apple-touch-icon" href="/img/apple-touch-icon.png">

  <link rel="stylesheet" href="/css/base.css?v=1">
  <link rel="stylesheet" href="/css/grid.css?v=1">
  <link rel="stylesheet" media="handheld" href="/css/handheld.css?v=1">
  <link rel="stylesheet" href="/css/pygments_murphy.css" type="text/css" />

  <script src="/js/libs/modernizr-1.7.min.js"></script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        displayAlign: "center",
        displayIndent: "0em",

        "HTML-CSS": { scale: 100,
                        linebreaks: { automatic: "false" },
                        webFont: "TeX"
                       },
        SVG: {scale: 100,
              linebreaks: { automatic: "false" },
              font: "TeX"},
        NativeMML: {scale: 100},
        TeX: { equationNumbers: {autoNumber: "AMS"},
               MultLineWidth: "85%",
               TagSide: "right",
               TagIndent: ".8em"
             }
});
</script>
<script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_HTML"></script>
  <link rel="stylesheet" href="/themes/theme1/style.css?v=1">
<link href='http://fonts.googleapis.com/css?family=Roboto' rel='stylesheet' type='text/css'>

</head>
  <body>
    <div id="container" class="container container_12">
      <div id="main" role="main">
        <div id="main_block">
          <header>
<div id="header" class="header_gradient theme_font">
<table><tr><td>
    <h1><a href="/">The Kitchin Research Group</a></h1>
    <h2>Chemical Engineering at Carnegie Mellon University</h2>
</td>
<td colspan=100%><div style="float:right;width:100%;text-align:right;"> <span id='badgeCont737515' style='width:126px'><script src='http://labs.researcherid.com/mashlets?el=badgeCont737515&mashlet=badge&showTitle=false&className=a&rid=A-2363-2010'></script></span></div>
</td></tr>
</table>
</div>
  <div id="navigation" class="grid_12">

    <ul class="theme_font">
      <li><a href="/blog"
             class="">Blog</a></li>

      <li><a href="/blog/archive"
             class="">Archives</a></li>

      <li><a href="/publications.html">Publications</a></li>

      <li><a href="/research.html"
             class="">Research</a></li>

      <li><a href="/categories.html"
             class="">Categories</a></li>

      <li><a href="/about.html"
             class="">About us</a></li>

      <li><a href="/subscribe.html">Subscribe</a></li>

    </ul>
  </div>
</header>

          <div id="prose_block" class="grid_8">
            
  





<article>
  <div class="blog_post">
    <header>
      <div id="Working-with-lists"></div>
      <h2 class="blog_post_title"><a href="/blog/2013/04/09/Working-with-lists/" rel="bookmark" title="Permanent Link to Working with lists">Working with lists</a></h2>
      <p><small><span class="blog_post_date">Posted April 09, 2013 at 09:54 PM</span> | categories:
        <span class="blog_post_categories"><a href='/blog/category/programming/'>programming</a></span> | tags: 
      <p><small><span class="blog_post_date">Updated May 19, 2013 at 11:27 AM</span></small>
      </small></p>
    </header>
    <div class="post_prose">
      



<p>
It is not too uncommon to have a list of data, and then to apply a function to every element, to filter the list, or extract elements that meet some criteria. In this example, we take a string and split it into words. Then, we will examine several ways to apply functions to the words, to filter the list to get data that meets some criteria. Here is the string splitting.
</p>

<div class="org-src-container">

<pre class="src src-python">text = <span style="color: #228b22;">'''</span>
<span style="color: #228b22;"> As we have seen, handling units with third party functions is fragile, and often requires additional code to wrap the function to handle the units. An alternative approach that avoids the wrapping is to rescale the equations so they are dimensionless. Then, we should be able to use all the standard external functions without modification. We obtain the final solutions by rescaling back to the answers we want.</span>

<span style="color: #228b22;">Before doing the examples, let us consider how the quantities package handles dimensionless numbers.</span>

<span style="color: #228b22;">import quantities as u</span>

<span style="color: #228b22;">a = 5 * u.m</span>
<span style="color: #228b22;">L = 10 * u.m # characteristic length</span>

<span style="color: #228b22;">print a/L</span>
<span style="color: #228b22;">print type(a/L)</span>

<span style="color: #228b22;">'''</span>

words = text.split()
<span style="color: #8b0000;">print</span> words
</pre>
</div>

<pre class="example">
... ... ... ... ... ... ... ... ... ... ... ... &gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; ['As', 'we', 'have', 'seen,', 'handling', 'units', 'with', 'third', 'party', 'functions', 'is', 'fragile,', 'and', 'often', 'requires', 'additional', 'code', 'to', 'wrap', 'the', 'function', 'to', 'handle', 'the', 'units.', 'An', 'alternative', 'approach', 'that', 'avoids', 'the', 'wrapping', 'is', 'to', 'rescale', 'the', 'equations', 'so', 'they', 'are', 'dimensionless.', 'Then,', 'we', 'should', 'be', 'able', 'to', 'use', 'all', 'the', 'standard', 'external', 'functions', 'without', 'modification.', 'We', 'obtain', 'the', 'final', 'solutions', 'by', 'rescaling', 'back', 'to', 'the', 'answers', 'we', 'want.', 'Before', 'doing', 'the', 'examples,', 'let', 'us', 'consider', 'how', 'the', 'quantities', 'package', 'handles', 'dimensionless', 'numbers.', 'import', 'quantities', 'as', 'u', 'a', '=', '5', '*', 'u.m', 'L', '=', '10', '*', 'u.m', '#', 'characteristic', 'length', 'print', 'a/L', 'print', 'type(a/L)']
</pre>

<p>
Let us get the length of each word.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">print</span> [<span style="color: #8b0000;">len</span>(word) <span style="color: #8b0000;">for</span> word <span style="color: #8b0000;">in</span> words]

<span style="color: #ff0000; font-weight: bold;"># functional approach with a lambda function</span>
<span style="color: #8b0000;">print</span> map(<span style="color: #8b0000;">lambda</span> word: <span style="color: #8b0000;">len</span>(word), words)

<span style="color: #ff0000; font-weight: bold;"># functional approach with a builtin function</span>
<span style="color: #8b0000;">print</span> map(len, words)

<span style="color: #ff0000; font-weight: bold;"># functional approach with a user-defined function</span>
<span style="color: #8b0000;">def</span> <span style="color: #8b2323;">get_length</span>(word):
    <span style="color: #8b0000;">return</span> <span style="color: #8b0000;">len</span>(word)

<span style="color: #8b0000;">print</span> map(get_length, words)
</pre>
</div>

<pre class="example">
[2, 2, 4, 5, 8, 5, 4, 5, 5, 9, 2, 8, 3, 5, 8, 10, 4, 2, 4, 3, 8, 2, 6, 3, 6, 2, 11, 8, 4, 6, 3, 8, 2, 2, 7, 3, 9, 2, 4, 3, 14, 5, 2, 6, 2, 4, 2, 3, 3, 3, 8, 8, 9, 7, 13, 2, 6, 3, 5, 9, 2, 9, 4, 2, 3, 7, 2, 5, 6, 5, 3, 9, 3, 2, 8, 3, 3, 10, 7, 7, 13, 8, 6, 10, 2, 1, 1, 1, 1, 1, 3, 1, 1, 2, 1, 3, 1, 14, 6, 5, 3, 5, 9]
&gt;&gt;&gt; ... [2, 2, 4, 5, 8, 5, 4, 5, 5, 9, 2, 8, 3, 5, 8, 10, 4, 2, 4, 3, 8, 2, 6, 3, 6, 2, 11, 8, 4, 6, 3, 8, 2, 2, 7, 3, 9, 2, 4, 3, 14, 5, 2, 6, 2, 4, 2, 3, 3, 3, 8, 8, 9, 7, 13, 2, 6, 3, 5, 9, 2, 9, 4, 2, 3, 7, 2, 5, 6, 5, 3, 9, 3, 2, 8, 3, 3, 10, 7, 7, 13, 8, 6, 10, 2, 1, 1, 1, 1, 1, 3, 1, 1, 2, 1, 3, 1, 14, 6, 5, 3, 5, 9]
&gt;&gt;&gt; [2, 2, 4, 5, 8, 5, 4, 5, 5, 9, 2, 8, 3, 5, 8, 10, 4, 2, 4, 3, 8, 2, 6, 3, 6, 2, 11, 8, 4, 6, 3, 8, 2, 2, 7, 3, 9, 2, 4, 3, 14, 5, 2, 6, 2, 4, 2, 3, 3, 3, 8, 8, 9, 7, 13, 2, 6, 3, 5, 9, 2, 9, 4, 2, 3, 7, 2, 5, 6, 5, 3, 9, 3, 2, 8, 3, 3, 10, 7, 7, 13, 8, 6, 10, 2, 1, 1, 1, 1, 1, 3, 1, 1, 2, 1, 3, 1, 14, 6, 5, 3, 5, 9]
&gt;&gt;&gt; ... ... ... &gt;&gt;&gt; [2, 2, 4, 5, 8, 5, 4, 5, 5, 9, 2, 8, 3, 5, 8, 10, 4, 2, 4, 3, 8, 2, 6, 3, 6, 2, 11, 8, 4, 6, 3, 8, 2, 2, 7, 3, 9, 2, 4, 3, 14, 5, 2, 6, 2, 4, 2, 3, 3, 3, 8, 8, 9, 7, 13, 2, 6, 3, 5, 9, 2, 9, 4, 2, 3, 7, 2, 5, 6, 5, 3, 9, 3, 2, 8, 3, 3, 10, 7, 7, 13, 8, 6, 10, 2, 1, 1, 1, 1, 1, 3, 1, 1, 2, 1, 3, 1, 14, 6, 5, 3, 5, 9]
</pre>

<p>
Now let us get all the words that start with the letter &ldquo;a&rdquo;. This is sometimes called filtering a list. We use a string function <code>startswith</code> to check for upper and lower-case letters. We will use list comprehension with a condition.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">print</span> [word <span style="color: #8b0000;">for</span> word <span style="color: #8b0000;">in</span> words <span style="color: #8b0000;">if</span> word.startswith(<span style="color: #228b22;">'a'</span>) <span style="color: #8b0000;">or</span> word.startswith(<span style="color: #228b22;">'A'</span>)]

<span style="color: #ff0000; font-weight: bold;"># make word lowercase to simplify the conditional statement</span>
<span style="color: #8b0000;">print</span> [word <span style="color: #8b0000;">for</span> word <span style="color: #8b0000;">in</span> words <span style="color: #8b0000;">if</span> word.lower().startswith(<span style="color: #228b22;">'a'</span>)]
</pre>
</div>

<pre class="example">
['As', 'and', 'additional', 'An', 'alternative', 'approach', 'avoids', 'are', 'able', 'all', 'answers', 'as', 'a', 'a/L']
['As', 'and', 'additional', 'An', 'alternative', 'approach', 'avoids', 'are', 'able', 'all', 'answers', 'as', 'a', 'a/L']
</pre>

<p>
A slightly harder example is to find all the words that are actually numbers. We could use a regular expression for that, but we will instead use a function we create. We use a function that tries to cast a word as a float. If this fails, we know the word is not a float, so we return False.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">def</span> <span style="color: #8b2323;">float_p</span>(word):
    <span style="color: #8b0000;">try:</span>
        <span style="color: #8b0000;">float</span>(word)
        <span style="color: #8b0000;">return</span> <span style="color: #8b0000;">True</span>
    <span style="color: #8b0000;">except</span> <span style="color: #cd0000;">ValueError</span>:
        <span style="color: #8b0000;">return</span> <span style="color: #8b0000;">False</span>

<span style="color: #8b0000;">print</span> [word <span style="color: #8b0000;">for</span> word <span style="color: #8b0000;">in</span> words <span style="color: #8b0000;">if</span> float_p(word)]

<span style="color: #ff0000; font-weight: bold;"># here is a functional approach</span>
<span style="color: #8b0000;">print</span> filter(float_p, words)
</pre>
</div>

<pre class="example">
... ... ... ... ... &gt;&gt;&gt; ['5', '10']
['5', '10']
</pre>

<p>
Finally, we consider filtering the list to find all words that contain certain symbols, say any character in this string &ldquo;./=*#&rdquo;. Any of those characters will do, so we search each word for one of them, and return True if it contains it, and False if none are contained. 
</p>
<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">def</span> <span style="color: #8b2323;">punctuation_p</span>(word):
    S = <span style="color: #228b22;">'./=*#'</span>
    <span style="color: #8b0000;">for</span> s <span style="color: #8b0000;">in</span> S:
        <span style="color: #8b0000;">if</span> s <span style="color: #8b0000;">in</span> word:
            <span style="color: #8b0000;">return</span> <span style="color: #8b0000;">True</span>
    <span style="color: #8b0000;">return</span> <span style="color: #8b0000;">False</span>

<span style="color: #8b0000;">print</span> [word <span style="color: #8b0000;">for</span> word <span style="color: #8b0000;">in</span> words <span style="color: #8b0000;">if</span> punctuation_p(word)]
<span style="color: #8b0000;">print</span> filter(punctuation_p, words)
</pre>
</div>

<pre class="example">
... ... ... ... ... &gt;&gt;&gt; ['units.', 'dimensionless.', 'modification.', 'want.', 'numbers.', '=', '*', 'u.m', '=', '*', 'u.m', '#', 'a/L', 'type(a/L)']
['units.', 'dimensionless.', 'modification.', 'want.', 'numbers.', '=', '*', 'u.m', '=', '*', 'u.m', '#', 'a/L', 'type(a/L)']
</pre>

<p>
In this section we examined a few ways to interact with lists using list comprehension and functional programming. These approaches make it possible to work on arbitrary size lists, without needing to know in advance how big the lists are. New lists are automatically generated as results, without the need to preallocate lists, i.e. you do not need to know the size of the output. This can be handy as it avoids needing to write loops in some cases and leads to more compact code.
</p>
<p>Copyright (C) 2013 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2013/04/09/Working-with-lists.org">org-mode source</a><p>

    </div>
  </div>
</article>



<a href="https://twitter.com/share" class="twitter-share-button" data-via="johnkitchin">Share on Twitter</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>


<a href="https://twitter.com/search?q=https://kitchingroup.cheme.cmu.edu/blog/2013/04/09/Working-with-lists">Discuss on Twitter</a>

  <hr class="interblog" />
  





<article>
  <div class="blog_post">
    <header>
      <div id="Using-Excel-in-Python"></div>
      <h2 class="blog_post_title"><a href="/blog/2013/04/06/Using-Excel-in-Python/" rel="bookmark" title="Permanent Link to Using Excel in Python">Using Excel in Python</a></h2>
      <p><small><span class="blog_post_date">Posted April 06, 2013 at 02:01 PM</span> | categories:
        <span class="blog_post_categories"><a href='/blog/category/programming/'>programming</a></span> | tags: <a href='/blog/tag/excel/'>excel</a>
      </small></p>
    </header>
    <div class="post_prose">
      



<p>
There may be a time where you have an Excel sheet that already has a model built into it, and you normally change cells in the sheet, and it solves the model. It can be tedious to do that a lot, and we can use python to do that. Python has a COM interface that can communicate with Excel (and many other windows programs. see <a href="http://my.safaribooksonline.com/1565926218" >http://my.safaribooksonline.com/1565926218</a> for Python Programming on Win32). In this example, we will use a very simple Excel sheet that calculates the volume of a CSTR that runs a zeroth order reaction (\(-r_A = k\)) for a particular conversion. You set the conversion in the cell B1, and the volume is automatically computed in cell B6. We simply need to set the value of B1, and get the value of B6 for a range of different conversion values. In this example, the volume is returned in Liters.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">import</span> win32com.client <span style="color: #8b0000;">as</span> win32
excel = win32.Dispatch(<span style="color: #228b22;">'Excel.Application'</span>)

wb = excel.Workbooks.Open(<span style="color: #228b22;">'c:/Users/jkitchin/Dropbox/pycse/data/cstr-zeroth-order.xlsx'</span>)
ws = wb.Worksheets(<span style="color: #228b22;">'Sheet1'</span>)

X = [0.1, 0.5, 0.9]
<span style="color: #8b0000;">for</span> x <span style="color: #8b0000;">in</span> X:
    ws.Range(<span style="color: #228b22;">"B1"</span>).Value = x
    V = ws.Range(<span style="color: #228b22;">"B6"</span>).Value
    <span style="color: #8b0000;">print</span> <span style="color: #228b22;">'at X = {0} V = {1:1.2f} L'</span>.format(x, V)
 
<span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">we tell Excel the workbook is saved, even though it is not, so it</span>
<span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">will quit without asking us to save.</span>
excel.ActiveWorkbook.Saved = <span style="color: #8b0000;">True</span> 
excel.Application.Quit()
</pre>
</div>

<pre class="example">
at X = 0.1 V = 22.73 L
at X = 0.5 V = 113.64 L
at X = 0.9 V = 204.55 L
</pre>

<p>
This was a simple example (one that did not actually need Excel at all) that illustrates the feasibility of communicating with Excel via a COM interface. 
</p>
<p>Copyright (C) 2013 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2013/04/06/Using-Excel-in-Python.org">org-mode source</a><p>

    </div>
  </div>
</article>



<a href="https://twitter.com/share" class="twitter-share-button" data-via="johnkitchin">Share on Twitter</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>


<a href="https://twitter.com/search?q=https://kitchingroup.cheme.cmu.edu/blog/2013/04/06/Using-Excel-in-Python">Discuss on Twitter</a>

  <hr class="interblog" />
  





<article>
  <div class="blog_post">
    <header>
      <div id="Transient-diffusion-partial-differential-equations"></div>
      <h2 class="blog_post_title"><a href="/blog/2013/04/02/Transient-diffusion-partial-differential-equations/" rel="bookmark" title="Permanent Link to Transient diffusion - partial differential equations">Transient diffusion - partial differential equations</a></h2>
      <p><small><span class="blog_post_date">Posted April 02, 2013 at 09:27 AM</span> | categories:
        <span class="blog_post_categories"><a href='/blog/category/pde/'>pde</a></span> | tags: <a href='/blog/tag/mass-transfer/'>mass transfer</a>
      <p><small><span class="blog_post_date">Updated April 02, 2013 at 09:44 AM</span></small>
      </small></p>
    </header>
    <div class="post_prose">
      



<p>

We want to solve for the concentration profile of  component that diffuses into a 1D rod, with an impermeable barrier at the end. The PDE governing this situation is:
</p>

<p>
\(\frac{\partial C}{\partial t} = D \frac{\partial^2 C}{\partial x^2}\)
</p>

<p>
at \(t=0\), in this example we have \(C_0(x) = 0\) as an initial condition, with boundary conditions \(C(0,t)=0.1\) and \(\partial C/ \partial x(L,t)=0\).
</p>

<p>
We are going to discretize this equation in both time and space to arrive at the solution. We will let \(i\) be the index for the spatial discretization, and \(j\) be the index for the temporal discretization. The discretization looks like this.
</p>

<p><img src="/img/./images/pde-diffusion-discretization-scheme.png"><p>

<p>
Note that we cannot use the method of lines as we did before because we have the derivative-based boundary condition at one of the boundaries.
</p>

<p>
We approximate the time derivative as:
</p>

<p>
\(\frac{\partial C}{\partial t} \bigg| _{i,j} \approx \frac{C_{i,j+1} - C_{i,j}}{\Delta t} \)
</p>

<p>
\(\frac{\partial^2 C}{\partial  x^2} \bigg| _{i,j} \approx \frac{C_{i+1,j} - 2 C_{i,j} + C_{i-1,j}}{h^2} \)
</p>

<p>
We define \(\alpha = \frac{D \Delta t}{h^2}\), and from these two approximations and the PDE, we solve for the unknown solution at a later time step as:
</p>

<p>
\(C_{i, j+1} = \alpha C_{i+1,j} + (1 - 2 \alpha) C_{i,j}  + \alpha C_{i-1,j} \)
</p>

<p>
We know \(C_{i,j=0}\) from the initial conditions, so we simply need to iterate to evaluate \(C_{i,j}\), which is the solution at each time step.
</p>

<p>
See also: <a href="http://www3.nd.edu/~jjwteach/441/PdfNotes/lecture16.pdf" >http://www3.nd.edu/~jjwteach/441/PdfNotes/lecture16.pdf</a>
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">import</span> numpy <span style="color: #8b0000;">as</span> np
<span style="color: #8b0000;">import</span> matplotlib.pyplot <span style="color: #8b0000;">as</span> plt

N = 20  <span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">number of points to discretize</span>
L = 1.0
X = np.linspace(0, L, N) <span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">position along the rod</span>
h = L / (N - 1)          <span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">discretization spacing</span>

C0t = 0.1  <span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">concentration at x = 0</span>
D = 0.02

tfinal = 50.0
Ntsteps = 1000
dt = tfinal / (Ntsteps - 1)
t = np.linspace(0, tfinal, Ntsteps)

alpha = D * dt / h**2
<span style="color: #8b0000;">print</span> alpha

C_xt = [] <span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">container for all the time steps</span>

<span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">initial condition at t = 0</span>
C = np.zeros(X.shape)
C[0] = C0t

C_xt += [C]

<span style="color: #8b0000;">for</span> j <span style="color: #8b0000;">in</span> <span style="color: #8b0000;">range</span>(1, Ntsteps):
    N = np.zeros(C.shape)
    N[0] =  C0t
    N[1:-1] = alpha*C[2:] + (1 - 2 * alpha) * C[1:-1] + alpha * C[0:-2]
    N[-1] = N[-2]  <span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">derivative boundary condition flux = 0</span>
    C[:] = N
    C_xt += [N]

    <span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">plot selective solutions</span>
    <span style="color: #8b0000;">if</span> j <span style="color: #8b0000;">in</span> [1,2,5,10,20,50,100,200,500]:
        plt.plot(X, N, label=<span style="color: #228b22;">'t={0:1.2f}'</span>.format(t[j]))

plt.xlabel(<span style="color: #228b22;">'Position in rod'</span>)
plt.ylabel(<span style="color: #228b22;">'Concentration'</span>)
plt.title(<span style="color: #228b22;">'Concentration at different times'</span>)
plt.legend(loc=<span style="color: #228b22;">'best'</span>)
plt.savefig(<span style="color: #228b22;">'images/transient-diffusion-temporal-dependence.png'</span>)

C_xt = np.array(C_xt)
plt.figure()
plt.plot(t, C_xt[:,5], label=<span style="color: #228b22;">'x={0:1.2f}'</span>.format(X[5]))
plt.plot(t, C_xt[:,10], label=<span style="color: #228b22;">'x={0:1.2f}'</span>.format(X[10]))
plt.plot(t, C_xt[:,15], label=<span style="color: #228b22;">'x={0:1.2f}'</span>.format(X[15]))
plt.plot(t, C_xt[:,19], label=<span style="color: #228b22;">'x={0:1.2f}'</span>.format(X[19]))
plt.legend(loc=<span style="color: #228b22;">'best'</span>)
plt.xlabel(<span style="color: #228b22;">'Time'</span>)
plt.ylabel(<span style="color: #228b22;">'Concentration'</span>)
plt.savefig(<span style="color: #228b22;">'images/transient-diffusion-position-dependence.png'</span>)

plt.show()
</pre>
</div>

<pre class="example">
0.361361361361
</pre>

<p><img src="/img/./images/transient-diffusion-temporal-dependence.png"><p>

<p><img src="/img/./images/transient-diffusion-position-dependence.png"><p>

<p>
The solution is somewhat sensitive to the choices of time step and spatial discretization. If you make the time step too big, the method is not stable, and large oscillations may occur.
</p>
<p>Copyright (C) 2013 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2013/04/02/Transient-diffusion---partial-differential-equations.org">org-mode source</a><p>

    </div>
  </div>
</article>



<a href="https://twitter.com/share" class="twitter-share-button" data-via="johnkitchin">Share on Twitter</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>


<a href="https://twitter.com/search?q=https://kitchingroup.cheme.cmu.edu/blog/2013/04/02/Transient-diffusion-partial-differential-equations">Discuss on Twitter</a>

  <hr class="interblog" />
  





<article>
  <div class="blog_post">
    <header>
      <div id="Computing-determinants-from-matrix-decompositions"></div>
      <h2 class="blog_post_title"><a href="/blog/2013/04/01/Computing-determinants-from-matrix-decompositions/" rel="bookmark" title="Permanent Link to Computing determinants from matrix decompositions">Computing determinants from matrix decompositions</a></h2>
      <p><small><span class="blog_post_date">Posted April 01, 2013 at 07:57 PM</span> | categories:
        <span class="blog_post_categories"><a href='/blog/category/linear-algebra/'>linear algebra</a></span> | tags: 
      <p><small><span class="blog_post_date">Updated April 02, 2013 at 08:18 AM</span></small>
      </small></p>
    </header>
    <div class="post_prose">
      



<p>

There are a few properties of a matrix that can make it easy to compute determinants.
</p>

<ol>
<li>The determinant of a triangular matrix is the product of the elements on the diagonal. 
</li>
<li>The determinant of a permutation matrix is (-1)**n where n is the number of permutations. Recall a permutation matrix is a matrix with a one in each row, and column, and zeros everywhere else. 
</li>
<li>The determinant of a product of matrices is equal to the product of the determinant of the matrices.
</li>
</ol>

<p>
The LU decomposition computes three matrices such that \(A = P L U\). Thus, \(\det A = \det P \det L \det U\). \(L\) and \(U\) are triangular, so we just need to compute the product of the diagonals. \(P\) is not triangular, but if the elements of the diagonal are not 1, they will be zero, and then there has been a swap. So we simply subtract the sum of the diagonal from the length of the diagonal and then subtract 1 to get the number of swaps.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">import</span> numpy <span style="color: #8b0000;">as</span> np
<span style="color: #8b0000;">from</span> scipy.linalg <span style="color: #8b0000;">import</span> lu

A = np.array([[6, 2, 3],
              [1, 1, 1],
              [0, 4, 9]])

P, L, U = lu(A)

nswaps = <span style="color: #8b0000;">len</span>(np.diag(P)) - np.sum(np.diag(P)) - 1

detP = (-1)**nswaps
detL =  np.prod(np.diag(L)) 
detU = np.prod(np.diag(U))

<span style="color: #8b0000;">print</span> detP * detL * detU

<span style="color: #8b0000;">print</span> np.linalg.det(A)
</pre>
</div>

<pre class="example">
24.0
24.0
</pre>

<p>
According to the numpy documentation, a method similar to this is used to compute the determinant. 
</p>
<p>Copyright (C) 2013 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2013/04/01/Computing-determinants-from-matrix-decompositions.org">org-mode source</a><p>

    </div>
  </div>
</article>



<a href="https://twitter.com/share" class="twitter-share-button" data-via="johnkitchin">Share on Twitter</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>


<a href="https://twitter.com/search?q=https://kitchingroup.cheme.cmu.edu/blog/2013/04/01/Computing-determinants-from-matrix-decompositions">Discuss on Twitter</a>

  <hr class="interblog" />
 <a href="../1">« Previous Page</a>

          </div>
          <div id="sidebar" class="grid_4">
            <aside>
<section>
<script>
  (function() {
    var cx = '002533177287215655227:l7uvu35ssbc';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
        '//www.google.com/cse/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>
</section>

<section>
    <h1 class="post_header_gradient theme_font">Twitter</h1>
    <a class="twitter-timeline" href="https://twitter.com/johnkitchin" data-widget-id="545217643582881792">Tweets by @johnkitchin</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+"://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
</section>


  <section>
    <h1 class="post_header_gradient theme_font">Links</h1>
    <ul>
      <li><a href="https://www.continuum.io">Anaconda Python</a></li>
      <li><a href="/pycse">Pycse</a></li>
      <li><a href="/dft-book">DFT-book</a></li>
    </ul>
  </section>

  <section>
    <h1 class="post_header_gradient theme_font">Latest Posts</h1>
    <ul>
      <li><a href="/blog/2025/09/27/New-publication-Uncertainty-Quantification-in-Graph-Neural-Networks-With-Shallow-Ensembles/">New publication - Uncertainty Quantification in Graph Neural Networks With    Shallow Ensembles</a></li>
      <li><a href="/blog/2025/09/16/New-publication-Towards-Agentic-Science-for-Advancing-Scientific-Discovery/">New publication - Towards Agentic Science for Advancing Scientific Discovery</a></li>
      <li><a href="/blog/2025/07/31/New-publication-Mapping-uncertainty-using-differentiable-programming/">New publication - Mapping uncertainty using differentiable programming</a></li>
      <li><a href="/blog/2025/07/17/New-publication-Spin-informed-universal-graph-neural-networks-for-simulating-magnetic-ordering/">New publication - Spin-informed universal graph neural networks for simulating magnetic ordering</a></li>
      <li><a href="/blog/2025/07/09/New-publication-Hyperplane-decision-trees-as-piecewise-linear-surrogate-models-for-chemical-process-design/">New publication - Hyperplane decision trees as piecewise linear surrogate models for chemical process design</a></li>
    </ul>
  </section>

<section>
<h1 class="post_header_gradient theme_font">Latest GitHub Repos</h1>
  <a href="https://github.com/jkitchin">@jkitchin</a> on GitHub.
  <ul id="my-github-projects">
        <li class="loading">Status updating&#8230;</li>
  </ul>

</section>
</aside>

          </div>
          <div class="clear"></div>
        </div>
      </div>
      
<footer>
  <div id="footer" class="grid_12">
    <div class="grid_8">
      <p>
        <a href="/blog/feed/index.xml">RSS</a>
      </p>
    </div>
    <div class="grid_4" id="credits">
      <p>
        Copyright 2025
        John Kitchin
      </p>
      <p>
        Powered by <a href="http://www.blogofile.com">Blogofile</a>
      </p>
    </div>
  </div>
</footer>

    </div>
      <script src="//ajax.googleapis.com/ajax/libs/jquery/1.5.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="/js/libs/jquery-1.5.1.min.js"%3E%3C/script%3E'))</script>
  <script src="/js/plugins.js"></script>
  <script src="/js/script.js"></script>
  <script src="/js/jquery.tweet.js"></script>  
  <script src="/js/site.js"></script>
  <!--[if lt IE 7 ]>
  <script src="js/libs/dd_belatedpng.js"></script>
  <script> DD_belatedPNG.fix('img, .png_bg');</script>
  <![endif]-->
 
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-PH8NF4F0RE"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-PH8NF4F0RE');
</script>


  </body>
</html>






<script src="http://ajax.microsoft.com/ajax/jquery/jquery-1.4.2.min.js" type="text/javascript"></script>
<script src="/js/git.js" type="text/javascript"></script>
<script type="text/javascript">
    $(function() {
     $("#my-github-projects").loadRepositories("jkitchin");
    });
</script>



