

<!doctype html>
<!--[if lt IE 7 ]> <html lang="en" class="no-js ie6"> <![endif]-->
<!--[if IE 7 ]>    <html lang="en" class="no-js ie7"> <![endif]-->
<!--[if IE 8 ]>    <html lang="en" class="no-js ie8"> <![endif]-->
<!--[if IE 9 ]>    <html lang="en" class="no-js ie9"> <![endif]-->
<!--[if (gt IE 9)|!(IE)]><!--> <html lang="en" class="no-js"> <!--<![endif]-->
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>The Kitchin Research Group</title>
  <meta name="google-site-verification" content="CGcacJdHc2YoZyI0Vey9XRA5qwhhFDzThKJezbRFcJ4" />
  <meta name="description" content="Chemical Engineering at Carnegie Mellon University">
  <meta name="author" content="John Kitchin">
  <link rel="alternate" type="application/rss+xml" title="RSS 2.0" href="/blog/feed" />
  <link rel="alternate" type="application/atom+xml" title="Atom 1.0" href="/blog/feed/atom" />
  <link rel="shortcut icon" href="/favicon.ico">
  <link rel="apple-touch-icon" href="/img/apple-touch-icon.png">

  <link rel="stylesheet" href="/css/base.css?v=1">
  <link rel="stylesheet" href="/css/grid.css?v=1">
  <link rel="stylesheet" media="handheld" href="/css/handheld.css?v=1">
  <link rel="stylesheet" href="/css/pygments_murphy.css" type="text/css" />

  <script src="/js/libs/modernizr-1.7.min.js"></script>
<script type="text/javascript"
  src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
  <link rel="stylesheet" href="/themes/theme1/style.css?v=1">
<link href='http://fonts.googleapis.com/css?family=Roboto' rel='stylesheet' type='text/css'>

</head>
  <body>
    <div id="container" class="container container_12">
      <div id="main" role="main">
        <div id="main_block">
          <header>
<div id="header" class="header_gradient theme_font">
<table><tr><td>
    <h1><a href="/">The Kitchin Research Group</a></h1>
    <h2>Chemical Engineering at Carnegie Mellon University</h2>
</td>
<td colspan=100%><div style="float:right;width:100%;text-align:right;"> <span id='badgeCont737515' style='width:126px'><script src='http://labs.researcherid.com/mashlets?el=badgeCont737515&mashlet=badge&showTitle=false&className=a&rid=A-2363-2010'></script></span></div>
</td></tr>
</table>
</div>
  <div id="navigation" class="grid_12">

    <ul class="theme_font">
      <li><a href="/blog"
             class="">Blog</a></li>

      <li><a href="/blog/archive"
             class="">Archives</a></li>

      <li><a href="/publications.html">Publications</a></li>
      <li><a href="/group.html">Group</a></li>

      <li><a href="/research.html"
             class="">Research</a></li>

      <li><a href="/categories.html"
             class="">Categories</a></li>

      <li><a href="/about.html"
             class="">About us</a></li>

      <li><a href="/subscribe.html">Subscribe</a></li>

    </ul>
  </div>
</header>

          <div id="prose_block" class="grid_8">
            
  





<article>
  <div class="blog_post">
    <header>
      <div id="Method-of-continuity-for-nonlinear-equation-solving"></div>
      <h2 class="blog_post_title"><a href="/blog/2013/02/22/Method-of-continuity-for-nonlinear-equation-solving/" rel="bookmark" title="Permanent Link to Method of continuity for nonlinear equation solving">Method of continuity for nonlinear equation solving</a></h2>
      <p><small><span class="blog_post_date">Posted February 22, 2013 at 09:00 AM</span> | categories:
        <span class="blog_post_categories"><a href='/blog/category/nonlinear-algebra/'>nonlinear algebra</a></span> | tags: 
        | <a href="http://jkitchin.github.io/blog/2013/02/22/Method-of-continuity-for-nonlinear-equation-solving#disqus_thread">View Comments</a>
      <p><small><span class="blog_post_date">Updated February 27, 2013 at 02:27 PM</span>
      </small></p>
    </header>
    <div class="post_prose">
      



<p>
<a href="http://matlab.cheme.cmu.edu/2011/11/01/method-of-continuity-for-nonlinear-equation-solving/" >Matlab post</a>

Adapted from Perry's Chemical Engineers Handbook, 6th edition 2-63.
</p>

<p>
We seek the solution to the following nonlinear equations:
</p>

<p>
\(2 + x + y - x^2 + 8 x y + y^3 = 0\)
</p>

<p>
\(1 + 2x - 3y + x^2 + xy - y e^x = 0\)
</p>

<p>
In principle this is easy, we simply need some initial guesses and a nonlinear solver. The challenge here is what would you guess? There could be many solutions. The equations are implicit, so it is not easy to graph them, but let us give it a shot, starting on the x range -5 to 5. The idea is set a value for x, and then solve for y in each equation.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">import</span> numpy <span style="color: #8b0000;">as</span> np
<span style="color: #8b0000;">from</span> scipy.optimize <span style="color: #8b0000;">import</span> fsolve

<span style="color: #8b0000;">import</span> matplotlib.pyplot <span style="color: #8b0000;">as</span> plt

<span style="color: #8b0000;">def</span> <span style="color: #8b2323;">f</span>(x, y):
    <span style="color: #8b0000;">return</span> 2 + x + y - x**2 + 8*x*y + y**3;

<span style="color: #8b0000;">def</span> <span style="color: #8b2323;">g</span>(x, y):
    <span style="color: #8b0000;">return</span> 1 + 2*x - 3*y + x**2 + x*y - y*np.exp(x)

x = np.linspace(-5, 5, 500)

<span style="color: #8b0000;">@np</span>.vectorize
<span style="color: #8b0000;">def</span> <span style="color: #8b2323;">fy</span>(x):
    x0 = 0.0
    <span style="color: #8b0000;">def</span> <span style="color: #8b2323;">tmp</span>(y):
        <span style="color: #8b0000;">return</span> f(x, y)
    y1, = fsolve(tmp, x0)
    <span style="color: #8b0000;">return</span> y1

<span style="color: #8b0000;">@np</span>.vectorize
<span style="color: #8b0000;">def</span> <span style="color: #8b2323;">gy</span>(x):
    x0 = 0.0
    <span style="color: #8b0000;">def</span> <span style="color: #8b2323;">tmp</span>(y):
        <span style="color: #8b0000;">return</span> g(x, y)
    y1, = fsolve(tmp, x0)
    <span style="color: #8b0000;">return</span> y1


plt.plot(x, fy(x), x, gy(x))
plt.xlabel(<span style="color: #228b22;">'x'</span>)
plt.ylabel(<span style="color: #228b22;">'y'</span>)
plt.legend([<span style="color: #228b22;">'fy'</span>, <span style="color: #228b22;">'gy'</span>])
plt.savefig(<span style="color: #228b22;">'images/continuation-1.png'</span>)
</pre>
</div>

<pre class="example">
&gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; ... ... &gt;&gt;&gt; ... ... &gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; ... ... ... ... ... ... ... &gt;&gt;&gt; ... ... ... ... ... ... ... &gt;&gt;&gt; &gt;&gt;&gt; /opt/kitchingroup/enthought/epd-7.3-2-rh5-x86_64/lib/python2.7/site-packages/scipy/optimize/minpack.py:152: RuntimeWarning: The iteration is not making good progress, as measured by the 
  improvement from the last ten iterations.
  warnings.warn(msg, RuntimeWarning)
/opt/kitchingroup/enthought/epd-7.3-2-rh5-x86_64/lib/python2.7/site-packages/scipy/optimize/minpack.py:152: RuntimeWarning: The iteration is not making good progress, as measured by the 
  improvement from the last five Jacobian evaluations.
  warnings.warn(msg, RuntimeWarning)
[&lt;matplotlib.lines.Line2D object at 0x1a0c4990&gt;, &lt;matplotlib.lines.Line2D object at 0x1a0c4a90&gt;]
&lt;matplotlib.text.Text object at 0x19d5e390&gt;
&lt;matplotlib.text.Text object at 0x19d61d90&gt;
&lt;matplotlib.legend.Legend object at 0x189df850&gt;
</pre>

<p><img src="/img/./images/continuation-1.png"><p>

<p>
You can see there is a solution near x = -1, y = 0, because both functions equal zero there. We can even use that guess with fsolve. It is disappointly easy! But, keep in mind that in 3 or more dimensions, you cannot perform this visualization, and another method could be required.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">def</span> <span style="color: #8b2323;">func</span>(X):
    x,y = X
    <span style="color: #8b0000;">return</span> [f(x, y), g(x, y)]

<span style="color: #8b0000;">print</span> fsolve(func, [-2, -2])
</pre>
</div>

<pre class="example">
... ... &gt;&gt;&gt; [ -1.00000000e+00   1.28730858e-15]
</pre>


<p>
We explore a method that bypasses this problem today. The principle is to introduce a new variable, \(\lambda\), which will vary from 0 to 1. at \(\lambda=0\) we will have a simpler equation, preferrably a linear one, which can be easily solved, or which can be analytically solved. At \(\lambda=1\), we have the original equations. Then, we create a system of differential equations that start at the easy solution, and integrate from \(\lambda=0\) to \(\lambda=1\), to recover the final solution.
</p>

<p>
We rewrite the equations as:
</p>

<p>
\(f(x,y) = (2 + x + y) + \lambda(- x^2 + 8 x y + y^3) = 0\)
</p>

<p>
\(g(x,y) = (1 + 2x - 3y) + \lambda(x^2 + xy - y e^x) = 0\)
</p>

<p>
Now, at \(\lambda=0\) we have the simple linear equations:
</p>

<p>
\(x + y = -2\)
</p>

<p>
\(2x - 3y = -1\)
</p>

<p>
These equations are trivial to solve:
</p>

<div class="org-src-container">

<pre class="src src-python">x0 = np.linalg.solve([[1., 1.], [2., -3.]],[ -2, -1])
<span style="color: #8b0000;">print</span> x0
</pre>
</div>

<pre class="example">
[-1.4 -0.6]
</pre>

<p>
We form the system of ODEs by differentiating the new equations with respect to \(\lambda\). Why do we do that? The solution, (x,y) will be a function of \(\lambda\). From calculus, you can show that:
</p>

<p>
\(\frac{\partial f}{\partial x}\frac{\partial x}{\partial \lambda}+\frac{\partial f}{\partial y}\frac{\partial y}{\partial \lambda}=-\frac{\partial f}{\partial \lambda}\)
</p>

<p>
\(\frac{\partial g}{\partial x}\frac{\partial x}{\partial \lambda}+\frac{\partial g}{\partial y}\frac{\partial y}{\partial \lambda}=-\frac{\partial g}{\partial \lambda}\)
</p>

<p>
Now, solve this for \(\frac{\partial x}{\partial \lambda}\) and \(\frac{\partial y}{\partial \lambda}\). You can use Cramer's rule to solve for these to yield:
</p>

\begin{eqnarray} \
\frac{\partial x}{\partial \lambda} &=& \frac{\partial f/\partial y \partial g/\partial \lambda - \partial f/\partial \lambda \partial g/\partial y}{\partial f/\partial x \partial g/\partial y - \partial f/\partial y \partial g/\partial x } \\\\
\frac{\partial y}{\partial \lambda} &=& \frac{\partial f/\partial \lambda \partial g/\partial x - \partial f/\partial x \partial g/\partial \lambda}{\partial f/\partial x \partial g/\partial y - \partial f/\partial y \partial g/\partial x } \end{eqnarray} 

For this set of equations: 

\begin{eqnarray} \
\partial f/\partial x &=& 1 - 2\lambda x + 8\lambda y \\\\ 
\partial f/\partial y &=& 1 + 8 \lambda x + 3 \lambda y^2 \\\\
\partial g/\partial x &=& 2 + 2 \lambda x + \lambda y - \lambda y e^x\\\\ 
\partial g/\partial y &=& -3 + \lambda x - \lambda e^x 
\end{eqnarray} 

<p>
Now, we simply set up those two differential equations on \(\frac{\partial x}{\partial \lambda}\) and \(\frac{\partial y}{\partial \lambda}\), with the initial conditions at \(\lambda = 0\) which is the solution of the simpler linear equations, and integrate to \(\lambda = 1\), which is the final solution of the original equations!
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">def</span> <span style="color: #8b2323;">ode</span>(X, LAMBDA):
    x,y = X
    pfpx = 1.0 - 2.0 * LAMBDA * x + 8 * LAMBDA * y
    pfpy = 1.0 + 8.0 * LAMBDA * x + 3.0 * LAMBDA * y**2
    pfpLAMBDA = -x**2 + 8.0 * x * y + y**3;
    pgpx = 2. + 2. * LAMBDA * x + LAMBDA * y - LAMBDA * y * np.exp(x)
    pgpy = -3. + LAMBDA * x - LAMBDA * np.exp(x)
    pgpLAMBDA = x**2 + x * y - y * np.exp(x);
    dxdLAMBDA = (pfpy * pgpLAMBDA - pfpLAMBDA * pgpy) / (pfpx * pgpy - pfpy * pgpx)
    dydLAMBDA = (pfpLAMBDA * pgpx - pfpx * pgpLAMBDA) / (pfpx * pgpy - pfpy * pgpx) 
    dXdLAMBDA = [dxdLAMBDA, dydLAMBDA]
    <span style="color: #8b0000;">return</span> dXdLAMBDA


<span style="color: #8b0000;">from</span> scipy.integrate <span style="color: #8b0000;">import</span> odeint

lambda_span = np.linspace(0, 1, 100)

X = odeint(ode, x0, lambda_span)

xsol, ysol = X[-1]
<span style="color: #8b0000;">print</span> <span style="color: #228b22;">'The solution is at x={0:1.3f}, y={1:1.3f}'</span>.format(xsol, ysol)
<span style="color: #8b0000;">print</span> f(xsol, ysol), g(xsol, ysol)
</pre>
</div>

<pre class="example">
... ... ... ... ... ... ... ... ... &gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; The solution is at x=-1.000, y=0.000
-1.27746598808e-06 -1.15873819107e-06
</pre>

<p>
You can see the solution is somewhat approximate; the true solution is x = -1, y = 0. The approximation could be improved by lowering the tolerance on the ODE solver. The functions evaluate to a small number, close to zero. You have to apply some judgment to determine if that is sufficiently accurate. For instance if the units on that answer are kilometers, but you need an answer accurate to a millimeter, this may not be accurate enough.
</p>

<p>
This is a fair amount of work to get a solution! The idea is to solve a simple problem, and then gradually turn on the hard part by the lambda parameter. What happens if there are multiple solutions? The answer you finally get will depend on your \(\lambda=0\)  starting point, so it is possible to miss solutions this way. For problems with lots of variables, this would be a good approach if you can identify the easy problem.
</p>
<p>Copyright (C) 2013 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2013/02/22/Method-of-continuity-for-nonlinear-equation-solving.org">org-mode source</a><p>

    </div>
  </div>
</article>



<a href="https://twitter.com/share" class="twitter-share-button" data-via="johnkitchin">Tweet</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>

  <div class="after_post"><a href="http://jkitchin.github.io/blog/2013/02/22/Method-of-continuity-for-nonlinear-equation-solving#disqus_thread">Read and Post Comments</a></div>
  <hr class="interblog" />
  





<article>
  <div class="blog_post">
    <header>
      <div id="ODEs-with-discontinuous-forcing-functions"></div>
      <h2 class="blog_post_title"><a href="/blog/2013/02/21/ODEs-with-discontinuous-forcing-functions/" rel="bookmark" title="Permanent Link to ODEs with discontinuous forcing functions">ODEs with discontinuous forcing functions</a></h2>
      <p><small><span class="blog_post_date">Posted February 21, 2013 at 09:00 AM</span> | categories:
        <span class="blog_post_categories"><a href='/blog/category/ode/'>ode</a></span> | tags: 
        | <a href="http://jkitchin.github.io/blog/2013/02/21/ODEs-with-discontinuous-forcing-functions#disqus_thread">View Comments</a>
      <p><small><span class="blog_post_date">Updated February 27, 2013 at 02:28 PM</span>
      </small></p>
    </header>
    <div class="post_prose">
      



<p>
<a href="http://matlab.cheme.cmu.edu/2011/09/01/odes-with-discontinuous-forcing-functions/" >Matlab post</a>
</p>

<p>
Adapted from <a href="http://archives.math.utk.edu/ICTCM/VOL18/S046/paper.pdf" >http://archives.math.utk.edu/ICTCM/VOL18/S046/paper.pdf</a>
</p>

<p>
A mixing tank initially contains 300 g of salt mixed into 1000 L of water. At t=0 min, a solution of 4 g/L salt enters the tank at 6 L/min. At t=10 min, the solution is changed to 2 g/L salt, still entering at 6 L/min. The tank is well stirred, and the tank solution leaves at a rate of 6 L/min. Plot the concentration of salt (g/L) in the tank as a function of time.
</p>

<p>
A mass balance on the salt in the tank leads to this differential equation: \(\frac{dM_S}{dt} = \nu C_{S,in}(t) - \nu M_S/V\) with the initial condition that \(M_S(t=0)=300\). The wrinkle is that the inlet conditions are not constant.
</p>

<p>
$$C_{S,in}(t) = \begin{array}{ll} 0 & t \le 0, \\ 4 & 0 < t \le 10, \\ 2 & t > 10. \end{array}$$
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">import</span> numpy <span style="color: #8b0000;">as</span> np
<span style="color: #8b0000;">from</span> scipy.integrate <span style="color: #8b0000;">import</span> odeint
<span style="color: #8b0000;">import</span> matplotlib.pyplot <span style="color: #8b0000;">as</span> plt

V = 1000.0 <span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">L</span>
nu = 6.0  <span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">L/min</span>
    
<span style="color: #8b0000;">def</span> <span style="color: #8b2323;">Cs_in</span>(t):
    <span style="color: #228b22;">'inlet concentration'</span>
    <span style="color: #8b0000;">if</span> t &lt; 0:
        Cs = 0.0 <span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">g/L</span>
    <span style="color: #8b0000;">elif</span> (t &gt; 0) <span style="color: #8b0000;">and</span> (t &lt;= 10):
        Cs = 4.0
    <span style="color: #8b0000;">else:</span>
        Cs = 2.0
    <span style="color: #8b0000;">return</span> Cs

<span style="color: #8b0000;">def</span> <span style="color: #8b2323;">mass_balance</span>(Ms, t):
    <span style="color: #228b22;">'$\frac{dM_S}{dt} = \nu C_{S,in}(t) - \nu M_S/V$'</span>
    dMsdt = nu * Cs_in(t) - nu * Ms / V
    <span style="color: #8b0000;">return</span> dMsdt

tspan = np.linspace(0.0, 15.0, 50)

M0 = 300.0 <span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">gm salt</span>
Ms = odeint(mass_balance, M0, tspan)

plt.plot(tspan, Ms/V, <span style="color: #228b22;">'b.-'</span>)
plt.xlabel(<span style="color: #228b22;">'Time (min)'</span>)
plt.ylabel(<span style="color: #228b22;">'Salt concentration (g/L)'</span>)
plt.savefig(<span style="color: #228b22;">'images/ode-discont.png'</span>)
</pre>
</div>

<p><img src="/img/./images/ode-discont.png"><p>

<p>
You can see the discontinuity in the salt concentration at 10 minutes due to the discontinous change in the entering salt concentration.
</p>
<p>Copyright (C) 2013 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2013/02/21/ODEs-with-discontinuous-forcing-functions.org">org-mode source</a><p>

    </div>
  </div>
</article>



<a href="https://twitter.com/share" class="twitter-share-button" data-via="johnkitchin">Tweet</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>

  <div class="after_post"><a href="http://jkitchin.github.io/blog/2013/02/21/ODEs-with-discontinuous-forcing-functions#disqus_thread">Read and Post Comments</a></div>
  <hr class="interblog" />
  





<article>
  <div class="blog_post">
    <header>
      <div id="Phase-portraits-of-a-system-of-ODEs"></div>
      <h2 class="blog_post_title"><a href="/blog/2013/02/21/Phase-portraits-of-a-system-of-ODEs/" rel="bookmark" title="Permanent Link to Phase portraits of a system of ODEs">Phase portraits of a system of ODEs</a></h2>
      <p><small><span class="blog_post_date">Posted February 21, 2013 at 09:00 AM</span> | categories:
        <span class="blog_post_categories"><a href='/blog/category/ode/'>ode</a>, <a href='/blog/category/math/'>math</a></span> | tags: 
        | <a href="http://jkitchin.github.io/blog/2013/02/21/Phase-portraits-of-a-system-of-ODEs#disqus_thread">View Comments</a>
      <p><small><span class="blog_post_date">Updated February 27, 2013 at 02:56 PM</span>
      </small></p>
    </header>
    <div class="post_prose">
      



<p>
<a href="http://matlab.cheme.cmu.edu/2011/08/09/phase-portraits-of-a-system-of-odes/" >Matlab post</a>
An undamped pendulum with no driving force is described by
</p>

<p>
$$ y'' + sin(y) = 0$$
</p>

<p>
We reduce this to standard matlab form of a system of first order ODEs by letting \(y_1 = y\) and \(y_2=y_1'\). This leads to:
</p>

<p>
\(y_1' = y_2\)
</p>

<p>
\(y_2' = -sin(y_1)\)
</p>

<p>
The phase portrait is a plot of a vector field which qualitatively shows how the solutions to these equations will go from a given starting point. here is our definition of the differential equations:
</p>

<p>
To generate the phase portrait, we need to compute the derivatives \(y_1'\) and \(y_2'\) at \(t=0\) on a grid over the range of values for \(y_1\) and \(y_2\) we are interested in. We will plot the derivatives as a vector at each (y1, y2) which will show us the initial direction from each point. We will examine the solutions over the range -2 &lt; y1 &lt; 8, and -2 &lt; y2 &lt; 2 for y2, and create a grid of 20 x 20 points.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">import</span> numpy <span style="color: #8b0000;">as</span> np
<span style="color: #8b0000;">import</span> matplotlib.pyplot <span style="color: #8b0000;">as</span> plt

<span style="color: #8b0000;">def</span> <span style="color: #8b2323;">f</span>(Y, t):
    y1, y2 = Y
    <span style="color: #8b0000;">return</span> [y2, -np.sin(y1)]

y1 = np.linspace(-2.0, 8.0, 20)
y2 = np.linspace(-2.0, 2.0, 20)

Y1, Y2 = np.meshgrid(y1, y2)

t = 0

u, v = np.zeros(Y1.shape), np.zeros(Y2.shape)

NI, NJ = Y1.shape

<span style="color: #8b0000;">for</span> i <span style="color: #8b0000;">in</span> <span style="color: #8b0000;">range</span>(NI):
    <span style="color: #8b0000;">for</span> j <span style="color: #8b0000;">in</span> <span style="color: #8b0000;">range</span>(NJ):
        x = Y1[i, j]
        y = Y2[i, j]
        yprime = f([x, y], t)
        u[i,j] = yprime[0]
        v[i,j] = yprime[1]
     

Q = plt.quiver(Y1, Y2, u, v, color=<span style="color: #228b22;">'r'</span>)

plt.xlabel(<span style="color: #228b22;">'$y_1$'</span>)
plt.ylabel(<span style="color: #228b22;">'$y_2$'</span>)
plt.xlim([-2, 8])
plt.ylim([-4, 4])
plt.savefig(<span style="color: #228b22;">'images/phase-portrait.png'</span>)
</pre>
</div>

<pre class="example">
&gt;&gt;&gt; ... &gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; ... ... ... &gt;&gt;&gt; &gt;&gt;&gt; &lt;matplotlib.text.Text object at 0xbcfd290&gt;
&lt;matplotlib.text.Text object at 0xbd14750&gt;
(-2, 8)
(-4, 4)
</pre>

<p><img src="/img/./images/phase-portrait.png"><p>

<p>
Let us plot a few solutions on the vector field. We will consider the solutions where y1(0)=0, and values of y2(0) = [0 0.5 1 1.5 2 2.5], in otherwords we start the pendulum at an angle of zero, with some angular velocity.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">from</span> scipy.integrate <span style="color: #8b0000;">import</span> odeint

<span style="color: #8b0000;">for</span> y20 <span style="color: #8b0000;">in</span> [0, 0.5, 1, 1.5, 2, 2.5]:
    tspan = np.linspace(0, 50, 200)
    y0 = [0.0, y20]
    ys = odeint(f, y0, tspan)
    plt.plot(ys[:,0], ys[:,1], <span style="color: #228b22;">'b-'</span>) <span style="color: #ff0000; font-weight: bold;"># path</span>
    plt.plot([ys[0,0]], [ys[0,1]], <span style="color: #228b22;">'o'</span>) <span style="color: #ff0000; font-weight: bold;"># start</span>
    plt.plot([ys[-1,0]], [ys[-1,1]], <span style="color: #228b22;">'s'</span>) <span style="color: #ff0000; font-weight: bold;"># end</span>
    

plt.xlim([-2, 8])
plt.savefig(<span style="color: #228b22;">'images/phase-portrait-2.png'</span>)
plt.show()
</pre>
</div>

<pre class="example">
&gt;&gt;&gt; ... ... ... [&lt;matplotlib.lines.Line2D object at 0xbc0dbd0&gt;]
[&lt;matplotlib.lines.Line2D object at 0xc135050&gt;]
[&lt;matplotlib.lines.Line2D object at 0xbd1a450&gt;]
[&lt;matplotlib.lines.Line2D object at 0xbd1a1d0&gt;]
[&lt;matplotlib.lines.Line2D object at 0xb88aa10&gt;]
[&lt;matplotlib.lines.Line2D object at 0xb88a5d0&gt;]
[&lt;matplotlib.lines.Line2D object at 0xc14e410&gt;]
[&lt;matplotlib.lines.Line2D object at 0xc14ed90&gt;]
[&lt;matplotlib.lines.Line2D object at 0xc2c5290&gt;]
[&lt;matplotlib.lines.Line2D object at 0xbea4bd0&gt;]
[&lt;matplotlib.lines.Line2D object at 0xbea4d50&gt;]
[&lt;matplotlib.lines.Line2D object at 0xbc401d0&gt;]
[&lt;matplotlib.lines.Line2D object at 0xc2d1190&gt;]
[&lt;matplotlib.lines.Line2D object at 0xc2f3e90&gt;]
[&lt;matplotlib.lines.Line2D object at 0xc2f3bd0&gt;]
[&lt;matplotlib.lines.Line2D object at 0xc2e4790&gt;]
[&lt;matplotlib.lines.Line2D object at 0xc2e0a90&gt;]
[&lt;matplotlib.lines.Line2D object at 0xc2c7390&gt;]
(-2, 8)
</pre>

<p><img src="/img/./images/phase-portrait-2.png"><p>

<p>
What do these figures mean? For starting points near the origin, and small velocities, the pendulum goes into a stable limit cycle. For others, the trajectory appears to fly off into y1 space. Recall that y1 is an angle that has values from \(-\pi\) to \(\pi\). The y1 data in this case is not wrapped around to be in this range.
</p>
<p>Copyright (C) 2013 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2013/02/21/Phase-portraits-of-a-system-of-ODEs.org">org-mode source</a><p>

    </div>
  </div>
</article>



<a href="https://twitter.com/share" class="twitter-share-button" data-via="johnkitchin">Tweet</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>

  <div class="after_post"><a href="http://jkitchin.github.io/blog/2013/02/21/Phase-portraits-of-a-system-of-ODEs#disqus_thread">Read and Post Comments</a></div>
  <hr class="interblog" />
  





<article>
  <div class="blog_post">
    <header>
      <div id="Advanced-string-formatting"></div>
      <h2 class="blog_post_title"><a href="/blog/2013/02/20/Advanced-string-formatting/" rel="bookmark" title="Permanent Link to Advanced string formatting">Advanced string formatting</a></h2>
      <p><small><span class="blog_post_date">Posted February 20, 2013 at 09:00 AM</span> | categories:
        <span class="blog_post_categories"><a href='/blog/category/python/'>python</a></span> | tags: 
        | <a href="http://jkitchin.github.io/blog/2013/02/20/Advanced-string-formatting#disqus_thread">View Comments</a>
      <p><small><span class="blog_post_date">Updated February 27, 2013 at 02:50 PM</span>
      </small></p>
    </header>
    <div class="post_prose">
      



<p>
There are several more advanced ways to include formatted values in a string. In the previous case we examined replacing format specifiers by <i>positional</i> arguments in the format command. We can instead use <i>keyword</i> arguments. 
</p>

<div class="org-src-container">

<pre class="src src-python">s = <span style="color: #228b22;">'The {speed} {color} fox'</span>.format(color=<span style="color: #228b22;">'brown'</span>, speed=<span style="color: #228b22;">'quick'</span>)
<span style="color: #8b0000;">print</span> s
</pre>
</div>

<pre class="example">
The quick brown fox
</pre>

<p>
If you have a lot of variables already defined in a script, it is convenient to use them in string formatting with the locals command:
</p>

<div class="org-src-container">

<pre class="src src-python">speed = <span style="color: #228b22;">'slow'</span>
color= <span style="color: #228b22;">'blue'</span>

<span style="color: #8b0000;">print</span> <span style="color: #228b22;">'The {speed} {color} fox'</span>.format(**<span style="color: #8b0000;">locals</span>())
</pre>
</div>

<pre class="example">
The slow blue fox
</pre>

<p>
If you want to access attributes on an object, you can specify them directly in the format identifier.
</p>
<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">class</span> <span style="color: #4682b4;">A</span>:
    <span style="color: #8b0000;">def</span> <span style="color: #8b2323;">__init__</span>(<span style="color: #8b0000;">self</span>, a, b, c):
        <span style="color: #8b0000;">self</span>.a = a
        <span style="color: #8b0000;">self</span>.b = b
        <span style="color: #8b0000;">self</span>.c = c

mya = A(3,4,5)

<span style="color: #8b0000;">print</span> <span style="color: #228b22;">'a = {obj.a}, b = {obj.b}, c = {obj.c:1.2f}'</span>.format(obj=mya)
</pre>
</div>

<pre class="example">
a = 3, b = 4, c = 5.00
</pre>

<p>
You can access values of a dictionary:
</p>
<div class="org-src-container">

<pre class="src src-python">d = {<span style="color: #228b22;">'a'</span>: 56, <span style="color: #228b22;">"test"</span>:<span style="color: #228b22;">'woohoo!'</span>}

<span style="color: #8b0000;">print</span> <span style="color: #228b22;">"the value of a in the dictionary is {obj[a]}. It works {obj[test]}"</span>.format(obj=d)
</pre>
</div>

<pre class="example">
the value of a in the dictionary is 56. It works woohoo!.
</pre>

<p>
And, you can access elements of a list. Note, however you cannot use -1 as an index in this case.
</p>

<div class="org-src-container">

<pre class="src src-python">L = [4, 5, <span style="color: #228b22;">'cat'</span>]

<span style="color: #8b0000;">print</span> <span style="color: #228b22;">'element 0 = {obj[0]}, and the last element is {obj[2]}'</span>.format(obj=L)
</pre>
</div>

<pre class="example">
element 0 = 4, and the last element is cat
</pre>

<p>
There are three different ways to &ldquo;print&rdquo; an object. If an object has a <span style="text-decoration:underline;"><span style="text-decoration:underline;">format</span></span> function, that is the default used in the format command. It may be helpful to use the <code>str</code> or <code>repr</code> of an object instead. We get this with !s for <code>str</code> and !r for <code>repr</code>.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">class</span> <span style="color: #4682b4;">A</span>:
    <span style="color: #8b0000;">def</span> <span style="color: #8b2323;">__init__</span>(<span style="color: #8b0000;">self</span>, a, b):
        <span style="color: #8b0000;">self</span>.a = a; <span style="color: #8b0000;">self</span>.b = b

    <span style="color: #8b0000;">def</span> <span style="color: #8b2323;">__format__</span>(<span style="color: #8b0000;">self</span>, format):
        s = <span style="color: #228b22;">'a={{0:{0}}} b={{1:{0}}}'</span>.format(format)
        <span style="color: #8b0000;">return</span> s.format(<span style="color: #8b0000;">self</span>.a, <span style="color: #8b0000;">self</span>.b)

    <span style="color: #8b0000;">def</span> <span style="color: #8b2323;">__str__</span>(<span style="color: #8b0000;">self</span>):
        <span style="color: #8b0000;">return</span> <span style="color: #228b22;">'str: class A, a={0} b={1}'</span>.format(<span style="color: #8b0000;">self</span>.a, <span style="color: #8b0000;">self</span>.b)

    <span style="color: #8b0000;">def</span> <span style="color: #8b2323;">__repr__</span>(<span style="color: #8b0000;">self</span>):
        <span style="color: #8b0000;">return</span> <span style="color: #228b22;">'representing: class A, a={0}, b={1}'</span>.format(<span style="color: #8b0000;">self</span>.a, <span style="color: #8b0000;">self</span>.b)

mya = A(3, 4)

<span style="color: #8b0000;">print</span> <span style="color: #228b22;">'{0}'</span>.format(mya)   <span style="color: #ff0000; font-weight: bold;"># uses __format__</span>
<span style="color: #8b0000;">print</span> <span style="color: #228b22;">'{0!s}'</span>.format(mya) <span style="color: #ff0000; font-weight: bold;"># uses __str__</span>
<span style="color: #8b0000;">print</span> <span style="color: #228b22;">'{0!r}'</span>.format(mya) <span style="color: #ff0000; font-weight: bold;"># uses __repr__</span>
</pre>
</div>

<pre class="example">
a=3 b=4
str: class A, a=3 b=4
representing: class A, a=3, b=4
</pre>

<p>
This covers the majority of string formatting requirements I have come across. If there are more sophisticated needs, they can be met with various string templating python modules. the one I have used most is <a href="http://www.cheetahtemplate.org/" >Cheetah</a>.</p>
<p>Copyright (C) 2013 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2013/02/20/Advanced-string-formatting.org">org-mode source</a><p>

    </div>
  </div>
</article>



<a href="https://twitter.com/share" class="twitter-share-button" data-via="johnkitchin">Tweet</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>

  <div class="after_post"><a href="http://jkitchin.github.io/blog/2013/02/20/Advanced-string-formatting#disqus_thread">Read and Post Comments</a></div>
  <hr class="interblog" />
  





<article>
  <div class="blog_post">
    <header>
      <div id="Subclassing-an-ase-calculators-vasp-calculator-to-do-post-analysis"></div>
      <h2 class="blog_post_title"><a href="/blog/2013/02/19/Subclassing-an-ase-calculators-vasp-calculator-to-do-post-analysis/" rel="bookmark" title="Permanent Link to Subclassing an ase.calculators.vasp calculator to do post analysis">Subclassing an ase.calculators.vasp calculator to do post analysis</a></h2>
      <p><small><span class="blog_post_date">Posted February 19, 2013 at 09:00 AM</span> | categories:
        <span class="blog_post_categories"><a href='/blog/category/vasp/'>vasp</a>, <a href='/blog/category/ase/'>ase</a></span> | tags: 
        | <a href="http://jkitchin.github.io/blog/2013/02/19/Subclassing-an-ase-calculators-vasp-calculator-to-do-post-analysis#disqus_thread">View Comments</a>
      <p><small><span class="blog_post_date">Updated March 01, 2013 at 02:54 PM</span>
      </small></p>
    </header>
    <div class="post_prose">
      




<p>
Recently someone <a href="https://listserv.fysik.dtu.dk/pipermail/ase-users/2013-February/001683.html" >reported</a> on the ase-users mail list an issue they had with the Vasp calculator where the maximum number of electronic steps and then stops, even though the calculation is not converged. They asked how to make this raise an exception. This is not a built in feature in ase.calculators.vasp, but we can add it via a subclass. The idea is create a new class that inherits from ase.calculators.vasp, and then augment the calculate function to do some post analysis. In this case, we will parse the OUTCAR file looking for lines like:
</p>

<pre class="example">
----------------------------------------- Iteration    1(   1)  ---------------------------------------
</pre>

<p>
I think the first integer corresponds to an ionic iteration, while the number in parentheses corresponds to an electronic iteration.  We will just count them up, and see if they match the values we specified. If they do, we can print an error message, or raise an exception. Here is the code:
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">from</span> ase.calculators.vasp <span style="color: #8b0000;">import</span> Vasp
<span style="color: #8b0000;">from</span> ase <span style="color: #8b0000;">import</span> Atom, Atoms
<span style="color: #8b0000;">import</span> os, re

os.chdir(<span style="color: #228b22;">'h2o-relax'</span>)

<span style="color: #8b0000;">class</span> <span style="color: #4682b4;">myvasp</span>(Vasp):
    <span style="color: #228b22;">'''subclass to run VASP and then check OUTCAR to see if the number</span>
<span style="color: #228b22;">    of electronic steps is equal to the max NELM specified, or if the</span>
<span style="color: #228b22;">    number of geometry steps is equal to NSW. Either case indicates</span>
<span style="color: #228b22;">    VASP may not be converged, but just stopped because it was told</span>
<span style="color: #228b22;">    too.'''</span>

    <span style="color: #ff0000; font-weight: bold;">#</span><span style="color: #ff0000; font-weight: bold;">save original function</span>
    
    <span style="color: #8b0000;">def</span> <span style="color: #8b2323;">calculate</span>(<span style="color: #8b0000;">self</span>, *args):
        <span style="color: #228b22;">'Run VASP, then check if nsw or nelm is met'</span>

        <span style="color: #ff0000; font-weight: bold;">#</span><span style="color: #ff0000; font-weight: bold;">run original calculate method</span>
        Vasp.calculate(<span style="color: #8b0000;">self</span>, *args)
        
        <span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">now do post analysis</span>
        NELM = <span style="color: #8b0000;">self</span>.int_params[<span style="color: #228b22;">'nelm'</span>]
        NSW = <span style="color: #8b0000;">self</span>.int_params[<span style="color: #228b22;">'nsw'</span>]

        max_nelm, max_nsw = 0, 0

        <span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">open OUTCAR and check for what you want</span>
        <span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">parse this line: - Iteration    1(   1)</span>
        regexp = re.compile(<span style="color: #228b22;">'Iteration\s+(?P&lt;nsw&gt;\d*)\(\s+(?P&lt;nelm&gt;\d*)\)'</span>)
        count = 0
        <span style="color: #8b0000;">with</span> <span style="color: #8b0000;">open</span>(<span style="color: #228b22;">'OUTCAR'</span>) <span style="color: #8b0000;">as</span> f:
            <span style="color: #8b0000;">for</span> line <span style="color: #8b0000;">in</span> f:
                <span style="color: #8b0000;">if</span> <span style="color: #228b22;">'Iteration'</span> <span style="color: #8b0000;">in</span> line:
                    m = regexp.search(line)
                    nsw = <span style="color: #8b0000;">int</span>(m.groupdict().get(<span style="color: #228b22;">'nsw'</span>))
                    <span style="color: #8b0000;">if</span> nsw &gt; max_nsw:
                        max_nsw = nsw
                    nelm = <span style="color: #8b0000;">int</span>(m.groupdict().get(<span style="color: #228b22;">'nelm'</span>))
                    <span style="color: #8b0000;">if</span> nelm &gt; max_nelm:
                        max_nelm = nelm

        <span style="color: #8b0000;">if</span> max_nelm == NELM:
            <span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">raise exception here if you prefer</span>
            <span style="color: #8b0000;">print</span> (<span style="color: #228b22;">'{0} NELM steps taken! check convergence'</span>.format(max_nelm))
        <span style="color: #8b0000;">if</span> max_nsw == NSW:
            <span style="color: #8b0000;">print</span>(<span style="color: #228b22;">'{0} NSW steps taken! check convergence'</span>.format(max_nsw))


atoms = Atoms([Atom(<span style="color: #228b22;">'H'</span>, [0.5960812, -0.7677068, 0.0000000]),
               Atom(<span style="color: #228b22;">'O'</span>, [0.0000000, 0.0000000, 0.0000000]),
               Atom(<span style="color: #228b22;">'H'</span>, [0.5960812, 0.7677068, 0.0000000])],
               cell=(8, 8, 8))

calc = myvasp(xc=<span style="color: #228b22;">'PBE'</span>,
              nelm=2,
              encut=400,
              ismear=0,<span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">Gaussian smearing</span>
              ibrion=2,
              ediff=1e-8,
              nsw=3)

atoms.set_calculator(calc)

<span style="color: #8b0000;">print</span> <span style="color: #228b22;">'Forces'</span>
<span style="color: #8b0000;">print</span> <span style="color: #228b22;">'==========================='</span>
<span style="color: #8b0000;">print</span> atoms.get_forces()
</pre>
</div>

<pre class="example">
Forces
===========================
 running on    1 nodes
 distr:  one band on    1 nodes,    1 groups
 vasp.5.2.12 11Nov11 complex                                                    
  
 POSCAR found :  2 types and       3 ions
 LDA part: xc-table for Pade appr. of Perdew
 found WAVECAR, reading the header
 POSCAR, INCAR and KPOINTS ok, starting setup
 WARNING: small aliasing (wrap around) errors must be expected
 FFT: planning ...(           1 )
 reading WAVECAR
 the WAVECAR file was read sucessfully
 initial charge from wavefunction
 entering main loop
       N       E                     dE             d eps       ncg     rms          rms(c)
DAV:   1    -0.142298749169E+02   -0.14230E+02   -0.10298E-01    24   0.330E+00    0.231E-01
DAV:   2    -0.142281671566E+02    0.17078E-02   -0.36659E-03    24   0.581E-01
   1 F= -.14228167E+02 E0= -.14228167E+02  d E =-.142282E+02
 curvature:   0.00 expect dE= 0.000E+00 dE for cont linesearch  0.000E+00
 trial: gam= 0.00000 g(F)=  0.114E-04 g(S)=  0.000E+00 ort = 0.000E+00 (trialstep = 0.100E+01)
 search vector abs. value=  0.114E-04
 bond charge predicted
       N       E                     dE             d eps       ncg     rms          rms(c)
DAV:   1    -0.142273929196E+02    0.24820E-02   -0.17613E-03    24   0.419E-01    0.149E-02
DAV:   2    -0.142274190765E+02   -0.26157E-04   -0.20256E-04    16   0.115E-01
   2 F= -.14227419E+02 E0= -.14227419E+02  d E =0.748080E-03
 trial-energy change:    0.000748  1 .order   -0.000006   -0.000011   -0.000001
 step:   1.0700(harm=  1.0700)  dis= 0.00047  next Energy=   -14.228173 (dE=-0.609E-05)
 bond charge predicted
       N       E                     dE             d eps       ncg     rms          rms(c)
DAV:   1    -0.142274279955E+02   -0.35076E-04   -0.72088E-06    32   0.308E-02    0.758E-03
DAV:   2    -0.142274385490E+02   -0.10553E-04   -0.97783E-07    24   0.858E-03
   3 F= -.14227439E+02 E0= -.14227439E+02  d E =0.728608E-03
 curvature:  -0.53 expect dE=-0.133E-03 dE for cont linesearch -0.931E-08
 trial: gam=21.74088 g(F)=  0.248E-03 g(S)=  0.000E+00 ort = 0.445E-06 (trialstep = 0.204E-02)
 search vector abs. value=  0.565E-02
 writing wavefunctions
Running vanilla serial job
2 NELM steps taken! check convergence
3 NSW steps taken! check convergence
[[ 0.024 -0.028  0.   ]
 [-0.048  0.     0.   ]
 [ 0.024  0.028  0.   ]]
</pre>
<p>Copyright (C) 2013 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2013/02/19/Subclassing-an-ase.calculators.vasp-calculator-to-do-post-analysis.org">org-mode source</a><p>


    </div>
  </div>
</article>



<a href="https://twitter.com/share" class="twitter-share-button" data-via="johnkitchin">Tweet</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>

  <div class="after_post"><a href="http://jkitchin.github.io/blog/2013/02/19/Subclassing-an-ase-calculators-vasp-calculator-to-do-post-analysis#disqus_thread">Read and Post Comments</a></div>
  <hr class="interblog" />
 <a href="../8">« Previous Page</a>
  --  
 <a href="../10">Next Page »</a>

          </div>
          <div id="sidebar" class="grid_4">
            <aside>
<section>
<script>
  (function() {
    var cx = '002533177287215655227:l7uvu35ssbc';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
        '//www.google.com/cse/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>
</section>

<section>
    <h1 class="post_header_gradient theme_font">Twitter</h1>
    <a class="twitter-timeline" href="https://twitter.com/johnkitchin" data-widget-id="545217643582881792">Tweets by @johnkitchin</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+"://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
</section>


  <section>
    <h1 class="post_header_gradient theme_font">Links</h1>
    <ul>
      <li><a href="https://www.continuum.io">Anaconda Python</a></li>
      <li><a href="/pycse">Pycse</a></li>
      <li><a href="/dft-book">DFT-book</a></li>
    </ul>
  </section>

  <section>
    <h1 class="post_header_gradient theme_font">Latest Posts</h1>
    <ul>
      <li><a href="/blog/2018/01/27/New-publication-in-Topics-in-Catalysis/">New publication in Topics in Catalysis</a></li>
      <li><a href="/blog/2018/01/03/New-publication-in-Molecular-Simulation/">New publication in Molecular Simulation</a></li>
      <li><a href="/blog/2017/12/31/2017-in-a-nutshell-for-the-Kitchin-Research-group/">2017 in a nutshell for the Kitchin Research group</a></li>
      <li><a href="/blog/2017/11/29/Solving-an-eigenvalue-differential-equation-with-a-neural-network/">Solving an eigenvalue differential equation with a neural network</a></li>
      <li><a href="/blog/2017/11/28/Solving-ODEs-with-a-neural-network-and-autograd/">Solving ODEs with a neural network and autograd</a></li>
    </ul>
  </section>

<section>
<h1 class="post_header_gradient theme_font">Latest GitHub Repos</h1>
  <a href="https://github.com/jkitchin">@jkitchin</a> on GitHub.
  <ul id="my-github-projects">
        <li class="loading">Status updating&#8230;</li>
  </ul>

</section>
</aside>

          </div>
          <div class="clear"></div>
        </div>
      </div>
      
<footer>
  <div id="footer" class="grid_12">
    <div class="grid_8">
      <p>
        <a href="/blog/feed/index.xml">RSS</a>
        <a href="http://kitchinresearchgroup.disqus.com/latest.rss">Comments RSS Feed</a>.
      </p>
    </div>
    <div class="grid_4" id="credits">
      <p>
        Copyright 2018
        John Kitchin
      </p>
      <p>
        Powered by <a href="http://www.blogofile.com">Blogofile</a>
      </p>
    </div>
  </div>
</footer>

    </div>
      <script src="//ajax.googleapis.com/ajax/libs/jquery/1.5.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="/js/libs/jquery-1.5.1.min.js"%3E%3C/script%3E'))</script>
  <script src="/js/plugins.js"></script>
  <script src="/js/script.js"></script>
  <script src="/js/jquery.tweet.js"></script>  
  <script src="/js/site.js"></script>
  <!--[if lt IE 7 ]>
  <script src="js/libs/dd_belatedpng.js"></script>
  <script> DD_belatedPNG.fix('img, .png_bg');</script>
  <![endif]-->
  <script>
      var _gaq=[['_setAccount','UA-35731398-1'],['_trackPageview']];
      (function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];g.async=1;
      g.src=('https:'==location.protocol?'//ssl':'//www')+'.google-analytics.com/ga.js';
      s.parentNode.insertBefore(g,s)}(document,'script'));
  </script>
  <script>
  (function() {
      var links = document.getElementsByTagName('a');
      var query = '?';
      for(var i = 0; i < links.length; i++) {
          if(links[i].href.indexOf('#disqus_thread') >= 0) {
              query += 'url' + i + '=' + encodeURIComponent(links[i].href) + '&';
          }
      }
      document.write('<script charset="utf-8" type="text/javascript" src="http://disqus.com/forums/kitchinresearchgroup/get_num_replies.js' + query + '"></' + 'script>');
  })();
  </script>

  </body>
</html>






<script src="http://ajax.microsoft.com/ajax/jquery/jquery-1.4.2.min.js" type="text/javascript"></script>
<script src="/js/git.js" type="text/javascript"></script>
<script type="text/javascript">
    $(function() {
     $("#my-github-projects").loadRepositories("jkitchin");
    });
</script>



