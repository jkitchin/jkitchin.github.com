<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0"
     xmlns:content="http://purl.org/rss/1.0/modules/content/"
     xmlns:sy="http://purl.org/rss/1.0/modules/syndication/"
     xmlns:atom="http://www.w3.org/2005/Atom"
     xmlns:dc="http://purl.org/dc/elements/1.1/"
     xmlns:wfw="http://wellformedweb.org/CommentAPI/"
     >
  <channel>
    <title>The Kitchin Research Group</title>
    <link>http://jkitchin.github.io/blog</link>
    <description>Chemical Engineering at Carnegie Mellon University</description>
    <pubDate>Sat, 26 Mar 2016 19:33:22 GMT</pubDate>
    <generator>Blogofile</generator>
    <sy:updatePeriod>hourly</sy:updatePeriod>
    <sy:updateFrequency>1</sy:updateFrequency>
    <item>
      <title>A molecule link for org-mode</title>
      <link>http://jkitchin.github.io/blog/2016/03/26/A-molecule-link-for-org-mode</link>
      <pubDate>Sat, 26 Mar 2016 15:28:17 EDT</pubDate>
      <category><![CDATA[orgmode]]></category>
      <category><![CDATA[chemistry]]></category>
      <category><![CDATA[emacs]]></category>
      <guid isPermaLink="false">U1RoQRECYwAfObskx8qSl1Vly28=</guid>
      <description>A molecule link for org-mode</description>
      <content:encoded><![CDATA[


<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#sec-1">1. Appendix of molecules</a></li>
<li><a href="#sec-2">2. smiles major mode</a></li>
</ul>
</div>
</div>
<p>
Here I am exploring some ideas on compact and functional representations of molecules in org-mode. We will use some functionality from OpenBabel (<a href="https://openbabel.org/docs/dev/index.html">https://openbabel.org/docs/dev/index.html</a> ) for conversion of formats.
</p>

<p>
One approach we could use is the <a href="https://en.wikipedia.org/wiki/Simplified_molecular-input_line-entry_system">SMILES</a> representation. OpenBabel provides tools to convert SMILES to a visualization like this. Let's check out an old favorite: caffeine.
</p>

<div class="org-src-container">

<pre class="src src-sh">obabel -:<span style="color: #008000;">"Cn1cnc2n(C)c(=O)n(C)c(=O)c12"</span> -osvg
</pre>
</div>


<div class="figure">
<p><img src="/media/2016-03-26-A-molecule-link-for-org-mode/out.svg"> 
</p>
</div>

<p>
We can imagine the SMILES string is a program, and use an org-mode src block to contain it.  It isn't quite a program, as it is more like data, but we can make the block executable if we define how to "execute" the block, and for that we will just have obabel generate the svg representation of the molecule. Here is our execute function. It simply generates the svg to stdout. We can use a :file header to capture it in a file.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #0000FF;">defun</span> <span style="color: #006699;">org-babel-execute:smiles</span> (body params)
  (shell-command-to-string
   (format <span style="color: #008000;">"obabel -:\"%s\" -osvg 2&gt; /dev/null"</span> body)))
</pre>
</div>

<pre class="example">
org-babel-execute:smiles
</pre>

<p>
You can find a smiles block in <a href="#sec-1">Appendix of molecules</a> that was adapted from <a href="http://www.daylight.com/dayhtml_tutorials/languages/smiles/smiles_examples.html">here</a> .
</p>

<p>
Now, we need a link to refer to our molecule. We want the follow action to jump to our src block which should have a name. We will have it export as the name of the block linked to the molecule definition. This should work fine for definitions in the document. It is not robust to link to molecules in other org-files in the export. That would require those files to be exported too. For now we just define an HTML export.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #0000FF;">defun</span> <span style="color: #006699;">molecule-jump</span> (name)
  (org-mark-ring-push)
  (org-open-link-from-string (format <span style="color: #008000;">"[[%s]]"</span> path)))

(<span style="color: #0000FF;">defun</span> <span style="color: #006699;">molecule-export</span> (path desc backend)
  (<span style="color: #0000FF;">let</span> ((name (<span style="color: #0000FF;">save-window-excursion</span>
                (molecule-jump path)
                (org-element-property <span style="color: #006FE0;">:name</span> (org-element-context)))))
    (<span style="color: #0000FF;">cond</span>
     ((eq 'html backend)
      (format <span style="color: #008000;">"&lt;a href=\"#%s\"&gt;%s&lt;/a&gt;"</span> name name)))))

(org-add-link-type
 <span style="color: #008000;">"molecule"</span>
 'molecule-jump
 'molecule-export)
</pre>
</div>

<p>
Now we link to <a href="#LSD">LSD</a> and <a href="#ethanol">ethanol</a> that allows us to navigate to the definition. We can also refer to a molecule in another file like <a href="#ethanol">ethanol</a>. The links are clickable, and should jump to the molecule definition. On export to HTML they will be links to the definition.
</p>

<p>
Our link provides some limited functionality. We can provide more by making the follow action open a menu for example. Instead, we created a major mode <a href="#sec-2">here</a>. It provides a function to convert smiles to CML. It is readily extensible to do other conversions.
</p>

<p>
One of the reasons we want to have molecules as "data" is so we can find them in our papers. Here is an example of that. We defined two molecules in the Appendix, and we find them here.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(org-element-map (org-element-parse-buffer)
    'src-block
  (<span style="color: #0000FF;">lambda</span> (src)
    (<span style="color: #0000FF;">when</span> (string= <span style="color: #008000;">"smiles"</span> (org-element-property <span style="color: #006FE0;">:language</span> src))
      (org-element-property <span style="color: #006FE0;">:name</span> src))))
</pre>
</div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="left" />

<col  class="left" />
</colgroup>
<tbody>
<tr>
<td class="left">LSD</td>
<td class="left">ethanol</td>
</tr>
</tbody>
</table>

<p>
There is still a lot to do to make this really functional. For example, we might want to use the molecules to write reactions. We might also want more advanced conversion or lookup functions, and more export options. It might be desirable to have tooltips on the links to see the molecules too. No doubt one might want to fine-tune the way the blocks run, so that options could be passed as header args.
Maybe I will work on that another day.
</p>

<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1"><a id="ID-1CD759B4-E276-4990-982C-E98CCE5B0517" name="ID-1CD759B4-E276-4990-982C-E98CCE5B0517"></a><span class="section-number-2">1</span> Appendix of molecules</h2>
<div class="outline-text-2" id="text-1">

<p>
Here is an example smiles block.
</p>
<div class="org-src-container">
<label class="org-src-name">A lysergic acid diethylamide molecule</label>
<pre class="src src-smiles" id="LSD">CCN(CC)C(=O)[C@H]1CN(C)[C@@H]2Cc3c[nH]c4cccc(C2=C1)c34
</pre>
</div>


<div class="figure">
<p><img src="/media/2016-03-26-A-molecule-link-for-org-mode/lsd.svg"> 
</p>
</div>

<div class="org-src-container">
<label class="org-src-name">An ethanol molecule.</label>
<pre class="src src-smiles" id="ethanol">CCO
</pre>
</div>


<div class="figure">
<p><img src="/media/2016-03-26-A-molecule-link-for-org-mode/ethanol.svg"> 
</p>
</div>
</div>
</div>

<div id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2"><a id="ID-7978044B-CB2F-4AB3-8142-34A28B3DB201" name="ID-7978044B-CB2F-4AB3-8142-34A28B3DB201"></a><span class="section-number-2">2</span> smiles major mode</h2>
<div class="outline-text-2" id="text-2">
<p>
It would be nice to have a language mode to do special edits of SMILES src blocks. This mode does very little but provide a function that converts SMILES to CML using obabel and open it in a buffer. We redirect stderr to /dev/null to avoid seeing the messages from obabel. We also provide another function that opens a browser to names of the molecule.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #0000FF;">require</span> '<span style="color: #D0372D;">easymenu</span>)

(<span style="color: #0000FF;">defun</span> <span style="color: #006699;">smiles-cml</span> ()
  <span style="color: #036A07;">"Convert the smiles string in the buffer to CML."</span>
  (<span style="color: #0000FF;">interactive</span>)
  (<span style="color: #0000FF;">let</span> ((smiles (buffer-string)))
    (switch-to-buffer (get-buffer-create <span style="color: #008000;">"SMILES-CML"</span>))
    (erase-buffer)
    (insert
     (shell-command-to-string
      (format <span style="color: #008000;">"obabel -:\"%s\" -ocml 2&gt; /dev/null"</span>
              smiles)))
    (goto-char (point-min))
    (xml-mode)))

(<span style="color: #0000FF;">defun</span> <span style="color: #006699;">smiles-names</span> ()
  (<span style="color: #0000FF;">interactive</span>)
  (browse-url
   (format <span style="color: #008000;">"http://cactus.nci.nih.gov/chemical/structure/%s/names"</span>
           (buffer-string))))

(<span style="color: #0000FF;">defvar</span> <span style="color: #BA36A5;">smiles-mode-map</span>
  nil
  <span style="color: #036A07;">"Keymap for smiles-mode."</span>)

<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">adapted from http://ergoemacs.org/emacs/elisp_menu_for_major_mode.html</span>
(<span style="color: #0000FF;">define-derived-mode</span> <span style="color: #006699;">smiles-mode</span> fundamental-mode <span style="color: #008000;">"smiles-mode"</span>
  <span style="color: #036A07;">"Major mode for SMILES code."</span>
  (<span style="color: #0000FF;">setq</span> buffer-invisibility-spec '(t)
        mode-name <span style="color: #008000;">" &#9786;"</span>)

  (<span style="color: #0000FF;">when</span> (not smiles-mode-map)
    (<span style="color: #0000FF;">setq</span> smiles-mode-map (make-sparse-keymap)))
  (define-key smiles-mode-map (kbd <span style="color: #008000;">"C-c C-c"</span>) 'smiles-cml)
  (define-key smiles-mode-map (kbd <span style="color: #008000;">"C-c C-n"</span>) 'smiles-names)

  (define-key smiles-mode-map [menu-bar] (make-sparse-keymap))

  (<span style="color: #0000FF;">let</span> ((menuMap (make-sparse-keymap <span style="color: #008000;">"SMILES"</span>)))
    (define-key smiles-mode-map [menu-bar smiles] (cons <span style="color: #008000;">"SMILES"</span> menuMap))

    (define-key menuMap [cml]
      '(<span style="color: #008000;">"CML"</span> . smiles-cml))
    (define-key menuMap [names]
      '(<span style="color: #008000;">"Names"</span> . smiles-names))))
</pre>
</div>

<pre class="example">
smiles-mode
</pre>
</div>
</div>
<p>Copyright (C) 2016 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p>
<p><a href="/org/2016/03/26/A-molecule-link-for-org-mode.org">org-mode source</a></p>
<p>Org-mode version = 8.2.10</p>]]></content:encoded>
    </item>
    <item>
      <title>Displaying image overlays on image filenames in Emacs</title>
      <link>http://jkitchin.github.io/blog/2016/03/21/Displaying-image-overlays-on-image-filenames-in-Emacs</link>
      <pubDate>Mon, 21 Mar 2016 11:21:19 EDT</pubDate>
      <category><![CDATA[orgmode]]></category>
      <category><![CDATA[emacs]]></category>
      <guid isPermaLink="false">TYzYY7kKXIdWZeDJIV9P-L4kQe0=</guid>
      <description>Displaying image overlays on image filenames in Emacs</description>
      <content:encoded><![CDATA[


<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#sec-1">1. Tooltip approach</a></li>
<li><a href="#sec-2">2. The overlay approach</a></li>
</ul>
</div>
</div>
<p>
It has always bothered me a little that I have to add a file image after code blocks in org-mode to see the results. That extra work&#x2026; I also don't like having to explicitly print the figure in the code, since that is the extra work, just in a different place. Today I look into two approaches to this. First, we consider something like tooltips, and second just putting overlays of image files right on the file name. The plus side of this is no extra work. The downside is they won't export; that will still take the extra work, but you needed that for the caption anyway for now.
</p>

<p>
Here is a video illustrating the code in this post: <a href="https://www.youtube.com/watch?v=VuAnwCERM0U">https://www.youtube.com/watch?v=VuAnwCERM0U</a> 
</p>

<p>
Here is a test.
</p>
<div class="org-src-container">

<pre class="src src-python"><span style="color: #0000FF;">import</span> matplotlib.pyplot <span style="color: #0000FF;">as</span> plt
plt.plot([0, 1, 2, 4, 16])
plt.savefig(<span style="color: #008000;">"test-fig.png"</span>)
</pre>
</div>


<div class="figure">
<p><img src="/media/2016-03-21-Displaying-image-overlays-on-image-filenames-in-Emacs/test-fig.png"> 
</p>
</div>

<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1"><span class="section-number-2">1</span> Tooltip approach</h2>
<div class="outline-text-2" id="text-1">
<p>
Building on our <a href="http://kitchingroup.cheme.cmu.edu/blog/2016/03/16/Getting-graphical-feedback-as-tooltips-in-Emacs/">previous approach</a> of graphical tooltips, we try that here to show the images. I have solved the issue of why the images didn't show in the tooltips before; it was related to how Emacs was built. I used to build it with "cocoa" support so it integrates well in OSX. Here, I have build it with gtk3, and the tooltips work with images.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #0000FF;">defvar</span> <span style="color: #BA36A5;">image-tooltip-re</span> (concat  <span style="color: #008000;">"</span><span style="color: #008000; font-weight: bold;">\\</span><span style="color: #008000; font-weight: bold;">(?3:</span><span style="color: #008000;">'</span><span style="color: #008000; font-weight: bold;">\\</span><span style="color: #008000; font-weight: bold;">|</span><span style="color: #008000;">\"</span><span style="color: #008000; font-weight: bold;">\\</span><span style="color: #008000; font-weight: bold;">)</span><span style="color: #008000; font-weight: bold;">\\</span><span style="color: #008000; font-weight: bold;">(?1:</span><span style="color: #008000;">.*\\."</span>
                                  (regexp-opt '(<span style="color: #008000;">"png"</span> <span style="color: #008000;">"PNG"</span> <span style="color: #008000;">"JPG"</span> <span style="color: #008000;">"jpeg"</span>
                                                <span style="color: #008000;">"jpg"</span> <span style="color: #008000;">"JPEG"</span> <span style="color: #008000;">"eps"</span> <span style="color: #008000;">"EPS"</span>))
                                  <span style="color: #008000;">"</span><span style="color: #008000; font-weight: bold;">\\</span><span style="color: #008000; font-weight: bold;">)</span><span style="color: #008000; font-weight: bold;">\\</span><span style="color: #008000; font-weight: bold;">(?:</span><span style="color: #008000;">\\3</span><span style="color: #008000; font-weight: bold;">\\</span><span style="color: #008000; font-weight: bold;">)</span><span style="color: #008000;">"</span>)
  <span style="color: #036A07;">"Regexp to match image filenames in quotes"</span>)

(<span style="color: #0000FF;">defun</span> <span style="color: #006699;">image-tooltip</span> (window object position)
  (<span style="color: #0000FF;">save-excursion</span>
    (goto-char position)
    (<span style="color: #0000FF;">let</span> (beg end imgfile img s)
      (<span style="color: #0000FF;">while</span> (not (looking-at image-tooltip-re))
        (forward-char -1))
      (<span style="color: #0000FF;">setq</span> imgfile (match-string-no-properties 1))
      (<span style="color: #0000FF;">when</span> (file-exists-p imgfile)
        (<span style="color: #0000FF;">setq</span> img (create-image (expand-file-name imgfile)
                                'imagemagick nil <span style="color: #006FE0;">:width</span> 200))
        (propertize <span style="color: #008000;">"Look in the minibuffer"</span>
                    'display img)))))

(font-lock-add-keywords
 nil
 `((,image-tooltip-re
    0 '(face font-lock-keyword-face
             help-echo image-tooltip))))

(font-lock-fontify-buffer)
</pre>
</div>

<p>
Now these both have tooltips on them: "test-fig.png"  and  'test-fig.png'.
</p>
</div>
</div>

<div id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2"><span class="section-number-2">2</span> The overlay approach</h2>
<div class="outline-text-2" id="text-2">
<p>
We might alternatively prefer to put overlays in the buffer. Here we make that happen.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #0000FF;">defun</span> <span style="color: #006699;">next-image-overlay</span> (<span style="color: #6434A3;">&amp;optional</span> limit)
  (<span style="color: #0000FF;">when</span> (re-search-forward image-tooltip-re limit t)
    (<span style="color: #0000FF;">setq</span> beg (match-beginning 0)
          end (match-end 0)
          imgfile (match-string 1))
    (<span style="color: #0000FF;">when</span> (file-exists-p imgfile)
      (<span style="color: #0000FF;">setq</span> img (create-image (expand-file-name imgfile)
                              'imagemagick nil <span style="color: #006FE0;">:width</span> 300))
      (<span style="color: #0000FF;">setq</span> ov (make-overlay beg end))
      (overlay-put ov 'display img)
      (overlay-put ov 'face 'default)
      (overlay-put ov 'org-image-overlay t)
      (overlay-put ov 'modification-hooks
                   (list 'org-display-inline-remove-overlay)))))

(font-lock-add-keywords
 nil
 '((next-image-overlay (0  'font-lock-keyword-face t)))
 t)
</pre>
</div>


<p>
Here is the example we looked at before.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #0000FF;">import</span> matplotlib.pyplot <span style="color: #0000FF;">as</span> plt
plt.plot([-0, 1, 2, 4, 16])
plt.savefig(<span style="color: #008000;">"test-fig.png"</span>)
</pre>
</div>

<p>
You may want to remove those overlays. Here is one way. Note they come back if you don't disable the font-lock keywords though.
</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp">(ov-clear 'org-image-overlay)
</pre>
</div>
<p>
I know you want to do that so here is:
</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp">(font-lock-remove-keywords
 nil
 '((next-image-overlay (0  'font-lock-keyword-face t))))

(ov-clear 'org-image-overlay)
</pre>
</div>


<p>
Note you still have to clear the overlays. Font lock doesn't seem to do that for you I think.
</p>
</div>
</div>
<p>Copyright (C) 2016 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p>
<p><a href="/org/2016/03/21/Displaying-image-overlays-on-image-filenames-in-Emacs.org">org-mode source</a></p>
<p>Org-mode version = 8.2.10</p>]]></content:encoded>
    </item>
    <item>
      <title>Org teleport headlines</title>
      <link>http://jkitchin.github.io/blog/2016/03/18/Org-teleport-headlines</link>
      <pubDate>Fri, 18 Mar 2016 08:47:14 EDT</pubDate>
      <category><![CDATA[orgmode]]></category>
      <category><![CDATA[emacs]]></category>
      <guid isPermaLink="false">oRuOS7EpzEm__3VkF6kCRgjKZ8w=</guid>
      <description>Org teleport headlines</description>
      <content:encoded><![CDATA[


<p>
I often want to rearrange org headlines.  There are super convenient shortcuts for some things, like Alt-up/down to move up and down, and Alt-left/right to change levels, and shift variants of that when there are nested headlines. There is also refile for some use cases. The case these don't handle for me is when I have a headline at the bottom and I want to move it a distance. To cut down on key strokes, I usually kill the headline, jump to where I want, and paste it.
</p>

<p>
In lispy, there is a teleport command for this! I am going to adapt this here for reorganizing org-headlines. This version allows you to move headlines around on the visible area. You need another strategy for the candidates to jump to if you want to move a headline off the screen. Note though that ivy is really smart, you can have one file in a split view and it will jump to any headline in any window! I use ivy for the navigation here, but you could also use helm to select headlines, for example. This function puts your headline after the selected headline, unless you use a prefix arg, and then it goes before.
</p>

<p>
Check out the video to see this in action: <a href="https://www.youtube.com/watch?v=Vv-2888rpyc">https://www.youtube.com/watch?v=Vv-2888rpyc</a> 
</p>

<p>
Note: this code is a little more advanced than what is in the video; I added a numeric prefix to change the headline level.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #0000FF;">defun</span> <span style="color: #006699;">org-teleport</span> (<span style="color: #6434A3;">&amp;optional</span> arg)
  <span style="color: #036A07;">"Teleport the current heading to after a headline selected with avy.</span>
<span style="color: #036A07;">With a prefix ARG move the headline to before the selected</span>
<span style="color: #036A07;">headline. With a numeric prefix, set the headline level. If ARG</span>
<span style="color: #036A07;">is positive, move after, and if negative, move before."</span>
  (<span style="color: #0000FF;">interactive</span> <span style="color: #008000;">"P"</span>)
  <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Kill current headline</span>
  (org-mark-subtree)
  (kill-region (region-beginning) (region-end))
  <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Jump to a visible headline</span>
  (<span style="color: #0000FF;">avy-with</span> avy-goto-line (avy--generic-jump <span style="color: #008000;">"^\\*+"</span> nil avy-style))
  (<span style="color: #0000FF;">cond</span>
   <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Move before  and change headline level</span>
   ((<span style="color: #0000FF;">and</span> (numberp arg) (&gt; 0 arg))
    (<span style="color: #0000FF;">save-excursion</span>
      (yank))
    <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">arg is what we want, second is what we have</span>
    <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">if n is positive, we need to demote (increase level)</span>
    (<span style="color: #0000FF;">let</span> ((n (- (abs arg) (car (org-heading-components)))))
      (<span style="color: #0000FF;">cl-loop</span> for i from 1 to (abs n)
               do
               (<span style="color: #0000FF;">if</span> (&gt; 0 n)
                   (org-promote-subtree)
                 (org-demote-subtree)))))
   <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Move after and change level</span>
   ((<span style="color: #0000FF;">and</span> (numberp arg) (&lt; 0 arg))
    (org-mark-subtree)
    (goto-char (region-end))
    (<span style="color: #0000FF;">when</span> (eobp) (insert <span style="color: #008000;">"\n"</span>))
    (<span style="color: #0000FF;">save-excursion</span>
      (yank))
    <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">n is what we want and second is what we have</span>
    <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">if n is positive, we need to demote</span>
    (<span style="color: #0000FF;">let</span> ((n (- (abs arg) (car (org-heading-components)))))
      (<span style="color: #0000FF;">cl-loop</span> for i from 1 to (abs n)
               do
               (<span style="color: #0000FF;">if</span> (&gt; 0 n) (org-promote-subtree)
                 (org-demote-subtree)))))

   <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">move to before selection</span>
   ((equal arg '(4))
    (<span style="color: #0000FF;">save-excursion</span>
      (yank)))
   <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">move to after selection</span>
   (t
    (org-mark-subtree)
    (goto-char (region-end))
    (<span style="color: #0000FF;">when</span> (eobp) (insert <span style="color: #008000;">"\n"</span>))
    (<span style="color: #0000FF;">save-excursion</span>
      (yank))))
  (outline-hide-leaves))
</pre>
</div>

<pre class="example">
org-teleport
</pre>

<p>
Now we add some new speed commands to help us out. I think we should be able to mark subtrees ("@" is bound to this, but I like "m" better) and kill them with a key stroke, in addition to teleporting them. Since we figured out the nice way to jump to a headline up there, we bind that to "q" which isn't used so far, and maps to a similar concept in lispy. The lowercase "t" is already bound to changing the TODO state, so we use capital "T" for the speed key to teleport. Note it is possible to "compose" the same effect by typing "k" to kill a headline, then "q" to jump somewhere else (or navigate where you want,  and then "C-y" to paste it at the new location. Or, "T".
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(add-to-list 'org-speed-commands-user (cons <span style="color: #008000;">"m"</span> 'org-mark-subtree))
(add-to-list 'org-speed-commands-user (cons <span style="color: #008000;">"k"</span> (<span style="color: #0000FF;">lambda</span> ()
                                                  (org-mark-subtree)
                                                  (kill-region
                                                   (region-beginning)
                                                   (region-end)))))
(add-to-list 'org-speed-commands-user
             (cons <span style="color: #008000;">"q"</span> (<span style="color: #0000FF;">lambda</span> ()
                         (<span style="color: #0000FF;">avy-with</span> avy-goto-line
                           (avy--generic-jump <span style="color: #008000;">"^\\*+"</span> nil avy-style)))))

(add-to-list 'org-speed-commands-user (cons <span style="color: #008000;">"T"</span> 'org-teleport))
<span style="color: #008000;">"done"</span>
</pre>
</div>

<pre class="example">
done
</pre>
<p>Copyright (C) 2016 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p>
<p><a href="/org/2016/03/18/Org-teleport-headlines.org">org-mode source</a></p>
<p>Org-mode version = 8.2.10</p>]]></content:encoded>
    </item>
    <item>
      <title>Getting graphical feedback as tooltips in Emacs</title>
      <link>http://jkitchin.github.io/blog/2016/03/16/Getting-graphical-feedback-as-tooltips-in-Emacs</link>
      <pubDate>Wed, 16 Mar 2016 17:14:21 EDT</pubDate>
      <category><![CDATA[emacs]]></category>
      <guid isPermaLink="false">rqzCQW6l0wZF8QL6uw-AUQxp5rY=</guid>
      <description>Getting graphical feedback as tooltips in Emacs</description>
      <content:encoded><![CDATA[


<p>
In a continued exploration of Emacs as a user interface today we consider how to look at alternative representations of text. The long term idea is you might have a link to a datafile, say a Raman spectrum. You could click on the link to open it, perhaps even in analysis software. But, it might be nice to have a thumbnail type image that shows the data in graphical form. That might be sufficient for some purposes to identify which file to open.
</p>

<p>
You need to see the video to see the tooltips actually working in Emacs: <a href="https://www.youtube.com/watch?v=uX_hAPb9NOc">https://www.youtube.com/watch?v=uX_hAPb9NOc</a> 
</p>

<p>
To illustrate the idea here we will have E1macs display an image when you mouse over some words that represent fruit, specifically grapes, kiwi and strawberry. We have in this directory images of those fruit:
</p>

<div class="org-src-container">

<pre class="src src-sh">ls
</pre>
</div>

<pre class="example">
grapes.png
image-tooltips.org
kiwi.png
strawberry.png
</pre>

<p>
We will use font-lock to add a tooltip to those words that displays the image in the minibuffer. I thought the image would show in the tooltip here, but for some reason it doesn't. Maybe that is ok, since it doesn't clutter the text with big images. Font lock also makes the words stand out a bit so you know there is something there. Here is our tooltip code, and the font-lock-add-keywords that activates it.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #0000FF;">defun</span> <span style="color: #006699;">image-tooltip</span> (window object position)
  (<span style="color: #0000FF;">save-excursion</span>
    (goto-char position)
    (<span style="color: #0000FF;">let*</span> ((img-file (format <span style="color: #008000;">"%s.png"</span> (thing-at-point 'word)))
           (s (propertize <span style="color: #008000;">"Look in the minbuffer"</span>
                          'display (create-image (expand-file-name img-file)))))
      (message <span style="color: #008000;">"%s"</span> s))))

(font-lock-add-keywords
 nil
 '((<span style="color: #008000;">"\\&lt;kiwi\\&gt;</span><span style="color: #008000; font-weight: bold;">\\</span><span style="color: #008000; font-weight: bold;">|</span><span style="color: #008000;">\\&lt;grapes\\&gt;</span><span style="color: #008000; font-weight: bold;">\\</span><span style="color: #008000; font-weight: bold;">|</span><span style="color: #008000;">strawberry"</span> 0 '(face font-lock-keyword-face
                                                      help-echo image-tooltip))))
</pre>
</div>

<p>
Some examples of fruit are the kiwi, the strawberry and grapes. That is a little example to illustrate the concept. Now, imagine something more sophisticated, e.g. a link to a molecular simulation that generates a thumbnail of the atomic geometry, and a summary of the energy. Or a Raman spectrum that shows a thumbnail of the spectrum.
</p>
<p>Copyright (C) 2016 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p>
<p><a href="/org/2016/03/16/Getting-graphical-feedback-as-tooltips-in-Emacs.org">org-mode source</a></p>
<p>Org-mode version = 8.2.10</p>]]></content:encoded>
    </item>
    <item>
      <title>New publication in International Journal of Quantum Chemistry</title>
      <link>http://jkitchin.github.io/blog/2016/03/03/New-publication-in-International-Journal-of-Quantum-Chemistry</link>
      <pubDate>Thu, 03 Mar 2016 13:48:01 EST</pubDate>
      <category><![CDATA[news]]></category>
      <category><![CDATA[publication]]></category>
      <guid isPermaLink="false">3wQ5SHi9EIlTBmYwIVYQ4TkN0tI=</guid>
      <description>New publication in International Journal of Quantum Chemistry</description>
      <content:encoded><![CDATA[


<p>
It is well known that DFT calculations are expensive, which limits the size of the calculations that can be performed, the number of them that can be performed, and their use in simulation methods such as molecular dynamics.  Molecular potentials are more suitable for these types of simulations, but they must be parameterized by some means. In this paper, we use a database of DFT calculations to train ReaxFF and a neural network potential. We compare and contrast these potentials with respect to their accuracy, trainability, and speed of calculation with application to properties of Au bulk, cluster and surface properties. There are clear tradeoffs with these two approaches, but both have advantages for different purposes. Congratulations Jake and Mitch! See the paper here: <a href="http://dx.doi.org/10.1002/qua.25115">http://dx.doi.org/10.1002/qua.25115</a> .
</p>

<div class="org-src-container">

<pre class="src src-bibtex"><span style="color: #006699;">@article</span> {<span style="color: #D0372D;">boes-2016-neural-reaxf</span>,
  <span style="color: #BA36A5;">author</span> =       {Boes, Jacob R. and Groenenboom, Mitchell C. and Keith, John A.
                  and Kitchin, John R.},
  <span style="color: #BA36A5;">title</span> =        {Neural network and ReaxFF comparison for Au properties},
  <span style="color: #BA36A5;">journal</span> =      {International Journal of Quantum Chemistry},
  <span style="color: #BA36A5;">issn</span> =         {1097-461X},
  <span style="color: #BA36A5;">url</span> =          {<span style="color: #006DAF; text-decoration: underline;">http://dx.doi.org/10.1002/qua.25115</span>},
  <span style="color: #BA36A5;">doi</span> =          {<span style="color: #006DAF; text-decoration: underline;">10.1002/qua.25115</span>},
  <span style="color: #BA36A5;">pages</span> =        {n/a--n/a},
  <span style="color: #BA36A5;">keywords</span> =     {Kohn-Sham density functional theory, neural networks, reactive
                  force fields, potential energy surfaces, machine learning},
  <span style="color: #BA36A5;">year</span> =         2016,
}
</pre>
</div>

<script type='text/javascript' src='https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js'></script>
<div data-badge-type='medium-donut' class='altmetric-embed' data-badge-details='right' data-doi='10.1002/qua.25115'></div>
<p>Copyright (C) 2016 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p>
<p><a href="/org/2016/03/03/New-publication-in-International-Journal-of-Quantum-Chemistry.org">org-mode source</a></p>
<p>Org-mode version = 8.2.10</p>]]></content:encoded>
    </item>
    <item>
      <title>Adding captions and attributes to figures and tables from code blocks in org-mode</title>
      <link>http://jkitchin.github.io/blog/2016/02/26/Adding-captions-and-attributes-to-figures-and-tables-from-code-blocks-in-org-mode</link>
      <pubDate>Fri, 26 Feb 2016 12:43:37 EST</pubDate>
      <category><![CDATA[orgmode]]></category>
      <guid isPermaLink="false">3IK0Y21ANnXvXxJZkBfh3Fv9WRk=</guid>
      <description>Adding captions and attributes to figures and tables from code blocks in org-mode</description>
      <content:encoded><![CDATA[



<p>
I have wanted for a long time to be able to add captions and attributes to figures and tables generated from code blocks. I brought this up on the mailing list (<a href="https://lists.gnu.org/archive/html/emacs-orgmode/2015-11/msg00544.html">https://lists.gnu.org/archive/html/emacs-orgmode/2015-11/msg00544.html</a> ) and finally, I have figured out a way to do it that seems ok. It is based on the :wrap feature of org-babel.
</p>

<p>
The idea is to use a function that will wrap the results in additional text. We use this function that will add a caption and attributes.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #0000FF;">defun</span> <span style="color: #006699;">src-decorate</span> (<span style="color: #6434A3;">&amp;optional</span> caption attributes)
  <span style="color: #036A07;">"A wrap function for src blocks."</span>
  (concat
   <span style="color: #008000;">"ORG\n"</span>
   (<span style="color: #0000FF;">when</span> attributes
     (concat (mapconcat 'identity attributes <span style="color: #008000;">"\n"</span>) <span style="color: #008000;">"\n"</span>))
   (<span style="color: #0000FF;">when</span> caption
     (format <span style="color: #008000;">"#+caption: %s"</span> caption))))
</pre>
</div>

<pre class="example">
src-decorate
</pre>

<p>
Now, we try it out on a figure:
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #0000FF;">import</span> numpy <span style="color: #0000FF;">as</span> np
<span style="color: #0000FF;">import</span> matplotlib.pyplot <span style="color: #0000FF;">as</span> plt

<span style="color: #BA36A5;">x</span> = np.linspace(0, 2 * np.pi)
<span style="color: #BA36A5;">y</span> = np.sin(x)

plt.plot(x, y)
plt.savefig(<span style="color: #008000;">'images/sin.png'</span>)
<span style="color: #0000FF;">print</span>(<span style="color: #008000;">'[[./images/sin.png'</span> + <span style="color: #008000;">']]'</span>)
</pre>
</div>

<div class="org">

<div class="figure">
<p><img src="/media/2016-02-26-Adding-captions-and-attributes-to-figures-and-tables-from-code-blocks-in-org-mode/sin.png"> 
</p>
<p><span class="figure-number">Figure 1:</span> A sin wave. <div id="fig-sin"></p>
</div>

</div>

<p>
Success. We can even refer to Fig. <a href="#fig-sin">fig-sin</a>. Next, we try it on a table.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #0000FF;">import</span> numpy <span style="color: #0000FF;">as</span> np

<span style="color: #BA36A5;">x</span> = np.linspace(0, 2 * np.pi, 5)
<span style="color: #BA36A5;">y</span> = np.sin(x)

<span style="color: #0000FF;">return</span> [[<span style="color: #008000;">'x'</span>, <span style="color: #008000;">'y'</span>], <span style="color: #D0372D;">None</span>] + <span style="color: #006FE0;">list</span>(<span style="color: #006FE0;">zip</span>(x, y))
</pre>
</div>

<div class="org">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<caption class="t-above"><span class="table-number">Table 1:</span> A table of sin data. <div id="tab-sin"></caption>

<colgroup>
<col  class="right" />

<col  class="right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="right">x</th>
<th scope="col" class="right">y</th>
</tr>
</thead>
<tbody>
<tr>
<td class="right">0.0</td>
<td class="right">0.0</td>
</tr>

<tr>
<td class="right">1.5707963267948966</td>
<td class="right">1.0</td>
</tr>

<tr>
<td class="right">3.141592653589793</td>
<td class="right">1.2246467991473532e-16</td>
</tr>

<tr>
<td class="right">4.71238898038469</td>
<td class="right">-1.0</td>
</tr>

<tr>
<td class="right">6.283185307179586</td>
<td class="right">-2.4492935982947064e-16</td>
</tr>
</tbody>
</table>

</div>

<p>
Sweet.  We can refer to Tab. <a href="#tab-sin">tab-sin</a> too. I have wanted this for a long time.  Perseverance wins again! and org-mode gets better. Hopefully this works with org 8.3 too!
</p>
<p>Copyright (C) 2016 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p>
<p><a href="/org/2016/02/26/Adding-captions-and-attributes-to-figures-and-tables-from-code-blocks-in-org-mode.org">org-mode source</a></p>
<p>Org-mode version = 8.2.10</p>]]></content:encoded>
    </item>
    <item>
      <title>Pycse is now using Python3</title>
      <link>http://jkitchin.github.io/blog/2016/02/25/Pycse-is-now-using-Python3</link>
      <pubDate>Thu, 25 Feb 2016 19:09:20 EST</pubDate>
      <category><![CDATA[python]]></category>
      <guid isPermaLink="false">kT-farz1aZTDbZpGySI59s7xv1Q=</guid>
      <description>Pycse is now using Python3</description>
      <content:encoded><![CDATA[


<p>
I spent the last couple of days going through the notes for <a href="http://kitchingroup.cheme.cmu.edu/pycse">pycse</a> and updating it for Python 3! If you aren't familiar with pycse, it is an acronym for Python3 Calculations in Science and Engineering, and it is about 400 pages of examples spanning scientific and engineering computations, and a python module that extends numpy/scipy with some functions for adding events to differential equation solvers, and regression with confidence intervals.
</p>

<p>
It is mostly done, and was pretty easy. The Python module for pycse
(<a href="http://github.com/jkitchin/pycse">http://github.com/jkitchin/pycse</a> ) should also be Python 3 compliant. Yep, on my
Mac I have switched over to the Anaconda Python 3 from Continuum IO (thanks for
that!).
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #0000FF;">import</span> sys
<span style="color: #0000FF;">print</span>(sys.version)
</pre>
</div>

<pre class="example">
3.5.1 |Anaconda 2.5.0 (x86_64)| (default, Dec  7 2015, 11:24:55)
[GCC 4.2.1 (Apple Inc. build 5577)]
</pre>

<p>
Now we can succinctly do matrix multiplication like this:
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #0000FF;">import</span> numpy <span style="color: #0000FF;">as</span> np
<span style="color: #BA36A5;">a</span> = np.array([1, 2, 3])
<span style="color: #BA36A5;">a</span> = np.array([1, 2, 3])
<span style="color: #0000FF;">print</span>(a @ a)  <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">the matrix multiplication operator</span>

<span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">instead of</span>
<span style="color: #0000FF;">print</span>(np.dot(a, a))
</pre>
</div>

<pre class="example">
14
14
</pre>

<p>
Here is a summary of what the changes to the Python2 version of Pycse entailed.
</p>

<ol class="org-ol">
<li>Change all print statements to print functions. There were so many&#x2026;
</li>
<li>Eliminate use of tabs in some code blocks, Python3 is not flexible on that.
</li>
</ol>

<p>
I wrote this function to fix both of these for me (I use Emacs as my editor), which worked nicely:
</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #0000FF;">defun</span> <span style="color: #006699;">fp</span> ()
  <span style="color: #036A07;">"convert print to print() allowing for line end comments. does not do multiline.</span>
<span style="color: #036A07;">and untabify"</span>
  (<span style="color: #0000FF;">interactive</span>)
  (beginning-of-line)
  (re-search-forward <span style="color: #008000;">"print "</span> (line-end-position) t)
  (delete-char -1)
  (insert <span style="color: #008000;">"("</span>)
  <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">rm spaces</span>
  (delete-forward-char
   (<span style="color: #0000FF;">save-excursion</span>
     (skip-chars-forward <span style="color: #008000;">" "</span>)))
  (<span style="color: #0000FF;">when</span>
      (re-search-forward <span style="color: #008000;">"#"</span> (line-end-position) 'move)
    (goto-char (match-beginning 0)))
  (skip-chars-backward <span style="color: #008000;">" "</span>)
  (insert <span style="color: #008000;">")"</span>)
  <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">untabify</span>
  (<span style="color: #0000FF;">let</span> ((src (org-element-context)))
    (untabify (org-element-property <span style="color: #006FE0;">:begin</span> src)
              (org-element-property <span style="color: #006FE0;">:end</span> src))))
</pre>
</div>

<ol class="org-ol">
<li>reduce no longer exists, you have to use functools.reduce. Probably will not affect me much&#x2026;
</li>
<li>Strings are sometimes bytes, and need to be encoded/decoded depending on what you are doing.
</li>
</ol>

<p>
Otherwise, most things seemed to work fine. In a few places I had articles on Windows specific code, which I couldn't test on the Mac I work on now. Only one package was apparently not ready for Python3, and that was scimath from Enthought, which had units capability. Quantities worked fine though.
</p>

<p>
For some reason I could not do interactive key-presses in matplotlib. I am not sure if that is a Python3, or my Mac setup for now.
</p>

<p>
When I first wrote the Pycse book (in org-mode naturally), I must have had a default session setup for org-mode, because there was no :session information in a few of the src-block headers. I had to add these back in a few places.
</p>

<p>
Overall the transition was pretty seamless. It looks like I will be transitioning to Python3 in teaching this fall! Big thanks to the Anaconda team for packaging Python 3.5 and making it so easy to install!
</p>
<p>Copyright (C) 2016 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p>
<p><a href="/org/2016/02/25/Pycse-is-now-using-Python3.org">org-mode source</a></p>
<p>Org-mode version = 8.2.10</p>]]></content:encoded>
    </item>
    <item>
      <title>Generating an alphabetized list of collaborators from the past five years</title>
      <link>http://jkitchin.github.io/blog/2016/02/20/Generating-an-alphabetized-list-of-collaborators-from-the-past-five-years</link>
      <pubDate>Sat, 20 Feb 2016 17:03:13 EST</pubDate>
      <category><![CDATA[python]]></category>
      <category><![CDATA[scopus]]></category>
      <guid isPermaLink="false">WVonYueoa2xWOB8KM-9Z-g7CEqg=</guid>
      <description>Generating an alphabetized list of collaborators from the past five years</description>
      <content:encoded><![CDATA[


<p>
Almost every proposal I write requires some list of my coauthors from the past several years. Some want the list alphabetized, and some want affiliations too. It has always bothered me to make this list, mostly because it is tedious, and it seems like something that should not be hard to generate. It turns out it is not too hard. I have been developing a Python interface ((<a href="https://github.com/jkitchin/scopus">https://github.com/jkitchin/scopus</a> )) to <a href="http://scopus.com">Scopus</a> that more or less enables me to script this.
</p>

<p>
Scopus is not free. You need either a license, or institutional access to use it. Here is the strategy to generate my list of coauthors. First, we need to get the articles for the past 5 years that are mine, and for each paper we get the coauthors. I use my Scopus author id in the query, and then sort the names alphabetically into a table. Then, I use that table as input to a second code block that does an author query in Scopus to get the current affiliations. Here is the code.
</p>

<div class="org-src-container">

<pre class="src src-python" id="coauthors"><span style="color: #0000FF;">from</span> scopus.scopus_api <span style="color: #0000FF;">import</span> ScopusAbstract
<span style="color: #0000FF;">from</span> scopus.scopus_search <span style="color: #0000FF;">import</span> ScopusSearch

<span style="color: #BA36A5;">s</span> = ScopusSearch(<span style="color: #008000;">'AU-ID(7004212771) AND PUBYEAR &gt; 2010'</span>)

<span style="color: #BA36A5;">coauthors</span> = {}
<span style="color: #0000FF;">for</span> eid <span style="color: #0000FF;">in</span> s.EIDS:
    <span style="color: #BA36A5;">ab</span> = ScopusAbstract(eid)
    <span style="color: #0000FF;">for</span> au <span style="color: #0000FF;">in</span> ab.authors:
        <span style="color: #0000FF;">if</span> au.auid <span style="color: #0000FF;">not</span> <span style="color: #0000FF;">in</span> coauthors <span style="color: #0000FF;">and</span> au.auid != <span style="color: #008000;">'7004212771'</span>:
            <span style="color: #BA36A5;">coauthors</span>[au.auid] = au.indexed_name

<span style="color: #0000FF;">return</span> <span style="color: #006FE0;">sorted</span>([[auid, name] <span style="color: #0000FF;">for</span> auid,name <span style="color: #0000FF;">in</span> coauthors.items()], key=<span style="color: #0000FF;">lambda</span> x:x[1])
</pre>
</div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="right" />

<col  class="left" />
</colgroup>
<tbody>
<tr>
<td class="right">52463103500</td>
<td class="left">Akhade S.A.</td>
</tr>

<tr>
<td class="right">6506329719</td>
<td class="left">Albenze E.</td>
</tr>

<tr>
<td class="right">36472906200</td>
<td class="left">Alesi W.R.</td>
</tr>

<tr>
<td class="right">56963752500</td>
<td class="left">Anna S.L.</td>
</tr>

<tr>
<td class="right">56522803500</td>
<td class="left">Boes J.R.</td>
</tr>

<tr>
<td class="right">26433085700</td>
<td class="left">Calle-Vallejo F.</td>
</tr>

<tr>
<td class="right">54973276000</td>
<td class="left">Chao R.</td>
</tr>

<tr>
<td class="right">7201800897</td>
<td class="left">Collins T.J.</td>
</tr>

<tr>
<td class="right">54883867200</td>
<td class="left">Curnan M.T.</td>
</tr>

<tr>
<td class="right">7003584159</td>
<td class="left">Damodaran K.</td>
</tr>

<tr>
<td class="right">55328415000</td>
<td class="left">Demeter E.L.</td>
</tr>

<tr>
<td class="right">37005464900</td>
<td class="left">Dsilva C.</td>
</tr>

<tr>
<td class="right">18037364800</td>
<td class="left">Egbebi A.</td>
</tr>

<tr>
<td class="right">35603120700</td>
<td class="left">Eslick J.C.</td>
</tr>

<tr>
<td class="right">56673468200</td>
<td class="left">Fan Q.</td>
</tr>

<tr>
<td class="right">24404182600</td>
<td class="left">Frenkel A.I.</td>
</tr>

<tr>
<td class="right">35514271900</td>
<td class="left">Gellman A.J.</td>
</tr>

<tr>
<td class="right">12803603300</td>
<td class="left">Gerdes K.</td>
</tr>

<tr>
<td class="right">54585146800</td>
<td class="left">Gumuslu G.</td>
</tr>

<tr>
<td class="right">55569145100</td>
<td class="left">Hallenbeck A.P.</td>
</tr>

<tr>
<td class="right">24316829300</td>
<td class="left">Hansen H.A.</td>
</tr>

<tr>
<td class="right">56009239000</td>
<td class="left">Hilburg S.L.</td>
</tr>

<tr>
<td class="right">55676869000</td>
<td class="left">Hopkinson D.</td>
</tr>

<tr>
<td class="right">56674328100</td>
<td class="left">Illes S.M.</td>
</tr>

<tr>
<td class="right">23479647900</td>
<td class="left">Inoglu N.G.</td>
</tr>

<tr>
<td class="right">6603398169</td>
<td class="left">Jaramillo T.F.</td>
</tr>

<tr>
<td class="right">8054222900</td>
<td class="left">Joshi Y.V.</td>
</tr>

<tr>
<td class="right">47962378000</td>
<td class="left">Keturakis C.</td>
</tr>

<tr>
<td class="right">57056061900</td>
<td class="left">Kondratyuk P.</td>
</tr>

<tr>
<td class="right">55391991800</td>
<td class="left">Kondratyuk P.</td>
</tr>

<tr>
<td class="right">7006205398</td>
<td class="left">Koper M.T.M.</td>
</tr>

<tr>
<td class="right">23004637900</td>
<td class="left">Kusuma V.A.</td>
</tr>

<tr>
<td class="right">35787409400</td>
<td class="left">Landon J.</td>
</tr>

<tr>
<td class="right">55005205100</td>
<td class="left">Lee A.S.</td>
</tr>

<tr>
<td class="right">6701399651</td>
<td class="left">Luebke D.R.</td>
</tr>

<tr>
<td class="right">35491189200</td>
<td class="left">Man I.C.</td>
</tr>

<tr>
<td class="right">27467500000</td>
<td class="left">Mantripragada H.</td>
</tr>

<tr>
<td class="right">55373026900</td>
<td class="left">Mao J.X.</td>
</tr>

<tr>
<td class="right">55210428500</td>
<td class="left">Marks A.</td>
</tr>

<tr>
<td class="right">27667815700</td>
<td class="left">Martinez J.I.</td>
</tr>

<tr>
<td class="right">56071079300</td>
<td class="left">Mehta P.</td>
</tr>

<tr>
<td class="right">56673592900</td>
<td class="left">Michael J.D.</td>
</tr>

<tr>
<td class="right">55772901000</td>
<td class="left">Miller D.C.</td>
</tr>

<tr>
<td class="right">7501599910</td>
<td class="left">Miller J.B.</td>
</tr>

<tr>
<td class="right">26032231600</td>
<td class="left">Miller S.D.</td>
</tr>

<tr>
<td class="right">35576929100</td>
<td class="left">Morreale B.</td>
</tr>

<tr>
<td class="right">55308251800</td>
<td class="left">Munprom R.</td>
</tr>

<tr>
<td class="right">14036290400</td>
<td class="left">Myers C.R.</td>
</tr>

<tr>
<td class="right">7007042214</td>
<td class="left">Norskov J.K.</td>
</tr>

<tr>
<td class="right">24081524800</td>
<td class="left">Nulwala H.B.</td>
</tr>

<tr>
<td class="right">56347288000</td>
<td class="left">Petrova R.</td>
</tr>

<tr>
<td class="right">7006208748</td>
<td class="left">Pushkarev V.V.</td>
</tr>

<tr>
<td class="right">56591664500</td>
<td class="left">Raman S.</td>
</tr>

<tr>
<td class="right">7004217247</td>
<td class="left">Resnik K.P.</td>
</tr>

<tr>
<td class="right">47962694800</td>
<td class="left">Richard Alesi Jr. W.</td>
</tr>

<tr>
<td class="right">9742604300</td>
<td class="left">Rossmeisl J.</td>
</tr>

<tr>
<td class="right">7201763336</td>
<td class="left">Rubin E.S.</td>
</tr>

<tr>
<td class="right">6602471339</td>
<td class="left">Sabolsky E.M.</td>
</tr>

<tr>
<td class="right">7004541416</td>
<td class="left">Salvador P.A.</td>
</tr>

<tr>
<td class="right">22981503200</td>
<td class="left">Shi W.</td>
</tr>

<tr>
<td class="right">55885836600</td>
<td class="left">Siefert N.S.</td>
</tr>

<tr>
<td class="right">25224517700</td>
<td class="left">Su H.-Y.</td>
</tr>

<tr>
<td class="right">57016792200</td>
<td class="left">Thirumalai H.</td>
</tr>

<tr>
<td class="right">8724572500</td>
<td class="left">Thompson R.L.</td>
</tr>

<tr>
<td class="right">8238710700</td>
<td class="left">Vasic R.</td>
</tr>

<tr>
<td class="right">37081979100</td>
<td class="left">Versteeg P.</td>
</tr>

<tr>
<td class="right">7006804734</td>
<td class="left">Wachs I.E.</td>
</tr>

<tr>
<td class="right">6701692232</td>
<td class="left">Washburn N.R.</td>
</tr>

<tr>
<td class="right">56542538800</td>
<td class="left">Watkins J.D.</td>
</tr>

<tr>
<td class="right">55569461200</td>
<td class="left">Xu Z.</td>
</tr>

<tr>
<td class="right">56424861600</td>
<td class="left">Yin C.</td>
</tr>

<tr>
<td class="right">56969809500</td>
<td class="left">Zhou X.</td>
</tr>
</tbody>
</table>

<p>
It is worth inspecting this list for duplicates. I see at least two duplicates. That is a limitation of almost every indexing service I have seen. Names are hard to disambiguate. I will live with it. Now, we will use another query to get affiliations, and the names. Since we use a sorted list from above, these names are in alphabetical order. We exclude co-authors from Carnegie Mellon University since these are often my students, or colleagues, and they are obvious conflicts of interest for proposal reviewing anyway. I split the current affiliation on a comma, since it appears the institution comes first, followed by the department. We only need an institution here.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #0000FF;">from</span> scopus.scopus_author <span style="color: #0000FF;">import</span> ScopusAuthor

<span style="color: #BA36A5;">coauthors</span> = [ScopusAuthor(auid) <span style="color: #0000FF;">for</span> auid, name <span style="color: #0000FF;">in</span> data]

<span style="color: #0000FF;">print</span>(<span style="color: #008000;">', '</span>.join([<span style="color: #008000;">'{0} ({1})'</span>.<span style="color: #006FE0;">format</span>(au.name, au.current_affiliation.split(<span style="color: #008000;">','</span>)[0])
                 <span style="color: #0000FF;">for</span> au <span style="color: #0000FF;">in</span> coauthors
                 <span style="color: #0000FF;">if</span> au.current_affiliation.split(<span style="color: #008000;">','</span>)[0] != <span style="color: #008000;">'Carnegie Mellon University'</span>]))
</pre>
</div>

<pre class="example">
Sneha A. Akhade (Pennsylvania State University), Erik J. Albenze (National Energy Technology Laboratory), Federico Calle-Vallejo (Leiden Institute of Chemistry), Robin Chao (National Energy Technology Laboratory), Krishnan V. Damodaran (University of Pittsburgh), Carmeline J. Dsilva (Princeton University), Adefemi A. Egbebi (URS), John C. Eslick (National Energy Technology Laboratory), Anatoly I. Frenkel (Yeshiva University), Kirk R. Gerdes (National Energy Technology Laboratory), Heine Anton Hansen (Danmarks Tekniske Universitet), David P. Hopkinson (National Energy Technology Laboratory), Thomas Francisco Jaramillo (Fermi National Accelerator Laboratory), Yogesh V. Joshi (Exxon Mobil Research and Engineering), Christopher J. Keturakis (Lehigh University), Marc T M Koper (Leiden Institute of Chemistry), Victor A. Kusuma (National Energy Technology Laboratory), James Landon (University of Kentucky), David R. Luebke (Liquid Ion Solutions), Isabelacostinela Man (Universitatea din Bucuresti), James X. Mao (University of Pittsburgh), Jos Ignacio Martnez (CSIC - Instituto de Ciencia de Materiales de Madrid (ICMM)), David C M Miller (National Energy Technology Laboratory), Bryan D. Morreale (National Energy Technology Laboratory), Christina R. Myers (National Energy Technology Laboratory), Jens Kehlet Nrskov (Stanford Linear Accelerator Center), Rumyana V. Petrova (International Iberian Nanotechnology Laboratory), Vladimir V. Pushkarev (Dow Corning Corporation), Sumathy Raman (Exxon Mobil Research and Engineering), Kevin P. Resnik (URS), Walter Richard Alesi (National Energy Technology Laboratory), Jan Rossmeisl (Kobenhavns Universitet), Edward M. Sabolsky (West Virginia University), Wei Shi (University of Pittsburgh), Nicholas S. Siefert (National Energy Technology Laboratory), Haiyan Su (Dalian Institute of Chemical Physics Chinese Academy of Sciences), Robert Lee Thompson (University of Pittsburgh Medical Center), Relja Vasi (SUNY College of Nanoscale Science and Engineering), Israel E. Wachs (Lehigh University), John D. Watkins (National Energy Technology Laboratory), Chunrong Yin (United States Department of Energy), Xu Zhou (Liquid Ion Solutions)
</pre>

<p>
This is pretty sweet. I could pretty easily create a query that had all the PIs on a proposal, and alphabetize everyone's coauthors, or print them to a CSV file for import to Excel, or whatever format is required for conflict of interest reporting. The list is not perfect, but it is easy to manually fix it here.
</p>

<p>
That little bit of code is wrapped in a command-line utility in the scopus Python package. You use it like this. Just run it every time you need an updated list of coauthors! It isn't super flexible for now, e.g. excluding multiple affiliations, including multiple authors, etc&#x2026; isn't fully supported.
</p>

<div class="org-src-container">

<pre class="src src-sh">./scopus_coauthors 7004212771 2010 --exclude-affiliation=<span style="color: #008000;">"Carnegie Mellon University"</span>
</pre>
</div>

<pre class="example">
Sneha A. Akhade (Pennsylvania State University), Erik J. Albenze (National Energy Technology Laboratory), Federico Calle-Vallejo (Leiden Institute of Chemistry), Robin Chao (National Energy Technology Laboratory), Krishnan V. Damodaran (University of Pittsburgh), Carmeline J. Dsilva (Princeton University), Adefemi A. Egbebi (URS), John C. Eslick (National Energy Technology Laboratory), Anatoly I. Frenkel (Yeshiva University), Kirk R. Gerdes (National Energy Technology Laboratory), Heine Anton Hansen (Danmarks Tekniske Universitet), David P. Hopkinson (National Energy Technology Laboratory), Thomas Francisco Jaramillo (Fermi National Accelerator Laboratory), Yogesh V. Joshi (Exxon Mobil Research and Engineering), Christopher J. Keturakis (Lehigh University), Marc T M Koper (Leiden Institute of Chemistry), Victor A. Kusuma (National Energy Technology Laboratory), James Landon (University of Kentucky), David R. Luebke (Liquid Ion Solutions), Isabelacostinela Man (Universitatea din Bucuresti), James X. Mao (University of Pittsburgh), Jos Ignacio Martnez (CSIC - Instituto de Ciencia de Materiales de Madrid (ICMM)), David C M Miller (National Energy Technology Laboratory), Bryan D. Morreale (National Energy Technology Laboratory), Christina R. Myers (National Energy Technology Laboratory), Jens Kehlet Nrskov (Stanford Linear Accelerator Center), Rumyana V. Petrova (International Iberian Nanotechnology Laboratory), Vladimir V. Pushkarev (Dow Corning Corporation), Sumathy Raman (Exxon Mobil Research and Engineering), Kevin P. Resnik (URS), Walter Richard Alesi (National Energy Technology Laboratory), Jan Rossmeisl (Kobenhavns Universitet), Edward M. Sabolsky (West Virginia University), Wei Shi (University of Pittsburgh), Nicholas S. Siefert (National Energy Technology Laboratory), Haiyan Su (Dalian Institute of Chemical Physics Chinese Academy of Sciences), Robert Lee Thompson (University of Pittsburgh Medical Center), Relja Vasi (SUNY College of Nanoscale Science and Engineering), Israel E. Wachs (Lehigh University), John D. Watkins (National Energy Technology Laboratory), Chunrong Yin (United States Department of Energy), Xu Zhou (Liquid Ion Solutions)
</pre>
<p>Copyright (C) 2016 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p>
<p><a href="/org/2016/02/20/Generating-an-alphabetized-list-of-collaborators-from-the-past-five-years.org">org-mode source</a></p>
<p>Org-mode version = 8.2.10</p>]]></content:encoded>
    </item>
    <item>
      <title>Zhongnan Xu selected for the 2015-16 Dighe Fellowship in Chemical Engineering</title>
      <link>http://jkitchin.github.io/blog/2016/02/17/Zhongnan-Xu-selected-for-the-2015-16-Dighe-Fellowship-in-Chemical-Engineering</link>
      <pubDate>Wed, 17 Feb 2016 13:43:18 EST</pubDate>
      <category><![CDATA[news]]></category>
      <guid isPermaLink="false">54cnRGnb0JkZNf0OsCigUCsolb0=</guid>
      <description>Zhongnan Xu selected for the 2015-16 Dighe Fellowship in Chemical Engineering</description>
      <content:encoded><![CDATA[


<p>
Congratulations Zhongnan!
</p>
<p>Copyright (C) 2016 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p>
<p><a href="/org/2016/02/17/Zhongnan-Xu-selected-for-the-2015-16-Dighe-Fellowship-in-Chemical-Engineering.org">org-mode source</a></p>
<p>Org-mode version = 8.2.10</p>]]></content:encoded>
    </item>
    <item>
      <title>Zhongnan Xu successfully defended his PhD</title>
      <link>http://jkitchin.github.io/blog/2016/02/17/Zhongnan-Xu-successfully-defended-his-PhD</link>
      <pubDate>Wed, 17 Feb 2016 13:16:15 EST</pubDate>
      <category><![CDATA[news]]></category>
      <guid isPermaLink="false">G1Kcxy-9ReiVCb5-tmjS34ikSio=</guid>
      <description>Zhongnan Xu successfully defended his PhD</description>
      <content:encoded><![CDATA[


<p>
Zhongnan successfully defended his PhD dissertation yesterday!
</p>

<p>
Title: Towards Accurate Predictions and Mechanistic Understanding of the Catalytic Activity of Transition Metal Oxides.
</p>

<p>
Committee Members: Professor John Kitchin (chair), Professor Andrew Gellman, Professor Erik Ydstie, Professor Paul Salvador
</p>

<p>
Congratulations!
</p>
<p>Copyright (C) 2016 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p>
<p><a href="/org/2016/02/17/Zhongnan-Xu-successfully-defended-his-PhD.org">org-mode source</a></p>
<p>Org-mode version = 8.2.10</p>]]></content:encoded>
    </item>
  </channel>
</rss>
