

<!doctype html>
<!--[if lt IE 7 ]> <html lang="en" class="no-js ie6"> <![endif]-->
<!--[if IE 7 ]>    <html lang="en" class="no-js ie7"> <![endif]-->
<!--[if IE 8 ]>    <html lang="en" class="no-js ie8"> <![endif]-->
<!--[if IE 9 ]>    <html lang="en" class="no-js ie9"> <![endif]-->
<!--[if (gt IE 9)|!(IE)]><!--> <html lang="en" class="no-js"> <!--<![endif]-->
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>The Kitchin Research Group</title>
  <meta name="google-site-verification" content="CGcacJdHc2YoZyI0Vey9XRA5qwhhFDzThKJezbRFcJ4" />
  <meta name="description" content="Chemical Engineering at Carnegie Mellon University">
  <meta name="author" content="John Kitchin">
  <link rel="alternate" type="application/rss+xml" title="RSS 2.0" href="/blog/feed" />
  <link rel="alternate" type="application/atom+xml" title="Atom 1.0" href="/blog/feed/atom" />
  <link rel="shortcut icon" href="/favicon.ico">
  <link rel="apple-touch-icon" href="/img/apple-touch-icon.png">

  <link rel="stylesheet" href="/css/base.css?v=1">
  <link rel="stylesheet" href="/css/grid.css?v=1">
  <link rel="stylesheet" media="handheld" href="/css/handheld.css?v=1">
  <link rel="stylesheet" href="/css/pygments_murphy.css" type="text/css" />

  <script src="/js/libs/modernizr-1.7.min.js"></script>
<script type="text/javascript"
  src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
  <link rel="stylesheet" href="/themes/theme1/style.css?v=1">
<link href='http://fonts.googleapis.com/css?family=Roboto' rel='stylesheet' type='text/css'>

</head>
  <body>
    <div id="container" class="container container_12">
      <div id="main" role="main">
        <div id="main_block">
          <header>
<div id="header" class="header_gradient theme_font">
<table><tr><td>
    <h1><a href="/">The Kitchin Research Group</a></h1>
    <h2>Chemical Engineering at Carnegie Mellon University</h2>
</td>
<td colspan=100%><div style="float:right;width:100%;text-align:right;"> <span id='badgeCont737515' style='width:126px'><script src='http://labs.researcherid.com/mashlets?el=badgeCont737515&mashlet=badge&showTitle=false&className=a&rid=A-2363-2010'></script></span></div>
</td></tr>
</table>
</div>
  <div id="navigation" class="grid_12">

    <ul class="theme_font">
      <li><a href="/blog"
             class="">Blog</a></li>

      <li><a href="/blog/archive"
             class="">Archives</a></li>

      <li><a href="http://www.researcherid.com/rid/A-2363-2010" target="_new">Publications</a></li>

      <li><a href="/research.html"
             class="">Research</a></li>

      <li><a href="/group.html"
             class="">Group</a></li>

      <li><a href="/categories.html"
             class="">Categories</a></li>

      <li><a href="/about.html"
             class="">About us</a></li>
    </ul>
  </div>
</header>

          <div id="prose_block" class="grid_8">
            
  





<article>
  <div class="blog_post">
    <header>
      <div id="Installing-and-configuring-blogofile"></div>
      <h2 class="blog_post_title"><a href="/blog/2013/09/27/Installing-and-configuring-blogofile/" rel="bookmark" title="Permanent Link to Installing and configuring blogofile">Installing and configuring blogofile</a></h2>
      <p><small><span class="blog_post_date">Posted September 27, 2013 at 12:57 PM</span> | categories: 
        <span class="blog_post_categories"><a href='/blog/category/blog/'>blog</a></span> | tags: 
        | <a href="http://jkitchin.github.io/blog/2013/09/27/Installing-and-configuring-blogofile#disqus_thread">View Comments</a>
      </small></p>
    </header>
    <div class="post_prose">
      



<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#sec-1">1. System notes</a></li>
<li><a href="#sec-2">2. Installing blogofile</a></li>
<li><a href="#sec-3">3. Setup the site</a></li>
<li><a href="#sec-4">4. Customizing your blogofile blog</a></li>
</ul>
</div>
</div>

<p>
Here I will describe how I setup and use blogofile (<a href="http://docs.blogofile.com/en/latest/">http://docs.blogofile.com/en/latest/</a>) for this blog. Some of these are notes I took during the initial setup, which was some time ago! Let me know if something seems to be missing. 
</p>

<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1"><span class="section-number-2">1</span> System notes</h2>
<div class="outline-text-2" id="text-1">
<p>
I do most of the blogging on a Windows 7 machine. I run everything from a git Bash shell that came from <a href="http://git-scm.com/downloads">http://git-scm.com/downloads</a>, and I use the Canopy (<a href="https://www.enthought.com/products/canopy/">https://www.enthought.com/products/canopy/</a>) Python distribution.
</p>
</div>
</div>
<div id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2"><span class="section-number-2">2</span> Installing blogofile</h2>
<div class="outline-text-2" id="text-2">
<p>
First, we install the python modules we need. 
</p>
<div class="org-src-container">

<pre class="src src-sh">pip install Blogofile
pip install Blogofile-blog
</pre>
</div>

<p>
<span class="timestamp-wrapper"><span class="timestamp">[2013-03-03 Sun]</span></span> Update
I uninstalled these packages because I wanted to modify the source code a bit.  I have forked the repositories and slightly modified them to get tags working for my blog. Those repositories are at <a href="https://github.com/jkitchin/blogofile_blog">https://github.com/jkitchin/blogofile_blog</a> and <a href="https://github.com/jkitchin/blogofile">https://github.com/jkitchin/blogofile</a>.
</p>
</div>
</div>
<div id="outline-container-sec-3" class="outline-2">
<h2 id="sec-3"><span class="section-number-2">3</span> Setup the site</h2>
<div class="outline-text-2" id="text-3">
<p>
Blogofile has a command <code>blogofile</code> that sets up the directories you need to create a blog. The goal is to setup the directory structure, then setup the blog directory under git. The blog will be hosted on GitHUB. We do that that by creating a repository called &lt;github-userid&gt;.github.com with two branches, source and master. GitHUB will serve whatever is in the master branch at &lt;github-userid&gt;.githb.io. My GitHUB userid is jkitchin, so my repository name is jkitchin.github.com, and it is served at <a href="http://jkitchin.github.io[fn:4">http://jkitchin.github.io[fn:4</a>]
</p>

<p>
Locally, I want the blog content in a directory called blogofile-jkitchin.github.com. I actually have this directory in a Dropbox folder, so it synchronizes to all my computers in the office and at home. Within this directory will be a directory called _site. Blogofile ignores directories starting with _, and _site will contain the built blog content that will eventually be served. We do not want this directory under git control, because it is always generated.
</p>

<p>
Here are the commands I used to setup the initial blog.
</p>

<div class="org-src-container">

<pre class="src src-sh">blogofile init blogofile-jkitchin.github.com blog

<span style="color: #cd0000;">cd</span> blogofile-jkitchin.github.com
git init
git add .
git commit -m <span style="color: #228b22;">"initial commit"</span>

<span style="color: #cd0000;">echo</span> _site &gt; .gitignore
git add .gitignore
git commit .gitignore -m <span style="color: #228b22;">"add .gitignore"</span>
</pre>
</div>

<p>
When you are in the blogofile directory, you want to be on the source branch of the repository. This is not essential actually, but it will allow you to keep the source and built content under git control in separate branches. Next we checkout the source branch (this actually makes the source branch and checks it out).
</p>

<div class="org-src-container">

<pre class="src src-sh">git checkout -b source
</pre>
</div>

<p>
You can build the blog now (it is essentially empty, but probably has some example posts to make sure it works). From the command line run this:
</p>

<div class="org-src-container">

<pre class="src src-sh">blogofile build
</pre>
</div>

<p>
That creates the _site directory, but it is not under vc with git yet because we have it in the .gitignore file. _site contains all the html that makes the site. If you run 
</p>

<div class="org-src-container">

<pre class="src src-sh">blogofile serve
</pre>
</div>

<p>
You can browse to <a href="http://localhost:8080">http://localhost:8080</a> and check out the appearance.
</p>

<p>
To get the content pushed to GitHUB, I like the following setup. I created a _deploy directory inside the root directory. I added _deploy to .gitignore so it is not under version control from the parent directory. Inside the _deploy directory, I initialized a new git repository that is on the default master branch.
</p>

<div class="org-src-container">

<pre class="src src-sh">mkdir _deploy
<span style="color: #cd0000;">cd</span> _deploy
git init
git add .
git commit -m <span style="color: #228b22;">"site initial commit"</span>
</pre>
</div>

<p>
For now this is all we do to configure the version control. To deploy the site, we just copy the contents of _site into _deploy, add and commit the new files, and push the master branch of _deploy to the master branch of jkitchin.github.com on GitHUB. 
</p>

<p>
Currently the two repositories are local. Next, I am going to configure the two git repositories to point to my github repository. In blogofile-jkitchin.github.com and in _deploy I ran this command to point them to GitHUB:
</p>

<div class="org-src-container">

<pre class="src src-sh">git config remote.origin.url git@github.com:jkitchin/jkitchin.github.com
</pre>
</div>

<p>
I <i>think</i> that is all I have done in the setup. Admittedly, these are notes partially notes I took in the installation, partially from inspection of the current setup, and partially from memory,  so there may be a missing step or detail. Initially I found the setup confusing to have a git repository in an ignored folder inside a git repository, with each repository on a different branch! But eventually I got it.
</p>


<p>
Now we are ready to push the new site to GitHUB. I have a script that I run from  the root directory blogofile-jkitchin.github.com with these contents. 
</p>

<div class="org-src-container">

<pre class="src src-sh">rm -fr _deploy/*

<span style="color: #cd0000;">cd</span> _deploy

cp -R ../_site/* .

git add .
git add -u
git commit -m <span style="color: #228b22;">"deploy"</span>
git push origin master
</pre>
</div>

<p>
I delete everything in _deploy because I have not setup something more sophisticated like rsync that would synchronize _deploy and _site, deleting things in _deploy that are not in _site. That is a current limitation of my Windows setup that I have not installed rsync. I know I could, I just haven't. After that script runs, I am prompted for my GitHUB password, and it pushes the new content up to GitHUB on the master branch. If I want, I can also commit the new changes to the source branch in blogofile-jkitchin.github.com and push those changes too.
</p>

<p>
So the workflow from here is:
</p>

<ol class="org-ol">
<li>Prepare your blogpost in the _posts directory (See this <a href="http://jkitchin.github.io/blog/2013/09/27/Publishing-to-blogofile-using-org-mode/">post</a> for how I do that)
</li>
<li>Run "blogofile build" in the root blog directory
</li>
<li>Run "blogofile serve" and check it out on <a href="http://localhost:8080">http://localhost:8080</a> if you want
</li>
<li>Run the deploy script to push it to GitHUB
</li>
<li>Wait a minute or two, and checkout your new post at the github site (<a href="http://jkitchin.github.io">http://jkitchin.github.io</a> for me)
</li>
</ol>

<p>
That works pretty well for me. 
</p>
</div>
</div>
<div id="outline-container-sec-4" class="outline-2">
<h2 id="sec-4"><span class="section-number-2">4</span> Customizing your blogofile blog</h2>
<div class="outline-text-2" id="text-4">
<p>
Blogofile uses mako templates to generate the pages. You can see the changes I have made to the default blogofile setup and templates to customize my blog at <a href="https://github.com/jkitchin/jkitchin.github.com/tree/source">https://github.com/jkitchin/jkitchin.github.com/tree/source</a>, including some other automation attempts with makefiles and fabric. 
</p>

<p>
I hope you find this useful!
</p>
</div>
</div>
<p>Copyright (C) 2013 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2013/09/27/Installing-and-configuring-blogofile.org">org-mode source</a><p>

    </div>
  </div>
</article>



  <div class="after_post"><a href="http://jkitchin.github.io/blog/2013/09/27/Installing-and-configuring-blogofile#disqus_thread">Read and Post Comments</a></div>
  <hr class="interblog" />
  





<article>
  <div class="blog_post">
    <header>
      <div id="Publishing-to-blogofile-using-org-mode"></div>
      <h2 class="blog_post_title"><a href="/blog/2013/09/27/Publishing-to-blogofile-using-org-mode/" rel="bookmark" title="Permanent Link to Publishing to blogofile using org-mode">Publishing to blogofile using org-mode</a></h2>
      <p><small><span class="blog_post_date">Posted September 27, 2013 at 10:33 AM</span> | categories: 
        <span class="blog_post_categories"><a href='/blog/category/org-mode/'>org-mode</a></span> | tags: 
        | <a href="http://jkitchin.github.io/blog/2013/09/27/Publishing-to-blogofile-using-org-mode#disqus_thread">View Comments</a>
      <p><small><span class="blog_post_date">Updated September 27, 2013 at 10:53 AM</span>
      </small></p>
    </header>
    <div class="post_prose">
      




<p>
A few people have asked me about how I generate the posts in this blog, so I thought I would try to capture that process here. The blog itself is generated by blogofile <sup><a id="fnr.1" name="fnr.1" class="footref" href="#fn.1">1</a></sup>. Blogofile is a pure python, static blog generator. I will discuss the setup of that another time. Here I will focus on how the posts are written and published to the blog.
</p>

<p>
The posts in this blog were created using Emacs and org-mode <sup><a id="fnr.2" name="fnr.2" class="footref" href="#fn.2">2</a></sup>. Basically I create a heading in org-mode (any level will do, but I usually make them top headings, i.e. with one *). The post can contain all the markup in org-mode that can be exported to HTML, including equations, code, links, and images. I set org-properties of the heading for the categories and tags of the post. 
</p>

<p>
Blogofile wants a post to be a file in a specific directory called _posts . The file must have a YAML heading, followed by the body of the html that will be the post. So, to create a blogofile post, we have to export the org-mode heading to a properly formatted post file, in the _posts directory of the blogofile root. org-mode has an excellent export system for generating html, but I had to write some customized emacs-lisp code to get exactly what I want. That code is available at <a href="https://github.com/jkitchin/jmax/blob/prelude/blogofile.el">https://github.com/jkitchin/jmax/blob/prelude/blogofile.el</a>. I am sure this code is not written most elegantly, but it has worked for me for about 186 posts (counting this one). This file gets loaded in my init.el file. It is very likely you will have to run a fairly modern version of org-mode (at least 8+) to do this. You will also probably need to configure your org-mode like mine to get similar looking results. My current setup builds off of Prelude<sup><a id="fnr.3" name="fnr.3" class="footref" href="#fn.3">3</a></sup>. The contents of the personal directory can be found here <a href="https://github.com/jkitchin/jmax/tree/prelude">https://github.com/jkitchin/jmax/tree/prelude</a>. I keep a git version of org in there.
</p>

<p>
Basically the blogofile code does the following:
</p>

<ol class="org-ol">
<li>Grabs the content of the current org-mode heading
</li>
<li>Constructs the YAML heading from information in properties of the heading, and the heading title
</li>
<li>Exports the heading body into an HTML string. If your post has images in it, there is an additional step required. In blogofile.el, I temporarily redefined org-html&#x2013;format-image so that it would copy the image to the images directory in the blogofile root, and return a url that would be correct when it is published to github. My blog uses Mathjax, so equations are automatically handled correctly.
</li>
<li>Combine the YAML heading and HTML string and save it to a file in the _posts directory.
</li>
<li>Enter a few new or update properties in the heading about when it was created and/or updated
</li>
<li>I wanted the org-code for each post to be published on the blog so I also save the org-code to a directory in the blogofile root and add a link to it in the HTML file.
</li>
</ol>

<p>
All of that action is written in a single command called <code>bf-blogpost</code> which I bind to the F10 key. So, after I am done with my blogpost, I press F10, and the post is created in my blogofile root directory. I find that pretty convenient.
</p>

<p>
To publish it to github, I have to do the following:
</p>

<ol class="org-ol">
<li>Change into the blogofile root directory, and run "blogofile build" which generates the html files from the new _post. I can locally serve the blog to check out the post if I want.
</li>
<li>Copy the new files to a directory called _deploy, which is is the master branch of the repository at <a href="https://github.com/jkitchin/jkitchin.github.com">https://github.com/jkitchin/jkitchin.github.com</a>, and only contains the published blog HTML
</li>
<li>Commit the new changes to the repository and push them to github. A few minutes later, the new post is visible on the website, which is hosted by GitHUB (Thanks GitHUB!).
</li>
</ol>

<p>
This all works well on my windows machines. I don't know why, but I cannot build the blog on a Linux machine. Maybe because of mixed dos/unix line endings, or something silly like that.
</p>

<p>
After spending some time getting this workflow to work, I find it pretty convenient. I love that I can write the posts in org-mode, because most of them are about using python or emacs-lisp, and I like to have the code and output together with my narrative text. I also like that the actual org-code is available as a link in each post. That way if I don't remember how I did something I can always go back to the source, or my students can learn how I used org-mode.
</p>

<p>
One thing I have not figured out yet is how to have uploads, e.g. if I use a datafile in a post, it would be nice to have the blogpost function automatically copy that file to the right place so that the link to it works in the blog. I haven't needed that too often, so it has not been a high priority.
</p>
<div id="footnotes">
<h2 class="footnotes">Footnotes: </h2>
<div id="text-footnotes">

<div class="footdef"><sup><a id="fn.1" name="fn.1" class="footnum" href="#fnr.1">1</a></sup> <p>
<a href="http://docs.blogofile.com/en/latest/">http://docs.blogofile.com/en/latest/</a> I have forked the repositories and slightly modified them to get tags working for my blog. Those repositories are at <a href="https://github.com/jkitchin/blogofile_blog">https://github.com/jkitchin/blogofile_blog</a> and <a href="https://github.com/jkitchin/blogofile">https://github.com/jkitchin/blogofile</a>.
</p></div>

<div class="footdef"><sup><a id="fn.2" name="fn.2" class="footnum" href="#fnr.2">2</a></sup> <p>
<a href="http://orgmode.org">http://orgmode.org</a>
</p></div>

<div class="footdef"><sup><a id="fn.3" name="fn.3" class="footnum" href="#fnr.3">3</a></sup> <p>
<a href="https://github.com/bbatsov/prelude">https://github.com/bbatsov/prelude</a>
</p></div>


</div>
</div><p>Copyright (C) 2013 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2013/09/27/Publishing-to-blogofile-using-org-mode.org">org-mode source</a><p>

    </div>
  </div>
</article>



  <div class="after_post"><a href="http://jkitchin.github.io/blog/2013/09/27/Publishing-to-blogofile-using-org-mode#disqus_thread">Read and Post Comments</a></div>
  <hr class="interblog" />
  





<article>
  <div class="blog_post">
    <header>
      <div id="Using-events-in-odelay-with-multiple-equations"></div>
      <h2 class="blog_post_title"><a href="/blog/2013/09/19/Using-events-in-odelay-with-multiple-equations/" rel="bookmark" title="Permanent Link to Using events in odelay with multiple equations">Using events in odelay with multiple equations</a></h2>
      <p><small><span class="blog_post_date">Posted September 19, 2013 at 10:33 AM</span> | categories: 
        <span class="blog_post_categories"><a href='/blog/category/odes/'>odes</a></span> | tags: <a href='/blog/tag/events/'>events</a>
        | <a href="http://jkitchin.github.io/blog/2013/09/19/Using-events-in-odelay-with-multiple-equations#disqus_thread">View Comments</a>
      </small></p>
    </header>
    <div class="post_prose">
      




<p>
<code>odelay</code> was recently updated to support multiple odes with events. Here is an example. We want the solutions to:
</p>

\begin{align}
\frac{dy_1}{dx} = y_2 \\
\frac{dy_2}{dx} = -y_1
\end{align}

<p>
with initial conditions \(y_1(0) = 2\) and \(y_2(0) = 1\). We want to stop the integration when \(y_2 = -1\) and find out when \(dy_1/dx=0\) and at a maximum.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">from</span> pycse <span style="color: #8b0000;">import</span> odelay
<span style="color: #8b0000;">import</span> matplotlib.pyplot <span style="color: #8b0000;">as</span> plt
<span style="color: #8b0000;">import</span> numpy <span style="color: #8b0000;">as</span> np

<span style="color: #8b0000;">def</span> <span style="color: #8b2323;">ode</span>(Y,x):
    <span style="color: #8b008b;">y1</span>, <span style="color: #8b008b;">y2</span> = Y
    <span style="color: #8b008b;">dy1dx</span> = y2
    <span style="color: #8b008b;">dy2dx</span> = -y1
    <span style="color: #8b0000;">return</span> [dy1dx, dy2dx]

<span style="color: #8b0000;">def</span> <span style="color: #8b2323;">event1</span>(Y, x):
    <span style="color: #8b008b;">y1</span>, <span style="color: #8b008b;">y2</span> = Y
    <span style="color: #8b008b;">value</span> = y2 - (-1.0)
    <span style="color: #8b008b;">isterminal</span> = <span style="color: #cd0000;">True</span>
    <span style="color: #8b008b;">direction</span>  = 0
    <span style="color: #8b0000;">return</span> value, isterminal, direction

<span style="color: #8b0000;">def</span> <span style="color: #8b2323;">event2</span>(Y, x):
    <span style="color: #8b008b;">dy1dx</span>, <span style="color: #8b008b;">dy2dx</span> = ode(Y,x)
    <span style="color: #8b008b;">value</span> = dy1dx - 0.0
    <span style="color: #8b008b;">isterminal</span> = <span style="color: #cd0000;">False</span>
    <span style="color: #8b008b;">direction</span> = -1  <span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">derivative is decreasing towards a maximum</span>
    <span style="color: #8b0000;">return</span> value, isterminal, direction

<span style="color: #8b008b;">Y0</span> = [2.0, 1.0]
<span style="color: #8b008b;">xspan</span> = np.linspace(0, 5)
<span style="color: #8b008b;">X</span>, <span style="color: #8b008b;">Y</span>, <span style="color: #8b008b;">XE</span>, <span style="color: #8b008b;">YE</span>, <span style="color: #8b008b;">IE</span> = odelay(ode, Y0, xspan, events=[event1, event2])

plt.plot(X, Y)
<span style="color: #8b0000;">for</span> ie,xe,ye <span style="color: #8b0000;">in</span> <span style="color: #cd0000;">zip</span>(IE, XE, YE):
    <span style="color: #8b0000;">if</span> ie == 1: <span style="color: #ff0000; font-weight: bold;">#</span><span style="color: #ff0000; font-weight: bold;">this is the second event</span>
        <span style="color: #8b008b;">y1</span>,y2 = ye
        plt.plot(xe, y1, <span style="color: #228b22;">'ro'</span>) 
        
plt.legend([<span style="color: #228b22;">'$y_1$'</span>, <span style="color: #228b22;">'$y_2$'</span>], loc=<span style="color: #228b22;">'best'</span>)
plt.savefig(<span style="color: #228b22;">'images/odelay-mult-eq.png'</span>)
plt.show()
</pre>
</div>

<p>
Here are the plotted results:
<p><img src="/img/./images/odelay-mult-eq.png"><p>
</p>
<p>Copyright (C) 2013 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2013/09/19/Using-events-in-odelay-with-multiple-equations.org">org-mode source</a><p>

    </div>
  </div>
</article>



  <div class="after_post"><a href="http://jkitchin.github.io/blog/2013/09/19/Using-events-in-odelay-with-multiple-equations#disqus_thread">Read and Post Comments</a></div>
  <hr class="interblog" />
  





<article>
  <div class="blog_post">
    <header>
      <div id="Customizing-plots-after-the-fact"></div>
      <h2 class="blog_post_title"><a href="/blog/2013/09/16/Customizing-plots-after-the-fact/" rel="bookmark" title="Permanent Link to Customizing plots after the fact">Customizing plots after the fact</a></h2>
      <p><small><span class="blog_post_date">Posted September 16, 2013 at 04:27 PM</span> | categories: 
        <span class="blog_post_categories"><a href='/blog/category/plotting/'>plotting</a></span> | tags: 
        | <a href="http://jkitchin.github.io/blog/2013/09/16/Customizing-plots-after-the-fact#disqus_thread">View Comments</a>
      <p><small><span class="blog_post_date">Updated September 16, 2013 at 04:32 PM</span>
      </small></p>
    </header>
    <div class="post_prose">
      



<p>
<a href="http://matlab.cheme.cmu.edu/2011/09/16/customizing-plots-after-the-fact/">Matlab post</a>
Sometimes it is desirable to make a plot that shows the data you want to present, and to customize the details, e.g. font size/type and line thicknesses afterwards. It can be tedious to try to add the customization code to the existing code that makes the plot. Today, we look at a way to do the customization after the plot is created.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">import</span> numpy <span style="color: #8b0000;">as</span> np
<span style="color: #8b0000;">import</span> matplotlib.pyplot <span style="color: #8b0000;">as</span> plt

<span style="color: #8b008b;">x</span> = np.linspace(0,2)
<span style="color: #8b008b;">y1</span> = x
<span style="color: #8b008b;">y2</span> = x**2
<span style="color: #8b008b;">y3</span> = x**3

plt.plot(x, y1, x, y2, x, y3)
<span style="color: #8b008b;">xL</span> = plt.xlabel(<span style="color: #228b22;">'x'</span>)
<span style="color: #8b008b;">yL</span> = plt.ylabel(<span style="color: #228b22;">'f(x)'</span>)
plt.title(<span style="color: #228b22;">'plots of y = x^n'</span>)
plt.legend([<span style="color: #228b22;">'x'</span>, <span style="color: #228b22;">'x^2'</span>, <span style="color: #228b22;">'x^3'</span>], loc=<span style="color: #228b22;">'best'</span>)
plt.savefig(<span style="color: #228b22;">'images/after-customization-1.png'</span>)

<span style="color: #8b008b;">fig</span> = plt.gcf()

plt.setp(fig, <span style="color: #228b22;">'size_inches'</span>, (4, 6))
plt.savefig(<span style="color: #228b22;">'images/after-customization-2.png'</span>)


<span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">set lines to dashed</span>
<span style="color: #8b0000;">from</span> matplotlib.lines <span style="color: #8b0000;">import</span> Line2D
<span style="color: #8b0000;">for</span> o <span style="color: #8b0000;">in</span> fig.findobj(Line2D):
    o.set_linestyle(<span style="color: #228b22;">'--'</span>)

<span style="color: #ff0000; font-weight: bold;">#</span><span style="color: #ff0000; font-weight: bold;">set(allaxes,'FontName','Arial','FontWeight','Bold','LineWidth',2,'FontSize',14);</span>

<span style="color: #8b0000;">import</span> matplotlib.text <span style="color: #8b0000;">as</span> text
<span style="color: #8b0000;">for</span> o <span style="color: #8b0000;">in</span> fig.findobj(text.Text):
    plt.setp(o, <span style="color: #228b22;">'fontname'</span>,<span style="color: #228b22;">'Arial'</span>, <span style="color: #228b22;">'fontweight'</span>,<span style="color: #228b22;">'bold'</span>, <span style="color: #228b22;">'fontsize'</span>, 14)

plt.setp(xL, <span style="color: #228b22;">'fontstyle'</span>, <span style="color: #228b22;">'italic'</span>)
plt.setp(yL, <span style="color: #228b22;">'fontstyle'</span>, <span style="color: #228b22;">'italic'</span>)
plt.savefig(<span style="color: #228b22;">'images/after-customization-3.png'</span>)
plt.show()
</pre>
</div>


<div class="figure">
<p><p><img src="/img/./images/after-customization-1.png"><p>
</p>
</div>


<div class="figure">
<p><p><img src="/img/./images/after-customization-2.png"><p>
</p>
</div>


<div class="figure">
<p><p><img src="/img/./images/after-customization-3.png"><p></p>
</div>
<p>Copyright (C) 2013 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2013/09/16/Customizing-plots-after-the-fact.org">org-mode source</a><p>

    </div>
  </div>
</article>



  <div class="after_post"><a href="http://jkitchin.github.io/blog/2013/09/16/Customizing-plots-after-the-fact#disqus_thread">Read and Post Comments</a></div>
  <hr class="interblog" />
  





<article>
  <div class="blog_post">
    <header>
      <div id="Plotting-two-datasets-with-very-different-scales"></div>
      <h2 class="blog_post_title"><a href="/blog/2013/09/13/Plotting-two-datasets-with-very-different-scales/" rel="bookmark" title="Permanent Link to Plotting two datasets with very different scales">Plotting two datasets with very different scales</a></h2>
      <p><small><span class="blog_post_date">Posted September 13, 2013 at 01:55 PM</span> | categories: 
        <span class="blog_post_categories"><a href='/blog/category/plotting/'>plotting</a></span> | tags: 
        | <a href="http://jkitchin.github.io/blog/2013/09/13/Plotting-two-datasets-with-very-different-scales#disqus_thread">View Comments</a>
      <p><small><span class="blog_post_date">Updated June 19, 2014 at 03:26 PM</span>
      </small></p>
    </header>
    <div class="post_prose">
      



<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#sec-1">1. Make two plots!</a></li>
<li><a href="#sec-2">2. Scaling the results</a></li>
<li><a href="#sec-3">3. Double-y axis plot</a></li>
<li><a href="#sec-4">4. Subplots</a></li>
</ul>
</div>
</div>
<p>
<a href="http://matlab.cheme.cmu.edu/2011/08/25/plotting-two-datasets-with-very-different-scales/">Matlab plot</a> 
</p>

<p>
Sometimes you will have two datasets you want to plot together, but the scales will be so different it is hard to seem them both in the same plot. Here we examine a few strategies to plotting this kind of data.
</p>

<div class="org-src-container">

<pre class="src src-python">import numpy as np
import matplotlib.pyplot as plt

x = np.linspace(0, 2*np.pi)
y1 = np.sin(x);
y2 = 0.01 * np.cos(x);

plt.plot(x, y1, x, y2)
plt.legend(['y1', 'y2'])
plt.savefig('images/two-scales-1.png')
# in this plot y2 looks almost flat!
</pre>
</div>

<pre class="example">
&gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; [&lt;matplotlib.lines.Line2D object at 0x0000000006089128&gt;, &lt;matplotlib.lines.Line2D object at 0x000000000766B2E8&gt;]
&lt;matplotlib.legend.Legend object at 0x0000000007661668&gt;
</pre>


<div class="figure">
<p><img src="/media/2013-09-13-Plotting-two-datasets-with-very-different-scales/two-scales-1.png"> 
</p>
</div>

<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1"><span class="section-number-2">1</span> Make two plots!</h2>
<div class="outline-text-2" id="text-1">
<p>
this certainly solves the problem, but you have two full size plots, which can take up a lot of space in a presentation and report. Often your goal in plotting both data sets is to compare them, and it is easiest to compare plots when they are perfectly lined up. Doing that manually can be tedious.
</p>

<div class="org-src-container">

<pre class="src src-python">plt.figure()
plt.plot(x,y1)
plt.legend(['y1'])
plt.savefig('images/two-scales-2.png')

plt.figure()
plt.plot(x,y2)
plt.legend(['y2'])
plt.savefig('images/two-scales-3.png')
</pre>
</div>

<pre class="example">
&lt;matplotlib.figure.Figure object at 0x0000000007D45438&gt;
[&lt;matplotlib.lines.Line2D object at 0x00000000081C61D0&gt;]
&lt;matplotlib.legend.Legend object at 0x0000000007FA1CF8&gt;
&gt;&gt;&gt; &gt;&gt;&gt; &lt;matplotlib.figure.Figure object at 0x00000000081C63C8&gt;
[&lt;matplotlib.lines.Line2D object at 0x00000000081C8F60&gt;]
&lt;matplotlib.legend.Legend object at 0x00000000081D7278&gt;
</pre>


<div class="figure">
<p><img src="/media/2013-09-13-Plotting-two-datasets-with-very-different-scales/two-scales-2.png"> 
</p>
</div>


<div class="figure">
<p><img src="/media/2013-09-13-Plotting-two-datasets-with-very-different-scales/two-scales-3.png"> 
</p>
</div>
</div>
</div>

<div id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2"><span class="section-number-2">2</span> Scaling the results</h2>
<div class="outline-text-2" id="text-2">
<p>
Sometimes you can scale one dataset so it has a similar magnitude as the other data set. Here we could multiply y2 by 100, and then it will be similar in size to y1. Of course, you need to indicate that y2 has been scaled in the graph somehow. Here we use the legend.
</p>

<div class="org-src-container">

<pre class="src src-python">plt.figure()
plt.plot(x, y1, x, 100 * y2)
plt.legend(['y1', '100*y2'])
plt.savefig('images/two-scales-4.png')
</pre>
</div>

<pre class="example">
&lt;matplotlib.figure.Figure object at 0x0000000007FA7908&gt;
[&lt;matplotlib.lines.Line2D object at 0x000000000B0285C0&gt;, &lt;matplotlib.lines.Line2D object at 0x000000000B0287B8&gt;]
&lt;matplotlib.legend.Legend object at 0x000000000B028C88&gt;
</pre>


<div class="figure">
<p><img src="/media/2013-09-13-Plotting-two-datasets-with-very-different-scales/two-scales-4.png"> 
</p>
</div>
</div>
</div>

<div id="outline-container-sec-3" class="outline-2">
<h2 id="sec-3"><span class="section-number-2">3</span> Double-y axis plot</h2>
<div class="outline-text-2" id="text-3">
<p>

</p>

<p>
Using two separate y-axes can solve your scaling problem. Note that each y-axis is color coded to the data. It can be difficult to read these graphs when printed in black and white
</p>

<div class="org-src-container">

<pre class="src src-python">fig = plt.figure()
ax1 = fig.add_subplot(111)
ax1.plot(x, y1)
ax1.set_ylabel('y1')

ax2 = ax1.twinx()
ax2.plot(x, y2, 'r-')
ax2.set_ylabel('y2', color='r')
for tl in ax2.get_yticklabels():
    tl.set_color('r')

plt.savefig('images/two-scales-5.png')
</pre>
</div>

<pre class="example">
&gt;&gt;&gt; [&lt;matplotlib.lines.Line2D object at 0x000000000BA34208&gt;]
&lt;matplotlib.text.Text object at 0x000000000BA37C50&gt;
&gt;&gt;&gt; &gt;&gt;&gt; [&lt;matplotlib.lines.Line2D object at 0x000000000BA4DEF0&gt;]
&lt;matplotlib.text.Text object at 0x000000000BA594A8&gt;
</pre>



<div class="figure">
<p><img src="/media/2013-09-13-Plotting-two-datasets-with-very-different-scales/two-scales-5.png"> 
</p>
</div>
</div>
</div>

<div id="outline-container-sec-4" class="outline-2">
<h2 id="sec-4"><span class="section-number-2">4</span> Subplots</h2>
<div class="outline-text-2" id="text-4">
<p>

An alternative approach to double y axes is to use subplots. 
</p>

<div class="org-src-container">

<pre class="src src-python">plt.figure()
f, axes = plt.subplots(2, 1)
axes[0].plot(x, y1)
axes[0].set_ylabel('y1')

axes[1].plot(x, y2)
axes[1].set_ylabel('y2')
plt.savefig('images/two-scales-6.png')
</pre>
</div>

<pre class="example">
&lt;matplotlib.figure.Figure object at 0x000000000BDC47B8&gt;
&gt;&gt;&gt; [&lt;matplotlib.lines.Line2D object at 0x000000000BDE2F28&gt;]
&lt;matplotlib.text.Text object at 0x000000000BDD74E0&gt;
&gt;&gt;&gt; [&lt;matplotlib.lines.Line2D object at 0x000000000D05E748&gt;]
&lt;matplotlib.text.Text object at 0x000000000BDEC438&gt;
</pre>


<div class="figure">
<p><img src="/media/2013-09-13-Plotting-two-datasets-with-very-different-scales/two-scales-6.png"> 
</p>
</div>
</div>
</div>
<p>Copyright (C) 2014 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2013/09/13/Plotting-two-datasets-with-very-different-scales.org">org-mode source</a><p><p>Org-mode version = 8.2.6</p>

    </div>
  </div>
</article>



  <div class="after_post"><a href="http://jkitchin.github.io/blog/2013/09/13/Plotting-two-datasets-with-very-different-scales#disqus_thread">Read and Post Comments</a></div>
  <hr class="interblog" />
 <a href="../22">« Previous Page</a>
  --  
 <a href="../24">Next Page »</a>

          </div>
          <div id="sidebar" class="grid_4">
            <aside>
<section>
Search
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:kitchingroup.cheme.cmu.edu" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
</section>


  <section>
    <h1 class="post_header_gradient theme_font">Links</h1>
    <ul>
    <li><a href="http://enthought.com">Enthought Python</a></li>
    <li><a href="/pycse">Pycse</a></li>
    <li><a href="/dft-book">DFT-book</a></li>
    </ul>
  </section>

  <section>
    <h1 class="post_header_gradient theme_font">Latest Posts</h1>
    <ul>
      <li><a href="/blog/2014/09/19/A-git-status-Emacs-modeline/">A git status Emacs modeline</a></li>
      <li><a href="/blog/2014/09/14/Colorized-text-in-Emacs/">Colorized text in Emacs</a></li>
      <li><a href="/blog/2014/09/13/Make-some-org-sections-read-only/">Make some org-sections read-only</a></li>
      <li><a href="/blog/2014/09/06/Randomize-a-list-in-Emacs/">Randomize a list in Emacs</a></li>
      <li><a href="/blog/2014/08/31/Using-Mac-gestures-in-Emacs/">Using Mac gestures in Emacs</a></li>
    </ul>
  </section>

  <section>
 <h1 class="post_header_gradient theme_font"><a href="http://www.citeulike.org/user/jkitchin" class="external text" title="http://www.citeulike.org/user/jkitchin" rel="nofollow">CiteULike</a> Reading List</h1>
<script type="text/javascript" src="http://code.jquery.com/jquery-1.7.1.min.js"></script>
<script type="text/javascript">
$(document).ready(function() {

var d = new Date();
curr_year = d.getFullYear();

$.getJSON('http://www.citeulike.org/json/user/jkitchin/,,?callback=?&per_page=5',
function(data) {
  var items = [];
  year=curr_year
  $.each(data, function(i) {
    year=data[i].published[0];
    var cit='<li id="' + i + '">' + '<a class="pap" href="http://dx.doi.org/'+data[i].doi+'">'+ data[i].title + '</a><br>';
    cit+='</li>';
    items.push( cit )      
  });

  $('<ul/>', {
    'class': 'my-new-list',
    html: items.join('')
  }).appendTo('#papers2');
});
});
</script>

<div id="papers2"></div>

  </section>

<section>
<h1 class="post_header_gradient theme_font">Latest GitHub Repos</h1>
  <a href="https://github.com/jkitchin">@jkitchin</a> on GitHub.
<ul id="my-github-projects">
    <li class="loading">Status updating&#8230;</li>
  </ul>

</section>
</aside>

          </div>
          <div class="clear"></div>
        </div>
      </div>
      
<footer>
  <div id="footer" class="grid_12">
    <div class="grid_8">
      <p>
        <a href="/blog/feed/index.xml">RSS</a>
        <a href="http://kitchinresearchgroup.disqus.com/latest.rss">Comments RSS Feed</a>.
      </p>
    </div>
    <div class="grid_4" id="credits">
      <p>
        Copyright 2014
        John Kitchin
      </p>
      <p>
        Powered by <a href="http://www.blogofile.com">Blogofile</a>
      </p>
    </div>
  </div>
</footer>

    </div>
      <script src="//ajax.googleapis.com/ajax/libs/jquery/1.5.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="/js/libs/jquery-1.5.1.min.js"%3E%3C/script%3E'))</script>
  <script src="/js/plugins.js"></script>
  <script src="/js/script.js"></script>
  <script src="/js/jquery.tweet.js"></script>  
  <script src="/js/site.js"></script>
  <!--[if lt IE 7 ]>
  <script src="js/libs/dd_belatedpng.js"></script>
  <script> DD_belatedPNG.fix('img, .png_bg');</script>
  <![endif]-->
  <script>
      var _gaq=[['_setAccount','UA-35731398-1'],['_trackPageview']];
      (function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];g.async=1;
      g.src=('https:'==location.protocol?'//ssl':'//www')+'.google-analytics.com/ga.js';
      s.parentNode.insertBefore(g,s)}(document,'script'));
  </script>
  <script>
  (function() {
      var links = document.getElementsByTagName('a');
      var query = '?';
      for(var i = 0; i < links.length; i++) {
          if(links[i].href.indexOf('#disqus_thread') >= 0) {
              query += 'url' + i + '=' + encodeURIComponent(links[i].href) + '&';
          }
      }
      document.write('<script charset="utf-8" type="text/javascript" src="http://disqus.com/forums/kitchinresearchgroup/get_num_replies.js' + query + '"></' + 'script>');
  })();
  </script>

  </body>
</html>






<script src="http://ajax.microsoft.com/ajax/jquery/jquery-1.4.2.min.js" type="text/javascript"></script>
<script src="/js/git.js" type="text/javascript"></script>
<script type="text/javascript">
    $(function() {
     $("#my-github-projects").loadRepositories("jkitchin");
    });
</script>



