

<!doctype html>
<!--[if lt IE 7 ]> <html lang="en" class="no-js ie6"> <![endif]-->
<!--[if IE 7 ]>    <html lang="en" class="no-js ie7"> <![endif]-->
<!--[if IE 8 ]>    <html lang="en" class="no-js ie8"> <![endif]-->
<!--[if IE 9 ]>    <html lang="en" class="no-js ie9"> <![endif]-->
<!--[if (gt IE 9)|!(IE)]><!--> <html lang="en" class="no-js"> <!--<![endif]-->
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>The Kitchin Research Group</title>
  <meta name="google-site-verification" content="CGcacJdHc2YoZyI0Vey9XRA5qwhhFDzThKJezbRFcJ4" />
  <meta name="description" content="Chemical Engineering at Carnegie Mellon University">
  <meta name="author" content="John Kitchin">
  <link rel="alternate" type="application/rss+xml" title="RSS 2.0" href="/blog/feed" />
  <link rel="alternate" type="application/atom+xml" title="Atom 1.0" href="/blog/feed/atom" />
  <link rel="shortcut icon" href="/favicon.ico">
  <link rel="apple-touch-icon" href="/img/apple-touch-icon.png">

  <link rel="stylesheet" href="/css/base.css?v=1">
  <link rel="stylesheet" href="/css/grid.css?v=1">
  <link rel="stylesheet" media="handheld" href="/css/handheld.css?v=1">
  <link rel="stylesheet" href="/css/pygments_murphy.css" type="text/css" />

  <script src="/js/libs/modernizr-1.7.min.js"></script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        displayAlign: "center",
        displayIndent: "0em",

        "HTML-CSS": { scale: 100,
                        linebreaks: { automatic: "false" },
                        webFont: "TeX"
                       },
        SVG: {scale: 100,
              linebreaks: { automatic: "false" },
              font: "TeX"},
        NativeMML: {scale: 100},
        TeX: { equationNumbers: {autoNumber: "AMS"},
               MultLineWidth: "85%",
               TagSide: "right",
               TagIndent: ".8em"
             }
});
</script>
<script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_HTML"></script>
  <link rel="stylesheet" href="/themes/theme1/style.css?v=1">
<link href='http://fonts.googleapis.com/css?family=Roboto' rel='stylesheet' type='text/css'>

</head>
  <body>
    <div id="container" class="container container_12">
      <div id="main" role="main">
        <div id="main_block">
          <header>
<div id="header" class="header_gradient theme_font">
<table><tr><td>
    <h1><a href="/">The Kitchin Research Group</a></h1>
    <h2>Chemical Engineering at Carnegie Mellon University</h2>
</td>
<td colspan=100%><div style="float:right;width:100%;text-align:right;"> <span id='badgeCont737515' style='width:126px'><script src='http://labs.researcherid.com/mashlets?el=badgeCont737515&mashlet=badge&showTitle=false&className=a&rid=A-2363-2010'></script></span></div>
</td></tr>
</table>
</div>
  <div id="navigation" class="grid_12">

    <ul class="theme_font">
      <li><a href="/blog"
             class="">Blog</a></li>

      <li><a href="/blog/archive"
             class="">Archives</a></li>

      <li><a href="/publications.html">Publications</a></li>

      <li><a href="/research.html"
             class="">Research</a></li>

      <li><a href="/categories.html"
             class="">Categories</a></li>

      <li><a href="/about.html"
             class="">About us</a></li>

      <li><a href="/subscribe.html">Subscribe</a></li>

    </ul>
  </div>
</header>

          <div id="prose_block" class="grid_8">
            
  





<article>
  <div class="blog_post">
    <header>
      <div id="New-Publication-An-Inverse-Mapping-Approach-for-Process-Systems-Engineering-Using-Automatic-Differentiation-and-the-Implicit-Function-Theorem"></div>
      <h2 class="blog_post_title"><a href="/blog/2023/04/25/New-Publication-An-Inverse-Mapping-Approach-for-Process-Systems-Engineering-Using-Automatic-Differentiation-and-the-Implicit-Function-Theorem/" rel="bookmark" title="Permanent Link to New Publication - An Inverse Mapping Approach for Process Systems Engineering Using Automatic Differentiation and the Implicit Function Theorem">New Publication - An Inverse Mapping Approach for Process Systems Engineering Using Automatic Differentiation and the Implicit Function Theorem</a></h2>
      <p><small><span class="blog_post_date">Posted April 25, 2023 at 01:43 PM</span> | categories:
        <span class="blog_post_categories"><a href='/blog/category/publication/'>publication</a>, <a href='/blog/category/news/'>news</a></span> | tags: 
      </small></p>
    </header>
    <div class="post_prose">
      



<p>
Solving inverse problems, where we know what outputs we want from a model and seek the inputs that provide them, is a difficult task. A conventional approach to this problem is to use a nonlinear program (NLP) solver to iteratively find the inputs for a specific output. If you seek a desired output space, then you must solve the NLP many times to map out the corresponding input space. This is often expensive, and tedious to perform. In this work, we demonstrate a new approach to solving this problem that avoids the NLP formulation, and is faster. The idea is simple; we compute a system of differential equations that maps how the input space changes with the output space. Then from a single known point we can integrate a path in the output space to automatically trace the corresponding path in the input space! We compute the system of differential equations using automatic differentiation, and the implicit derivative theorem. We show two examples of this using a steady state continuously stirred tank reactor, which is a set of nonlinear algebraic equations that define the output space from input variables, and another plug flow reactor where the output space is defined by a set of differential equations that must be numerically integrated. In both cases we use automatic differentiation to define the system of ODEs that relate outputs and inputs, and show that the path integration method developed here is as accurate and faster than even the best NLP approach. The idea in this paper is general and applicable to many other systems, not just chemical reactors.
</p>

<div class="org-src-container">
<pre class="src src-bibtex"><span style="color: #006699;">@article</span>{<span style="color: #D0372D;">alves-2023</span>,
  <span style="color: #BA36A5;">author</span> =       {Alves, Victor and Kitchin, John R. and Lima, Fernando V.},
  <span style="color: #BA36A5;">title</span> =        {An inverse mapping approach for process systems engineering
                  using automatic differentiation and the implicit function
                  theorem},
  <span style="color: #BA36A5;">journal</span> =      {AIChE Journal},
  <span style="color: #BA36A5;">year</span> =         2023,
  <span style="color: #BA36A5;">volume</span> =       {n/a},
  <span style="color: #BA36A5;">number</span> =       {n/a},
  <span style="color: #BA36A5;">pages</span> =        {e18119},
  <span style="color: #BA36A5;">keywords</span> =     {automatic differentiation, implicit function theorem, inverse
                  mapping, inverse problems, process systems engineering},
  <span style="color: #BA36A5;">doi</span> =          {<span style="color: #006DAF; text-decoration: underline;">10.1002/aic.18119</span>},
  <span style="color: #BA36A5;">url</span> =
                  {https://aiche.onlinelibrary.wiley.com/doi/abs/10.1002/aic.18119}
}
</pre>
</div>

<p>
<script type='text/javascript' src='https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js'></script>
<div data-badge-type='medium-donut' class='altmetric-embed' data-badge-details='right' data-doi='10.1002/aic.18119'></div>
</p>

<iframe width="560" height="315" src="https://www.youtube.com/embed/UAIUSr4TzBk" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>
<p>Copyright (C) 2023 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p>
<p><a href="/org/2023/04/25/New-Publication---An-Inverse-Mapping-Approach-for-Process-Systems-Engineering-Using-Automatic-Differentiation-and-the-Implicit-Function-Theorem.org">org-mode source</a></p>
<p>Org-mode version = 9.5.5</p>

    </div>
  </div>
</article>



<a href="https://twitter.com/share" class="twitter-share-button" data-via="johnkitchin">Share on Twitter</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>


<a href="https://twitter.com/search?q=https://kitchingroup.cheme.cmu.edu/blog/2023/04/25/New-Publication-An-Inverse-Mapping-Approach-for-Process-Systems-Engineering-Using-Automatic-Differentiation-and-the-Implicit-Function-Theorem">Discuss on Twitter</a>

  <hr class="interblog" />
  





<article>
  <div class="blog_post">
    <header>
      <div id="New-publication-WhereWulff-A-Semiautonomous-Workflow-for-Systematic-Catalyst-Surface-Reactivity-under-Reaction-Conditions"></div>
      <h2 class="blog_post_title"><a href="/blog/2023/04/16/New-publication-WhereWulff-A-Semiautonomous-Workflow-for-Systematic-Catalyst-Surface-Reactivity-under-Reaction-Conditions/" rel="bookmark" title="Permanent Link to New publication - WhereWulff A Semiautonomous Workflow for Systematic Catalyst Surface Reactivity under Reaction Conditions">New publication - WhereWulff A Semiautonomous Workflow for Systematic Catalyst Surface Reactivity under Reaction Conditions</a></h2>
      <p><small><span class="blog_post_date">Posted April 16, 2023 at 09:46 AM</span> | categories:
        <span class="blog_post_categories"><a href='/blog/category/publication/'>publication</a>, <a href='/blog/category/news/'>news</a></span> | tags: 
      <p><small><span class="blog_post_date">Updated April 16, 2023 at 09:49 AM</span></small>
      </small></p>
    </header>
    <div class="post_prose">
      



<p>
Suppose you want to explore metal oxides as potential water oxidation electrocatalysts. There are many steps to do this. You can use databases of materials to get compositions and structures, but for each one you have to determine the ground state structure, including magnetic states, for each bulk structure, and filter out bulk materials that are not stable under water oxidation conditions. Then, using the remaining structures you have to construct slabs and determine which surfaces are likely to be stable, and most relevant. After that you have to compute adsorption energies on those surfaces to see which surfaces have the most relevant reactivity (while also being stable). This results in hundreds to thousands of calculations that depend on each other in important ways. It is very useful to use software workflow tools to facilitate and manage this process. In this paper we develop a workflow like this for exploring metal oxides for water oxidation. The software is open source and available at <a href="https://github.com/ulissigroup/wherewulff">https://github.com/ulissigroup/wherewulff</a>.
</p>

<p>
The paper is free to read for 6 months at <a href="https://pubs.acs.org/doi/10.1021/acs.jcim.3c00142">https://pubs.acs.org/doi/10.1021/acs.jcim.3c00142</a>.
</p>

<div class="org-src-container">
<pre class="src src-bibtex"><span style="color: #006699;">@article</span>{<span style="color: #D0372D;">sanspeur-2023</span>,
  <span style="color: #BA36A5;">author</span> = {Rohan Yuri Sanspeur and Javier Heras-Domingo and John R. Kitchin and Zachary Ulissi},
  <span style="color: #BA36A5;">title</span> = {wherewulff: a Semiautonomous Workflow for Systematic Catalyst Surface Reactivity Under Reaction Conditions},
  <span style="color: #BA36A5;">journal</span> = {Journal of Chemical Information and Modeling},
  <span style="color: #BA36A5;">volume</span> = {nil},
  <span style="color: #BA36A5;">number</span> = {nil},
  <span style="color: #BA36A5;">pages</span> = {nil},
  <span style="color: #BA36A5;">year</span> = {2023},
  <span style="color: #BA36A5;">doi</span> = {<span style="color: #006DAF; text-decoration: underline;">10.1021/acs.jcim.3c00142</span>},
  <span style="color: #BA36A5;">url</span> = {<span style="color: #006DAF; text-decoration: underline;">http://dx.doi.org/10.1021/acs.jcim.3c00142</span>},
  <span style="color: #BA36A5;">DATE_ADDED</span> = {Sun Apr 16 09:17:23 2023},
}
</pre>
</div>

<p>
<script type='text/javascript' src='https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js'></script>
<div data-badge-type='medium-donut' class='altmetric-embed' data-badge-details='right' data-doi='10.1021/acs.jcim.3c00142'></div>
</p>

<iframe width="560" height="315" src="https://www.youtube.com/embed/UyjTvIeZOEk" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>
<p>Copyright (C) 2023 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p>
<p><a href="/org/2023/04/16/New-publication---WhereWulff-A-Semiautonomous-Workflow-for-Systematic-Catalyst-Surface-Reactivity-under-Reaction-Conditions.org">org-mode source</a></p>
<p>Org-mode version = 9.5.5</p>

    </div>
  </div>
</article>



<a href="https://twitter.com/share" class="twitter-share-button" data-via="johnkitchin">Share on Twitter</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>


<a href="https://twitter.com/search?q=https://kitchingroup.cheme.cmu.edu/blog/2023/04/16/New-publication-WhereWulff-A-Semiautonomous-Workflow-for-Systematic-Catalyst-Surface-Reactivity-under-Reaction-Conditions">Discuss on Twitter</a>

  <hr class="interblog" />
  





<article>
  <div class="blog_post">
    <header>
      <div id="New-publication-High-throughput-discovery-of-ternary-Cu-Fe-Ru-alloy-catalysts-for-photo-driven-hydrogen-production"></div>
      <h2 class="blog_post_title"><a href="/blog/2023/04/15/New-publication-High-throughput-discovery-of-ternary-Cu-Fe-Ru-alloy-catalysts-for-photo-driven-hydrogen-production/" rel="bookmark" title="Permanent Link to New publication - High throughput discovery of ternary Cu-Fe-Ru alloy catalysts for photo-driven hydrogen production">New publication - High throughput discovery of ternary Cu-Fe-Ru alloy catalysts for photo-driven hydrogen production</a></h2>
      <p><small><span class="blog_post_date">Posted April 15, 2023 at 08:14 AM</span> | categories:
        <span class="blog_post_categories"><a href='/blog/category/publication/'>publication</a>, <a href='/blog/category/news/'>news</a></span> | tags: 
      </small></p>
    </header>
    <div class="post_prose">
      



<p>
Finding new ways to make hydrogen with renewable energy and renewable feedstocks using earth abundant materials remains a challenge in catalysis today. Metal nanoparticles are common heterogeneous catalysts for hydrogen production, and their properties can often be improved by using multiple metals at a time. In this work we show a high-throughput experimental approach to discovering a ternary alloy catalyst containing earth abundant metals that is more active at producing hydrogen than any of the pure metals it is made of. It a surprising discovery because these metals are not typically miscible, and they do not form a well characterized material, but rather a distribution of particle sizes and compositions. 
</p>

<div class="org-src-container">
<pre class="src src-bibtex"><span style="color: #006699;">@article</span>{<span style="color: #D0372D;">bhat-2023-high-throug</span>,
  <span style="color: #BA36A5;">author</span> = {Maya Bhat and Zoe C Simon and Savannah Talledo and Riti Sen and Jacob H. Smith and Stefan Bernhard and Jill E Millstone and John R Kitchin},
  <span style="color: #BA36A5;">title</span> = {High Throughput Discovery of Ternary Cu-Fe-Ru Alloy Catalysts for Photo-Driven Hydrogen Production},
  <span style="color: #BA36A5;">journal</span> = {Reaction Chemistry \&amp; Engineering},
  <span style="color: #BA36A5;">volume</span> = {nil},
  <span style="color: #BA36A5;">number</span> = {nil},
  <span style="color: #BA36A5;">pages</span> = {nil},
  <span style="color: #BA36A5;">year</span> = {2023},
  <span style="color: #BA36A5;">doi</span> = {<span style="color: #006DAF; text-decoration: underline;">10.1039/d3re00059a</span>},
  <span style="color: #BA36A5;">url</span> = {<span style="color: #006DAF; text-decoration: underline;">http://dx.doi.org/10.1039/D3RE00059A</span>},
  <span style="color: #BA36A5;">DATE_ADDED</span> = {Sat Apr 15 07:55:55 2023},
}
</pre>
</div>

<p>
<script type='text/javascript' src='https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js'></script>
<div data-badge-type='medium-donut' class='altmetric-embed' data-badge-details='right' data-doi='10.1039/d3re00059a'></div>
</p>

<iframe width="560" height="315" src="https://www.youtube.com/embed/2OXbkIvWkjs" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>
<p>Copyright (C) 2023 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p>
<p><a href="/org/2023/04/15/New-publication---High-throughput-discovery-of-ternary-Cu-Fe-Ru-alloy-catalysts-for-photo-driven-hydrogen-production.org">org-mode source</a></p>
<p>Org-mode version = 9.5.5</p>

    </div>
  </div>
</article>



<a href="https://twitter.com/share" class="twitter-share-button" data-via="johnkitchin">Share on Twitter</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>


<a href="https://twitter.com/search?q=https://kitchingroup.cheme.cmu.edu/blog/2023/04/15/New-publication-High-throughput-discovery-of-ternary-Cu-Fe-Ru-alloy-catalysts-for-photo-driven-hydrogen-production">Discuss on Twitter</a>

  <hr class="interblog" />
  





<article>
  <div class="blog_post">
    <header>
      <div id="MS-Word-comments-from-org-mode"></div>
      <h2 class="blog_post_title"><a href="/blog/2023/02/25/MS-Word-comments-from-org-mode/" rel="bookmark" title="Permanent Link to MS Word comments from org-mode">MS Word comments from org-mode</a></h2>
      <p><small><span class="blog_post_date">Posted February 25, 2023 at 11:49 AM</span> | categories:
        <span class="blog_post_categories"><a href='/blog/category/orgmode/'>orgmode</a>, <a href='/blog/category/docx/'>docx</a></span> | tags: 
      <p><small><span class="blog_post_date">Updated February 25, 2023 at 03:48 PM</span></small>
      </small></p>
    </header>
    <div class="post_prose">
      



<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#org0b8ac89">1. export features for test</a></li>
<li><a href="#orgb2df34d">2. References</a></li>
<li><a href="#orga834870">3. Alternate build with HTML.</a></li>
</ul>
</div>
</div>
<p>
TL;DR: 
</p>

<iframe width="560" height="315" src="https://www.youtube.com/embed/sKo1qb3xxWI" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>

<p>
Today I <a href="https://www.reddit.com/r/orgmode/comments/11bkt2h/is_it_possible_to_pass_html_in_org_to_pandoc_word/">learned</a> you can make a Word document from org-mode with Word comments in them. This could be useful when working with collaborators maybe. The gist is you use html for the comment, then export to markdown or html, then let pandoc convert those to docx. A comment in HTML looks like this:
</p>

<pre class="example" id="orga243141">
&lt;span class="comment-start" author="jkitchin"&gt;Comment text&lt;/span&gt;The text being commented on &lt;span class="comment-end"&gt;&lt;/span&gt; 
</pre>

<p>
Let's wrap that in a link for convenience. I use a full display so it is easy to see the comment. I only export the comment for markdown and html export, for everything else we just use the path. We somewhat abuse the link syntax here by using the path for the text to comment on, and the description for the comment.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(org-link-set-parameters
 <span style="color: #008000;">"comment"</span>
 <span style="color: #006FE0;">:export</span> (<span style="color: #0000FF;">lambda</span> (path desc backend)
           (<span style="color: #0000FF;">if</span> (member backend '(md html))
               (format <span style="color: #008000;">"&lt;span class=\"comment-start\" author=\"%s\"&gt;%s&lt;/span&gt;%s&lt;span class=\"comment-end\"&gt;&lt;/span&gt;"</span>
                       (user-full-name)
                       desc
                       path)
             <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">ignore for other backends and just use path</span>
             path))
 <span style="color: #006FE0;">:display</span> 'full
 <span style="color: #006FE0;">:face</span> '(<span style="color: #006FE0;">:foreground</span> <span style="color: #008000;">"orange"</span>))                  
</pre>
</div>

<p>
Now, we use it like this <span class="comment-start" author="John Kitchin">This is the comment</span>This is the text commented on<span class="comment-end"></span>.
</p>

<p>
In org-mode it looks like:
</p>

<p>
<figure><img src="/media/date-25-02-2023-time-11-44-11.png"></figure> 
</p>

<p>
To get the Word doc, we need some code that first exports to Markdown, and then calls pandoc to convert that to docx. Here is my solution to that. Usually you would put this in a subsection tagged with :noexport: but I show it here to see it. Running this block generates the docx file and opens it. Here I also leverage org-ref to get some citations and cross-references.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #0000FF;">require</span> '<span style="color: #D0372D;">org-ref-refproc</span>)
(<span style="color: #0000FF;">let*</span> ((org-export-before-parsing-hook '(org-ref-cite-natmove <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">do this first</span>
                                        org-ref-csl-preprocess-buffer
                                        org-ref-refproc))
       (md (org-md-export-to-markdown))
       (docx (concat (file-name-sans-extension md) <span style="color: #008000;">".docx"</span>)))
  (shell-command (format <span style="color: #008000;">"pandoc -s %s -o %s"</span> md docx))
  (org-open-file docx '(16)))
</pre>
</div>

<p>
The result looks like this in MS Word:
</p>


<p>
<figure><img src="/media/date-25-02-2023-time-11-41-37.png"><figcaption>How a comment looks in Word.</figcaption></figure> 
</p>

<p>
That is pretty remarkable. There are some limitations in Markdown, e.g. I find the tables don't look good, not all equations are converted, some cross-references are off. Next we add some more org-features and try the export with HTML.
</p>

<div id="outline-container-org0b8ac89" class="outline-2">
<h2 id="org0b8ac89"><span class="section-number-2">1.</span> export features for test</h2>
<div class="outline-text-2" id="text-1">
<p>
Test cross-references, references, equations, etc&#x2026;
</p>

<p>
Aliquam erat volutpat (Fig. <a href="fig-2">fig-2</a>).  Nunc eleifend leo vitae magna.  In id erat non orci commodo lobortis.  Proin neque massa, cursus ut, gravida ut, lobortis eget, lacus.  Sed diam.  Praesent fermentum tempor tellus.  Nullam tempus <a href="&amp;yang-2022-evaluat-degree">&amp;yang-2022-evaluat-degree</a>.  Mauris ac felis vel velit tristique imperdiet.  Donec at pede.  Etiam vel neque nec dui dignissim bibendum.  Vivamus id enim.  Phasellus neque orci, porta a, aliquet quis in Table <a href="tab-1">tab-1</a>, semper a, massa.  Phasellus purus (<a href="eq-1">eq-1</a>).  Pellentesque tristique imperdiet tortor.  Nam euismod tellus id erat <a href="&amp;kolluru-2022-open-chall">&amp;kolluru-2022-open-chall</a>.
</p>

<table id="org90422fb" border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<caption class="t-above"><span class="table-number">Table 1:</span> A table.</caption>

<colgroup>
<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<tbody>
<tr>
<td class="org-right">x</td>
<td class="org-right">y</td>
</tr>

<tr>
<td class="org-right">1</td>
<td class="org-right">3</td>
</tr>

<tr>
<td class="org-right">3</td>
<td class="org-right">6</td>
</tr>
</tbody>
</table>

<p>
We have equations:
</p>

\begin{equation}
\label{org9973acf}
y = mx + b
\end{equation}


<ul class="org-ul">
<li>bullet1
<ul class="org-ul">
<li>nested bullet</li>
</ul></li>
<li>bullet2</li>
</ul>

<p>
some defintions:
</p>

<dl class="org-dl">
<dt>emacs</dt><dd>greatest editor</dd>
</dl>


<ol class="org-ol">
<li>item 1</li>
<li>item 2</li>
</ol>

<p>
One equation: \(e^{i\pi} - 1 = 0\)
</p>

<p>
A second equation:
</p>

\begin{equation}
e^{i\pi} - 1 = 0
\end{equation}
</div>
</div>


<div id="outline-container-orgb2df34d" class="outline-2">
<h2 id="orgb2df34d"><span class="section-number-2">2.</span> References</h2>
<div class="outline-text-2" id="text-2">
<p>
<a href="~/Dropbox/emacs/bibliography/references.bib">~/Dropbox/emacs/bibliography/references.bib</a>
</p>
</div>
</div>

<div id="outline-container-orga834870" class="outline-2">
<h2 id="orga834870"><span class="section-number-2">3.</span> Alternate build with HTML.</h2>
<div class="outline-text-2" id="text-3">
<p>
Here we consider <span class="comment-start" author="John Kitchin">For example, html</span>alternate build approaches<span class="comment-end"></span>.
</p>

<p>
Run this to get the docx file. I find this superior; it has references, cross-references, equations, tables, figures, etc. Even a title.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #0000FF;">let*</span> ((org-export-before-parsing-hook '(org-ref-csl-preprocess-buffer
                                         org-ref-refproc))
       (org-html-with-latex 'dvipng)
       (f (org-html-export-to-html))
       (docx (concat (file-name-sans-extension f) <span style="color: #008000;">".docx"</span>)))
  (shell-command (format <span style="color: #008000;">"pandoc -s %s -o %s"</span> f docx))
  (org-open-file docx '(16)))
</pre>
</div>
</div>
</div>
<p>Copyright (C) 2023 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p>
<p><a href="/org/2023/02/25/MS-Word-comments-from-org-mode.org">org-mode source</a></p>
<p>Org-mode version = 9.5.5</p>

    </div>
  </div>
</article>



<a href="https://twitter.com/share" class="twitter-share-button" data-via="johnkitchin">Share on Twitter</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>


<a href="https://twitter.com/search?q=https://kitchingroup.cheme.cmu.edu/blog/2023/02/25/MS-Word-comments-from-org-mode">Discuss on Twitter</a>

  <hr class="interblog" />
  





<article>
  <div class="blog_post">
    <header>
      <div id="Update-on-finding-the-minimum-distance-from-a-point-to-a-curve"></div>
      <h2 class="blog_post_title"><a href="/blog/2023/02/17/Update-on-finding-the-minimum-distance-from-a-point-to-a-curve/" rel="bookmark" title="Permanent Link to Update on finding the minimum distance from a point to a curve">Update on finding the minimum distance from a point to a curve</a></h2>
      <p><small><span class="blog_post_date">Posted February 17, 2023 at 06:41 PM</span> | categories:
        <span class="blog_post_categories"><a href='/blog/category/optimization/'>optimization</a></span> | tags: 
      </small></p>
    </header>
    <div class="post_prose">
      



<p>
Almost 10 years ago I <a href="https://kitchingroup.cheme.cmu.edu/blog/2013/02/14/Find-the-minimum-distance-from-a-point-to-a-curve/">wrote</a> about finding the minimum distance from a point to a curve using a constrained optimization. At that time, the way to do this used <code>scipy.optimize.fmin_coblya</code>. I learned today from a student, that sometimes this method fails! I reproduce the code here, updated for Python 3, some style updates, and to show it does indeed fail sometimes, notably when the point is "outside" the parabola.
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #0000FF;">import</span> numpy <span style="color: #0000FF;">as</span> np
<span style="color: #0000FF;">import</span> matplotlib.pyplot <span style="color: #0000FF;">as</span> plt
<span style="color: #0000FF;">from</span> scipy.optimize <span style="color: #0000FF;">import</span> fmin_cobyla

<span style="color: #0000FF;">def</span> <span style="color: #006699;">f</span>(x):
    <span style="color: #0000FF;">return</span> x**2

<span style="color: #0000FF;">for</span> P <span style="color: #0000FF;">in</span> np.array([[0.5, 2],
                   [2, 2],
                   [-1, 2],
                   [-2, 2],
                   [0, 0.5],
                   [0, -0.5]]):
    
    <span style="color: #0000FF;">def</span> <span style="color: #006699;">objective</span>(X):
        <span style="color: #BA36A5;">X</span> = np.array(X)
        <span style="color: #0000FF;">return</span> np.linalg.norm(X - P)

    <span style="color: #0000FF;">def</span> <span style="color: #006699;">c1</span>(X):
        <span style="color: #BA36A5;">x</span>,<span style="color: #BA36A5;">y</span> = X
        <span style="color: #0000FF;">return</span> f(x) - y

    <span style="color: #BA36A5;">X</span> = fmin_cobyla(objective, x0=[P[0], f(P[0])], cons=[c1])

    <span style="color: #006FE0;">print</span>(f<span style="color: #008000;">'The minimum distance is </span>{objective(X):1.2f}<span style="color: #008000;">. Constraint satisfied = </span>{c1(X) &lt; 1e-6}<span style="color: #008000;">'</span>)

    <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">Verify the vector to this point is normal to the tangent of the curve</span>
    <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">position vector from curve to point</span>
    v1 = np.array(P) - np.array(X)
    <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">position vector</span>
    v2 = np.array([1, 2.0 * X[0]])
    <span style="color: #006FE0;">print</span>(<span style="color: #008000;">'dot(v1, v2) = '</span>, np.dot(v1, v2))

    x = np.linspace(-2, 2, 100)

    plt.plot(x, f(x), <span style="color: #008000;">'r-'</span>, label=<span style="color: #008000;">'f(x)'</span>)
    plt.plot(P[0], P[1], <span style="color: #008000;">'bo'</span>, label=<span style="color: #008000;">'point'</span>)
    plt.plot([P[0], X[0]], [P[1], X[1]], <span style="color: #008000;">'b-'</span>, label=<span style="color: #008000;">'shortest distance'</span>)
    plt.plot([X[0], X[0] + 1], [X[1], X[1] + 2.0 * X[0]], <span style="color: #008000;">'g-'</span>, label=<span style="color: #008000;">'tangent'</span>)
    plt.axis(<span style="color: #008000;">'equal'</span>)
    plt.xlabel(<span style="color: #008000;">'x'</span>)
    plt.ylabel(<span style="color: #008000;">'y'</span>)    
</pre>
</div>

<p>
The minimum distance is 0.86. Constraint satisfied = True
dot(v1, v2) =  0.0002913487659186309
The minimum distance is 0.00. Constraint satisfied = False
dot(v1, v2) =  0.00021460906432962284
The minimum distance is 0.39. Constraint satisfied = True
dot(v1, v2) =  0.00014271520451364372
The minimum distance is 0.00. Constraint satisfied = False
dot(v1, v2) =  -0.0004089466778209598
The minimum distance is 0.50. Constraint satisfied = True
dot(v1, v2) =  1.9999998429305957e-12
The minimum distance is 0.00. Constraint satisfied = False
dot(v1, v2) =  8.588744170160093e-06
<figure><img src="/media/f66cff16ba65526d5877bd894142fa021c51f434.png"></figure> 
</p>

<p>
So, sure enough, the optimizer is failing to find a solution that meets the constraint. It is strange it does not work on the outside. That is almost certainly an algorithm problem. Here we solve it nearly identically with the more modern <code>scipy.optimize.minimize</code> function, and it converges every time. 
</p>

<div class="org-src-container">
<pre class="src src-jupyter-python"><span style="color: #0000FF;">from</span> scipy.optimize <span style="color: #0000FF;">import</span> minimize

<span style="color: #0000FF;">for</span> P <span style="color: #0000FF;">in</span> np.array([[0.5, 2],
                   [2, 2],
                   [-1, 2],
                   [-2, 2],
                   [0, 0.5],
                   [0, -0.5]]):
    
    <span style="color: #0000FF;">def</span> <span style="color: #006699;">objective</span>(X):
        <span style="color: #BA36A5;">X</span> = np.array(X)
        <span style="color: #0000FF;">return</span> np.linalg.norm(X - P)

    <span style="color: #0000FF;">def</span> <span style="color: #006699;">c1</span>(X):
        <span style="color: #BA36A5;">x</span>,<span style="color: #BA36A5;">y</span> = X
        <span style="color: #0000FF;">return</span> f(x) - y

    <span style="color: #BA36A5;">sol</span> = minimize(objective, x0=[P[0], f(P[0])], constraints={<span style="color: #008000;">'type'</span>: <span style="color: #008000;">'eq'</span>, <span style="color: #008000;">'fun'</span>: c1})
    X = sol.x

    <span style="color: #006FE0;">print</span>(f<span style="color: #008000;">'The minimum distance is </span>{objective(X):1.2f}<span style="color: #008000;">. Constraint satisfied = </span>{sol.status &lt; 1e-6}<span style="color: #008000;">'</span>)

    <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">Verify the vector to this point is normal to the tangent of the curve</span>
    <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">position vector from curve to point</span>
    v1 = np.array(P) - np.array(X)
    <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">position vector</span>
    v2 = np.array([1, 2.0 * X[0]])
    <span style="color: #006FE0;">print</span>(<span style="color: #008000;">'dot(v1, v2) = '</span>, np.dot(v1, v2))

    x = np.linspace(-2, 2, 100)

    plt.plot(x, f(x), <span style="color: #008000;">'r-'</span>, label=<span style="color: #008000;">'f(x)'</span>)
    plt.plot(P[0], P[1], <span style="color: #008000;">'bo'</span>, label=<span style="color: #008000;">'point'</span>)
    plt.plot([P[0], X[0]], [P[1], X[1]], <span style="color: #008000;">'b-'</span>, label=<span style="color: #008000;">'shortest distance'</span>)
    plt.plot([X[0], X[0] + 1], [X[1], X[1] + 2.0 * X[0]], <span style="color: #008000;">'g-'</span>, label=<span style="color: #008000;">'tangent'</span>)
    plt.axis(<span style="color: #008000;">'equal'</span>)
    plt.xlabel(<span style="color: #008000;">'x'</span>)
    plt.ylabel(<span style="color: #008000;">'y'</span>)
</pre>
</div>

<p>
The minimum distance is 0.86. Constraint satisfied = True
dot(v1, v2) =  1.0701251773603815e-08
The minimum distance is 0.55. Constraint satisfied = True
dot(v1, v2) =  -0.0005793028003104883
The minimum distance is 0.39. Constraint satisfied = True
dot(v1, v2) =  -1.869272921939391e-05
The minimum distance is 0.55. Constraint satisfied = True
dot(v1, v2) =  0.0005792953298950909
The minimum distance is 0.50. Constraint satisfied = True
dot(v1, v2) =  0.0
The minimum distance is 0.50. Constraint satisfied = True
dot(v1, v2) =  0.0
<figure><img src="/media/4776aa1f11411aa8cf0c3ea47f96e2a8973e314e.png"></figure> 
</p>

<p>
There is no wisdom in fixing the first problem, here I just tried a newer optimization method. Out of the box with default settings it just worked. I did learn the answer is sensitive to the initial guess, so it could make sense to sample the function and find the point that is closest as the initial guess, but here the simple heuristic guess I used worked fine.
</p>
<p>Copyright (C) 2023 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p>
<p><a href="/org/2023/02/17/Update-on-finding-the-minimum-distance-from-a-point-to-a-curve.org">org-mode source</a></p>
<p>Org-mode version = 9.5.5</p>

    </div>
  </div>
</article>



<a href="https://twitter.com/share" class="twitter-share-button" data-via="johnkitchin">Share on Twitter</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>


<a href="https://twitter.com/search?q=https://kitchingroup.cheme.cmu.edu/blog/2023/02/17/Update-on-finding-the-minimum-distance-from-a-point-to-a-curve">Discuss on Twitter</a>

  <hr class="interblog" />
 <a href="../5">« Previous Page</a>
  --  
 <a href="../7">Next Page »</a>

          </div>
          <div id="sidebar" class="grid_4">
            <aside>
<section>
<script>
  (function() {
    var cx = '002533177287215655227:l7uvu35ssbc';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
        '//www.google.com/cse/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>
</section>

<section>
    <h1 class="post_header_gradient theme_font">Twitter</h1>
    <a class="twitter-timeline" href="https://twitter.com/johnkitchin" data-widget-id="545217643582881792">Tweets by @johnkitchin</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+"://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
</section>


  <section>
    <h1 class="post_header_gradient theme_font">Links</h1>
    <ul>
      <li><a href="https://www.continuum.io">Anaconda Python</a></li>
      <li><a href="/pycse">Pycse</a></li>
      <li><a href="/dft-book">DFT-book</a></li>
    </ul>
  </section>

  <section>
    <h1 class="post_header_gradient theme_font">Latest Posts</h1>
    <ul>
      <li><a href="/blog/2025/02/04/New-publication-Integrated-systems-To-Atoms-S2A-Framework-for-Designing-Resilient-and-Efficient-Hydrogen-Infrastructure-Solutions/">New publication - Integrated systems-To-Atoms (S2A) Framework for Designing Resilient and Efficient Hydrogen Infrastructure Solutions</a></li>
      <li><a href="/blog/2025/02/03/New-publication-Multiscale-Optimization-of-Formic-Acid-Dehydrogenation-Process-via-Linear-Model-Decision-Tree-Surrogates/">New publication - Multiscale Optimization of Formic Acid Dehydrogenation Process via Linear Model Decision Tree Surrogates</a></li>
      <li><a href="/blog/2025/02/02/New-publication-Enumeration-of-surface-site-nuclearity-and-shape-in-a-database-of-intermetallic-low-index-surface-facets/">New publication - Enumeration of surface site nuclearity and shape in a database of intermetallic low-index surface facets</a></li>
      <li><a href="/blog/2025/02/01/New-publication-Improved-Uncertainty-Estimation-of-Graph-Neural-Network-Potentials-Using-Engineered-Latent-Space-Distance/">New publication - Improved Uncertainty Estimation of Graph Neural Network Potentials Using Engineered Latent Space Distance</a></li>
      <li><a href="/blog/2025/01/31/New-publication-AdsorbDiff-:-Adsorbate-Placement-via-Conditional-Denoising-Diffusion/">New publication - AdsorbDiff &#58; Adsorbate Placement via Conditional Denoising Diffusion</a></li>
    </ul>
  </section>

<section>
<h1 class="post_header_gradient theme_font">Latest GitHub Repos</h1>
  <a href="https://github.com/jkitchin">@jkitchin</a> on GitHub.
  <ul id="my-github-projects">
        <li class="loading">Status updating&#8230;</li>
  </ul>

</section>
</aside>

          </div>
          <div class="clear"></div>
        </div>
      </div>
      
<footer>
  <div id="footer" class="grid_12">
    <div class="grid_8">
      <p>
        <a href="/blog/feed/index.xml">RSS</a>
      </p>
    </div>
    <div class="grid_4" id="credits">
      <p>
        Copyright 2025
        John Kitchin
      </p>
      <p>
        Powered by <a href="http://www.blogofile.com">Blogofile</a>
      </p>
    </div>
  </div>
</footer>

    </div>
      <script src="//ajax.googleapis.com/ajax/libs/jquery/1.5.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="/js/libs/jquery-1.5.1.min.js"%3E%3C/script%3E'))</script>
  <script src="/js/plugins.js"></script>
  <script src="/js/script.js"></script>
  <script src="/js/jquery.tweet.js"></script>  
  <script src="/js/site.js"></script>
  <!--[if lt IE 7 ]>
  <script src="js/libs/dd_belatedpng.js"></script>
  <script> DD_belatedPNG.fix('img, .png_bg');</script>
  <![endif]-->
 
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-PH8NF4F0RE"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-PH8NF4F0RE');
</script>


  </body>
</html>






<script src="http://ajax.microsoft.com/ajax/jquery/jquery-1.4.2.min.js" type="text/javascript"></script>
<script src="/js/git.js" type="text/javascript"></script>
<script type="text/javascript">
    $(function() {
     $("#my-github-projects").loadRepositories("jkitchin");
    });
</script>



