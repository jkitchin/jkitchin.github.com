

<!doctype html>
<!--[if lt IE 7 ]> <html lang="en" class="no-js ie6"> <![endif]-->
<!--[if IE 7 ]>    <html lang="en" class="no-js ie7"> <![endif]-->
<!--[if IE 8 ]>    <html lang="en" class="no-js ie8"> <![endif]-->
<!--[if IE 9 ]>    <html lang="en" class="no-js ie9"> <![endif]-->
<!--[if (gt IE 9)|!(IE)]><!--> <html lang="en" class="no-js"> <!--<![endif]-->
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>The Kitchin Research Group</title>
  <meta name="google-site-verification" content="CGcacJdHc2YoZyI0Vey9XRA5qwhhFDzThKJezbRFcJ4" />
  <meta name="description" content="Chemical Engineering at Carnegie Mellon University">
  <meta name="author" content="John Kitchin">
  <link rel="alternate" type="application/rss+xml" title="RSS 2.0" href="/blog/feed" />
  <link rel="alternate" type="application/atom+xml" title="Atom 1.0" href="/blog/feed/atom" />
  <link rel="shortcut icon" href="/favicon.ico">
  <link rel="apple-touch-icon" href="/img/apple-touch-icon.png">

  <link rel="stylesheet" href="/css/base.css?v=1">
  <link rel="stylesheet" href="/css/grid.css?v=1">
  <link rel="stylesheet" media="handheld" href="/css/handheld.css?v=1">
  <link rel="stylesheet" href="/css/pygments_murphy.css" type="text/css" />

  <script src="/js/libs/modernizr-1.7.min.js"></script>
<script type="text/javascript"
  src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
  <link rel="stylesheet" href="/themes/theme1/style.css?v=1">
<link href='http://fonts.googleapis.com/css?family=Roboto' rel='stylesheet' type='text/css'>

</head>
  <body>
    <div id="container" class="container container_12">
      <div id="main" role="main">
        <div id="main_block">
          <header>
<div id="header" class="header_gradient theme_font">
<table><tr><td>
    <h1><a href="/">The Kitchin Research Group</a></h1>
    <h2>Chemical Engineering at Carnegie Mellon University</h2>
</td>
<td colspan=100%><div style="float:right;width:100%;text-align:right;"> <span id='badgeCont737515' style='width:126px'><script src='http://labs.researcherid.com/mashlets?el=badgeCont737515&mashlet=badge&showTitle=false&className=a&rid=A-2363-2010'></script></span></div>
</td></tr>
</table>
</div>
  <div id="navigation" class="grid_12">

    <ul class="theme_font">
      <li><a href="/blog"
             class="">Blog</a></li>

      <li><a href="/blog/archive"
             class="">Archives</a></li>

      <li><a href="/publications.html">Publications</a></li>
      <li><a href="/group.html">Group</a></li>

      <li><a href="/research.html"
             class="">Research</a></li>

      <li><a href="/categories.html"
             class="">Categories</a></li>

      <li><a href="/about.html"
             class="">About us</a></li>

      <li><a href="/subscribe.html">Subscribe</a></li>

    </ul>
  </div>
</header>

          <div id="prose_block" class="grid_8">
            
  





<article>
  <div class="blog_post">
    <header>
      <div id="Successful-PhD-Defense-for-Ethan-Demeter"></div>
      <h2 class="blog_post_title"><a href="/blog/2013/04/24/Successful-PhD-Defense-for-Ethan-Demeter/" rel="bookmark" title="Permanent Link to Successful PhD Defense for Ethan Demeter">Successful PhD Defense for Ethan Demeter</a></h2>
      <p><small><span class="blog_post_date">Posted April 24, 2013 at 05:00 PM</span> | categories:
        <span class="blog_post_categories"><a href='/blog/category/news/'>news</a></span> | tags: 
        | <a href="http://jkitchin.github.io/blog/2013/04/24/Successful-PhD-Defense-for-Ethan-Demeter#disqus_thread">View Comments</a>
      <p><small><span class="blog_post_date">Updated May 12, 2013 at 04:20 PM</span>
      </small></p>
    </header>
    <div class="post_prose">
      



<p>
Congratulations to Ethan Demeter for successfully defending his dissertation entitled &ldquo;The Promotion of Base Metal Catalysts for the Electrochemical Oxygen Evolution Reaction&rdquo;!
</p>
<p>Copyright (C) 2013 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2013/04/24/Successful-PhD-Defense-for-Ethan-Demeter.org">org-mode source</a><p>

    </div>
  </div>
</article>



<a href="https://twitter.com/share" class="twitter-share-button" data-via="johnkitchin">Tweet</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>

  <div class="after_post"><a href="http://jkitchin.github.io/blog/2013/04/24/Successful-PhD-Defense-for-Ethan-Demeter#disqus_thread">Read and Post Comments</a></div>
  <hr class="interblog" />
  





<article>
  <div class="blog_post">
    <header>
      <div id="Mail-merge-with-python"></div>
      <h2 class="blog_post_title"><a href="/blog/2013/04/16/Mail-merge-with-python/" rel="bookmark" title="Permanent Link to Mail merge with python">Mail merge with python</a></h2>
      <p><small><span class="blog_post_date">Posted April 16, 2013 at 04:10 PM</span> | categories:
        <span class="blog_post_categories"><a href='/blog/category/email/'>email</a>, <a href='/blog/category/programming/'>programming</a></span> | tags: 
        | <a href="http://jkitchin.github.io/blog/2013/04/16/Mail-merge-with-python#disqus_thread">View Comments</a>
      </small></p>
    </header>
    <div class="post_prose">
      



<p>
Suppose you are organizing some event, and you have a mailing list of email addresses and people you need to send a mail to telling them what room they will be in. You would like to send a personalized email to each person, and you do not want to type each one by hand. Python can automate this for you. All you need is the mailing list in some kind of structured format, and then you can go through it line by line to create and send emails.
</p>

<p>
We will use an org-table to store the data in.
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides" id="mail-list">
<caption></caption>

<colgroup>
<col class="left"/>

<col class="left"/>

<col class="left"/>

<col class="right"/>
</colgroup>
<thead>
<tr>
<th scope="col" class="left">First name</th>
<th scope="col" class="left">Last name</th>
<th scope="col" class="left">email address</th>
<th scope="col" class="right">Room number</th>
</tr>
</thead>
<tbody>
<tr>
<td class="left">Jane</td>
<td class="left">Doe</td>
<td class="left">jane-doe@gmail.com</td>
<td class="right">1</td>
</tr>

<tr>
<td class="left">John</td>
<td class="left">Doe</td>
<td class="left">john-doe@gmail.com</td>
<td class="right">2</td>
</tr>

<tr>
<td class="left">Jimmy</td>
<td class="left">John</td>
<td class="left">jimmy-john@gmail.com</td>
<td class="right">3</td>
</tr>
</tbody>
</table>

<p>
We pass that table into an org-mode source block as a variable called data, which will be a list of lists, one for each row of the table. You could alternatively read these from an excel spreadsheet, a csv file, or some kind of python data structure. 
</p>

<p>
We do not actually send the emails in this example. To do that you need to have access to a mail server, which could be on your own machine, or it could be a relay server you have access to.
</p>

<p>
We create a string that is a template with some fields to be substituted, e.g. the firstname and room number in this case. Then we loop through each row of the table, and format the template with those values, and create an email message to the person. First we print each message to check that they are correct. 
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #ebbbff; font-weight: bold;">import</span> smtplib
<span style="color: #ebbbff; font-weight: bold;">from</span> email.MIMEMultipart <span style="color: #ebbbff; font-weight: bold;">import</span> MIMEMultipart
<span style="color: #ebbbff; font-weight: bold;">from</span> email.MIMEText <span style="color: #ebbbff; font-weight: bold;">import</span> MIMEText
<span style="color: #ebbbff; font-weight: bold;">from</span> email.Utils <span style="color: #ebbbff; font-weight: bold;">import</span>  formatdate

template = <span style="color: #d1f1a9;">'''</span>
<span style="color: #d1f1a9;">Dear {firstname:s},</span>

<span style="color: #d1f1a9;">I am pleased to inform you that your talk will be in room {roomnumber:d}.</span>

<span style="color: #d1f1a9;">Sincerely,</span>
<span style="color: #d1f1a9;">John</span>
<span style="color: #d1f1a9;">'''</span>

<span style="color: #ebbbff; font-weight: bold;">for</span> firstname, lastname, emailaddress, roomnumber <span style="color: #ebbbff; font-weight: bold;">in</span> data:
    msg = MIMEMultipart()
    msg[<span style="color: #d1f1a9;">'From'</span>] = <span style="color: #d1f1a9;">"youremail@gmail.com"</span>
    msg[<span style="color: #d1f1a9;">'To'</span>] = emailaddress
    msg[<span style="color: #d1f1a9;">'Date'</span>] = formatdate(localtime=<span style="color: #ebbbff; font-weight: bold;">True</span>)

    msgtext = template.format(**<span style="color: #ffc58f;">locals</span>())
    <span style="color: #ffc58f;">print</span> msgtext

    msg.attach(MIMEText(msgtext))

    <span style="color: #7285b7; font-weight: bold; font-style: italic;">#</span><span style="color: #7285b7; font-weight: bold; font-style: italic;"># Uncomment these lines and fix </span>
    <span style="color: #7285b7; font-weight: bold; font-style: italic;">#</span><span style="color: #7285b7; font-weight: bold; font-style: italic;">server = smtplib.SMTP('your.relay.server.edu')</span>
    <span style="color: #7285b7; font-weight: bold; font-style: italic;">#</span><span style="color: #7285b7; font-weight: bold; font-style: italic;">server.sendmail('your_email@gmail.com', # from</span>
    <span style="color: #7285b7; font-weight: bold; font-style: italic;">#                </span><span style="color: #7285b7; font-weight: bold; font-style: italic;">emailaddress,</span>
    <span style="color: #7285b7; font-weight: bold; font-style: italic;">#                </span><span style="color: #7285b7; font-weight: bold; font-style: italic;">msg.as_string())</span>
    <span style="color: #7285b7; font-weight: bold; font-style: italic;">#</span><span style="color: #7285b7; font-weight: bold; font-style: italic;">server.quit()</span>

    <span style="color: #ffc58f;">print</span> msg.as_string()
    <span style="color: #ffc58f;">print</span> <span style="color: #d1f1a9;">'------------------------------------------------------------------'</span>
</pre>
</div>

<pre class="example">
Dear Jane,

I am pleased to inform you that your talk will be in room 1.

Sincerely,
John

Content-Type: multipart/mixed; boundary="===============1191311863=="
MIME-Version: 1.0
From: youremail@gmail.com
To: jane-doe@gmail.com
Date: Tue, 16 Apr 2013 16:10:23 -0400

--===============1191311863==
Content-Type: text/plain; charset="us-ascii"
MIME-Version: 1.0
Content-Transfer-Encoding: 7bit


Dear Jane,

I am pleased to inform you that your talk will be in room 1.

Sincerely,
John

--===============1191311863==--
------------------------------------------------------------------

Dear John,

I am pleased to inform you that your talk will be in room 2.

Sincerely,
John

Content-Type: multipart/mixed; boundary="===============1713881863=="
MIME-Version: 1.0
From: youremail@gmail.com
To: john-doe@gmail.com
Date: Tue, 16 Apr 2013 16:10:23 -0400

--===============1713881863==
Content-Type: text/plain; charset="us-ascii"
MIME-Version: 1.0
Content-Transfer-Encoding: 7bit


Dear John,

I am pleased to inform you that your talk will be in room 2.

Sincerely,
John

--===============1713881863==--
------------------------------------------------------------------

Dear Jimmy,

I am pleased to inform you that your talk will be in room 3.

Sincerely,
John

Content-Type: multipart/mixed; boundary="===============0696685580=="
MIME-Version: 1.0
From: youremail@gmail.com
To: jimmy-john@gmail.com
Date: Tue, 16 Apr 2013 16:10:23 -0400

--===============0696685580==
Content-Type: text/plain; charset="us-ascii"
MIME-Version: 1.0
Content-Transfer-Encoding: 7bit


Dear Jimmy,

I am pleased to inform you that your talk will be in room 3.

Sincerely,
John

--===============0696685580==--
------------------------------------------------------------------
</pre>
<p>Copyright (C) 2013 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2013/04/16/Mail-merge-with-python.org">org-mode source</a><p>

    </div>
  </div>
</article>



<a href="https://twitter.com/share" class="twitter-share-button" data-via="johnkitchin">Tweet</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>

  <div class="after_post"><a href="http://jkitchin.github.io/blog/2013/04/16/Mail-merge-with-python#disqus_thread">Read and Post Comments</a></div>
  <hr class="interblog" />
  





<article>
  <div class="blog_post">
    <header>
      <div id="Tool-tips-on-text-in-Emacs"></div>
      <h2 class="blog_post_title"><a href="/blog/2013/04/12/Tool-tips-on-text-in-Emacs/" rel="bookmark" title="Permanent Link to Tool tips on text in Emacs">Tool tips on text in Emacs</a></h2>
      <p><small><span class="blog_post_date">Posted April 12, 2013 at 10:12 AM</span> | categories:
        <span class="blog_post_categories"><a href='/blog/category/emacs/'>emacs</a></span> | tags: 
        | <a href="http://jkitchin.github.io/blog/2013/04/12/Tool-tips-on-text-in-Emacs#disqus_thread">View Comments</a>
      <p><small><span class="blog_post_date">Updated April 12, 2013 at 11:36 AM</span>
      </small></p>
    </header>
    <div class="post_prose">
      



<p>
Here we look at a way to get tool tips on text in Emacs. This would be helpful for giving hints, or definitions, or reminders about something. Tool tips are created by setting the help-echo text property for the string of interest. We will write a function that adds the tool tip to every instance of a string in the current buffer. We will also change the color of the string slightly to give the reader a hint there might be something there.
</p>

<p>
Here is the code. We use save-excursion so that the cursor stays where it starts. Then we search for the string we want a tool tip on, and set the appropriate properties.
</p>

<p>
What is a foobar?
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #ff0000; font-weight: bold;">; </span><span style="color: #ff0000; font-weight: bold;">add a tooltip to every instance of foobar</span>
(<span style="color: #8b0000;">save-excursion</span>  <span style="color: #ff0000; font-weight: bold;">;</span><span style="color: #ff0000; font-weight: bold;">return cursor to current-point</span>
  (goto-char 1)
    (<span style="color: #8b0000;">while</span> (search-forward <span style="color: #228b22;">"foobar"</span> (point-max) t)
      (set-text-properties  (match-beginning 0) (match-end 0)
                            `(help-echo <span style="color: #228b22;">"You know... a bar for foos!"</span>
                             font-lock-face (<span style="color: #cd0000;">:foreground</span> <span style="color: #228b22;">"dark slate gray"</span>))
)))
</pre>
</div>

<p>
After you run the function above, the next sentence should have a grayed word in it, and when you hold your mouse over the grayed word a tool tip should appear.
</p>

<p>
There is a foobar in the woods.
</p>

<p>
You can see the effect here:
</p>

<p><img src="/img/./tooltip-emacs.png"><p>

<p>
This could be an interesting way to increase the depth and richness of text. To use it you would have to define a function that runs when a file is opened, or call the function after opening a file.
</p>
<p>Copyright (C) 2013 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2013/04/12/Tool-tips-on-text-in-Emacs.org">org-mode source</a><p>

    </div>
  </div>
</article>



<a href="https://twitter.com/share" class="twitter-share-button" data-via="johnkitchin">Tweet</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>

  <div class="after_post"><a href="http://jkitchin.github.io/blog/2013/04/12/Tool-tips-on-text-in-Emacs#disqus_thread">Read and Post Comments</a></div>
  <hr class="interblog" />
  





<article>
  <div class="blog_post">
    <header>
      <div id="Working-with-lists"></div>
      <h2 class="blog_post_title"><a href="/blog/2013/04/09/Working-with-lists/" rel="bookmark" title="Permanent Link to Working with lists">Working with lists</a></h2>
      <p><small><span class="blog_post_date">Posted April 09, 2013 at 09:54 PM</span> | categories:
        <span class="blog_post_categories"><a href='/blog/category/programming/'>programming</a></span> | tags: 
        | <a href="http://jkitchin.github.io/blog/2013/04/09/Working-with-lists#disqus_thread">View Comments</a>
      <p><small><span class="blog_post_date">Updated May 19, 2013 at 11:27 AM</span>
      </small></p>
    </header>
    <div class="post_prose">
      



<p>
It is not too uncommon to have a list of data, and then to apply a function to every element, to filter the list, or extract elements that meet some criteria. In this example, we take a string and split it into words. Then, we will examine several ways to apply functions to the words, to filter the list to get data that meets some criteria. Here is the string splitting.
</p>

<div class="org-src-container">

<pre class="src src-python">text = <span style="color: #228b22;">'''</span>
<span style="color: #228b22;"> As we have seen, handling units with third party functions is fragile, and often requires additional code to wrap the function to handle the units. An alternative approach that avoids the wrapping is to rescale the equations so they are dimensionless. Then, we should be able to use all the standard external functions without modification. We obtain the final solutions by rescaling back to the answers we want.</span>

<span style="color: #228b22;">Before doing the examples, let us consider how the quantities package handles dimensionless numbers.</span>

<span style="color: #228b22;">import quantities as u</span>

<span style="color: #228b22;">a = 5 * u.m</span>
<span style="color: #228b22;">L = 10 * u.m # characteristic length</span>

<span style="color: #228b22;">print a/L</span>
<span style="color: #228b22;">print type(a/L)</span>

<span style="color: #228b22;">'''</span>

words = text.split()
<span style="color: #8b0000;">print</span> words
</pre>
</div>

<pre class="example">
... ... ... ... ... ... ... ... ... ... ... ... &gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; ['As', 'we', 'have', 'seen,', 'handling', 'units', 'with', 'third', 'party', 'functions', 'is', 'fragile,', 'and', 'often', 'requires', 'additional', 'code', 'to', 'wrap', 'the', 'function', 'to', 'handle', 'the', 'units.', 'An', 'alternative', 'approach', 'that', 'avoids', 'the', 'wrapping', 'is', 'to', 'rescale', 'the', 'equations', 'so', 'they', 'are', 'dimensionless.', 'Then,', 'we', 'should', 'be', 'able', 'to', 'use', 'all', 'the', 'standard', 'external', 'functions', 'without', 'modification.', 'We', 'obtain', 'the', 'final', 'solutions', 'by', 'rescaling', 'back', 'to', 'the', 'answers', 'we', 'want.', 'Before', 'doing', 'the', 'examples,', 'let', 'us', 'consider', 'how', 'the', 'quantities', 'package', 'handles', 'dimensionless', 'numbers.', 'import', 'quantities', 'as', 'u', 'a', '=', '5', '*', 'u.m', 'L', '=', '10', '*', 'u.m', '#', 'characteristic', 'length', 'print', 'a/L', 'print', 'type(a/L)']
</pre>

<p>
Let us get the length of each word.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">print</span> [<span style="color: #8b0000;">len</span>(word) <span style="color: #8b0000;">for</span> word <span style="color: #8b0000;">in</span> words]

<span style="color: #ff0000; font-weight: bold;"># functional approach with a lambda function</span>
<span style="color: #8b0000;">print</span> map(<span style="color: #8b0000;">lambda</span> word: <span style="color: #8b0000;">len</span>(word), words)

<span style="color: #ff0000; font-weight: bold;"># functional approach with a builtin function</span>
<span style="color: #8b0000;">print</span> map(len, words)

<span style="color: #ff0000; font-weight: bold;"># functional approach with a user-defined function</span>
<span style="color: #8b0000;">def</span> <span style="color: #8b2323;">get_length</span>(word):
    <span style="color: #8b0000;">return</span> <span style="color: #8b0000;">len</span>(word)

<span style="color: #8b0000;">print</span> map(get_length, words)
</pre>
</div>

<pre class="example">
[2, 2, 4, 5, 8, 5, 4, 5, 5, 9, 2, 8, 3, 5, 8, 10, 4, 2, 4, 3, 8, 2, 6, 3, 6, 2, 11, 8, 4, 6, 3, 8, 2, 2, 7, 3, 9, 2, 4, 3, 14, 5, 2, 6, 2, 4, 2, 3, 3, 3, 8, 8, 9, 7, 13, 2, 6, 3, 5, 9, 2, 9, 4, 2, 3, 7, 2, 5, 6, 5, 3, 9, 3, 2, 8, 3, 3, 10, 7, 7, 13, 8, 6, 10, 2, 1, 1, 1, 1, 1, 3, 1, 1, 2, 1, 3, 1, 14, 6, 5, 3, 5, 9]
&gt;&gt;&gt; ... [2, 2, 4, 5, 8, 5, 4, 5, 5, 9, 2, 8, 3, 5, 8, 10, 4, 2, 4, 3, 8, 2, 6, 3, 6, 2, 11, 8, 4, 6, 3, 8, 2, 2, 7, 3, 9, 2, 4, 3, 14, 5, 2, 6, 2, 4, 2, 3, 3, 3, 8, 8, 9, 7, 13, 2, 6, 3, 5, 9, 2, 9, 4, 2, 3, 7, 2, 5, 6, 5, 3, 9, 3, 2, 8, 3, 3, 10, 7, 7, 13, 8, 6, 10, 2, 1, 1, 1, 1, 1, 3, 1, 1, 2, 1, 3, 1, 14, 6, 5, 3, 5, 9]
&gt;&gt;&gt; [2, 2, 4, 5, 8, 5, 4, 5, 5, 9, 2, 8, 3, 5, 8, 10, 4, 2, 4, 3, 8, 2, 6, 3, 6, 2, 11, 8, 4, 6, 3, 8, 2, 2, 7, 3, 9, 2, 4, 3, 14, 5, 2, 6, 2, 4, 2, 3, 3, 3, 8, 8, 9, 7, 13, 2, 6, 3, 5, 9, 2, 9, 4, 2, 3, 7, 2, 5, 6, 5, 3, 9, 3, 2, 8, 3, 3, 10, 7, 7, 13, 8, 6, 10, 2, 1, 1, 1, 1, 1, 3, 1, 1, 2, 1, 3, 1, 14, 6, 5, 3, 5, 9]
&gt;&gt;&gt; ... ... ... &gt;&gt;&gt; [2, 2, 4, 5, 8, 5, 4, 5, 5, 9, 2, 8, 3, 5, 8, 10, 4, 2, 4, 3, 8, 2, 6, 3, 6, 2, 11, 8, 4, 6, 3, 8, 2, 2, 7, 3, 9, 2, 4, 3, 14, 5, 2, 6, 2, 4, 2, 3, 3, 3, 8, 8, 9, 7, 13, 2, 6, 3, 5, 9, 2, 9, 4, 2, 3, 7, 2, 5, 6, 5, 3, 9, 3, 2, 8, 3, 3, 10, 7, 7, 13, 8, 6, 10, 2, 1, 1, 1, 1, 1, 3, 1, 1, 2, 1, 3, 1, 14, 6, 5, 3, 5, 9]
</pre>

<p>
Now let us get all the words that start with the letter &ldquo;a&rdquo;. This is sometimes called filtering a list. We use a string function <code>startswith</code> to check for upper and lower-case letters. We will use list comprehension with a condition.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">print</span> [word <span style="color: #8b0000;">for</span> word <span style="color: #8b0000;">in</span> words <span style="color: #8b0000;">if</span> word.startswith(<span style="color: #228b22;">'a'</span>) <span style="color: #8b0000;">or</span> word.startswith(<span style="color: #228b22;">'A'</span>)]

<span style="color: #ff0000; font-weight: bold;"># make word lowercase to simplify the conditional statement</span>
<span style="color: #8b0000;">print</span> [word <span style="color: #8b0000;">for</span> word <span style="color: #8b0000;">in</span> words <span style="color: #8b0000;">if</span> word.lower().startswith(<span style="color: #228b22;">'a'</span>)]
</pre>
</div>

<pre class="example">
['As', 'and', 'additional', 'An', 'alternative', 'approach', 'avoids', 'are', 'able', 'all', 'answers', 'as', 'a', 'a/L']
['As', 'and', 'additional', 'An', 'alternative', 'approach', 'avoids', 'are', 'able', 'all', 'answers', 'as', 'a', 'a/L']
</pre>

<p>
A slightly harder example is to find all the words that are actually numbers. We could use a regular expression for that, but we will instead use a function we create. We use a function that tries to cast a word as a float. If this fails, we know the word is not a float, so we return False.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">def</span> <span style="color: #8b2323;">float_p</span>(word):
    <span style="color: #8b0000;">try:</span>
        <span style="color: #8b0000;">float</span>(word)
        <span style="color: #8b0000;">return</span> <span style="color: #8b0000;">True</span>
    <span style="color: #8b0000;">except</span> <span style="color: #cd0000;">ValueError</span>:
        <span style="color: #8b0000;">return</span> <span style="color: #8b0000;">False</span>

<span style="color: #8b0000;">print</span> [word <span style="color: #8b0000;">for</span> word <span style="color: #8b0000;">in</span> words <span style="color: #8b0000;">if</span> float_p(word)]

<span style="color: #ff0000; font-weight: bold;"># here is a functional approach</span>
<span style="color: #8b0000;">print</span> filter(float_p, words)
</pre>
</div>

<pre class="example">
... ... ... ... ... &gt;&gt;&gt; ['5', '10']
['5', '10']
</pre>

<p>
Finally, we consider filtering the list to find all words that contain certain symbols, say any character in this string &ldquo;./=*#&rdquo;. Any of those characters will do, so we search each word for one of them, and return True if it contains it, and False if none are contained. 
</p>
<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">def</span> <span style="color: #8b2323;">punctuation_p</span>(word):
    S = <span style="color: #228b22;">'./=*#'</span>
    <span style="color: #8b0000;">for</span> s <span style="color: #8b0000;">in</span> S:
        <span style="color: #8b0000;">if</span> s <span style="color: #8b0000;">in</span> word:
            <span style="color: #8b0000;">return</span> <span style="color: #8b0000;">True</span>
    <span style="color: #8b0000;">return</span> <span style="color: #8b0000;">False</span>

<span style="color: #8b0000;">print</span> [word <span style="color: #8b0000;">for</span> word <span style="color: #8b0000;">in</span> words <span style="color: #8b0000;">if</span> punctuation_p(word)]
<span style="color: #8b0000;">print</span> filter(punctuation_p, words)
</pre>
</div>

<pre class="example">
... ... ... ... ... &gt;&gt;&gt; ['units.', 'dimensionless.', 'modification.', 'want.', 'numbers.', '=', '*', 'u.m', '=', '*', 'u.m', '#', 'a/L', 'type(a/L)']
['units.', 'dimensionless.', 'modification.', 'want.', 'numbers.', '=', '*', 'u.m', '=', '*', 'u.m', '#', 'a/L', 'type(a/L)']
</pre>

<p>
In this section we examined a few ways to interact with lists using list comprehension and functional programming. These approaches make it possible to work on arbitrary size lists, without needing to know in advance how big the lists are. New lists are automatically generated as results, without the need to preallocate lists, i.e. you do not need to know the size of the output. This can be handy as it avoids needing to write loops in some cases and leads to more compact code.
</p>
<p>Copyright (C) 2013 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2013/04/09/Working-with-lists.org">org-mode source</a><p>

    </div>
  </div>
</article>



<a href="https://twitter.com/share" class="twitter-share-button" data-via="johnkitchin">Tweet</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>

  <div class="after_post"><a href="http://jkitchin.github.io/blog/2013/04/09/Working-with-lists#disqus_thread">Read and Post Comments</a></div>
  <hr class="interblog" />
  





<article>
  <div class="blog_post">
    <header>
      <div id="Using-Excel-in-Python"></div>
      <h2 class="blog_post_title"><a href="/blog/2013/04/06/Using-Excel-in-Python/" rel="bookmark" title="Permanent Link to Using Excel in Python">Using Excel in Python</a></h2>
      <p><small><span class="blog_post_date">Posted April 06, 2013 at 02:01 PM</span> | categories:
        <span class="blog_post_categories"><a href='/blog/category/programming/'>programming</a></span> | tags: <a href='/blog/tag/excel/'>excel</a>
        | <a href="http://jkitchin.github.io/blog/2013/04/06/Using-Excel-in-Python#disqus_thread">View Comments</a>
      </small></p>
    </header>
    <div class="post_prose">
      



<p>
There may be a time where you have an Excel sheet that already has a model built into it, and you normally change cells in the sheet, and it solves the model. It can be tedious to do that a lot, and we can use python to do that. Python has a COM interface that can communicate with Excel (and many other windows programs. see <a href="http://my.safaribooksonline.com/1565926218" >http://my.safaribooksonline.com/1565926218</a> for Python Programming on Win32). In this example, we will use a very simple Excel sheet that calculates the volume of a CSTR that runs a zeroth order reaction (\(-r_A = k\)) for a particular conversion. You set the conversion in the cell B1, and the volume is automatically computed in cell B6. We simply need to set the value of B1, and get the value of B6 for a range of different conversion values. In this example, the volume is returned in Liters.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">import</span> win32com.client <span style="color: #8b0000;">as</span> win32
excel = win32.Dispatch(<span style="color: #228b22;">'Excel.Application'</span>)

wb = excel.Workbooks.Open(<span style="color: #228b22;">'c:/Users/jkitchin/Dropbox/pycse/data/cstr-zeroth-order.xlsx'</span>)
ws = wb.Worksheets(<span style="color: #228b22;">'Sheet1'</span>)

X = [0.1, 0.5, 0.9]
<span style="color: #8b0000;">for</span> x <span style="color: #8b0000;">in</span> X:
    ws.Range(<span style="color: #228b22;">"B1"</span>).Value = x
    V = ws.Range(<span style="color: #228b22;">"B6"</span>).Value
    <span style="color: #8b0000;">print</span> <span style="color: #228b22;">'at X = {0} V = {1:1.2f} L'</span>.format(x, V)
 
<span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">we tell Excel the workbook is saved, even though it is not, so it</span>
<span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">will quit without asking us to save.</span>
excel.ActiveWorkbook.Saved = <span style="color: #8b0000;">True</span> 
excel.Application.Quit()
</pre>
</div>

<pre class="example">
at X = 0.1 V = 22.73 L
at X = 0.5 V = 113.64 L
at X = 0.9 V = 204.55 L
</pre>

<p>
This was a simple example (one that did not actually need Excel at all) that illustrates the feasibility of communicating with Excel via a COM interface. 
</p>
<p>Copyright (C) 2013 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2013/04/06/Using-Excel-in-Python.org">org-mode source</a><p>

    </div>
  </div>
</article>



<a href="https://twitter.com/share" class="twitter-share-button" data-via="johnkitchin">Tweet</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>

  <div class="after_post"><a href="http://jkitchin.github.io/blog/2013/04/06/Using-Excel-in-Python#disqus_thread">Read and Post Comments</a></div>
  <hr class="interblog" />
 <a href="../80">« Previous Page</a>
  --  
 <a href="../82">Next Page »</a>

          </div>
          <div id="sidebar" class="grid_4">
            <aside>
<section>
<script>
  (function() {
    var cx = '002533177287215655227:l7uvu35ssbc';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
        '//www.google.com/cse/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>
</section>

<section>
    <h1 class="post_header_gradient theme_font">Twitter</h1>
    <a class="twitter-timeline" href="https://twitter.com/johnkitchin" data-widget-id="545217643582881792">Tweets by @johnkitchin</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+"://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
</section>


  <section>
    <h1 class="post_header_gradient theme_font">Links</h1>
    <ul>
      <li><a href="https://www.continuum.io">Anaconda Python</a></li>
      <li><a href="/pycse">Pycse</a></li>
      <li><a href="/dft-book">DFT-book</a></li>
    </ul>
  </section>

  <section>
    <h1 class="post_header_gradient theme_font">Latest Posts</h1>
    <ul>
      <li><a href="/blog/2018/10/10/Autograd-and-the-derivative-of-an-integral-function/">Autograd and the derivative of an integral function</a></li>
      <li><a href="/blog/2018/10/09/Compressibility-variation-from-an-implicit-equation-of-state/">Compressibility variation from an implicit equation of state</a></li>
      <li><a href="/blog/2018/10/08/Getting-derivatives-from-implicit-functions-with-autograd/">Getting derivatives from implicit functions with autograd</a></li>
      <li><a href="/blog/2018/10/07/Compressibility-factor-variation-from-the-van-der-Waals-equation-by-three-different-approaches/">Compressibility factor variation from the van der Waals equation by three different approaches</a></li>
      <li><a href="/blog/2018/09/24/Solving-nonlinear-algebra-problems-with-internal-state-information/">Solving nonlinear algebra problems with internal state information</a></li>
    </ul>
  </section>

<section>
<h1 class="post_header_gradient theme_font">Latest GitHub Repos</h1>
  <a href="https://github.com/jkitchin">@jkitchin</a> on GitHub.
  <ul id="my-github-projects">
        <li class="loading">Status updating&#8230;</li>
  </ul>

</section>
</aside>

          </div>
          <div class="clear"></div>
        </div>
      </div>
      
<footer>
  <div id="footer" class="grid_12">
    <div class="grid_8">
      <p>
        <a href="/blog/feed/index.xml">RSS</a>
        <a href="http://kitchinresearchgroup.disqus.com/latest.rss">Comments RSS Feed</a>.
      </p>
    </div>
    <div class="grid_4" id="credits">
      <p>
        Copyright 2018
        John Kitchin
      </p>
      <p>
        Powered by <a href="http://www.blogofile.com">Blogofile</a>
      </p>
    </div>
  </div>
</footer>

    </div>
      <script src="//ajax.googleapis.com/ajax/libs/jquery/1.5.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="/js/libs/jquery-1.5.1.min.js"%3E%3C/script%3E'))</script>
  <script src="/js/plugins.js"></script>
  <script src="/js/script.js"></script>
  <script src="/js/jquery.tweet.js"></script>  
  <script src="/js/site.js"></script>
  <!--[if lt IE 7 ]>
  <script src="js/libs/dd_belatedpng.js"></script>
  <script> DD_belatedPNG.fix('img, .png_bg');</script>
  <![endif]-->
  <script>
      var _gaq=[['_setAccount','UA-35731398-1'],['_trackPageview']];
      (function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];g.async=1;
      g.src=('https:'==location.protocol?'//ssl':'//www')+'.google-analytics.com/ga.js';
      s.parentNode.insertBefore(g,s)}(document,'script'));
  </script>
  <script>
  (function() {
      var links = document.getElementsByTagName('a');
      var query = '?';
      for(var i = 0; i < links.length; i++) {
          if(links[i].href.indexOf('#disqus_thread') >= 0) {
              query += 'url' + i + '=' + encodeURIComponent(links[i].href) + '&';
          }
      }
      document.write('<script charset="utf-8" type="text/javascript" src="http://disqus.com/forums/kitchinresearchgroup/get_num_replies.js' + query + '"></' + 'script>');
  })();
  </script>

  </body>
</html>






<script src="http://ajax.microsoft.com/ajax/jquery/jquery-1.4.2.min.js" type="text/javascript"></script>
<script src="/js/git.js" type="text/javascript"></script>
<script type="text/javascript">
    $(function() {
     $("#my-github-projects").loadRepositories("jkitchin");
    });
</script>



