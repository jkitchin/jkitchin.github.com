

<!doctype html>
<!--[if lt IE 7 ]> <html lang="en" class="no-js ie6"> <![endif]-->
<!--[if IE 7 ]>    <html lang="en" class="no-js ie7"> <![endif]-->
<!--[if IE 8 ]>    <html lang="en" class="no-js ie8"> <![endif]-->
<!--[if IE 9 ]>    <html lang="en" class="no-js ie9"> <![endif]-->
<!--[if (gt IE 9)|!(IE)]><!--> <html lang="en" class="no-js"> <!--<![endif]-->
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>The Kitchin Research Group</title>
  <meta name="google-site-verification" content="CGcacJdHc2YoZyI0Vey9XRA5qwhhFDzThKJezbRFcJ4" />
  <meta name="description" content="Chemical Engineering at Carnegie Mellon University">
  <meta name="author" content="John Kitchin">
  <link rel="alternate" type="application/rss+xml" title="RSS 2.0" href="/blog/feed" />
  <link rel="alternate" type="application/atom+xml" title="Atom 1.0" href="/blog/feed/atom" />
  <link rel="shortcut icon" href="/favicon.ico">
  <link rel="apple-touch-icon" href="/img/apple-touch-icon.png">

  <link rel="stylesheet" href="/css/base.css?v=1">
  <link rel="stylesheet" href="/css/grid.css?v=1">
  <link rel="stylesheet" media="handheld" href="/css/handheld.css?v=1">
  <link rel="stylesheet" href="/css/pygments_murphy.css" type="text/css" />

  <script src="/js/libs/modernizr-1.7.min.js"></script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        displayAlign: "center",
        displayIndent: "0em",

        "HTML-CSS": { scale: 100,
                        linebreaks: { automatic: "false" },
                        webFont: "TeX"
                       },
        SVG: {scale: 100,
              linebreaks: { automatic: "false" },
              font: "TeX"},
        NativeMML: {scale: 100},
        TeX: { equationNumbers: {autoNumber: "AMS"},
               MultLineWidth: "85%",
               TagSide: "right",
               TagIndent: ".8em"
             }
});
</script>
<script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_HTML"></script>
  <link rel="stylesheet" href="/themes/theme1/style.css?v=1">
<link href='http://fonts.googleapis.com/css?family=Roboto' rel='stylesheet' type='text/css'>

</head>
  <body>
    <div id="container" class="container container_12">
      <div id="main" role="main">
        <div id="main_block">
          <header>
<div id="header" class="header_gradient theme_font">
<table><tr><td>
    <h1><a href="/">The Kitchin Research Group</a></h1>
    <h2>Chemical Engineering at Carnegie Mellon University</h2>
</td>
<td colspan=100%><div style="float:right;width:100%;text-align:right;"> <span id='badgeCont737515' style='width:126px'><script src='http://labs.researcherid.com/mashlets?el=badgeCont737515&mashlet=badge&showTitle=false&className=a&rid=A-2363-2010'></script></span></div>
</td></tr>
</table>
</div>
  <div id="navigation" class="grid_12">

    <ul class="theme_font">
      <li><a href="/blog"
             class="">Blog</a></li>

      <li><a href="/blog/archive"
             class="">Archives</a></li>

      <li><a href="/publications.html">Publications</a></li>

      <li><a href="/research.html"
             class="">Research</a></li>

      <li><a href="/categories.html"
             class="">Categories</a></li>

      <li><a href="/about.html"
             class="">About us</a></li>

      <li><a href="/subscribe.html">Subscribe</a></li>

    </ul>
  </div>
</header>

          <div id="prose_block" class="grid_8">
            
  





<article>
  <div class="blog_post">
    <header>
      <div id="An-alternative-approach-to-including-org-source-in-blog-posts"></div>
      <h2 class="blog_post_title"><a href="/blog/2015/05/09/An-alternative-approach-to-including-org-source-in-blog-posts/" rel="bookmark" title="Permanent Link to An alternative approach to including org-source in blog posts">An alternative approach to including org-source in blog posts</a></h2>
      <p><small><span class="blog_post_date">Posted May 09, 2015 at 01:50 PM</span> | categories:
        <span class="blog_post_categories"><a href='/blog/category/orgmode/'>orgmode</a></span> | tags: 
      <p><small><span class="blog_post_date">Updated May 09, 2015 at 02:58 PM</span></small>
      </small></p>
    </header>
    <div class="post_prose">
      



<p>
When you publish a Matlab m-file to HTML, Matlab includes the m-file source as an html comment in the output. They also provide a nice function called grabcode that will take a url, and open the source code in the editor. Today, we try a similar approach for org-mode.
</p>

<p>
This post is not totally self-contained. I have my own emacs-lisp module that converts org-mode to blogofile posts, and so far I have not made it broadly available. This is also a super exploratory idea, so I am just going to show the changes I need to make to my setup to get to the evaluation of the idea.
</p>

<p>
The idea is pretty simple, we just insert the current buffer string into an HTML comment. I just modify the bf-get-post-html function lightly to do that. This is a somewhat pathological example since there are html comments in the post! So, we will encode all the dashes to get around that.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #0000FF;">require</span> '<span style="color: #D0372D;">browse-url</span>)
(<span style="color: #0000FF;">defun</span> <span style="color: #006699;">bf-get-post-html</span> ()
  <span style="color: #036A07;">"Return a string containing the YAML header, the post html, my</span>
<span style="color: #036A07;">copyright line, and a link to the org-source code."</span>
  (<span style="color: #0000FF;">interactive</span>)
  (<span style="color: #0000FF;">let</span> ((org-source (buffer-string))
        (url-to-org (bf-get-url-to-org-source))
        (yaml (bf-get-YAML-heading))
        (body (bf-get-HTML)))

    (<span style="color: #0000FF;">with-temp-buffer</span>
      (insert yaml)
      (insert body)
      (insert
       (format <span style="color: #008000;">"&lt;p&gt;Copyright (C) %s by John Kitchin. See the &lt;a href=\"/copying.html\"&gt;License&lt;/a&gt; for information about copying.&lt;p&gt;"</span>
               (format-time-string <span style="color: #008000;">"%Y"</span>)))
      (insert (format <span style="color: #008000;">"&lt;p&gt;&lt;a href=\"%s\"&gt;org-mode source&lt;/a&gt;&lt;p&gt;"</span>
                      url-to-org))
      (insert (format <span style="color: #008000;">"&lt;p&gt;Org-mode version = %s&lt;/p&gt;"</span> (org-version)))
      <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">this is the only new code we need to add.</span>
      (insert (format <span style="color: #008000;">"</span>
<span style="color: #008000;">&lt;!--</span>
<span style="color: #008000;">  ##### SOURCE BEGIN #####</span>
<span style="color: #008000;">%s</span>
<span style="color: #008000;">##### SOURCE END #####</span>
<span style="color: #008000;">--&gt;"</span> (browse-url-url-encode-chars org-source <span style="color: #008000;">"[-]"</span>)))
      <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">return value</span>
      (buffer-string))))
</pre>
</div>

<p>
By itself, that has limited value to me. So, let's also create a grab-org-source function to get the embedded source and open it in a buffer. This might be a naive approach, we just use a regexp to find the source boundaries and open it in a new buffer. We have to unescape the dashes, which appear as %2D in the comments. Here is our function.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #0000FF;">defun</span> <span style="color: #006699;">grab-org-source</span> (url)
  <span style="color: #036A07;">"Extract org-source from URL to a buffer named *grab-org-source*."</span>
  (<span style="color: #0000FF;">interactive</span> <span style="color: #008000;">"sURL: "</span>)
  (switch-to-buffer (get-buffer-create <span style="color: #008000;">"*grab-org-source*"</span>))
  (erase-buffer)
  (org-mode)
  (insert
   (<span style="color: #0000FF;">with-current-buffer</span>
       (url-retrieve-synchronously url)
     (<span style="color: #0000FF;">let</span> (start)
       (re-search-forward
        <span style="color: #008000;">"</span>
<span style="color: #008000;">&lt;!--</span>
<span style="color: #008000;">  ##### SOURCE BEGIN #####</span>
<span style="color: #008000;">"</span> nil t)
       (<span style="color: #0000FF;">setq</span> start (point))
       (re-search-forward <span style="color: #008000;">"##### SOURCE END #####</span>
<span style="color: #008000;">--&gt;"</span> nil t)
       (buffer-substring start (match-beginning 0)))))
  (goto-char (point-min))
  (<span style="color: #0000FF;">while</span> (search-forward <span style="color: #008000;">"%2D"</span> nil t)
    (replace-match <span style="color: #008000;">"-"</span>))
  (goto-char (point-min)))
</pre>
</div>

<p>
This concludes my basic proof of concept. I think there is a general escaping challenge in this approach, because it isn't clear if you can put really arbitrary stuff in an html comment, e.g. you cannot put &#x2013;&gt;! I am going to try incorporating this into my posts and see what other issues come up in the future.
</p>
<p>Copyright (C) 2015 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2015/05/09/An-alternative-approach-to-including-org-source-in-blog-posts.org">org-mode source</a><p><p>Org-mode version = 8.2.10</p>
<!--
  ##### SOURCE BEGIN #####
* DONE An alternative approach to including org%2Dsource in blog posts
  CLOSED: [2015%2D05%2D09 Sat 13:57]
  :PROPERTIES:
  :categories: orgmode
  :date:     2015/05/09 13:50:18
  :updated:  2015/05/09 14:58:24
  :END:
When you publish a Matlab m%2Dfile to HTML, Matlab includes the m%2Dfile source as an html comment in the output. They also provide a nice function called grabcode that will take a url, and open the source code in the editor. Today, we try a similar approach for org%2Dmode.

This post is not totally self%2Dcontained. I have my own emacs%2Dlisp module that converts org%2Dmode to blogofile posts, and so far I have not made it broadly available. This is also a super exploratory idea, so I am just going to show the changes I need to make to my setup to get to the evaluation of the idea.

The idea is pretty simple, we just insert the current buffer string into an HTML comment. I just modify the bf%2Dget%2Dpost%2Dhtml function lightly to do that. This is a somewhat pathological example since there are html comments in the post! So, we will encode all the dashes to get around that.

#+BEGIN_SRC emacs%2Dlisp
(require 'browse%2Durl)
(defun bf%2Dget%2Dpost%2Dhtml ()
  "Return a string containing the YAML header, the post html, my
copyright line, and a link to the org%2Dsource code."
  (interactive)
  (let ((org%2Dsource (buffer%2Dstring))
	(url%2Dto%2Dorg (bf%2Dget%2Durl%2Dto%2Dorg%2Dsource))
	(yaml (bf%2Dget%2DYAML%2Dheading))
	(body (bf%2Dget%2DHTML)))

    (with%2Dtemp%2Dbuffer
      (insert yaml)
      (insert body)
      (insert
       (format "<p>Copyright (C) %s by John Kitchin. See the <a href=\"/copying.html\">License</a> for information about copying.<p>"
	       (format%2Dtime%2Dstring "%Y")))
      (insert (format "<p><a href=\"%s\">org%2Dmode source</a><p>"
		      url%2Dto%2Dorg))
      (insert (format "<p>Org%2Dmode version = %s</p>" (org%2Dversion)))
      ;; this is the only new code we need to add.
      (insert (format "
<!%2D%2D
  ##### SOURCE BEGIN #####
%s
##### SOURCE END #####
%2D%2D>" (browse%2Durl%2Durl%2Dencode%2Dchars org%2Dsource "[%2D]")))
      ;; return value
      (buffer%2Dstring))))
#+END_SRC

By itself, that has limited value to me. So, let's also create a grab%2Dorg%2Dsource function to get the embedded source and open it in a buffer. This might be a naive approach, we just use a regexp to find the source boundaries and open it in a new buffer. We have to unescape the dashes, which appear as %2D in the comments. Here is our function.

#+BEGIN_SRC emacs%2Dlisp
(defun grab%2Dorg%2Dsource (url)
  "Extract org%2Dsource from URL to a buffer named *grab%2Dorg%2Dsource*."
  (interactive "sURL: ")
  (switch%2Dto%2Dbuffer (get%2Dbuffer%2Dcreate "*grab%2Dorg%2Dsource*"))
  (erase%2Dbuffer)
  (org%2Dmode)
  (insert
   (with%2Dcurrent%2Dbuffer
       (url%2Dretrieve%2Dsynchronously url)
     (let (start)
       (re%2Dsearch%2Dforward
	"
<!%2D%2D
  ##### SOURCE BEGIN #####
" nil t)
       (setq start (point))
       (re%2Dsearch%2Dforward "##### SOURCE END #####
%2D%2D>" nil t)
       (buffer%2Dsubstring start (match%2Dbeginning 0)))))
  (goto%2Dchar (point%2Dmin))
  (while (search%2Dforward "%2D" nil t)
    (replace%2Dmatch "%2D"))
  (goto%2Dchar (point%2Dmin)))
#+END_SRC

This concludes my basic proof of concept. I think there is a general escaping challenge in this approach, because it isn't clear if you can put really arbitrary stuff in an html comment, e.g. you cannot put %2D%2D>! I am going to try incorporating this into my posts and see what other issues come up in the future.

##### SOURCE END #####
-->

    </div>
  </div>
</article>



<a href="https://twitter.com/share" class="twitter-share-button" data-via="johnkitchin">Share on Twitter</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>


<a href="https://twitter.com/search?q=https://kitchingroup.cheme.cmu.edu/blog/2015/05/09/An-alternative-approach-to-including-org-source-in-blog-posts">Discuss on Twitter</a>

  <hr class="interblog" />
  





<article>
  <div class="blog_post">
    <header>
      <div id="New-publication-in-J-Phys-Chem-C"></div>
      <h2 class="blog_post_title"><a href="/blog/2015/05/07/New-publication-in-J-Phys-Chem-C/" rel="bookmark" title="Permanent Link to New publication in J. Phys. Chem. C">New publication in J. Phys. Chem. C</a></h2>
      <p><small><span class="blog_post_date">Posted May 07, 2015 at 03:07 PM</span> | categories:
        <span class="blog_post_categories"><a href='/blog/category/news/'>news</a>, <a href='/blog/category/publication/'>publication</a></span> | tags: 
      </small></p>
    </header>
    <div class="post_prose">
      



<p>
In this paper we show that the electrolyte can  modify the reactivity of nickel hydroxide based electrodes for electrochemical water oxidation. There are two effects that are important: 1) Fe-impurities, and 2) the identify of the electrolyte cation. Fe-impurities are known to promote water oxidation. We found that a LiOH electrolyte can <i>suppress</i> the oxygen evolution reaction, which is also known from the battery literature. KOH and CsOH are the best electrolytes for the OER on nickel hydroxide based electrodes.
</p>

<p>
"Alkaline Electrolyte and Fe Impurity Effects on the Performance and Active-phase Structure of NiOOH Thin Films for OER Catalysis Applications"
</p>

<p>
<a href="http://pubs.acs.org/doi/abs/10.1021/acs.jpcc.5b02458">http://pubs.acs.org/doi/abs/10.1021/acs.jpcc.5b02458</a>
</p>

<div class="org-src-container">

<pre class="src src-bibtex"><span style="color: #006699;">@article</span>{<span style="color: #D0372D;">michael-2015-alkal-elect</span>,
  <span style="color: #BA36A5;">author</span> =       {Michael, John and Demeter, Ethan L and Illes, Steven M. and
                  Fan, Qingqi and Boes, Jacob R. and Kitchin, John R.},
  <span style="color: #BA36A5;">title</span> =        {Alkaline Electrolyte and Fe Impurity Effects on the
                  Performance and Active-Phase Structure of NiOOH Thin Films for
                  OER Catalysis Applications},
  <span style="color: #BA36A5;">journal</span> =      {The Journal of Physical Chemistry C},
  <span style="color: #BA36A5;">volume</span> =       0,
  <span style="color: #BA36A5;">number</span> =       {ja},
  <span style="color: #BA36A5;">pages</span> =        {null},
  <span style="color: #BA36A5;">year</span> =         2015,
  <span style="color: #BA36A5;">doi</span> =          {<span style="color: #006DAF; text-decoration: underline;">10.1021/acs.jpcc.5b02458</span>},
  <span style="color: #BA36A5;">url</span> =          {<span style="color: #006DAF; text-decoration: underline;"> https://doi.org/10.1021/acs.jpcc.5b02458 </span>},
  <span style="color: #BA36A5;">eprint</span> =       { https://doi.org/10.1021/acs.jpcc.5b02458 },
}
</pre>
</div>
<p>Copyright (C) 2015 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2015/05/07/New-publication-in-J.-Phys.-Chem.-C.org">org-mode source</a><p><p>Org-mode version = 8.2.10</p>


    </div>
  </div>
</article>



<a href="https://twitter.com/share" class="twitter-share-button" data-via="johnkitchin">Share on Twitter</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>


<a href="https://twitter.com/search?q=https://kitchingroup.cheme.cmu.edu/blog/2015/05/07/New-publication-in-J-Phys-Chem-C">Discuss on Twitter</a>

  <hr class="interblog" />
  





<article>
  <div class="blog_post">
    <header>
      <div id="New-publication-in-ACS-Catalysis-on-composition-dependent-alloy-electronic-structure"></div>
      <h2 class="blog_post_title"><a href="/blog/2015/04/24/New-publication-in-ACS-Catalysis-on-composition-dependent-alloy-electronic-structure/" rel="bookmark" title="Permanent Link to New publication in ACS Catalysis on composition dependent alloy electronic structure">New publication in ACS Catalysis on composition dependent alloy electronic structure</a></h2>
      <p><small><span class="blog_post_date">Posted April 24, 2015 at 03:41 PM</span> | categories:
        <span class="blog_post_categories"><a href='/blog/category/news/'>news</a>, <a href='/blog/category/publication/'>publication</a></span> | tags: 
      </small></p>
    </header>
    <div class="post_prose">
      



<p>
In this collaborative paper we map out the electronic structure of a Cu-Pd alloy across composition space, and then correlate that electronic structure with the reactivity of the alloy. We experimentally measure the average energy of the filled valence band, and show it is similar to the calculated d-band center. We then show how those measured electronic structure properties correlate with the H<sub>2</sub>\D<sub>2</sub> exchange kinetics. The combination of experiments on composition spread alloy films (CSAF) and theory provides an integrated understanding of alloy reactivity in this system.
</p>

<div class="org-src-container">

<pre class="src src-bibtex"><span style="color: #006699;">@article</span>{<span style="color: #D0372D;">gumuslu-2015-correl-elect</span>,
  <span style="color: #BA36A5;">author</span> =       {G. Gumuslu and P. Kondratyuk and J. R. Boes and B. Morreale
                  and J. B. Miller and J. R. Kitchin and A. J. Gellman},
  <span style="color: #BA36A5;">title</span> =        {Correlation of Electronic Structure With Catalytic Activity:
                  \ce{H2}-\ce{D2} Exchange Across \ce{Cu_{x}Pd_{1-x} Composition
                  Space},
  <span style="color: #BA36A5;">journal</span> =      {ACS Catalysis},
  <span style="color: #BA36A5;">volume</span> =       {5},
  <span style="color: #BA36A5;">pages</span> =        {3137-3147},
  <span style="color: #BA36A5;">year</span> =         2015,
  <span style="color: #BA36A5;">doi</span> =          {<span style="color: #006DAF; text-decoration: underline;">10.1021/cs501586t</span>},
  <span style="color: #BA36A5;">url</span> =          {<span style="color: #006DAF; text-decoration: underline;">https://doi.org/10.1021/cs501586t</span>},
  <span style="color: #BA36A5;">date_added</span> =   {Fri Apr 24 14:47:29 2015},
}
</pre>
</div>
<p>Copyright (C) 2015 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2015/04/24/New-publication-in-ACS-Catalysis-on-composition-dependent-alloy-electronic-structure.org">org-mode source</a><p><p>Org-mode version = 8.2.10</p>


    </div>
  </div>
</article>



<a href="https://twitter.com/share" class="twitter-share-button" data-via="johnkitchin">Share on Twitter</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>


<a href="https://twitter.com/search?q=https://kitchingroup.cheme.cmu.edu/blog/2015/04/24/New-publication-in-ACS-Catalysis-on-composition-dependent-alloy-electronic-structure">Discuss on Twitter</a>

  <hr class="interblog" />
  





<article>
  <div class="blog_post">
    <header>
      <div id="Commenting-in-org-files"></div>
      <h2 class="blog_post_title"><a href="/blog/2015/04/24/Commenting-in-org-files/" rel="bookmark" title="Permanent Link to Commenting in org-files">Commenting in org-files</a></h2>
      <p><small><span class="blog_post_date">Posted April 24, 2015 at 12:41 PM</span> | categories:
        <span class="blog_post_categories"><a href='/blog/category/org/'>org</a></span> | tags: 
      <p><small><span class="blog_post_date">Updated November 19, 2015 at 09:22 AM</span></small>
      </small></p>
    </header>
    <div class="post_prose">
      



<p>
There was an interesting discussion on the org-mode mail list about putting comments in org files. Eric Fraga suggested using inline tasks, and customizing the export of them so they make a footnote, or use the todonotes package (suggested by Marcin Borkowski). Here is Eric's export. A big advantage of this is integration with the Agenda, so you can see what there is todo in your document.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">  (<span style="color: #0000FF;">setq</span> org-inlinetask-export-templates
        '((latex <span style="color: #008000;">"%s\\footnote{%s\\\\ %s}\\marginpar{\\fbox{\\thefootnote}}"</span>
                 '((<span style="color: #0000FF;">unless</span>
                       (eq todo <span style="color: #008000;">""</span>)
                     (format <span style="color: #008000;">"\\fbox{\\textsc{%s%s}}"</span> todo priority))
                   heading content))))
</pre>
</div>

<p>
Eric Abrahamsen suggested an idea to use a link syntax. I like the idea a lot, so here we develop some ideas. A link has two parts, the path, and description. A simple comment would just be a simple link, probably in double square brackets so you can have spaces in your comment. <font color="red"><abbr title="Why do you think there are only two parts" color="red">COMMENT</abbr></font>  It might be feasible to use <font color="red"><abbr title="Why do you quote mark?" color="red">COMMENT</abbr></font> the description to "mark text" that the comment refers to. The remaining question is what functionality should our link have when you click on it, and how to export it. For functionality, a click will show the comment in the minibuffer and offer to delete it. For export, for now we will make it export with todonotes in LaTeX, and as a red COMMENT with a tooltip in html. To use this, you need to have the LaTeX package todonotes included in your org file.
</p>
<p>
Here is our comment link.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(org-add-link-type
 <span style="color: #008000;">"comment"</span>
 (<span style="color: #0000FF;">lambda</span> (linkstring)
   (<span style="color: #0000FF;">let</span> ((elm (org-element-context))
         (use-dialog-box nil))
     (<span style="color: #0000FF;">when</span> (y-or-n-p <span style="color: #008000;">"Delete comment? "</span>)
       (<span style="color: #0000FF;">setf</span> (buffer-substring
              (org-element-property <span style="color: #006FE0;">:begin</span> elm)
              (org-element-property <span style="color: #006FE0;">:end</span> elm))
             (<span style="color: #0000FF;">cond</span>
              ((org-element-property <span style="color: #006FE0;">:contents-begin</span> elm)
               (buffer-substring
                (org-element-property <span style="color: #006FE0;">:contents-begin</span> elm)
                (org-element-property <span style="color: #006FE0;">:contents-end</span> elm)))
              (t
               <span style="color: #008000;">""</span>))))))
 (<span style="color: #0000FF;">lambda</span> (keyword desc format)
   (<span style="color: #0000FF;">cond</span>
    ((eq format 'html)
     (format <span style="color: #008000;">"&lt;font color=\"red\"&gt;&lt;abbr title=\"%s\" color=\"red\"&gt;COMMENT&lt;/abbr&gt;&lt;/font&gt; %s"</span> keyword (<span style="color: #0000FF;">or</span> desc <span style="color: #008000;">""</span>)))
    ((eq format 'latex)
     (format <span style="color: #008000;">"\\todo{%s}{%s}"</span> keyword (<span style="color: #0000FF;">or</span> desc <span style="color: #008000;">""</span>))))))
</pre>
</div>


<p>
It would be convenient to have a quick function for adding a comment to some highlighted text.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #0000FF;">defun</span> <span style="color: #006699;">add-comment</span> (begin end)
  (<span style="color: #0000FF;">interactive</span> <span style="color: #008000;">"r"</span>)
  (<span style="color: #0000FF;">if</span> (region-active-p)
      (<span style="color: #0000FF;">let</span> ((selected-text (buffer-substring begin end)))
        (<span style="color: #0000FF;">setf</span> (buffer-substring begin end)
              (format <span style="color: #008000;">"[[comment:%s][%s]]"</span>
                      (read-input <span style="color: #008000;">"Comment: "</span>) selected-text)))
  (insert (format  <span style="color: #008000;">"[[comment:%s]]"</span> (read-input <span style="color: #008000;">"Comment: "</span>)))))
</pre>
</div>

<p>
Test 1: <font color="red"><abbr title="test comment" color="red">COMMENT</abbr></font> 
</p>

<p>
<font color="red"><abbr title="You seem to have forgotten Test 2" color="red">COMMENT</abbr></font> Test 2
</p>

<p>
That is it. I could see a few other enhancements that might be very useful, e.g. a command to list all the comments, remove all the comments, etc&#x2026; I am pretty satisfied with this for now though.
</p>

<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1"><span class="section-number-2">1</span> An updated approach to comments.</h2>
<div class="outline-text-2" id="text-1">
<p>
Rainer asked about making some comments inline. It would be nice if a single link syntax could accommodate both styles of comments. I previously developed an approach to extend links with attributes (<a href="http://kitchingroup.cheme.cmu.edu/blog/2015/02/05/Extending-the-org-mode-link-syntax-with-attributes/">http://kitchingroup.cheme.cmu.edu/blog/2015/02/05/Extending-the-org-mode-link-syntax-with-attributes/</a> ), which I will reuse here for that purpose. The idea is to add an ":inline" attribute to change the export behavior. We only modify the LaTeX export here.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(org-add-link-type
 <span style="color: #008000;">"comment"</span>
 <span style="color: #8D8D84;">;;  </span><span style="color: #8D8D84; font-style: italic;">follow function</span>
(<span style="color: #0000FF;">lambda</span> (linkstring)
   (<span style="color: #0000FF;">let</span> ((elm (org-element-context))
         (use-dialog-box nil))
     (<span style="color: #0000FF;">when</span> (y-or-n-p <span style="color: #008000;">"Delete comment? "</span>)
       (<span style="color: #0000FF;">setf</span> (buffer-substring
              (org-element-property <span style="color: #006FE0;">:begin</span> elm)
              (org-element-property <span style="color: #006FE0;">:end</span> elm))
             (<span style="color: #0000FF;">cond</span>
              ((org-element-property <span style="color: #006FE0;">:contents-begin</span> elm)
               (buffer-substring
                (org-element-property <span style="color: #006FE0;">:contents-begin</span> elm)
                (org-element-property <span style="color: #006FE0;">:contents-end</span> elm)))
              (t
               <span style="color: #008000;">""</span>))))))
 <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">format function</span>
 (<span style="color: #0000FF;">lambda</span> (path description format)
   (<span style="color: #0000FF;">let*</span> ((data (read (concat <span style="color: #008000;">"("</span> path <span style="color: #008000;">")"</span>)))
          (head (car data))
          (plist (cdr data)))
     (<span style="color: #0000FF;">cond</span>
      ((eq format 'html)
       (format <span style="color: #008000;">"&lt;font color=\"red\"&gt;&lt;abbr title=\"%s\" color=\"red\"&gt;COMMENT&lt;/abbr&gt;&lt;/font&gt; %s"</span> path (<span style="color: #0000FF;">or</span> description <span style="color: #008000;">""</span>)))
      ((eq format 'latex)
       (format <span style="color: #008000;">"\\todo%s{%s}%s"</span>
               (<span style="color: #0000FF;">if</span> (-contains? data <span style="color: #006FE0;">:inline</span>) <span style="color: #008000;">"[inline]"</span> <span style="color: #008000;">""</span>)
               (mapconcat (<span style="color: #0000FF;">lambda</span> (s)
                            (format <span style="color: #008000;">"%s"</span> s))
                          (-remove-item <span style="color: #006FE0;">:inline</span> data) <span style="color: #008000;">" "</span>)
               (<span style="color: #0000FF;">if</span> description (format <span style="color: #008000;">"{%s}"</span> description) <span style="color: #008000;">""</span>)))))))
</pre>
</div>

<p>
Here are some examples of the syntax:
</p>
<pre class="example">
[[comment: :inline the rest of your text]]

[[comment:Some text you want to highlight]]

[[comment:Some text you want to highlight :inline]]
</pre>

<p>
It doesn't matter where the :inline attribute is added. This seems to work pretty well.
</p>

<p>
We can modify our convenience function to allow us to use a prefix arg to make the comment inline. Here is one way to do it.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #0000FF;">defun</span> <span style="color: #006699;">add-comment</span> (begin end <span style="color: #6434A3;">&amp;optional</span> arg)
  <span style="color: #036A07;">"Comment the region. With a prefix ARG, make the comment inline."</span>
  (<span style="color: #0000FF;">interactive</span> (list (region-beginning)
                     (region-end)
                     current-prefix-arg))
  (<span style="color: #0000FF;">let</span> ((<span style="color: #0000FF;">inline</span> (<span style="color: #0000FF;">if</span> arg <span style="color: #008000;">":inline "</span> <span style="color: #008000;">""</span>)))
        (<span style="color: #0000FF;">if</span> (region-active-p)
            (<span style="color: #0000FF;">let</span> ((selected-text (buffer-substring begin end)))
              (<span style="color: #0000FF;">setf</span> (buffer-substring begin end)
                    (format
                     <span style="color: #008000;">"[[comment:%s%s][%s]]"</span>
                     inline
                     (read-input <span style="color: #008000;">"Comment: "</span>) selected-text)))
          (insert (format
                   <span style="color: #008000;">"[[comment:%s%s]]"</span>
                   inline
                   (read-input <span style="color: #008000;">"Comment: "</span>))))))
</pre>
</div>

<pre class="example">
add-comment
</pre>

<p>
Test <font color="red"><abbr title="a new regular comment" color="red">COMMENT</abbr></font> text to  <font color="red"><abbr title=":inline an inline comment" color="red">COMMENT</abbr></font> comment on.
</p>
</div>
</div>
<p>Copyright (C) 2015 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2015/04/24/Commenting-in-org-files.org">org-mode source</a><p><p>Org-mode version = 8.2.10</p>

    </div>
  </div>
</article>



<a href="https://twitter.com/share" class="twitter-share-button" data-via="johnkitchin">Share on Twitter</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>


<a href="https://twitter.com/search?q=https://kitchingroup.cheme.cmu.edu/blog/2015/04/24/Commenting-in-org-files">Discuss on Twitter</a>

  <hr class="interblog" />
  





<article>
  <div class="blog_post">
    <header>
      <div id="New-publication-in-J-Chem-Physics-on-calculating-oxide-properties-with-DFT+U"></div>
      <h2 class="blog_post_title"><a href="/blog/2015/04/08/New-publication-in-J-Chem-Physics-on-calculating-oxide-properties-with-DFT+U/" rel="bookmark" title="Permanent Link to New publication in J. Chem. Physics on calculating oxide properties with DFT+U">New publication in J. Chem. Physics on calculating oxide properties with DFT+U</a></h2>
      <p><small><span class="blog_post_date">Posted April 08, 2015 at 11:18 AM</span> | categories:
        <span class="blog_post_categories"><a href='/blog/category/publication/'>publication</a>, <a href='/blog/category/news/'>news</a></span> | tags: 
      </small></p>
    </header>
    <div class="post_prose">
      




<p>
In this paper we demonstrate a novel method to use linear response DFT+U in a thermodynamic cycle to more accurately calculate metal oxide properties such as band gaps and reaction energies. This was a collaborative paper with ExxonMobil. Congratulations Zhongnan!
</p>

<div class="org-src-container">

<pre class="src src-bibtex"><span style="color: #006699;">@article</span>{<span style="color: #D0372D;">xu-2015-accur-u</span>,
  <span style="color: #BA36A5;">author</span> =       "Xu, Zhongnan and Joshi, Yogesh V. and Raman, Sumathy and
                  Kitchin, John R.",
  <span style="color: #BA36A5;">title</span> =        {Accurate Electronic and Chemical Properties of 3d Transition
                  Metal Oxides Using a Calculated Linear Response U and a DFT +
                  U(V) Method},
  <span style="color: #BA36A5;">journal</span> =      "The Journal of Chemical Physics",
  <span style="color: #BA36A5;">volume</span> =       142,
  <span style="color: #BA36A5;">number</span> =       14,
  <span style="color: #BA36A5;">pages</span> =        144701,
  <span style="color: #BA36A5;">year</span> =         2015,
  <span style="color: #BA36A5;">doi</span> =          {<span style="color: #006DAF; text-decoration: underline;">10.1063/1.4916823</span>},
  <span style="color: #BA36A5;">url</span> =
                  "http://scitation.aip.org/content/aip/journal/jcp/142/14/10.1063/1.4916823",
  <span style="color: #BA36A5;">eid</span> =          144701,
}
</pre>
</div>
<p>Copyright (C) 2015 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2015/04/08/New-publication-in-J.-Chem.-Physics-on-calculating-oxide-properties-with-DFT+U.org">org-mode source</a><p><p>Org-mode version = 8.2.10</p>

    </div>
  </div>
</article>



<a href="https://twitter.com/share" class="twitter-share-button" data-via="johnkitchin">Share on Twitter</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>


<a href="https://twitter.com/search?q=https://kitchingroup.cheme.cmu.edu/blog/2015/04/08/New-publication-in-J-Chem-Physics-on-calculating-oxide-properties-with-DFT+U">Discuss on Twitter</a>

  <hr class="interblog" />
 <a href="../40">« Previous Page</a>
  --  
 <a href="../42">Next Page »</a>

          </div>
          <div id="sidebar" class="grid_4">
            <aside>
<section>
<script>
  (function() {
    var cx = '002533177287215655227:l7uvu35ssbc';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
        '//www.google.com/cse/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>
</section>

<section>
    <h1 class="post_header_gradient theme_font">Twitter</h1>
    <a class="twitter-timeline" href="https://twitter.com/johnkitchin" data-widget-id="545217643582881792">Tweets by @johnkitchin</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+"://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
</section>


  <section>
    <h1 class="post_header_gradient theme_font">Links</h1>
    <ul>
      <li><a href="https://www.continuum.io">Anaconda Python</a></li>
      <li><a href="/pycse">Pycse</a></li>
      <li><a href="/dft-book">DFT-book</a></li>
    </ul>
  </section>

  <section>
    <h1 class="post_header_gradient theme_font">Latest Posts</h1>
    <ul>
      <li><a href="/blog/2021/06/29/Youtube-live-streamed-research-talks/">Youtube live-streamed research talks</a></li>
      <li><a href="/blog/2021/06/21/New-publication-Machine-learning-accelerated-geometry-optimization-in-molecular-simulation/">New publication "Machine-learning accelerated geometry optimization in molecular simulation"</a></li>
      <li><a href="/blog/2021/03/07/New-publication-Semi-grand-Canonical-Monte-Carlo-Simulation-of-the-Acrolein-induced-Surface-Segregation-and-Aggregation-of-AgPd-with-Machine-Learning-Surrogate-Models/">New publication - Semi-grand Canonical Monte Carlo Simulation of the Acrolein induced Surface Segregation and Aggregation of AgPd with Machine Learning Surrogate Models</a></li>
      <li><a href="/blog/2020/07/09/New-publication-SingleNN-Modified-Behler-Parrinello-Neural-Network-with-Shared-Weights-for-Atomistic-Simulations-with-Transferability/">New publication SingleNN - Modified Behler–Parrinello Neural Network with Shared Weights for Atomistic Simulations with Transferability</a></li>
      <li><a href="/blog/2020/03/10/New-publication-Parallelized-Screening-of-Characterized-and-DFT-Modelled-Bimetallic-Colloidal-Co-Catalysts-for-Photocatalytic-Hydrogen-Evolution/">New publication - Parallelized Screening of Characterized and DFT-Modelled Bimetallic Colloidal Co-Catalysts for Photocatalytic Hydrogen Evolution</a></li>
    </ul>
  </section>

<section>
<h1 class="post_header_gradient theme_font">Latest GitHub Repos</h1>
  <a href="https://github.com/jkitchin">@jkitchin</a> on GitHub.
  <ul id="my-github-projects">
        <li class="loading">Status updating&#8230;</li>
  </ul>

</section>
</aside>

          </div>
          <div class="clear"></div>
        </div>
      </div>
      
<footer>
  <div id="footer" class="grid_12">
    <div class="grid_8">
      <p>
        <a href="/blog/feed/index.xml">RSS</a>
      </p>
    </div>
    <div class="grid_4" id="credits">
      <p>
        Copyright 2021
        John Kitchin
      </p>
      <p>
        Powered by <a href="http://www.blogofile.com">Blogofile</a>
      </p>
    </div>
  </div>
</footer>

    </div>
      <script src="//ajax.googleapis.com/ajax/libs/jquery/1.5.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="/js/libs/jquery-1.5.1.min.js"%3E%3C/script%3E'))</script>
  <script src="/js/plugins.js"></script>
  <script src="/js/script.js"></script>
  <script src="/js/jquery.tweet.js"></script>  
  <script src="/js/site.js"></script>
  <!--[if lt IE 7 ]>
  <script src="js/libs/dd_belatedpng.js"></script>
  <script> DD_belatedPNG.fix('img, .png_bg');</script>
  <![endif]-->
  <script>
      var _gaq=[['_setAccount','UA-35731398-1'],['_trackPageview']];
      (function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];g.async=1;
      g.src=('https:'==location.protocol?'//ssl':'//www')+'.google-analytics.com/ga.js';
      s.parentNode.insertBefore(g,s)}(document,'script'));
  </script>

  </body>
</html>






<script src="http://ajax.microsoft.com/ajax/jquery/jquery-1.4.2.min.js" type="text/javascript"></script>
<script src="/js/git.js" type="text/javascript"></script>
<script type="text/javascript">
    $(function() {
     $("#my-github-projects").loadRepositories("jkitchin");
    });
</script>



