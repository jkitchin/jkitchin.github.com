

<!doctype html>
<!--[if lt IE 7 ]> <html lang="en" class="no-js ie6"> <![endif]-->
<!--[if IE 7 ]>    <html lang="en" class="no-js ie7"> <![endif]-->
<!--[if IE 8 ]>    <html lang="en" class="no-js ie8"> <![endif]-->
<!--[if IE 9 ]>    <html lang="en" class="no-js ie9"> <![endif]-->
<!--[if (gt IE 9)|!(IE)]><!--> <html lang="en" class="no-js"> <!--<![endif]-->
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>The Kitchin Research Group</title>
  <meta name="google-site-verification" content="CGcacJdHc2YoZyI0Vey9XRA5qwhhFDzThKJezbRFcJ4" />
  <meta name="description" content="Chemical Engineering at Carnegie Mellon University">
  <meta name="author" content="John Kitchin">
  <link rel="alternate" type="application/rss+xml" title="RSS 2.0" href="/blog/feed" />
  <link rel="alternate" type="application/atom+xml" title="Atom 1.0" href="/blog/feed/atom" />
  <link rel="shortcut icon" href="/favicon.ico">
  <link rel="apple-touch-icon" href="/img/apple-touch-icon.png">

  <link rel="stylesheet" href="/css/base.css?v=1">
  <link rel="stylesheet" href="/css/grid.css?v=1">
  <link rel="stylesheet" media="handheld" href="/css/handheld.css?v=1">
  <link rel="stylesheet" href="/css/pygments_murphy.css" type="text/css" />

  <script src="/js/libs/modernizr-1.7.min.js"></script>
<script type="text/javascript"
  src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
  <link rel="stylesheet" href="/themes/theme1/style.css?v=1">
<link href='http://fonts.googleapis.com/css?family=Roboto' rel='stylesheet' type='text/css'>

</head>
  <body>
    <div id="container" class="container container_12">
      <div id="main" role="main">
        <div id="main_block">
          <header>
<div id="header" class="header_gradient theme_font">
<table><tr><td>
    <h1><a href="/">The Kitchin Research Group</a></h1>
    <h2>Chemical Engineering at Carnegie Mellon University</h2>
</td>
<td colspan=100%><div style="float:right;width:100%;text-align:right;"> <span id='badgeCont737515' style='width:126px'><script src='http://labs.researcherid.com/mashlets?el=badgeCont737515&mashlet=badge&showTitle=false&className=a&rid=A-2363-2010'></script></span></div>
</td></tr>
</table>
</div>
  <div id="navigation" class="grid_12">

    <ul class="theme_font">
      <li><a href="/blog"
             class="">Blog</a></li>

      <li><a href="/blog/archive"
             class="">Archives</a></li>

      <li><a href="/publications.html">Publications</a></li>
      <li><a href="/group.html">Group</a></li>

      <li><a href="/research.html"
             class="">Research</a></li>

      <li><a href="/categories.html"
             class="">Categories</a></li>

      <li><a href="/about.html"
             class="">About us</a></li>

      <li><a href="/subscribe.html">Subscribe</a></li>

    </ul>
  </div>
</header>

          <div id="prose_block" class="grid_8">
            
  





<article>
  <div class="blog_post">
    <header>
      <div id="Send-email-to-a-list-of-users"></div>
      <h2 class="blog_post_title"><a href="/blog/2014/01/13/Send-email-to-a-list-of-users/" rel="bookmark" title="Permanent Link to Send email to a list of users">Send email to a list of users</a></h2>
      <p><small><span class="blog_post_date">Posted January 13, 2014 at 06:41 PM</span> | categories:
        <span class="blog_post_categories"><a href='/blog/category/emacs/'>emacs</a>, <a href='/blog/category/emacs-lisp/'>emacs-lisp</a></span> | tags: 
        | <a href="http://jkitchin.github.io/blog/2014/01/13/Send-email-to-a-list-of-users#disqus_thread">View Comments</a>
      <p><small><span class="blog_post_date">Updated January 13, 2014 at 06:42 PM</span>
      </small></p>
    </header>
    <div class="post_prose">
      



<p>
I have a need to send a lot of emails to users in my class. I have to send each student an email containing there userid and a password assigned to them. I have a list of these, so the strategy is to create a function that will email that information to one user, and then use mapcar to apply the function to each pair in a list.  First, we work out a function that will send one email to one user.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #8b0000;">defun</span> <span style="color: #8b2323;">send-mail</span> (userid password)
  <span style="color: #228b22;">"send email to userid@andrew.cmu.edu containing their password"</span>
  (interactive)
  (mail)
  (mail-to)
  (insert (format <span style="color: #228b22;">"%s@andrew.cmu.edu"</span> userid))
  (mail-subject)
  (insert <span style="color: #228b22;">"[06-640] account information"</span>)
  (mail-text)
  (insert (format <span style="color: #228b22;">"</span>
<span style="color: #228b22;">An account has been created on gilgamesh.cheme.cmu.edu</span>
<span style="color: #228b22;">userid: %s</span>
<span style="color: #228b22;">password: %s"</span> userid password))
  (mail-send-and-exit))

(send-mail <span style="color: #228b22;">"jkitchin"</span> <span style="color: #228b22;">"trustme99"</span>)
</pre>
</div>

<p>
That worked well. I ran the block and got the email. 
</p>

<p>
Now, suppose I have this data:
</p>
<table id="users" border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="left" />

<col  class="left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="left">userid</th>
<th scope="col" class="left">password</th>
</tr>
</thead>
<tbody>
<tr>
<td class="left">user1</td>
<td class="left">trustme99</td>
</tr>

<tr>
<td class="left">user2</td>
<td class="left">foolme99</td>
</tr>

<tr>
<td class="left">user3</td>
<td class="left">blameme99</td>
</tr>
</tbody>
</table>

<p>
We can pass that to a source block as a list of lists that will look like this:
</p>
<pre class="example">
 ((user1 trustme99) (user2 foolme99) (user3 blameme99))
</pre>

<p>
Then, we can use a mapcar to process each element. Here I use a dummy function with two arguments. If I substitute the function above, each of these users would get an email.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #8b0000;">defun</span> <span style="color: #8b2323;">fun</span> (a b)
  (princ (format <span style="color: #228b22;">"user: %s\npassword: %s\n"</span> a b)))

(mapcar (<span style="color: #8b0000;">lambda</span> (x) (fun (car x) (cadr x))) data)
</pre>
</div>

<pre class="example">
user: user1
password: trustme99
user: user2
password: foolme99
user: user3
password: blameme99
</pre>

<p>
I am not sure that is the best way to get the first and second elements in the list element. It looks funny to me, but it works fine. the alternative is not much prettier:
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #8b0000;">defun</span> <span style="color: #8b2323;">fun</span> (a b)
  (princ (format <span style="color: #228b22;">"user: %s\npassword: %s\n"</span> a b)))

(mapcar (<span style="color: #8b0000;">lambda</span> (x) (fun (nth 0 x) (nth 1 x))) data)
</pre>
</div>

<pre class="example">
user: user1
password: trustme99
user: user2
password: foolme99
user: user3
password: blameme99
</pre>
<p>Copyright (C) 2014 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2014/01/13/Send-email-to-a-list-of-users.org">org-mode source</a><p>

    </div>
  </div>
</article>



<a href="https://twitter.com/share" class="twitter-share-button" data-via="johnkitchin">Tweet</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>

  <div class="after_post"><a href="http://jkitchin.github.io/blog/2014/01/13/Send-email-to-a-list-of-users#disqus_thread">Read and Post Comments</a></div>
  <hr class="interblog" />
  





<article>
  <div class="blog_post">
    <header>
      <div id="Finding-bibtex-entries-with-no-downloaded-pdf"></div>
      <h2 class="blog_post_title"><a href="/blog/2014/01/08/Finding-bibtex-entries-with-no-downloaded-pdf/" rel="bookmark" title="Permanent Link to Finding bibtex entries with no downloaded pdf">Finding bibtex entries with no downloaded pdf</a></h2>
      <p><small><span class="blog_post_date">Posted January 08, 2014 at 10:27 AM</span> | categories:
        <span class="blog_post_categories"><a href='/blog/category/bibtex/'>bibtex</a></span> | tags: 
        | <a href="http://jkitchin.github.io/blog/2014/01/08/Finding-bibtex-entries-with-no-downloaded-pdf#disqus_thread">View Comments</a>
      <p><small><span class="blog_post_date">Updated January 08, 2014 at 10:41 AM</span>
      </small></p>
    </header>
    <div class="post_prose">
      



<p>
We use bibtex for bibiliography management in our group. Almost every journal provides a utility to download bibtex entries, and you can pretty easily download bibtex entries from citeulike. It doesn't take too long though before you have a few hundred entries. You need some tools to interact with that database.
</p>

<p>
Bibtex-mode in Emacs provides some tools for working with your bibtex files. For example, you can (bibtex-validate) to check if entries are correct, and (bibtex-sort-buffer) to sort them by key. 
</p>

<p>
I have a specific workflow to entering new entries. This is what I prefer to do:
</p>

<ol class="org-ol">
<li>Go to journal, get bibtex entry, paste into bibtex file.
</li>
<li>delete the key that is used, if any
</li>
<li>type C-c C-c to autogenerate a key of my style
</li>
<li>Copy the key, download the pdf, and save the pdf as (format "%s.pdf" key) in my pdfs directory.
</li>
<li>Make an entry in a notes file for that reference. These entries are initially tagged as TODO to remind me to organize them.
</li>
</ol>

<p>
Doing this has some payoffs; my org-mode cite links can open either the bibtex entry, or the pdf file directly from the org-file! The notes file is also an org-file, which I can organize as I see fit. 
</p>

<p>
Sometimes I am lazy, and do not get all these steps done, especially the pdf download step. I like to have local copies of the pdf files so I can read them even if I am offline, and because I often annotate them using a tablet PC. It also makes it easy to send them to my students if I need to. Periodically, I like to go through my bibtex database to do some maintenance, download missing files, and notes entries etc&#x2026; The problem is how do I know which entries have downloaded pdfs or note entries? It is not that difficult with a bit of elisp. 
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(find-file <span style="color: #228b22;">"~/Dropbox/bibliography/references.bib"</span>)
(bibtex-map-entries (<span style="color: #8b0000;">lambda</span> (bibtex-key start end) 
                      (<span style="color: #8b0000;">let</span> ((type  (cdr (car (bibtex-parse-entry)))))                        
                        (<span style="color: #8b0000;">unless</span> (file-exists-p 
                                 (format <span style="color: #228b22;">"~/Dropbox/bibliography/bibtex-pdfs/%s.pdf"</span> bibtex-key))
                          (princ (format <span style="color: #228b22;">"%10s:  cite:%s has no pdf\n"</span> type bibtex-key))))))
</pre>
</div>

<pre class="example">
      Book:  cite:ambrose-2010-how-learn-works has no pdf
   article:  cite:gerken-2010-fluor-modul has no pdf
      Book:  cite:gray-1973-chemic-bonds has no pdf
   ARTICLE:  cite:kitchin-2003-tio2 has no pdf
   ARTICLE:  cite:kitchin-2012-prefac has no pdf
      Book:  cite:kittel-2005-introd-solid has no pdf
   ARTICLE:  cite:mccormick-2003-tio2-pd has no pdf
   ARTICLE:  cite:mhadeshwar-2004-nh3-ru has no pdf
      Misc:  cite:ni-website has no pdf
   ARTICLE:  cite:norskov-2006-respon has no pdf
      Book:  cite:reif-1965-fundam-statis has no pdf
   article:  cite:risch-2012-water-oxidat has no pdf
   ARTICLE:  cite:shultz-1995-prepar-and has no pdf
   ARTICLE:  cite:shultz-1997-prepar has no pdf
   ARTICLE:  cite:song-2002-h3pw1 has no pdf
</pre>

<p>
Using that list, I can click on those links, which takes me to the entry in file. That entry probably has a url or doi that makes it easy to navigate to the journal page where I can download the pdf file. You could improve on the code above by filtering out only articles, for example.  
</p>
<p>Copyright (C) 2014 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2014/01/08/Finding-bibtex-entries-with-no-downloaded-pdf.org">org-mode source</a><p>

    </div>
  </div>
</article>



<a href="https://twitter.com/share" class="twitter-share-button" data-via="johnkitchin">Tweet</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>

  <div class="after_post"><a href="http://jkitchin.github.io/blog/2014/01/08/Finding-bibtex-entries-with-no-downloaded-pdf#disqus_thread">Read and Post Comments</a></div>
  <hr class="interblog" />
  





<article>
  <div class="blog_post">
    <header>
      <div id="Finding-bibtex-entries-with-non-ascii-characters"></div>
      <h2 class="blog_post_title"><a href="/blog/2014/01/08/Finding-bibtex-entries-with-non-ascii-characters/" rel="bookmark" title="Permanent Link to Finding bibtex entries with non-ascii characters">Finding bibtex entries with non-ascii characters</a></h2>
      <p><small><span class="blog_post_date">Posted January 08, 2014 at 09:49 AM</span> | categories:
        <span class="blog_post_categories"><a href='/blog/category/bibtex/'>bibtex</a></span> | tags: 
        | <a href="http://jkitchin.github.io/blog/2014/01/08/Finding-bibtex-entries-with-non-ascii-characters#disqus_thread">View Comments</a>
      </small></p>
    </header>
    <div class="post_prose">
      



<p>
I have found that some journals cannot handle bibtex entries with non-ascii characters in them. Unfortunately, when you paste bibtex entries into your reference file from the web, there are often non-ascii characters in them. Emacs usually shows those characters just fine, so it is difficult to find them. Here is a little recipe to go through each entry to find entries with non-ascii characters. These range from accented characters, greek letters, degree symbols, dashes, fancy quotes, etc&#x2026; Since they are hard to see by eye, we can let Emacs find them for us, and then replace them with the corresponding ascii LaTeX commands. 
</p>

<p>
I found a function to find non-ascii characters here: <a href="http://www.emacswiki.org/emacs/FindingNonAsciiCharacters">http://www.emacswiki.org/emacs/FindingNonAsciiCharacters</a> . Now, we use a modified version of this on each entry in a bibtex file. If we find a character, we will print an org-mode link to make it easy to get right to the entry.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #8b0000;">defun</span> <span style="color: #8b2323;">contains-non-ascii-char-p</span> ()
  <span style="color: #228b22;">"tests if buffer contains non-ascii character"</span>
  (interactive)
  (<span style="color: #8b0000;">let</span> (point)
    (<span style="color: #8b0000;">save-excursion</span>
      (setq point
            (<span style="color: #8b0000;">catch</span> '<span style="color: #cd0000;">non-ascii</span>
              (<span style="color: #8b0000;">while</span> (not (eobp))
                (or (eq (char-charset (following-char))
                        'ascii)
                    (<span style="color: #8b0000;">throw</span> '<span style="color: #cd0000;">non-ascii</span> (point)))
                (forward-char 1)))))
    (<span style="color: #8b0000;">if</span> point
        (goto-char point)
      nil)))


(find-file <span style="color: #228b22;">"~/Dropbox/bibliography/references.bib"</span>)
(bibtex-map-entries (<span style="color: #8b0000;">lambda</span> (bibtex-key start end)                        
                      (<span style="color: #8b0000;">save-restriction</span>
                        <span style="color: #ff0000; font-weight: bold;">;; </span><span style="color: #ff0000; font-weight: bold;">narrow so we only look at this entry. save-restriction will rewiden</span>
                        (bibtex-narrow-to-entry)
                        (<span style="color: #8b0000;">when</span> (contains-non-ascii-char-p) (princ (format <span style="color: #228b22;">"cite:%s"</span> bibtex-key)))))))
</pre>
</div>

<pre class="example">
cite:suntivich-2011-perov-oxide
</pre>

<p>
You can see I only had one reference in that file with a non-ascii character. I think it is best practice to replace these with pure LaTeX commands. See <a href="http://en.wikibooks.org/wiki/LaTeX/Special_Characters">http://en.wikibooks.org/wiki/LaTeX/Special_Characters</a> for a good reference on what commands are used for the accented characters.
</p>
<p>Copyright (C) 2014 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2014/01/08/Finding-bibtex-entries-with-non-ascii-characters.org">org-mode source</a><p>

    </div>
  </div>
</article>



<a href="https://twitter.com/share" class="twitter-share-button" data-via="johnkitchin">Tweet</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>

  <div class="after_post"><a href="http://jkitchin.github.io/blog/2014/01/08/Finding-bibtex-entries-with-non-ascii-characters#disqus_thread">Read and Post Comments</a></div>
  <hr class="interblog" />
  





<article>
  <div class="blog_post">
    <header>
      <div id="A-function-to-save-an-org-file-for-submitting-assignments-in-org-mode"></div>
      <h2 class="blog_post_title"><a href="/blog/2014/01/01/A-function-to-save-an-org-file-for-submitting-assignments-in-org-mode/" rel="bookmark" title="Permanent Link to A function to save an org-file for submitting assignments in org-mode">A function to save an org-file for submitting assignments in org-mode</a></h2>
      <p><small><span class="blog_post_date">Posted January 01, 2014 at 02:55 PM</span> | categories:
        <span class="blog_post_categories"><a href='/blog/category/org-mode/'>org-mode</a></span> | tags: 
        | <a href="http://jkitchin.github.io/blog/2014/01/01/A-function-to-save-an-org-file-for-submitting-assignments-in-org-mode#disqus_thread">View Comments</a>
      </small></p>
    </header>
    <div class="post_prose">
      




<p>
I am going to be assigning homeworks and quizzes in org-mode next semester, and it would be nice if there was a function that would save the file with the right name in the right place. The file will have some keywords at the top to identify the student, course and assignment. Those look like:
</p>
<pre class="example">
#+NAME: John Kitchin
#+ANDREWID: jkitchin
#+COURSE: 06-640
#+ASSIGNMENT: quiz1
</pre>

<p>
I would like a function that saves the current buffer to a file like /some-path/ANDREWID-COURSE-ASSIGNMENT.org. That will be "turning the assignment in" so I can do some analysis of the files. I previously wrote about getting keywords from org-files <a href="http://kitchingroup.cheme.cmu.edu/blog/2013/05/05/Getting-keyword-options-in-org-files/">here</a> . We will build on that to accomplish this goal. Here is the function that seems to do what I want. For now it saves the file in the same directory, with the correct name.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #8b0000;">defun</span> <span style="color: #8b2323;">submit-assignment</span> ()
  <span style="color: #228b22;">"Save current buffer to assignment. You must set #+ANDREWID, #+COURSE and #+ASSIGNMENT. There is no checking for this."</span>
  (interactive)
  (save-buffer)
  (<span style="color: #8b0000;">let</span> ((org-keywords (org-element-map (org-element-parse-buffer 'element) 'keyword
                        (<span style="color: #8b0000;">lambda</span> (keyword) (cons (org-element-property <span style="color: #cd0000;">:key</span> keyword)
                                                (org-element-property <span style="color: #cd0000;">:value</span> keyword)))))
        (assignment-content (buffer-string)) <span style="color: #ff0000; font-weight: bold;">; </span><span style="color: #ff0000; font-weight: bold;">store contents to write to file later</span>
        (assignment-filename))
    <span style="color: #ff0000; font-weight: bold;">;; </span><span style="color: #ff0000; font-weight: bold;">create the filename we will save the buffer in</span>
    (setq assignment-filename (concat (cdr (assoc <span style="color: #228b22;">"ANDREWID"</span> org-keywords))
                                      <span style="color: #228b22;">"-"</span>
                                      (cdr (assoc <span style="color: #228b22;">"COURSE"</span> org-keywords))
                                      <span style="color: #228b22;">"-"</span>
                                      (cdr (assoc <span style="color: #228b22;">"ASSIGNMENT"</span> org-keywords))
                                      <span style="color: #228b22;">".org"</span>))
    <span style="color: #ff0000; font-weight: bold;">;; </span><span style="color: #ff0000; font-weight: bold;">now write out contents to filename</span>
    (<span style="color: #8b0000;">with-temp-file</span> assignment-filename
      (insert assignment-content))
    (message <span style="color: #228b22;">"%s was submitted"</span> assignment-filename)))

(submit-assignment)
</pre>
</div>

<pre class="example">
jkitchin-06-640-quiz1.org was submitted
</pre>

<p>
Now, we have a nice function that can be put as a link in the org-file: <pre>elisp:submit-assignment</pre> , or <pre>elisp:submit-assignment</pre> . The assignment will be copied to a location specified, and I can grade it, assess it, etc&#x2026; from there. That function will have to be loaded by students, but since I provide them with lisp files that are loaded at startup that should not be an issue. 
</p>

<p>
This solution lacks some features I have to think about. For example, if the path where everyone submits to is common, everyone will be able to read the file, which is not desirable. It is also not feasible to make the submitted files read-only to the students this way (so they cannot modify the files after they turn them in). I could have the submit function do something like submit to box.com by email.
</p>

<p>
I am not sure how grading of these files would go. In the past, I have preferred PDF files (which you can export org to) because I could grade them using a tablet without modifying the actual content in the files. However it would not be simple at all to export an org-file to PDF with that data in a machine readable way. One point of having them in org-mode is that I could collect statistics from the headings of many files pretty easily. I have written code to annotate org-files in the past, which I might have to dig out. 
</p>

<p>
There is a limitation of the submit function, and that is if the org-file references images or other files (I would expect many of my assignments would have plots in them). Those would not be copied to the right place. I handle those when I publish the blog, so it could be done. But, it would require creating a new directory, and writing all the files to it (including making sure the relative paths are handled correctly), or creating some kind of zip-archive that contains everything. That sounds like a project for another day!
</p>

<div class="inlinetask">
<b><span class="todo TODO">TODO</span> rewrite the submit-assignment function to copy any images or files it links to into the submission directory</b><br  />
nil</div>
<p>Copyright (C) 2014 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2014/01/01/A-function-to-save-an-org-file-for-submitting-assignments-in-org-mode.org">org-mode source</a><p>

    </div>
  </div>
</article>



<a href="https://twitter.com/share" class="twitter-share-button" data-via="johnkitchin">Tweet</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>

  <div class="after_post"><a href="http://jkitchin.github.io/blog/2014/01/01/A-function-to-save-an-org-file-for-submitting-assignments-in-org-mode#disqus_thread">Read and Post Comments</a></div>
  <hr class="interblog" />
  





<article>
  <div class="blog_post">
    <header>
      <div id="Interactive-quizzes-with-feedback-in-org-mode"></div>
      <h2 class="blog_post_title"><a href="/blog/2014/01/01/Interactive-quizzes-with-feedback-in-org-mode/" rel="bookmark" title="Permanent Link to Interactive quizzes with feedback in org-mode">Interactive quizzes with feedback in org-mode</a></h2>
      <p><small><span class="blog_post_date">Posted January 01, 2014 at 12:58 PM</span> | categories:
        <span class="blog_post_categories"><a href='/blog/category/org-mode/'>org-mode</a></span> | tags: 
        | <a href="http://jkitchin.github.io/blog/2014/01/01/Interactive-quizzes-with-feedback-in-org-mode#disqus_thread">View Comments</a>
      </small></p>
    </header>
    <div class="post_prose">
      



<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#sec-1">1. What is 2 + 4?</a></li>
<li><a href="#sec-2">2. Lets make a custom link for this</a></li>
<li><a href="#sec-3">3. Storing quiz answers and number of attempts</a></li>
<li><a href="#sec-4">4. Using inline tasks instead of headings</a></li>
<li><a href="#sec-5">5. Concluding thoughts</a></li>
</ul>
</div>
</div>

<p>
I have been exploring ways to facilitate learning and grading. One way I like is to provide quizzes inline with text
Here are some examples of "interactive" quizzes with feedback to the user in org-mode. The principle idea is to use a headline for the question, and use properties to hold the answer. The answers are coded into links that run lisp code to check if the link text matches the correct answer. The properties are folded, so you have to willfully cheat to look at the answer. For getting instant feedback, this isn't such an issue. These aren't for formal assessment, but for knowledge checkpoints in active learning.
</p>

<p>
Blog alert: The links may only work in the actual org-file in Emacs, they will not function in html.  
</p>

<p>
Here is an example in a subheading. These links play an amusing sound (crowd cheers for correct answer, a buzzer for a wrong answer). The sounds are stored locally with the file. This gives students immediate feedback on their answer. These might be incorporated into reading assignments.
</p>

<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1"><span class="section-number-2">1</span> What is 2 + 4?</h2>
<div class="outline-text-2" id="text-1">
<p>
a) <pre>elisp:(if (string= "4" (org-entry-get (point) "CORRECT-ANSWER"))  (play-sound-file "sounds/99636__tomlija__small-crowd-yelling-yeah.wav" 0.91 nil) (play-sound-file "sounds/fail-buzzer-01.wav" 0.91 nil))</pre> 
</p>

<p>
b) <pre>elisp:(if (string= "6" (org-entry-get (point) "CORRECT-ANSWER"))  (play-sound-file "sounds/99636__tomlija__small-crowd-yelling-yeah.wav" 0.91 nil) (play-sound-file "sounds/fail-buzzer-01.wav" 0.91 nil))</pre> 
</p>

<p>
c) <pre>elisp:(if (string= "-2" (org-entry-get (point) "CORRECT-ANSWER"))  (play-sound-file "sounds/99636__tomlija__small-crowd-yelling-yeah.wav" 0.91 nil) (play-sound-file "sounds/fail-buzzer-01.wav" 0.91 nil))</pre> 
</p>
</div>
</div>
<div id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2"><span class="section-number-2">2</span> Lets make a custom link for this</h2>
<div class="outline-text-2" id="text-2">
<p>
Hand coding the links isn't very convenient. Let us write an org-link function that is more convenient. This new function will also record the number of correct and incorrect attempts. You could hard code some sound into them, but I did not do that here.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(org-add-link-type 
 <span style="color: #228b22;">"ans"</span> 
 (<span style="color: #8b0000;">lambda</span> (path) 
   (<span style="color: #8b0000;">let*</span> ((correct-answer (org-entry-get (point) <span style="color: #228b22;">"CORRECT-ANSWER"</span>))
          (ncorrect (org-entry-get (point) <span style="color: #228b22;">"NUM-CORRECT"</span>))
          (num-correct (<span style="color: #8b0000;">if</span> ncorrect (string-to-number ncorrect) 0))
          (nincorrect (org-entry-get (point) <span style="color: #228b22;">"NUM-INCORRECT"</span>))
          (num-incorrect (<span style="color: #8b0000;">if</span> nincorrect (string-to-number nincorrect) 0)))
     (<span style="color: #8b0000;">if</span> (string= path correct-answer) 
         (<span style="color: #8b0000;">progn</span>
          (org-entry-put (point) <span style="color: #228b22;">"NUM-CORRECT"</span> (number-to-string (+ num-correct 1)))
          (message <span style="color: #228b22;">"correct"</span>))
       (org-entry-put (point) <span style="color: #228b22;">"NUM-INCORRECT"</span> (number-to-string (+ num-incorrect 1)))
       (message <span style="color: #228b22;">"incorrect"</span>)))))
</pre>
</div>

<p>
That function was a bit trickier than I thought it would be. First, I used let* because the first time you click on a link the correct answer counters may not exist, so getting the property would return nil. If it is nil, then we should initialize to 0. If it is not nil, we need to convert the string that is returned to an integer so we can add to it later. Then, we need to convert that integer back to a string to store it as a property, otherwise it is stored as some strange control character. 
</p>

<p>
Now, we can put our question in.
question: Is 3 greater than 2?
</p>

<p>
Here are the new links:  <pre>ans:yes</pre> <pre>ans:no</pre> 
</p>


<p>
That function goes along way to making it pretty easy to write the answers. One limitation here is that you can only put one question per section. We address that later. It is still easy to cheat if you want. We could do a few things to make that harder. One idea would be to encrypt the answers, and compare the hash of the answers. Another is to just record what was clicked on, and then grade it later. In the next section we try that out.
</p>
</div>
</div>
<div id="outline-container-sec-3" class="outline-2">
<h2 id="sec-3"><a id="ID-fa6cc63f-e2da-47a7-9721-cb970dde335e" name="ID-fa6cc63f-e2da-47a7-9721-cb970dde335e"></a><span class="section-number-2">3</span> Storing quiz answers and number of attempts</h2>
<div class="outline-text-2" id="text-3">

<p>
Here, we store the answer, and number of attempts. Students won't get feedback from this approach, but they cannot cheat either. They could just type answers in to the org-file, but this approach is like a Scantron multiple choice exam that could be automatically graded later. You could use something like this as an electronic clicker to quickly assess everyone's understanding of some concepts.
</p>

<p>
Here is our new link function.
</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp">(org-add-link-type 
 <span style="color: #228b22;">"ans2"</span> 
 (<span style="color: #8b0000;">lambda</span> (path) 
   (org-entry-put (point) <span style="color: #228b22;">"ANSWER"</span> path)
   (<span style="color: #8b0000;">let*</span> ((nattempts (org-entry-get (point) <span style="color: #228b22;">"NUM-ATTEMPTS"</span>))
          (num-attempts (<span style="color: #8b0000;">if</span> nattempts (string-to-number nattempts) 0)))
     (org-entry-put (point) <span style="color: #228b22;">"NUM-ATTEMPTS"</span> (number-to-string (+ num-attempts 1))))
   (message <span style="color: #228b22;">"You selected %s for your answer"</span> path)))
</pre>
</div>

<p>
And now a question: Is 3 greater than 2?
<pre>ans2:yes</pre> <pre>ans2:no</pre> 
</p>

<p>
This way works very well. It might also be a good idea to give each question a unique id (org-id-get-create) so you can collect specific results. 
</p>
</div>
</div>
<div id="outline-container-sec-4" class="outline-2">
<h2 id="sec-4"><span class="section-number-2">4</span> Using inline tasks instead of headings</h2>
<div class="outline-text-2" id="text-4">
<p>
If you were integrating these into a book, it would be inconvenient to use headings because they would mess up the outline. We can use inline tasks instead.
</p>

<div class="inlinetask">
<b>Is 3 greater than 2?</b><br  />
<p>
<pre>ans2:yes</pre> <pre>ans2:no</pre> 
</p>
</div>

<p>
This adds some additional lines, but does not change the heading level. We can put multiple questions in then.
</p>

<div class="inlinetask">
<b>What is 4*4?</b><br  />
<p>
<pre>ans2:16</pre> <pre>ans2:18</pre> <pre>ans2:8</pre> 
</p>
</div>

<p>
Interesing, I noticed in this last example that a link path must have at least two characters to be automatically recognized by org-mode. I had to put double square brackets to make it a link!
</p>
</div>
</div>
<div id="outline-container-sec-5" class="outline-2">
<h2 id="sec-5"><span class="section-number-2">5</span> Concluding thoughts</h2>
<div class="outline-text-2" id="text-5">
<p>
This seems like a pretty promising approach to getting structured input from students. You would have to invest some time training them to use emacs and org-mode, and not modify the file in ways they are not supposed to.  You would also have to invest some time in writing analysis code to collect all the answers and analyze them somehow. I do not think that would be too hard though, and the payoff could be large. By giving students quick feedback they could have a better understanding of what they know, and might ask better questions. This could be a useful approach to active learning activities that students work on while reading.
</p>
</div>
</div>
<p>Copyright (C) 2014 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2014/01/01/Interactive-quizzes-with-feedback-in-org-mode.org">org-mode source</a><p>

    </div>
  </div>
</article>



<a href="https://twitter.com/share" class="twitter-share-button" data-via="johnkitchin">Tweet</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>

  <div class="after_post"><a href="http://jkitchin.github.io/blog/2014/01/01/Interactive-quizzes-with-feedback-in-org-mode#disqus_thread">Read and Post Comments</a></div>
  <hr class="interblog" />
 <a href="../64">« Previous Page</a>
  --  
 <a href="../66">Next Page »</a>

          </div>
          <div id="sidebar" class="grid_4">
            <aside>
<section>
<script>
  (function() {
    var cx = '002533177287215655227:l7uvu35ssbc';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
        '//www.google.com/cse/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>
</section>

<section>
    <h1 class="post_header_gradient theme_font">Twitter</h1>
    <a class="twitter-timeline" href="https://twitter.com/johnkitchin" data-widget-id="545217643582881792">Tweets by @johnkitchin</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+"://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
</section>


  <section>
    <h1 class="post_header_gradient theme_font">Links</h1>
    <ul>
      <li><a href="https://www.continuum.io">Anaconda Python</a></li>
      <li><a href="/pycse">Pycse</a></li>
      <li><a href="/dft-book">DFT-book</a></li>
    </ul>
  </section>

  <section>
    <h1 class="post_header_gradient theme_font">Latest Posts</h1>
    <ul>
      <li><a href="/blog/2018/05/14/f-strings-in-emacs-lisp/">f-strings in emacs-lisp</a></li>
      <li><a href="/blog/2018/05/09/Making-it-easier-to-extend-the-export-of-org-mode-links-with-generic-functions/">Making it easier to extend the export of org-mode links with generic functions</a></li>
      <li><a href="/blog/2018/04/16/New-publication-in-Nature-Catalysis/">New publication in Nature Catalysis</a></li>
      <li><a href="/blog/2018/04/11/Caching-searches-using-biblio-and-only-seeing-new-results/">Caching searches using biblio and only seeing new results</a></li>
      <li><a href="/blog/2018/04/09/Zhitao-Guo-receives-the-2017-2018-James-C-Meade-Fellowship-in-Chemical-Engineering/">Zhitao Guo receives the 2017-2018 James C. Meade Fellowship in Chemical Engineering</a></li>
    </ul>
  </section>

<section>
<h1 class="post_header_gradient theme_font">Latest GitHub Repos</h1>
  <a href="https://github.com/jkitchin">@jkitchin</a> on GitHub.
  <ul id="my-github-projects">
        <li class="loading">Status updating&#8230;</li>
  </ul>

</section>
</aside>

          </div>
          <div class="clear"></div>
        </div>
      </div>
      
<footer>
  <div id="footer" class="grid_12">
    <div class="grid_8">
      <p>
        <a href="/blog/feed/index.xml">RSS</a>
        <a href="http://kitchinresearchgroup.disqus.com/latest.rss">Comments RSS Feed</a>.
      </p>
    </div>
    <div class="grid_4" id="credits">
      <p>
        Copyright 2018
        John Kitchin
      </p>
      <p>
        Powered by <a href="http://www.blogofile.com">Blogofile</a>
      </p>
    </div>
  </div>
</footer>

    </div>
      <script src="//ajax.googleapis.com/ajax/libs/jquery/1.5.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="/js/libs/jquery-1.5.1.min.js"%3E%3C/script%3E'))</script>
  <script src="/js/plugins.js"></script>
  <script src="/js/script.js"></script>
  <script src="/js/jquery.tweet.js"></script>  
  <script src="/js/site.js"></script>
  <!--[if lt IE 7 ]>
  <script src="js/libs/dd_belatedpng.js"></script>
  <script> DD_belatedPNG.fix('img, .png_bg');</script>
  <![endif]-->
  <script>
      var _gaq=[['_setAccount','UA-35731398-1'],['_trackPageview']];
      (function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];g.async=1;
      g.src=('https:'==location.protocol?'//ssl':'//www')+'.google-analytics.com/ga.js';
      s.parentNode.insertBefore(g,s)}(document,'script'));
  </script>
  <script>
  (function() {
      var links = document.getElementsByTagName('a');
      var query = '?';
      for(var i = 0; i < links.length; i++) {
          if(links[i].href.indexOf('#disqus_thread') >= 0) {
              query += 'url' + i + '=' + encodeURIComponent(links[i].href) + '&';
          }
      }
      document.write('<script charset="utf-8" type="text/javascript" src="http://disqus.com/forums/kitchinresearchgroup/get_num_replies.js' + query + '"></' + 'script>');
  })();
  </script>

  </body>
</html>






<script src="http://ajax.microsoft.com/ajax/jquery/jquery-1.4.2.min.js" type="text/javascript"></script>
<script src="/js/git.js" type="text/javascript"></script>
<script type="text/javascript">
    $(function() {
     $("#my-github-projects").loadRepositories("jkitchin");
    });
</script>



