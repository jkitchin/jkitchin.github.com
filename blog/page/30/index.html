

<!doctype html>
<!--[if lt IE 7 ]> <html lang="en" class="no-js ie6"> <![endif]-->
<!--[if IE 7 ]>    <html lang="en" class="no-js ie7"> <![endif]-->
<!--[if IE 8 ]>    <html lang="en" class="no-js ie8"> <![endif]-->
<!--[if IE 9 ]>    <html lang="en" class="no-js ie9"> <![endif]-->
<!--[if (gt IE 9)|!(IE)]><!--> <html lang="en" class="no-js"> <!--<![endif]-->
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>The Kitchin Research Group</title>
  <meta name="google-site-verification" content="CGcacJdHc2YoZyI0Vey9XRA5qwhhFDzThKJezbRFcJ4" />
  <meta name="description" content="Chemical Engineering at Carnegie Mellon University">
  <meta name="author" content="John Kitchin">
  <link rel="alternate" type="application/rss+xml" title="RSS 2.0" href="/blog/feed" />
  <link rel="alternate" type="application/atom+xml" title="Atom 1.0" href="/blog/feed/atom" />
  <link rel="shortcut icon" href="/favicon.ico">
  <link rel="apple-touch-icon" href="/img/apple-touch-icon.png">

  <link rel="stylesheet" href="/css/base.css?v=1">
  <link rel="stylesheet" href="/css/grid.css?v=1">
  <link rel="stylesheet" media="handheld" href="/css/handheld.css?v=1">
  <link rel="stylesheet" href="/css/pygments_murphy.css" type="text/css" />

  <script src="/js/libs/modernizr-1.7.min.js"></script>
<script type="text/javascript"
  src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
  <link rel="stylesheet" href="/themes/theme1/style.css?v=1">
<link href='http://fonts.googleapis.com/css?family=Roboto' rel='stylesheet' type='text/css'>

</head>
  <body>
    <div id="container" class="container container_12">
      <div id="main" role="main">
        <div id="main_block">
          <header>
<div id="header" class="header_gradient theme_font">
<table><tr><td>
    <h1><a href="/">The Kitchin Research Group</a></h1>
    <h2>Chemical Engineering at Carnegie Mellon University</h2>
</td>
<td colspan=100%><div style="float:right;width:100%;text-align:right;"> <span id='badgeCont737515' style='width:126px'><script src='http://labs.researcherid.com/mashlets?el=badgeCont737515&mashlet=badge&showTitle=false&className=a&rid=A-2363-2010'></script></span></div>
</td></tr>
</table>
</div>
  <div id="navigation" class="grid_12">

    <ul class="theme_font">
      <li><a href="/blog"
             class="">Blog</a></li>

      <li><a href="/blog/archive"
             class="">Archives</a></li>

      <li><a href="http://www.researcherid.com/rid/A-2363-2010" target="_new">Publications</a></li>

      <li><a href="/research.html"
             class="">Research</a></li>

      <li><a href="/group.html"
             class="">Group</a></li>

      <li><a href="/categories.html"
             class="">Categories</a></li>

      <li><a href="/about.html"
             class="">About us</a></li>
    </ul>
  </div>
</header>

          <div id="prose_block" class="grid_8">
            
  





<article>
  <div class="blog_post">
    <header>
      <div id="Numerical-Simpsons-rule"></div>
      <h2 class="blog_post_title"><a href="/blog/2013/03/08/Numerical-Simpsons-rule/" rel="bookmark" title="Permanent Link to Numerical Simpsons rule">Numerical Simpsons rule</a></h2>
      <p><small><span class="blog_post_date">Posted March 08, 2013 at 06:18 PM</span> | categories: 
        <span class="blog_post_categories"><a href='/blog/category/integration/'>integration</a>, <a href='/blog/category/math/'>math</a></span> | tags: 
        | <a href="http://jkitchin.github.io/blog/2013/03/08/Numerical-Simpsons-rule#disqus_thread">View Comments</a>
      </small></p>
    </header>
    <div class="post_prose">
      



<p>

A more accurate numerical integration than the trapezoid method is <a href="http://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.simps.html" >Simpson's rule</a>. The syntax is similar to trapz, but the method is in scipy.integrate.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">import</span> numpy <span style="color: #8b0000;">as</span> np
<span style="color: #8b0000;">from</span> scipy.integrate <span style="color: #8b0000;">import</span> simps, romb

a = 0.0; b = np.pi / 4.0;
N = 10  <span style="color: #ff0000; font-weight: bold;"># this is the number of intervals</span>

x = np.linspace(a, b, N)
y = np.cos(x)

t = np.trapz(y, x)
s = simps(y, x)
a = np.sin(b) - np.sin(a)

<span style="color: #8b0000;">print</span>
<span style="color: #8b0000;">print</span> <span style="color: #228b22;">'trapz = {0} ({1:%} error)'</span>.format(t, (t - a)/a)
<span style="color: #8b0000;">print</span> <span style="color: #228b22;">'simps = {0} ({1:%} error)'</span>.format(s, (s - a)/a)
<span style="color: #8b0000;">print</span> <span style="color: #228b22;">'analy = {0}'</span>.format(a)
</pre>
</div>

<pre class="example">
&gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt;
trapz = 0.70665798038 (-0.063470% error)
simps = 0.707058914216 (-0.006769% error)
analy = 0.707106781187
</pre>

<p>
You can see the Simpson's method is more accurate than the trapezoid method.
</p>
<p>Copyright (C) 2013 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2013/03/08/Numerical-Simpsons-rule.org">org-mode source</a><p>

    </div>
  </div>
</article>



  <div class="after_post"><a href="http://jkitchin.github.io/blog/2013/03/08/Numerical-Simpsons-rule#disqus_thread">Read and Post Comments</a></div>
  <hr class="interblog" />
  





<article>
  <div class="blog_post">
    <header>
      <div id="Uncertainty-in-implicit-functions"></div>
      <h2 class="blog_post_title"><a href="/blog/2013/03/08/Uncertainty-in-implicit-functions/" rel="bookmark" title="Permanent Link to Uncertainty in implicit functions">Uncertainty in implicit functions</a></h2>
      <p><small><span class="blog_post_date">Posted March 08, 2013 at 05:04 PM</span> | categories: 
        <span class="blog_post_categories"><a href='/blog/category/statistics/'>statistics</a></span> | tags: 
        | <a href="http://jkitchin.github.io/blog/2013/03/08/Uncertainty-in-implicit-functions#disqus_thread">View Comments</a>
      <p><small><span class="blog_post_date">Updated March 14, 2013 at 03:34 PM</span>
      </small></p>
    </header>
    <div class="post_prose">
      



<p>
Suppose we have an equation \(y = e^{a y}\) that we want to solve, where \(a\) is a constant with some uncertainty. What is the uncertainty in the solution \(y\)?
</p>

<p>
Finding a solution is not difficult. The uncertainty in the solution, however, is not easy, since we do not have an explicit function to propagate errors through. Let us examine the solution first.
</p>
<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">import</span> numpy <span style="color: #8b0000;">as</span> np
<span style="color: #8b0000;">from</span> scipy.optimize <span style="color: #8b0000;">import</span> fsolve

a = 0.20

<span style="color: #8b0000;">def</span> <span style="color: #8b2323;">f</span>(y):
    <span style="color: #8b0000;">return</span> y - np.exp(a * y)

sol, = fsolve(f, 1)
<span style="color: #8b0000;">print</span> sol
</pre>
</div>

<pre class="example">
1.2958555091
</pre>

<p>
A way to estimate the uncertainty is by Monte Carlo simulation. We solve the equation many times, using values sampled from the uncertainty distribution. Here we assume that the \(a\) parameter is normally distributed  with an average of 0.2 and a std deviation of 0.02. We solve the equation 10000 times for different values of \(a\) sampled according to the normal distribution. That gives us a distribution of solutions that we can do statistical analysis of to get the average and std deviation.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">import</span> numpy <span style="color: #8b0000;">as</span> np
<span style="color: #8b0000;">from</span> scipy.optimize <span style="color: #8b0000;">import</span> fsolve
N = 10000

A = np.random.normal(0.2, 0.02, size=N)

sol = np.zeros(A.shape)

<span style="color: #8b0000;">for</span> i, a <span style="color: #8b0000;">in</span> <span style="color: #8b0000;">enumerate</span>(A):
    s, = fsolve(<span style="color: #8b0000;">lambda</span> y:y - np.exp(a * y), 1)
    sol[i] = s

ybar = np.mean(sol)
s_y = np.std(sol)

<span style="color: #8b0000;">print</span> ybar, s_y, s_y / ybar

<span style="color: #8b0000;">import</span> matplotlib.pyplot <span style="color: #8b0000;">as</span> plt
count, bins, ignored = plt.hist(sol)
plt.savefig(<span style="color: #228b22;">'images/implicit-uncertainty.png'</span>)
</pre>
</div>

<pre class="example">
1.29887470397 0.0465110111613 0.0358086973433
</pre>

<p>
We get approximately the same answer, and you can see here the distribution of solution values is not quite normal. We compute the standard deviation anyway, and find the standard deviation is about 3.6%. It would be nice to have some analytical method to estimate this uncertainty. So far I have not figured that out.
</p>

<p>
This method could have relevance in estimating the uncertainty in the friction factor for turbulent flow (\(Re > 2100\)). In that case we have the implicit equation \(\frac{1}{\sqrt{f_F}}=4.0 \log(Re \sqrt{f_F})-0.4\). Uncertainties in the Re number would lead to uncertainties in the friction factor. Whether those uncertainties are larger than the uncertainties from the original correlation would require some investigation.
</p>
<p>Copyright (C) 2013 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2013/03/08/Uncertainty-in-implicit-functions.org">org-mode source</a><p>

    </div>
  </div>
</article>



  <div class="after_post"><a href="http://jkitchin.github.io/blog/2013/03/08/Uncertainty-in-implicit-functions#disqus_thread">Read and Post Comments</a></div>
  <hr class="interblog" />
  





<article>
  <div class="blog_post">
    <header>
      <div id="Interacting-with-Excel-in-python"></div>
      <h2 class="blog_post_title"><a href="/blog/2013/03/08/Interacting-with-Excel-in-python/" rel="bookmark" title="Permanent Link to Interacting with Excel in python">Interacting with Excel in python</a></h2>
      <p><small><span class="blog_post_date">Posted March 08, 2013 at 02:39 PM</span> | categories: 
        <span class="blog_post_categories"><a href='/blog/category/programming/'>programming</a></span> | tags: 
        | <a href="http://jkitchin.github.io/blog/2013/03/08/Interacting-with-Excel-in-python#disqus_thread">View Comments</a>
      </small></p>
    </header>
    <div class="post_prose">
      



<p>
<a href="http://matlab.cheme.cmu.edu/2011/08/07/manipulating-excel-with-matlab/" >Matlab post</a>
</p>

<p>
There will be times it is convenient to either read data from Excel, or write data to Excel. This is possible in python (<a href="http://www.python-excel.org/" >http://www.python-excel.org/</a>). You may also look at (<a href="https://bitbucket.org/ericgazoni/openpyxl/wiki/Home" >https://bitbucket.org/ericgazoni/openpyxl/wiki/Home</a>).
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">import</span> xlrd

wb = xlrd.open_workbook(<span style="color: #228b22;">'data/example.xlsx'</span>)
sh1 = wb.sheet_by_name(u<span style="color: #228b22;">'Sheet1'</span>)

<span style="color: #8b0000;">print</span> sh1.col_values(0)  <span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">column 0</span>
<span style="color: #8b0000;">print</span> sh1.col_values(1)  <span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">column 1</span>

sh2 = wb.sheet_by_name(u<span style="color: #228b22;">'Sheet2'</span>)

x = sh2.col_values(0)  <span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">column 0</span>
y = sh2.col_values(1)  <span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">column 1</span>

<span style="color: #8b0000;">import</span> matplotlib.pyplot <span style="color: #8b0000;">as</span> plt
plt.plot(x, y)
plt.savefig(<span style="color: #228b22;">'images/excel-1.png'</span>)
</pre>
</div>

<pre class="example">
[u'value', u'function']
[2.0, 3.0]
</pre>

<p><img src="/img/./images/excel-1.png"><p>

<div id="outline-container-1" class="outline-2">
<h2 id="sec-1"><span class="section-number-2">1</span> Writing Excel workbooks</h2>
<div class="outline-text-2" id="text-1">
<p>
Writing data to Excel sheets is pretty easy. Note, however, that this overwrites the worksheet if it already exists.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">import</span> xlwt
<span style="color: #8b0000;">import</span> numpy <span style="color: #8b0000;">as</span> np

x = np.linspace(0, 2)
y = np.sqrt(x)

<span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">save the data</span>
book = xlwt.Workbook()

sheet1 = book.add_sheet(<span style="color: #228b22;">'Sheet 1'</span>)

<span style="color: #8b0000;">for</span> i <span style="color: #8b0000;">in</span> <span style="color: #8b0000;">range</span>(len(x)):
    sheet1.write(i, 0, x[i])
    sheet1.write(i, 1, y[i])

book.save(<span style="color: #228b22;">'data/example2.xls'</span>) <span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">maybe can only write .xls format</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-2" class="outline-2">
<h2 id="sec-2"><span class="section-number-2">2</span> Updating an existing Excel workbook</h2>
<div class="outline-text-2" id="text-2">
<p>
It turns out you have to make a copy of an existing workbook, modify the copy and then write out the results using the <code>xlwt</code> module.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">from</span> xlrd <span style="color: #8b0000;">import</span> open_workbook

<span style="color: #8b0000;">from</span> xlutils.copy <span style="color: #8b0000;">import</span> copy

rb = open_workbook(<span style="color: #228b22;">'data/example2.xls'</span>,formatting_info=<span style="color: #8b0000;">True</span>)
rs = rb.sheet_by_index(0)

wb = copy(rb)

ws = wb.add_sheet(<span style="color: #228b22;">'Sheet 2'</span>)
ws.write(0, 0, <span style="color: #228b22;">"Appended"</span>)

wb.save(<span style="color: #228b22;">'data/example2.xls'</span>)
</pre>
</div>
</div>
</div>
<div id="outline-container-3" class="outline-2">
<h2 id="sec-3"><span class="section-number-2">3</span> Summary</h2>
<div class="outline-text-2" id="text-3">
<p>
Matlab has better support for interacting with Excel than python does right now. You could get better Excel interaction via COM, but that is Windows specific, and requires you to have Excel installed on your computer. 
If you only need to read or write data, then xlrd/xlwt or the openpyxl modules will server you well.
</p>
</div>
</div>
<p>Copyright (C) 2013 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2013/03/08/Interacting-with-Excel-in-python.org">org-mode source</a><p>

    </div>
  </div>
</article>



  <div class="after_post"><a href="http://jkitchin.github.io/blog/2013/03/08/Interacting-with-Excel-in-python#disqus_thread">Read and Post Comments</a></div>
  <hr class="interblog" />
  





<article>
  <div class="blog_post">
    <header>
      <div id="A-nonlinear-BVP"></div>
      <h2 class="blog_post_title"><a href="/blog/2013/03/08/A-nonlinear-BVP/" rel="bookmark" title="Permanent Link to A nonlinear BVP">A nonlinear BVP</a></h2>
      <p><small><span class="blog_post_date">Posted March 08, 2013 at 09:19 AM</span> | categories: 
        <span class="blog_post_categories"><a href='/blog/category/pde/'>pde</a></span> | tags: 
        | <a href="http://jkitchin.github.io/blog/2013/03/08/A-nonlinear-BVP#disqus_thread">View Comments</a>
      </small></p>
    </header>
    <div class="post_prose">
      



<p>

Adapted from Example 8.7 in _Numerical Methods in Engineering with Python_ by Jaan Kiusalaas.
</p>

<p>
We want to solve \(y''(x) = -3 y(x) y'(x)\) with $y(0) = 0 and \(y(2) = 1\) using a finite difference method. We discretize the region and approximate the derivatives as:
</p>

<p>
\(y''(x) \approx \frac{y_{i-1} - 2 y_i + y_{i+1}}{h^2} \)
</p>

<p>
\(y'(x) \approx \frac{y_{i+1} - y_{i-1}}{2 h} \)
</p>

<p>
We define a function \(y''(x) = F(x, y, y')\). At each node in our discretized region, we will have an equation that looks like \(y''(x) - F(x, y, y') = 0\), which will be nonlinear in the unknown solution \(y\). The set of equations to solve is:
</p>

\begin{eqnarray}
y_0 - \alpha &=& 0 \\
\frac{y_{i-1} - 2 y_i + y_{i+1}}{h^2} + (3 y_i) (\frac{y_{i+1} - y_{i-1}}{2 h}) &=& 0 \\
y_L - \beta &=&0
\end{eqnarray}

<p>
Since we use a nonlinear solver, we will have to provide an initial guess to the solution. We will in this case assume a line. In other cases, a bad initial guess may lead to no solution.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">import</span> numpy <span style="color: #8b0000;">as</span> np
<span style="color: #8b0000;">from</span> scipy.optimize <span style="color: #8b0000;">import</span> fsolve
<span style="color: #8b0000;">import</span> matplotlib.pyplot <span style="color: #8b0000;">as</span> plt

x1 = 0.0
x2 = 2.0

alpha = 0.0
beta = 1.0

N = 11
X = np.linspace(x1, x2, N)
h = (x2 - x1) / (N - 1)

<span style="color: #8b0000;">def</span> <span style="color: #8b2323;">Ypp</span>(x, y, yprime):
    <span style="color: #228b22;">'''define y'' = 3*y*y' '''</span>
    <span style="color: #8b0000;">return</span> -3.0 * y * yprime

<span style="color: #8b0000;">def</span> <span style="color: #8b2323;">residuals</span>(y):
    <span style="color: #228b22;">'''When we have the right values of y, this function will be zero.'''</span>

    res = np.zeros(y.shape)

    res[0] = y[0] - alpha
    
    <span style="color: #8b0000;">for</span> i <span style="color: #8b0000;">in</span> <span style="color: #8b0000;">range</span>(1, N - 1):
        x = X[i]
        YPP = (y[i - 1] - 2 * y[i] + y[i + 1]) / h**2
        YP = (y[i + 1] - y[i - 1]) / (2 * h)
        res[i] = YPP - Ypp(x, y[i], YP)

    res[-1] = y[-1] - beta
    <span style="color: #8b0000;">return</span> res

<span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">we need an initial guess</span>
init = alpha + (beta - alpha) / (x2 - x1) * X

Y = fsolve(residuals, init)

plt.plot(X, Y)
plt.savefig(<span style="color: #228b22;">'images/bvp-nonlinear-1.png'</span>)
</pre>
</div>

<p><img src="/img/./images/bvp-nonlinear-1.png"><p>

<p>
That code looks useful, so I put it in the pycse module in the function BVP_nl. Here is an example usage. We have to create two functions, one for the differential equation, and one for the initial guess.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">from</span> pycse <span style="color: #8b0000;">import</span>  BVP_nl
<span style="color: #8b0000;">import</span> matplotlib.pyplot <span style="color: #8b0000;">as</span> plt

<span style="color: #8b0000;">def</span> <span style="color: #8b2323;">Ypp</span>(x, y, yprime):
    <span style="color: #228b22;">'''define y'' = 3*y*y' '''</span>
    <span style="color: #8b0000;">return</span> -3.0 * y * yprime

<span style="color: #8b0000;">def</span> <span style="color: #8b2323;">init</span>(x):
    <span style="color: #8b0000;">return</span> alpha + (beta - alpha) / (x2 - x1) * x

x1 = 0.0
x2 = 2.0

alpha = 0.0
beta = 1.0

N = 11
x, y = BVP_nl(Ypp, x1, x2, alpha, beta, init, N)

plt.plot(x, y)
plt.savefig(<span style="color: #228b22;">'images/bvp-nonlinear-2.png'</span>)
</pre>
</div>

<p><img src="/img/./images/bvp-nonlinear-2.png"><p>

<p>
The results are the same.
</p>
<p>Copyright (C) 2013 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2013/03/08/A-nonlinear-BVP.org">org-mode source</a><p>

    </div>
  </div>
</article>



  <div class="after_post"><a href="http://jkitchin.github.io/blog/2013/03/08/A-nonlinear-BVP#disqus_thread">Read and Post Comments</a></div>
  <hr class="interblog" />
  





<article>
  <div class="blog_post">
    <header>
      <div id="Transient-heat-conduction-partial-differential-equations"></div>
      <h2 class="blog_post_title"><a href="/blog/2013/03/07/Transient-heat-conduction-partial-differential-equations/" rel="bookmark" title="Permanent Link to Transient heat conduction - partial differential equations">Transient heat conduction - partial differential equations</a></h2>
      <p><small><span class="blog_post_date">Posted March 07, 2013 at 03:54 PM</span> | categories: 
        <span class="blog_post_categories"><a href='/blog/category/pde/'>pde</a></span> | tags: <a href='/blog/tag/heat-transfer/'>heat transfer</a>
        | <a href="http://jkitchin.github.io/blog/2013/03/07/Transient-heat-conduction-partial-differential-equations#disqus_thread">View Comments</a>
      <p><small><span class="blog_post_date">Updated March 07, 2013 at 04:25 PM</span>
      </small></p>
    </header>
    <div class="post_prose">
      



<p>
<a href="http://matlab.cheme.cmu.edu/2011/08/21/transient-heat-conduction-partial-differential-equations/" >Matlab post</a>
adapated from <a href="http://msemac.redwoods.edu/~darnold/math55/DEproj/sp02/AbeRichards/slideshowdefinal.pdf" >http://msemac.redwoods.edu/~darnold/math55/DEproj/sp02/AbeRichards/slideshowdefinal.pdf</a>

</p>

<p>
We solved a steady state BVP modeling heat conduction. Today we examine the transient behavior of a rod at constant T put between two heat reservoirs at different temperatures, again T1 = 100, and T2 = 200. The rod will start at 150. Over time, we should expect a solution that approaches the steady state solution: a linear temperature profile from one side of the rod to the other.
</p>

<p>
\(\frac{\partial u}{\partial t} = k \frac{\partial^2 u}{\partial x^2}\)
</p>

<p>
at \(t=0\), in this example we have \(u_0(x) = 150\) as an initial condition. with boundary conditions \(u(0,t)=100\) and \(u(L,t)=200\).
</p>

<p>
In Matlab there is the pdepe command. There is not yet a PDE solver in scipy. Instead, we will utilze the method of lines to solve this problem. We discretize the rod into segments, and approximate the second derivative in the spatial dimension as \(\frac{\partial^2 u}{\partial x^2} = (u(x + h) - 2 u(x) + u(x-h))/ h^2\) at each node. This leads to a set of coupled ordinary differential equations that is easy to solve.
</p>

<p>
Let us say the rod has a length of 1, \(k=0.02\), and solve for the time-dependent temperature profiles.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">import</span> numpy <span style="color: #8b0000;">as</span> np
<span style="color: #8b0000;">from</span> scipy.integrate <span style="color: #8b0000;">import</span> odeint
<span style="color: #8b0000;">import</span> matplotlib.pyplot <span style="color: #8b0000;">as</span> plt

N = 100  <span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">number of points to discretize</span>
L = 1.0
X = np.linspace(0, L, N) <span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">position along the rod</span>
h = L / (N - 1)

k = 0.02

<span style="color: #8b0000;">def</span> <span style="color: #8b2323;">odefunc</span>(u, t):
    dudt = np.zeros(X.shape)

    dudt[0] = 0 <span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">constant at boundary condition</span>
    dudt[-1] = 0

    <span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">now for the internal nodes</span>
    <span style="color: #8b0000;">for</span> i <span style="color: #8b0000;">in</span> <span style="color: #8b0000;">range</span>(1, N-1):
        dudt[i] = k * (u[i + 1] - 2*u[i] + u[i - 1]) / h**2

    <span style="color: #8b0000;">return</span> dudt

init = 150.0 * np.ones(X.shape) <span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">initial temperature</span>
init[0] = 100.0  <span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">one boundary condition</span>
init[-1] = 200.0 <span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">the other boundary condition</span>

tspan = np.linspace(0.0, 5.0, 100)
sol = odeint(odefunc, init, tspan)


<span style="color: #8b0000;">for</span> i <span style="color: #8b0000;">in</span> <span style="color: #8b0000;">range</span>(0, <span style="color: #8b0000;">len</span>(tspan), 5):
    plt.plot(X, sol[i], label=<span style="color: #228b22;">'t={0:1.2f}'</span>.format(tspan[i]))

<span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">put legend outside the figure</span>
plt.legend(loc=<span style="color: #228b22;">'center left'</span>, bbox_to_anchor=(1, 0.5))
plt.xlabel(<span style="color: #228b22;">'X position'</span>)
plt.ylabel(<span style="color: #228b22;">'Temperature'</span>)

<span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">adjust figure edges so the legend is in the figure</span>
plt.subplots_adjust(top=0.89, right=0.77)
plt.savefig(<span style="color: #228b22;">'images/pde-transient-heat-1.png'</span>)


<span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">Make a 3d figure</span>
<span style="color: #8b0000;">from</span> mpl_toolkits.mplot3d <span style="color: #8b0000;">import</span> Axes3D
fig = plt.figure()
ax = fig.add_subplot(111, projection=<span style="color: #228b22;">'3d'</span>)

SX, ST = np.meshgrid(X, tspan)
ax.plot_surface(SX, ST, sol, cmap=<span style="color: #228b22;">'jet'</span>)
ax.set_xlabel(<span style="color: #228b22;">'X'</span>)
ax.set_ylabel(<span style="color: #228b22;">'time'</span>)
ax.set_zlabel(<span style="color: #228b22;">'T'</span>)
ax.view_init(elev=15, azim=-124) <span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">adjust view so it is easy to see</span>
plt.savefig(<span style="color: #228b22;">'images/pde-transient-heat-3d.png'</span>)

<span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">animated solution. We will use imagemagick for this</span>

<span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">we save each frame as an image, and use the imagemagick convert command to </span>
<span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">make an animated gif</span>
<span style="color: #8b0000;">for</span> i <span style="color: #8b0000;">in</span> <span style="color: #8b0000;">range</span>(len(tspan)):
    plt.clf()
    plt.plot(X, sol[i])
    plt.xlabel(<span style="color: #228b22;">'X'</span>)
    plt.ylabel(<span style="color: #228b22;">'T(X)'</span>)
    plt.title(<span style="color: #228b22;">'t = {0}'</span>.format(tspan[i]))
    plt.savefig(<span style="color: #228b22;">'___t{0:03d}.png'</span>.format(i))

<span style="color: #8b0000;">import</span> commands
<span style="color: #8b0000;">print</span> commands.getoutput(<span style="color: #228b22;">'convert -quality 100 ___t*.png images/transient_heat.gif'</span>)
<span style="color: #8b0000;">print</span> commands.getoutput(<span style="color: #228b22;">'rm ___t*.png'</span>) <span style="color: #ff0000; font-weight: bold;">#</span><span style="color: #ff0000; font-weight: bold;">remove temp files</span>
</pre>
</div>

<pre class="example">
</pre>

<p>
This version of the graphical solution is not that easy to read, although with some study you can see the solution evolves from the initial condition which is flat, to the steady state solution which is a linear temperature ramp.
<p><img src="/img/./images/pde-transient-heat-1.png"><p>
</p>

<p>
The 3d version may be easier to interpret. The temperature profile starts out flat, and gradually changes to the linear ramp.
<p><img src="/img/./images/pde-transient-heat-3d.png"><p>
</p>

<p>
Finally, the animated solution.
</p>

<p><img src="/img/./images/transient_heat.gif"><p>
<p>Copyright (C) 2013 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2013/03/07/Transient-heat-conduction---partial-differential-equations.org">org-mode source</a><p>

    </div>
  </div>
</article>



  <div class="after_post"><a href="http://jkitchin.github.io/blog/2013/03/07/Transient-heat-conduction-partial-differential-equations#disqus_thread">Read and Post Comments</a></div>
  <hr class="interblog" />
 <a href="../29">« Previous Page</a>
  --  
 <a href="../31">Next Page »</a>

          </div>
          <div id="sidebar" class="grid_4">
            <aside>
<section>
Search
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:kitchingroup.cheme.cmu.edu" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
</section>


  <section>
    <h1 class="post_header_gradient theme_font">Links</h1>
    <ul>
    <li><a href="http://enthought.com">Enthought Python</a></li>
    <li><a href="/pycse">Pycse</a></li>
    <li><a href="/dft-book">DFT-book</a></li>
    </ul>
  </section>

  <section>
    <h1 class="post_header_gradient theme_font">Latest Posts</h1>
    <ul>
      <li><a href="/blog/2014/06/24/Using-org-files-like-el-files/">Using org-files like el-files</a></li>
      <li><a href="/blog/2014/06/08/Better-integration-of-org-mode-and-email/">Better integration of org-mode and email</a></li>
      <li><a href="/blog/2014/06/05/Finding-emails-from-tags-from-org-contacts-database/">Finding emails from tags from org-contacts database</a></li>
      <li><a href="/blog/2014/05/23/Automatic-downloading-of-a-pdf-from-a-journal-site/">Automatic downloading of a pdf from a journal site</a></li>
      <li><a href="/blog/2014/05/22/Converting-a-doi-to-a-bibtex-entry/">Converting a doi to a bibtex entry</a></li>
    </ul>
  </section>

  <section>
 <h1 class="post_header_gradient theme_font"><a href="http://www.citeulike.org/user/jkitchin" class="external text" title="http://www.citeulike.org/user/jkitchin" rel="nofollow">CiteULike</a> Reading List</h1>
<script type="text/javascript" src="http://code.jquery.com/jquery-1.7.1.min.js"></script>
<script type="text/javascript">
$(document).ready(function() {

var d = new Date();
curr_year = d.getFullYear();

$.getJSON('http://www.citeulike.org/json/user/jkitchin/,,?callback=?&per_page=5',
function(data) {
  var items = [];
  year=curr_year
  $.each(data, function(i) {
    year=data[i].published[0];
    var cit='<li id="' + i + '">' + '<a class="pap" href="http://dx.doi.org/'+data[i].doi+'">'+ data[i].title + '</a><br>';
    cit+='</li>';
    items.push( cit )      
  });

  $('<ul/>', {
    'class': 'my-new-list',
    html: items.join('')
  }).appendTo('#papers2');
});
});
</script>

<div id="papers2"></div>

  </section>

<section>
<h1 class="post_header_gradient theme_font">Latest GitHub Repos</h1>
  <a href="https://github.com/jkitchin">@jkitchin</a> on GitHub.
<ul id="my-github-projects">
    <li class="loading">Status updating&#8230;</li>
  </ul>

</section>
</aside>

          </div>
          <div class="clear"></div>
        </div>
      </div>
      
<footer>
  <div id="footer" class="grid_12">
    <div class="grid_8">
      <p>
        <a href="/blog/feed/index.xml">RSS</a>
        <a href="http://kitchinresearchgroup.disqus.com/latest.rss">Comments RSS Feed</a>.
      </p>
    </div>
    <div class="grid_4" id="credits">
      <p>
        Copyright 2014
        John Kitchin
      </p>
      <p>
        Powered by <a href="http://www.blogofile.com">Blogofile</a>
      </p>
    </div>
  </div>
</footer>

    </div>
      <script src="//ajax.googleapis.com/ajax/libs/jquery/1.5.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="/js/libs/jquery-1.5.1.min.js"%3E%3C/script%3E'))</script>
  <script src="/js/plugins.js"></script>
  <script src="/js/script.js"></script>
  <script src="/js/jquery.tweet.js"></script>  
  <script src="/js/site.js"></script>
  <!--[if lt IE 7 ]>
  <script src="js/libs/dd_belatedpng.js"></script>
  <script> DD_belatedPNG.fix('img, .png_bg');</script>
  <![endif]-->
  <script>
      var _gaq=[['_setAccount','UA-35731398-1'],['_trackPageview']];
      (function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];g.async=1;
      g.src=('https:'==location.protocol?'//ssl':'//www')+'.google-analytics.com/ga.js';
      s.parentNode.insertBefore(g,s)}(document,'script'));
  </script>
  <script>
  (function() {
      var links = document.getElementsByTagName('a');
      var query = '?';
      for(var i = 0; i < links.length; i++) {
          if(links[i].href.indexOf('#disqus_thread') >= 0) {
              query += 'url' + i + '=' + encodeURIComponent(links[i].href) + '&';
          }
      }
      document.write('<script charset="utf-8" type="text/javascript" src="http://disqus.com/forums/kitchinresearchgroup/get_num_replies.js' + query + '"></' + 'script>');
  })();
  </script>

  </body>
</html>






<script src="http://ajax.microsoft.com/ajax/jquery/jquery-1.4.2.min.js" type="text/javascript"></script>
<script src="/js/git.js" type="text/javascript"></script>
<script type="text/javascript">
    $(function() {
     $("#my-github-projects").loadRepositories("jkitchin");
    });
</script>



