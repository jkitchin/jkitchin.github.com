

<!doctype html>
<!--[if lt IE 7 ]> <html lang="en" class="no-js ie6"> <![endif]-->
<!--[if IE 7 ]>    <html lang="en" class="no-js ie7"> <![endif]-->
<!--[if IE 8 ]>    <html lang="en" class="no-js ie8"> <![endif]-->
<!--[if IE 9 ]>    <html lang="en" class="no-js ie9"> <![endif]-->
<!--[if (gt IE 9)|!(IE)]><!--> <html lang="en" class="no-js"> <!--<![endif]-->
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>The Kitchin Research Group</title>
  <meta name="google-site-verification" content="CGcacJdHc2YoZyI0Vey9XRA5qwhhFDzThKJezbRFcJ4" />
  <meta name="description" content="Chemical Engineering at Carnegie Mellon University">
  <meta name="author" content="John Kitchin">
  <link rel="alternate" type="application/rss+xml" title="RSS 2.0" href="/blog/feed" />
  <link rel="alternate" type="application/atom+xml" title="Atom 1.0" href="/blog/feed/atom" />
  <link rel="shortcut icon" href="/favicon.ico">
  <link rel="apple-touch-icon" href="/img/apple-touch-icon.png">

  <link rel="stylesheet" href="/css/base.css?v=1">
  <link rel="stylesheet" href="/css/grid.css?v=1">
  <link rel="stylesheet" media="handheld" href="/css/handheld.css?v=1">
  <link rel="stylesheet" href="/css/pygments_murphy.css" type="text/css" />

  <script src="/js/libs/modernizr-1.7.min.js"></script>
<script type="text/javascript"
  src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
  <link rel="stylesheet" href="/themes/theme1/style.css?v=1">
<link href='http://fonts.googleapis.com/css?family=Roboto' rel='stylesheet' type='text/css'>

</head>
  <body>
    <div id="container" class="container container_12">
      <div id="main" role="main">
        <div id="main_block">
          <header>
<div id="header" class="header_gradient theme_font">
<table><tr><td>
    <h1><a href="/">The Kitchin Research Group</a></h1>
    <h2>Chemical Engineering at Carnegie Mellon University</h2>
</td>
<td colspan=100%><div style="float:right;width:100%;text-align:right;"> <span id='badgeCont737515' style='width:126px'><script src='http://labs.researcherid.com/mashlets?el=badgeCont737515&mashlet=badge&showTitle=false&className=a&rid=A-2363-2010'></script></span></div>
</td></tr>
</table>
</div>
  <div id="navigation" class="grid_12">

    <ul class="theme_font">
      <li><a href="/blog"
             class="">Blog</a></li>

      <li><a href="/blog/archive"
             class="">Archives</a></li>

      <li><a href="/publications/index.html">Publications</a></li>
      <li><a href="/group.html">Group</a></li>

      <li><a href="/research.html"
             class="">Research</a></li>

      <li><a href="/categories.html"
             class="">Categories</a></li>

      <li><a href="/about.html"
             class="">About us</a></li>

      <li><a href="/subscribe.html">Subscribe</a></li>

    </ul>
  </div>
</header>

          <div id="prose_block" class="grid_8">
            
  





<article>
  <div class="blog_post">
    <header>
      <div id="Finding-the-box-root-directory-on-a-local-machine"></div>
      <h2 class="blog_post_title"><a href="/blog/2013/12/22/Finding-the-box-root-directory-on-a-local-machine/" rel="bookmark" title="Permanent Link to Finding the box root directory on a local machine">Finding the box root directory on a local machine</a></h2>
      <p><small><span class="blog_post_date">Posted December 22, 2013 at 10:26 AM</span> | categories:
        <span class="blog_post_categories"><a href='/blog/category/box/'>box</a></span> | tags: 
        | <a href="http://jkitchin.github.io/blog/2013/12/22/Finding-the-box-root-directory-on-a-local-machine#disqus_thread">View Comments</a>
      </small></p>
    </header>
    <div class="post_prose">
      



<p>
I am working to automate some aspects of box.com, specifically to create collaborations in folders and tasks on files on my local computer at the command-line. I use Box Sync to mirror folders and files on my local computer, and I would like to open a prompt in one of these folders and type something like:
</p>
<pre class="example">
box collaborate --role editor someone@gmail.com
</pre>
<p>
to add that person as an editor to my box folder. 
</p>

<p>
The challenge is that I need to know the <code>id</code> of that folder on box. Box stores the files on their server by id, not by name, and the root box folder has an id of <code>0</code>. On my local computer, the box root folder is where <code>Box Sync</code> puts my synchronized files. In my box<sub>course</sub> python module I wrote a function that will return the <code>id</code> of an item in box given the <i>box path</i> which is relative to the box root directory. For example, here we can get the <code>id</code> for a folder called group-course.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">from</span> box_course <span style="color: #8b0000;">import</span> box

<span style="color: #8b0000;">print</span> box.get_item(<span style="color: #228b22;">'/group-course'</span>)
</pre>
</div>

<pre class="example">
{u'sequence_id': u'1', u'etag': u'1', u'type': u'folder', u'id': u'1328895168', u'name': u'group-course'}
</pre>

<p>
On my local computer, group course is located at C:\Users\jkitchin\Box Sync\group-course, and C:\Users\jkitchin\Box Sync is like the box root directory. So, the challenge is, if I am on the local computer in some directory, how do I determine the box path to that directory? 
</p>

<p>
What I worked out is to start in the current directory, and check directories above this for a file that indicates you are in the box root directory. With Box Sync 3, that file was "Box Sync ReadMe.pdf", but Box Sync 4 does not include that file anymore. I just put a folder of that name in the Box Sync 4 root directory <sup><a id="fnr.1" name="fnr.1" class="footref" href="#fn.1">1</a></sup>.
</p>

<p>
Here is a way to start in a box directory, and walk up the path to look for the file. We get the path, and then split each directory off the end, checking for the existence of the file, until the path is gone.
</p>
<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">import</span> os
<span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">change into a box directory</span>
os.chdir(<span style="color: #228b22;">'C:\Users\jkitchin\Box Sync\group-course'</span>)

<span style="color: #8b008b;">wd</span>, <span style="color: #8b008b;">last</span> = os.getcwd(), <span style="color: #cd0000;">True</span>
<span style="color: #8b0000;">while</span> last:
    <span style="color: #8b008b;">wd</span>, <span style="color: #8b008b;">last</span> = os.path.split(wd)
    
    <span style="color: #8b008b;">cfile</span> = os.path.join(wd, <span style="color: #228b22;">'Box Sync ReadMe.pdf'</span>)
    <span style="color: #8b0000;">if</span> os.path.exists(cfile):
        <span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">we found box root</span>
        <span style="color: #8b0000;">break</span>

<span style="color: #8b0000;">print</span> wd
</pre>
</div>

<pre class="example">
C:\Users\jkitchin\Box Sync
</pre>

<p>
That gets us the box root directory. Now, we need to strip this off of the current working directory. We also need to replace all the backslashes that Windows uses with forward slashes so that we can get the id. 
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">import</span> os
os.chdir(<span style="color: #228b22;">'C:\Users\jkitchin\Box Sync\group-course'</span>)

<span style="color: #8b008b;">cwd</span> = os.getcwd()

<span style="color: #8b008b;">wd</span>, <span style="color: #8b008b;">last</span> = os.getcwd(), <span style="color: #cd0000;">True</span>
<span style="color: #8b0000;">while</span> last:
    <span style="color: #8b008b;">wd</span>, <span style="color: #8b008b;">last</span> = os.path.split(wd)
    
    <span style="color: #8b008b;">cfile</span> = os.path.join(wd, <span style="color: #228b22;">'Box Sync ReadMe.pdf'</span>)
    <span style="color: #8b0000;">if</span> os.path.exists(cfile):
        <span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">we found box root</span>
        <span style="color: #8b0000;">break</span>

<span style="color: #8b0000;">print</span> wd
<span style="color: #8b0000;">print</span> cwd
<span style="color: #8b0000;">print</span> cwd.replace(wd, <span style="color: #228b22;">''</span>).replace(<span style="color: #228b22;">'\\'</span>,<span style="color: #228b22;">'/'</span>)
</pre>
</div>

<pre class="example">
C:\Users\jkitchin\Box Sync
C:\Users\jkitchin\Box Sync\group-course
/group-course
</pre>

<p>
This seems to work pretty well, but on some Windows machines, the drive letter is lower case, and then this does not work. In that case, we use <code>os.path.normcase</code> to make everything consistent.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">import</span> os
os.chdir(<span style="color: #228b22;">'C:\Users\jkitchin\Box Sync\group-course'</span>)

<span style="color: #8b0000;">from</span> box_course <span style="color: #8b0000;">import</span> box

<span style="color: #8b008b;">cwd</span> = os.getcwd()

<span style="color: #8b008b;">wd</span>, <span style="color: #8b008b;">last</span> = os.getcwd(), <span style="color: #cd0000;">True</span>
<span style="color: #8b0000;">while</span> last:
    <span style="color: #8b008b;">wd</span>, <span style="color: #8b008b;">last</span> = os.path.split(wd)
    
    <span style="color: #8b008b;">cfile</span> = os.path.join(wd, <span style="color: #228b22;">'Box Sync ReadMe.pdf'</span>)
    <span style="color: #8b0000;">if</span> os.path.exists(cfile):
        <span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">we found box root</span>
        <span style="color: #8b0000;">break</span>

<span style="color: #8b0000;">print</span> wd
<span style="color: #8b0000;">print</span> cwd
<span style="color: #8b008b;">bpath</span> = os.path.normcase(cwd).replace(os.path.normcase(wd), <span style="color: #228b22;">''</span>).replace(<span style="color: #228b22;">'\\'</span>,<span style="color: #228b22;">'/'</span>)

<span style="color: #8b0000;">print</span> bpath
<span style="color: #8b0000;">print</span> box.get_item(bpath)
</pre>
</div>

<pre class="example">
C:\Users\jkitchin\Box Sync
C:\Users\jkitchin\Box Sync\group-course
/group-course
{u'sequence_id': u'1', u'etag': u'1', u'type': u'folder', u'id': u'1328895168', u'name': u'group-course'}
</pre>

<p>
This seems to work so far. Something similar this is probably done in git repositories, to find the .git file. This is also a useful way to find a config file higher up the path.
</p>
<div id="footnotes">
<h2 class="footnotes">Footnotes: </h2>
<div id="text-footnotes">

<div class="footdef"><sup><a id="fn.1" name="fn.1" class="footnum" href="#fnr.1">1</a></sup> <p>
Box Sync 4 renames your sync directory from "~/Documents/My Box Files" to "~/Box Sync".
</p></div>


</div>
</div><p>Copyright (C) 2013 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2013/12/22/Finding-the-box-root-directory-on-a-local-machine.org">org-mode source</a><p>

    </div>
  </div>
</article>



<a href="https://twitter.com/share" class="twitter-share-button" data-via="johnkitchin">Tweet</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>

  <div class="after_post"><a href="http://jkitchin.github.io/blog/2013/12/22/Finding-the-box-root-directory-on-a-local-machine#disqus_thread">Read and Post Comments</a></div>
  <hr class="interblog" />
  





<article>
  <div class="blog_post">
    <header>
      <div id="New-MS-students-join-the-Kitchin-Research-Group"></div>
      <h2 class="blog_post_title"><a href="/blog/2013/12/13/New-MS-students-join-the-Kitchin-Research-Group/" rel="bookmark" title="Permanent Link to New MS students join the Kitchin Research Group">New MS students join the Kitchin Research Group</a></h2>
      <p><small><span class="blog_post_date">Posted December 13, 2013 at 10:50 AM</span> | categories:
        <span class="blog_post_categories"><a href='/blog/category/news/'>news</a></span> | tags: 
        | <a href="http://jkitchin.github.io/blog/2013/12/13/New-MS-students-join-the-Kitchin-Research-Group#disqus_thread">View Comments</a>
      <p><small><span class="blog_post_date">Updated January 16, 2014 at 08:04 PM</span>
      </small></p>
    </header>
    <div class="post_prose">
      



<p>
Three new M.S. students have joined the Kitchin Research Group! We are pleased to welcome Wenqin You, Meiheng Lu, and Nitish Govindarajan!
</p>

<p>
Wenqin will work on modeling CO2 capture processes, Meiheng will work on a data sharing project, and Nitish will use density functional theory to model oxide materials relevant to SOFCs and CO2 conversion.
</p>
<p>Copyright (C) 2014 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2013/12/13/New-MS-students-join-the-Kitchin-Research-Group.org">org-mode source</a><p><p>Org-mode version = 8.2.5c</p>

    </div>
  </div>
</article>



<a href="https://twitter.com/share" class="twitter-share-button" data-via="johnkitchin">Tweet</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>

  <div class="after_post"><a href="http://jkitchin.github.io/blog/2013/12/13/New-MS-students-join-the-Kitchin-Research-Group#disqus_thread">Read and Post Comments</a></div>
  <hr class="interblog" />
  





<article>
  <div class="blog_post">
    <header>
      <div id="Selectively-exporting-headlines-in-org-mode"></div>
      <h2 class="blog_post_title"><a href="/blog/2013/12/08/Selectively-exporting-headlines-in-org-mode/" rel="bookmark" title="Permanent Link to Selectively exporting headlines in org-mode">Selectively exporting headlines in org-mode</a></h2>
      <p><small><span class="blog_post_date">Posted December 08, 2013 at 04:35 PM</span> | categories:
        <span class="blog_post_categories"><a href='/blog/category/org-mode/'>org-mode</a></span> | tags: 
        | <a href="http://jkitchin.github.io/blog/2013/12/08/Selectively-exporting-headlines-in-org-mode#disqus_thread">View Comments</a>
      </small></p>
    </header>
    <div class="post_prose">
      



<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#sec-1">1. problem 1&#xa0;&#xa0;&#xa0;<span class="tag"><span class="problem">problem</span></span></a>
<ul>
<li><a href="#sec-1-1">1.1. solution to problem 1&#xa0;&#xa0;&#xa0;<span class="tag"><span class="solution">solution</span></span></a></li>
</ul>
</li>
<li><a href="#sec-2">2. problem 2&#xa0;&#xa0;&#xa0;<span class="tag"><span class="problem">problem</span></span></a>
<ul>
<li><a href="#sec-2-1">2.1. solution to problem 2&#xa0;&#xa0;&#xa0;<span class="tag"><span class="solution">solution</span></span></a></li>
</ul>
</li>
<li><a href="#sec-3">3. Code to export&#xa0;&#xa0;&#xa0;<span class="tag"><span class="code">code</span></span></a>
<ul>
<li><a href="#sec-3-1">3.1. Export just the problems</a></li>
<li><a href="#sec-3-2">3.2. Problems and solutions</a></li>
</ul>
</li>
<li><a href="#sec-4">4. Summary</a></li>
</ul>
</div>
</div>
<p>
I have on several occasions needed to selectively export only portions of an org document. For example, I may write a problem set or exam, and have some headlines that are the problems, and others that are the solutions. Or, I may have done some analysis in a headline, e.g. statistics of problem scores that I do not want in exported content, or I have a manuscript with a supporting information section that does not go in the exported manuscript, and the manuscript cannot go in the supporting information file. 
</p>

<p>
org-mode supports <a href="http://www.gnu.org/software/emacs/manual/html_node/org/Selective-export.html">selective export</a> through use of tags. However, this is inflexible if you want to export multiple different documents with different selective exports, unless you don't mind changing the settings, or commenting and uncommenting lines all the time. 
</p>

<p>
Enter dynamic binding of variables in emacs-lisp. We can temporarily define variables, especially <code>org-export-select-tags</code> and <code>org-export-exclude-tags</code>, and write emacs-lisp code blocks to export the current document the way we want. First, let us create some headlines.
</p>

<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1"><span class="section-number-2">1</span> problem 1&#xa0;&#xa0;&#xa0;<span class="tag"><span class="problem">problem</span></span></h2>
<div class="outline-text-2" id="text-1">
<p>
description of a hard problem
</p>
</div>
<div id="outline-container-sec-1-1" class="outline-3">
<h3 id="sec-1-1"><span class="section-number-3">1.1</span> solution to problem 1&#xa0;&#xa0;&#xa0;<span class="tag"><span class="solution">solution</span></span></h3>
<div class="outline-text-3" id="text-1-1">
<p>
it is an easy solution
</p>
</div>
</div>
</div>

<div id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2"><span class="section-number-2">2</span> problem 2&#xa0;&#xa0;&#xa0;<span class="tag"><span class="problem">problem</span></span></h2>
<div class="outline-text-2" id="text-2">
<p>
what is the square root of 100?
</p>
</div>
<div id="outline-container-sec-2-1" class="outline-3">
<h3 id="sec-2-1"><span class="section-number-3">2.1</span> solution to problem 2&#xa0;&#xa0;&#xa0;<span class="tag"><span class="solution">solution</span></span></h3>
<div class="outline-text-3" id="text-2-1">
<p>
why it's 10 of course.
</p>
</div>
</div>
</div>
<div id="outline-container-sec-3" class="outline-2">
<h2 id="sec-3"><span class="section-number-2">3</span> Code to export&#xa0;&#xa0;&#xa0;<span class="tag"><span class="code">code</span></span></h2>
<div class="outline-text-2" id="text-3">
</div><div id="outline-container-sec-3-1" class="outline-3">
<h3 id="sec-3-1"><span class="section-number-3">3.1</span> Export just the problems</h3>
<div class="outline-text-3" id="text-3-1">
<p>
First, let us output this document with just the problems. The code block does that, just put your cursor in in block and press C-c C-c (in emacs of course). 
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #8b0000;">let</span> ((org-export-exclude-tags '(<span style="color: #228b22;">"solution"</span> <span style="color: #228b22;">"code"</span>))
      (org-latex-default-packages-alist
       '((<span style="color: #228b22;">""</span> <span style="color: #228b22;">"lmodern"</span> nil)
         (<span style="color: #228b22;">"linktocpage,</span>
<span style="color: #228b22;">  pdfstartview=FitH,</span>
<span style="color: #228b22;">  colorlinks,</span>
<span style="color: #228b22;">  linkcolor=blue,</span>
<span style="color: #228b22;">  anchorcolor=blue,</span>
<span style="color: #228b22;">  citecolor=blue,</span>
<span style="color: #228b22;">  filecolor=blue,</span>
<span style="color: #228b22;">  menucolor=blue,</span>
<span style="color: #228b22;">  urlcolor=blue"</span> <span style="color: #228b22;">"hyperref"</span> t)))
      (async nil)
      (subtreep nil)
      (visible-only nil)
      (body-only nil)
      (ext-plist '()))
  (org-latex-export-to-pdf async subtreep visible-only body-only ext-plist))
(rename-file <span style="color: #228b22;">"blog.pdf"</span> <span style="color: #228b22;">"blog-1.pdf"</span>)
</pre>
</div>

<p>
You get this: <a href="/media/2013-12-08-Selectively-exporting-headlines-in-org-mode/blog-1.pdf">blog-1.pdf</a> which only has the problems in it.
</p>
</div>
</div>
<div id="outline-container-sec-3-2" class="outline-3">
<h3 id="sec-3-2"><span class="section-number-3">3.2</span> Problems and solutions</h3>
<div class="outline-text-3" id="text-3-2">
<p>
Next, we consider the problems and the solutions. We cannot just get solutions in this document because solutions are nested in the problems.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #8b0000;">let</span> ((org-export-exclude-tags '(<span style="color: #228b22;">"code"</span>))
      (org-latex-default-packages-alist
       '((<span style="color: #228b22;">""</span> <span style="color: #228b22;">"lmodern"</span> nil)
         (<span style="color: #228b22;">"linktocpage,</span>
<span style="color: #228b22;">  pdfstartview=FitH,</span>
<span style="color: #228b22;">  colorlinks,</span>
<span style="color: #228b22;">  linkcolor=blue,</span>
<span style="color: #228b22;">  anchorcolor=blue,</span>
<span style="color: #228b22;">  citecolor=blue,</span>
<span style="color: #228b22;">  filecolor=blue,</span>
<span style="color: #228b22;">  menucolor=blue,</span>
<span style="color: #228b22;">  urlcolor=blue"</span> <span style="color: #228b22;">"hyperref"</span> t)))
      (async nil)
      (subtreep nil)
      (visible-only nil)
      (body-only nil)
      (ext-plist '()))
  (org-latex-export-to-pdf async subtreep visible-only body-only ext-plist))
(rename-file <span style="color: #228b22;">"blog.pdf"</span> <span style="color: #228b22;">"blog-2.pdf"</span> t)
</pre>
</div>

<p>
This document (<a href="/media/2013-12-08-Selectively-exporting-headlines-in-org-mode/blog-2.pdf">blog-2.pdf</a> ) now has problems and solutions. Note that neither of these documents has the section we labeled <code>:code:</code>.
</p>
</div>
</div>
</div>
<div id="outline-container-sec-4" class="outline-2">
<h2 id="sec-4"><span class="section-number-2">4</span> Summary</h2>
<div class="outline-text-2" id="text-4">
<p>
Tags are a nice way to label sections. In combination with dynamic binding, you can build code blocks that selectively export pieces of an org-file by temporarily defining the values of variables. In this example, there are four versions of this document: 1) the org-file that contains everything, 2) the html blog post, 3) a pdf with the problems, and 4) a pdf with problems and solutions. Good luck getting that out of a Word file ;)
</p>
</div>
</div>
<p>Copyright (C) 2013 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2013/12/08/Selectively-exporting-headlines-in-org-mode.org">org-mode source</a><p>

    </div>
  </div>
</article>



<a href="https://twitter.com/share" class="twitter-share-button" data-via="johnkitchin">Tweet</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>

  <div class="after_post"><a href="http://jkitchin.github.io/blog/2013/12/08/Selectively-exporting-headlines-in-org-mode#disqus_thread">Read and Post Comments</a></div>
  <hr class="interblog" />
  





<article>
  <div class="blog_post">
    <header>
      <div id="Custom-directives"></div>
      <h2 class="blog_post_title"><a href="/blog/2013/11/30/Custom-directives/" rel="bookmark" title="Permanent Link to Custom directives">Custom directives</a></h2>
      <p><small><span class="blog_post_date">Posted November 30, 2013 at 09:19 AM</span> | categories:
        <span class="blog_post_categories"><a href='/blog/category/org-mode/'>org-mode</a>, <a href='/blog/category/emacs/'>emacs</a></span> | tags: 
        | <a href="http://jkitchin.github.io/blog/2013/11/30/Custom-directives#disqus_thread">View Comments</a>
      <p><small><span class="blog_post_date">Updated November 30, 2013 at 09:35 AM</span>
      </small></p>
    </header>
    <div class="post_prose">
      





<p>
You can define custom <a href="http://orgmode.org/worg/org-contrib/org-special-blocks.html">special blocks</a> in org-mode. Here is an example of creating attention and note directives. Note you need to specify the styles and environments in the header like this:
</p>
<pre class="example">
#+HTML_HEAD_EXTRA:  &lt;style&gt;.attention {font-size: 30px; text-indent: 50px; color: red; background-color:HotPink;}&lt;/style&gt;
#+HTML_HEAD_EXTRA:  &lt;style&gt;.note {font-size: 30px; text-indent: 50px; background-color:LightSkyBlue;}&lt;/style&gt;

#+LATEX_HEADER: \usepackage[usenames,dvipsnames,svgnames,table]{xcolor}
#+LATEX_HEADER: \newenvironment{attention}{\color{red}}{\ignorespacesafterend}
#+LATEX_HEADER: \newenvironment{note}{\itshape}{\ignorespacesafterend}
</pre>

<p>
That allows you to define different looks for exporting to html and LaTeX. For the blog post, I put the style in the body of the html.
</p>

<style>.attention {font-size: 30px; text-indent: 50px; color: red; background-color:HotPink;}</style>
<style>.note {font-size: 30px; text-indent: 50px; background-color:LightSkyBlue;}</style>

<p>
Here is the markup for an attention block.
</p>

<pre class="example">
#+BEGIN_ATTENTION
Pay attention to this text!
#+END_ATTENTION
</pre>

<p>
Renders like this: 
</p>
<div class="attention">
<p>
Pay attention to this text!
</p>

</div>


<p>
A note is defined as:
</p>
<pre class="example">
#+begin_note
this is a note
#+end_note
</pre>

<p>
and it renders like this:
</p>
<div class="note">
<p>
this is a note.
</p>

</div>

<p>
I am not sure if it is possible to add arguments, e.g. via attributes. Anyway, this may enable some flexibility in adding content that may be rendered in html and LaTeX in org-mode. There is a function (org-html-special-block and org-latex-special-block) that does the rendering, and it has an info plist that probably has the information. It does not appear you can pass arguments in though. That would require a filter that redefines the rendering.
</p>
<p>Copyright (C) 2013 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2013/11/30/Custom-directives.org">org-mode source</a><p>

    </div>
  </div>
</article>



<a href="https://twitter.com/share" class="twitter-share-button" data-via="johnkitchin">Tweet</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>

  <div class="after_post"><a href="http://jkitchin.github.io/blog/2013/11/30/Custom-directives#disqus_thread">Read and Post Comments</a></div>
  <hr class="interblog" />
  





<article>
  <div class="blog_post">
    <header>
      <div id="Automating-Adobe-Acrobat-Pro-with-python"></div>
      <h2 class="blog_post_title"><a href="/blog/2013/11/23/Automating-Adobe-Acrobat-Pro-with-python/" rel="bookmark" title="Permanent Link to Automating Adobe Acrobat Pro with python">Automating Adobe Acrobat Pro with python</a></h2>
      <p><small><span class="blog_post_date">Posted November 23, 2013 at 10:34 AM</span> | categories:
        <span class="blog_post_categories"><a href='/blog/category/pdf/'>pdf</a>, <a href='/blog/category/automation/'>automation</a></span> | tags: 
        | <a href="http://jkitchin.github.io/blog/2013/11/23/Automating-Adobe-Acrobat-Pro-with-python#disqus_thread">View Comments</a>
      </small></p>
    </header>
    <div class="post_prose">
      



<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#sec-1">1. Summary</a></li>
</ul>
</div>
</div>

<p>
I have a need to automate Adobe Pro for a couple of applications:
</p>

<ol class="org-ol">
<li>I could use Adobe Pro to automatically add rubric pages to assignments before grading them. The rubric has embedded javascript that stores the grade inside the pdf file.
</li>
<li>I could use Adobe Pro to extract information, e.g. grades, stored in a set of PDF files for analysis.
</li>
</ol>

<p>
I came across this <a href="http://win32com.goermezer.de/content/view/232/288/">script</a> to automate Adobe Pro using python and OLE automation.  Two other useful references are:
</p>

<ol class="org-ol">
<li><a href="http://www.adobe.com/content/dam/Adobe/en/devnet/acrobat/pdfs/iac_api_reference.pdf">http://www.adobe.com/content/dam/Adobe/en/devnet/acrobat/pdfs/iac_api_reference.pdf</a> 
</li>
<li><a href="http://www.adobe.com/content/dam/Adobe/en/devnet/acrobat/pdfs/iac_developer_guide.pdf">http://www.adobe.com/content/dam/Adobe/en/devnet/acrobat/pdfs/iac_developer_guide.pdf</a> 
</li>
</ol>

<p>
In this post, we look at some simple code to get data out of a pdf.  We start with just opening a PDF file.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">import</span> os
<span style="color: #8b0000;">from</span> win32com.client.dynamic <span style="color: #8b0000;">import</span> Dispatch
<span style="color: #8b008b;">src</span> = os.path.abspath(<span style="color: #228b22;">'writing-exams-in-orgmode.pdf'</span>)

<span style="color: #8b008b;">app</span> = Dispatch(<span style="color: #228b22;">"AcroExch.AVDoc"</span>)

app.Open(src, src)

app.Close(-1)  <span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">do not save on close</span>
</pre>
</div>

<p>
Opening and closing a file is not that useful.  Here, we can get some information out of the file. The pdf we looked at above has a custom property <code>PTEX.Fullbanner</code> from pdflatex. We can extract it like this.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">import</span> os
<span style="color: #8b0000;">from</span> win32com.client.dynamic <span style="color: #8b0000;">import</span> Dispatch
<span style="color: #8b008b;">src</span> = os.path.abspath(<span style="color: #228b22;">'writing-exams-in-orgmode.pdf'</span>)

<span style="color: #8b008b;">app</span> = Dispatch(<span style="color: #228b22;">"AcroExch.AVDoc"</span>)

app.Open(src, src)
<span style="color: #8b008b;">pddoc</span> = app.GetPDDoc()
<span style="color: #8b0000;">print</span> pddoc.GetInfo(<span style="color: #228b22;">'PTEX.Fullbanner'</span>)

<span style="color: #8b0000;">print</span> pddoc.GetNumPages()
app.Close(-1)  <span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">do not save on close</span>
</pre>
</div>

<pre class="example">
This is MiKTeX-pdfTeX 2.9.4535 (1.40.13)
5
</pre>


<p>
Finally, let us try inserting pages. I have a <a href="/media/2013-11-23-Automating-Adobe-Acrobat-Pro-with-python/rubric.pdf">rubric file </a> that I want to insert at the end of the <pre>writing-exams-in-orgmode.pdf</pre> above. We will open both documents, insert the rubric, and save the result as a new file.
</p>


<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">import</span> os
<span style="color: #8b0000;">from</span> win32com.client.dynamic <span style="color: #8b0000;">import</span> Dispatch
<span style="color: #8b008b;">src</span> = os.path.abspath(<span style="color: #228b22;">'../../CMU/classes/06-625/rubric/rubric.pdf'</span>)
<span style="color: #8b008b;">src2</span> = os.path.abspath(<span style="color: #228b22;">'writing-exams-in-orgmode.pdf'</span>)

<span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">It seems I need two of these</span>
<span style="color: #8b008b;">avdoc1</span> = Dispatch(<span style="color: #228b22;">"AcroExch.AVDoc"</span>)
<span style="color: #8b008b;">avdoc2</span> = Dispatch(<span style="color: #228b22;">"AcroExch.AVDoc"</span>)

<span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">this is the rubric</span>
avdoc1.Open(src, src)
<span style="color: #8b008b;">pddoc1</span> = avdoc1.GetPDDoc()
<span style="color: #8b008b;">N1</span> = pddoc1.GetNumPages()

<span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">this is the other doc</span>
avdoc2.Open(src2, src2)
<span style="color: #8b008b;">pddoc2</span> = avdoc2.GetPDDoc()
<span style="color: #8b008b;">N2</span> = pddoc2.GetNumPages()

<span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">Insert rubric after last page of the other doc. pages start at 0</span>
pddoc2.InsertPages(N2 - 1, pddoc1, 0, N1, 0)

<span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">save as a new file. 1 means full save at absolute path provided.</span>
pddoc2.Save(1, os.path.abspath(<span style="color: #228b22;">'./woohoo.pdf'</span>))

<span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">close files.</span>
avdoc1.Close(-1)
avdoc2.Close(-1)
</pre>
</div>

<p>
Here is our result: <a href="/media/2013-11-23-Automating-Adobe-Acrobat-Pro-with-python/woohoo.pdf">woohoo.pdf</a> . I went ahead and gave myself an A ;). 
</p>

<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1"><span class="section-number-2">1</span> Summary</h2>
<div class="outline-text-2" id="text-1">
<p>
It looks like I can replace the dependence of my box-course code on all the python-based pdf libraries (which are not fully functional, and do not work on all pdfs), and on pdftk, with this automation approach of Adobe Pro. It is unfortunate that it is not a free program, but i would expect it to work on all PDF files, and it provides features like combining PDFs with their javascript, that <i>no</i> other PDF package has. I have tried other PDF programs to combine the rubric and assignment page, but they all lose the javascript. With this method, I could keep a set of enriched rubric files for different types of assignments, and add them to assignments as part of the assessment process. 
</p>
</div>
</div>
<p>Copyright (C) 2013 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2013/11/23/Automating-Adobe-Acrobat-Pro-with-python.org">org-mode source</a><p>

    </div>
  </div>
</article>



<a href="https://twitter.com/share" class="twitter-share-button" data-via="johnkitchin">Tweet</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>

  <div class="after_post"><a href="http://jkitchin.github.io/blog/2013/11/23/Automating-Adobe-Acrobat-Pro-with-python#disqus_thread">Read and Post Comments</a></div>
  <hr class="interblog" />
 <a href="../51">« Previous Page</a>
  --  
 <a href="../53">Next Page »</a>

          </div>
          <div id="sidebar" class="grid_4">
            <aside>
<section>
<script>
  (function() {
    var cx = '002533177287215655227:l7uvu35ssbc';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
        '//www.google.com/cse/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>
</section>

<section>
    <h1 class="post_header_gradient theme_font">Twitter</h1>
    <a class="twitter-timeline" href="https://twitter.com/johnkitchin" data-widget-id="545217643582881792">Tweets by @johnkitchin</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+"://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
</section>


  <section>
    <h1 class="post_header_gradient theme_font">Links</h1>
    <ul>
      <li><a href="https://www.continuum.io">Anaconda Python</a></li>
      <li><a href="/pycse">Pycse</a></li>
      <li><a href="/dft-book">DFT-book</a></li>
    </ul>
  </section>

  <section>
    <h1 class="post_header_gradient theme_font">Latest Posts</h1>
    <ul>
      <li><a href="/blog/2016/05/30/Writing-lisp-code-from-Python/">Writing lisp code from Python</a></li>
      <li><a href="/blog/2016/05/29/Expanding-orgmode-py-to-get-better-org-python-integration/">Expanding orgmode.py to get better org-python integration</a></li>
      <li><a href="/blog/2016/05/06/When-in-python-do-as-Pythonistas-unless/">When in python do as Pythonistas unless...</a></li>
      <li><a href="/blog/2016/05/01/Automatic-decorating-of-class-methods-to-run-them-in-a-context/">Automatic decorating of class methods to run them in a context</a></li>
      <li><a href="/blog/2016/04/30/Another-approach-to-docstrings-and-validation-of-args-and-kwargs-in-Python/">Another approach to docstrings and validation of args and kwargs in Python</a></li>
    </ul>
  </section>

<section>
<h1 class="post_header_gradient theme_font">Latest GitHub Repos</h1>
  <a href="https://github.com/jkitchin">@jkitchin</a> on GitHub.
  <ul id="my-github-projects">
        <li class="loading">Status updating&#8230;</li>
  </ul>

</section>
</aside>

          </div>
          <div class="clear"></div>
        </div>
      </div>
      
<footer>
  <div id="footer" class="grid_12">
    <div class="grid_8">
      <p>
        <a href="/blog/feed/index.xml">RSS</a>
        <a href="http://kitchinresearchgroup.disqus.com/latest.rss">Comments RSS Feed</a>.
      </p>
    </div>
    <div class="grid_4" id="credits">
      <p>
        Copyright 2016
        John Kitchin
      </p>
      <p>
        Powered by <a href="http://www.blogofile.com">Blogofile</a>
      </p>
    </div>
  </div>
</footer>

    </div>
      <script src="//ajax.googleapis.com/ajax/libs/jquery/1.5.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="/js/libs/jquery-1.5.1.min.js"%3E%3C/script%3E'))</script>
  <script src="/js/plugins.js"></script>
  <script src="/js/script.js"></script>
  <script src="/js/jquery.tweet.js"></script>  
  <script src="/js/site.js"></script>
  <!--[if lt IE 7 ]>
  <script src="js/libs/dd_belatedpng.js"></script>
  <script> DD_belatedPNG.fix('img, .png_bg');</script>
  <![endif]-->
  <script>
      var _gaq=[['_setAccount','UA-35731398-1'],['_trackPageview']];
      (function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];g.async=1;
      g.src=('https:'==location.protocol?'//ssl':'//www')+'.google-analytics.com/ga.js';
      s.parentNode.insertBefore(g,s)}(document,'script'));
  </script>
  <script>
  (function() {
      var links = document.getElementsByTagName('a');
      var query = '?';
      for(var i = 0; i < links.length; i++) {
          if(links[i].href.indexOf('#disqus_thread') >= 0) {
              query += 'url' + i + '=' + encodeURIComponent(links[i].href) + '&';
          }
      }
      document.write('<script charset="utf-8" type="text/javascript" src="http://disqus.com/forums/kitchinresearchgroup/get_num_replies.js' + query + '"></' + 'script>');
  })();
  </script>

  </body>
</html>






<script src="http://ajax.microsoft.com/ajax/jquery/jquery-1.4.2.min.js" type="text/javascript"></script>
<script src="/js/git.js" type="text/javascript"></script>
<script type="text/javascript">
    $(function() {
     $("#my-github-projects").loadRepositories("jkitchin");
    });
</script>



