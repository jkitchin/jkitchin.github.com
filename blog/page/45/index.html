

<!doctype html>
<!--[if lt IE 7 ]> <html lang="en" class="no-js ie6"> <![endif]-->
<!--[if IE 7 ]>    <html lang="en" class="no-js ie7"> <![endif]-->
<!--[if IE 8 ]>    <html lang="en" class="no-js ie8"> <![endif]-->
<!--[if IE 9 ]>    <html lang="en" class="no-js ie9"> <![endif]-->
<!--[if (gt IE 9)|!(IE)]><!--> <html lang="en" class="no-js"> <!--<![endif]-->
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>The Kitchin Research Group</title>
  <meta name="google-site-verification" content="CGcacJdHc2YoZyI0Vey9XRA5qwhhFDzThKJezbRFcJ4" />
  <meta name="description" content="Chemical Engineering at Carnegie Mellon University">
  <meta name="author" content="John Kitchin">
  <link rel="alternate" type="application/rss+xml" title="RSS 2.0" href="/blog/feed" />
  <link rel="alternate" type="application/atom+xml" title="Atom 1.0" href="/blog/feed/atom" />
  <link rel="shortcut icon" href="/favicon.ico">
  <link rel="apple-touch-icon" href="/img/apple-touch-icon.png">

  <link rel="stylesheet" href="/css/base.css?v=1">
  <link rel="stylesheet" href="/css/grid.css?v=1">
  <link rel="stylesheet" media="handheld" href="/css/handheld.css?v=1">
  <link rel="stylesheet" href="/css/pygments_murphy.css" type="text/css" />

  <script src="/js/libs/modernizr-1.7.min.js"></script>
<script type="text/javascript"
  src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
  <link rel="stylesheet" href="/themes/theme1/style.css?v=1">
<link href='http://fonts.googleapis.com/css?family=Roboto' rel='stylesheet' type='text/css'>

</head>
  <body>
    <div id="container" class="container container_12">
      <div id="main" role="main">
        <div id="main_block">
          <header>
<div id="header" class="header_gradient theme_font">
<table><tr><td>
    <h1><a href="/">The Kitchin Research Group</a></h1>
    <h2>Chemical Engineering at Carnegie Mellon University</h2>
</td>
<td colspan=100%><div style="float:right;width:100%;text-align:right;"> <span id='badgeCont737515' style='width:126px'><script src='http://labs.researcherid.com/mashlets?el=badgeCont737515&mashlet=badge&showTitle=false&className=a&rid=A-2363-2010'></script></span></div>
</td></tr>
</table>
</div>
  <div id="navigation" class="grid_12">

    <ul class="theme_font">
      <li><a href="/blog"
             class="">Blog</a></li>

      <li><a href="/blog/archive"
             class="">Archives</a></li>

      <li><a href="http://www.researcherid.com/rid/A-2363-2010" target="_new">Publications</a></li>

      <li><a href="/research.html"
             class="">Research</a></li>

      <li><a href="/group.html"
             class="">Group</a></li>

      <li><a href="/categories.html"
             class="">Categories</a></li>

      <li><a href="/about.html"
             class="">About us</a></li>
    </ul>
  </div>
</header>

          <div id="prose_block" class="grid_8">
            
  





<article>
  <div class="blog_post">
    <header>
      <div id="Integrating-functions-in-python"></div>
      <h2 class="blog_post_title"><a href="/blog/2013/02/02/Integrating-functions-in-python/" rel="bookmark" title="Permanent Link to Integrating functions in python">Integrating functions in python</a></h2>
      <p><small><span class="blog_post_date">Posted February 02, 2013 at 09:00 AM</span> | categories: 
        <span class="blog_post_categories"><a href='/blog/category/python/'>python</a>, <a href='/blog/category/math/'>math</a></span> | tags: 
        | <a href="http://jkitchin.github.io/blog/2013/02/02/Integrating-functions-in-python#disqus_thread">View Comments</a>
      <p><small><span class="blog_post_date">Updated February 27, 2013 at 02:54 PM</span>
      </small></p>
    </header>
    <div class="post_prose">
      



<p>
<a href="http://matlab.cheme.cmu.edu/2011/08/01/integrating-functions-in-matlab/" >Matlab post</a>
</p>

<p>
<b>Problem statement</b>
</p>

<p>
find the integral of a function f(x) from a to b i.e.
</p>

<p>
$$\int_a^b f(x) dx$$
</p>

<p>
In python we use numerical quadrature to achieve this with the scipy.integrate.quad command. 
</p>

<p>
as a specific example, lets integrate
</p>

<p>
$$y=x^2$$
</p>

<p>
from x=0 to x=1. You should be able to work out that the answer is 1/3.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">from</span> scipy.integrate <span style="color: #8b0000;">import</span> quad

<span style="color: #8b0000;">def</span> <span style="color: #8b2323;">integrand</span>(x):
    <span style="color: #8b0000;">return</span> x**2

ans, err = quad(integrand, 0, 1)
<span style="color: #8b0000;">print</span> ans
</pre>
</div>

<pre class="example">
0.333333333333
</pre>

<div id="outline-container-1" class="outline-2">
<h2 id="sec-1"><span class="section-number-2">1</span> double integrals</h2>
<div class="outline-text-2" id="text-1">
<p>
we use the scipy.integrate.dblquad command
</p>

<p>
Integrate \(f(x,y)=y sin(x)+x cos(y)\) over
</p>

<p>
\(\pi <= x <= 2\pi\)
</p>

<p>
\(0 <= y <= \pi\)
</p>

<p>
i.e.
</p>

<p>
\(\int_{x=\pi}^{2\pi}\int_{y=0}^{\pi}y sin(x)+x cos(y)dydx\)
</p>

<p>
The syntax in dblquad is a bit more complicated than in Matlab. We have to provide callable functions for the range of the y-variable. Here they are constants, so we create lambda functions that return the constants. Also, note that the order of arguments in the integrand is different than in Matlab.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">from</span> scipy.integrate <span style="color: #8b0000;">import</span> dblquad
<span style="color: #8b0000;">import</span> numpy <span style="color: #8b0000;">as</span> np

<span style="color: #8b0000;">def</span> <span style="color: #8b2323;">integrand</span>(y, x):
    <span style="color: #228b22;">'y must be the first argument, and x the second.'</span>
    <span style="color: #8b0000;">return</span> y * np.sin(x) + x * np.cos(y)

ans, err = dblquad(integrand, np.pi, 2*np.pi,
                   <span style="color: #8b0000;">lambda</span> x: 0,
                   <span style="color: #8b0000;">lambda</span> x: np.pi)
<span style="color: #8b0000;">print</span> ans
</pre>
</div>

<pre class="example">
-9.86960440109
</pre>

<p>
we use the tplquad command  to integrate \(f(x,y,z)=y sin(x)+z cos(x)\) over the region
</p>

<p>
\(0 <= x <= \pi\)
</p>

<p>
\(0 <= y <= 1\)
</p>

<p>
\(-1 <= z <= 1\)
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">from</span> scipy.integrate <span style="color: #8b0000;">import</span> tplquad
<span style="color: #8b0000;">import</span> numpy <span style="color: #8b0000;">as</span> np

<span style="color: #8b0000;">def</span> <span style="color: #8b2323;">integrand</span>(z, y, x):
    <span style="color: #8b0000;">return</span> y * np.sin(x) + z * np.cos(x)

ans, err = tplquad(integrand,
                   0, np.pi,  <span style="color: #ff0000; font-weight: bold;"># x limits</span>
                   <span style="color: #8b0000;">lambda</span> x: 0,
                   <span style="color: #8b0000;">lambda</span> x: 1, <span style="color: #ff0000; font-weight: bold;"># y limits</span>
                   <span style="color: #8b0000;">lambda</span> x,y: -1,
                   <span style="color: #8b0000;">lambda</span> x,y: 1) <span style="color: #ff0000; font-weight: bold;"># z limits</span>

<span style="color: #8b0000;">print</span> ans
</pre>
</div>

<pre class="example">
2.0
</pre>
</div>
</div>
<div id="outline-container-2" class="outline-2">
<h2 id="sec-2"><span class="section-number-2">2</span> Summary</h2>
<div class="outline-text-2" id="text-2">
<p>
scipy.integrate offers the same basic functionality as Matlab does. The syntax differs significantly for these simple examples, but the use of functions for the limits enables freedom to integrate over non-constant limits.</p>
</div>
</div>
<p>Copyright (C) 2013 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2013/02/02/Integrating-functions-in-python.org">org-mode source</a><p>

    </div>
  </div>
</article>



  <div class="after_post"><a href="http://jkitchin.github.io/blog/2013/02/02/Integrating-functions-in-python#disqus_thread">Read and Post Comments</a></div>
  <hr class="interblog" />
  





<article>
  <div class="blog_post">
    <header>
      <div id="Lather-rinse-and-repeat"></div>
      <h2 class="blog_post_title"><a href="/blog/2013/02/02/Lather-rinse-and-repeat/" rel="bookmark" title="Permanent Link to Lather, rinse and repeat">Lather, rinse and repeat</a></h2>
      <p><small><span class="blog_post_date">Posted February 02, 2013 at 09:00 AM</span> | categories: 
        <span class="blog_post_categories"><a href='/blog/category/recursive/'>recursive</a>, <a href='/blog/category/math/'>math</a></span> | tags: 
        | <a href="http://jkitchin.github.io/blog/2013/02/02/Lather-rinse-and-repeat#disqus_thread">View Comments</a>
      <p><small><span class="blog_post_date">Updated February 27, 2013 at 02:45 PM</span>
      </small></p>
    </header>
    <div class="post_prose">
      



<p>
<a href="http://matlab.cheme.cmu.edu/2012/05/28/lather-rinse-and-repeat/" >Matlab post</a>
</p>

<p>
Recursive functions are functions that call themselves repeatedly until some exit condition is met. Today we look at a classic example of recursive function for computing a factorial. The factorial of a non-negative integer n is denoted n!, and is defined as the product of all positive integers less than or equal to n.
</p>

<p>
The key ideas in defining a recursive function is that there needs to be some logic to identify when to terminate the function. Then, you need logic that calls the function again, but with a smaller part of the problem. Here we recursively call the function with n-1 until it gets called with n=0. 0! is defined to be 1.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">def</span> <span style="color: #8b2323;">recursive_factorial</span>(n):
    <span style="color: #228b22;">'''compute the factorial recursively. Note if you put a negative</span>
<span style="color: #228b22;">    number in, this function will never end. We also do not check if</span>
<span style="color: #228b22;">    n is an integer.'''</span>
    <span style="color: #8b0000;">if</span> n == 0:
        <span style="color: #8b0000;">return</span> 1
    <span style="color: #8b0000;">else:</span>
        <span style="color: #8b0000;">return</span> n * recursive_factorial(n - 1)

<span style="color: #8b0000;">print</span> recursive_factorial(5)
</pre>
</div>

<pre class="example">
120
</pre>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">from</span> scipy.misc <span style="color: #8b0000;">import</span> factorial
<span style="color: #8b0000;">print</span> factorial(5)
</pre>
</div>

<pre class="example">
120.0
</pre>

<div id="outline-container-0-1" class="outline-3">
<h3 id="sec-0-1"><span class="section-number-3">0.1</span> Compare to a loop solution</h3>
<div class="outline-text-3" id="text-0-1">
<p>
This example can also be solved by a loop. This loop is easier to read and understand than the recursive function. Note the recursive nature of defining the variable as itself times a number.
</p>

<div class="org-src-container">

<pre class="src src-python">n = 5
factorial_loop = 1
<span style="color: #8b0000;">for</span> i <span style="color: #8b0000;">in</span> <span style="color: #8b0000;">range</span>(1, n + 1):
    factorial_loop *= i

<span style="color: #8b0000;">print</span> factorial_loop
</pre>
</div>

<pre class="example">
120
</pre>

<p>
There are some significant differences in this example than in Matlab. 
</p>

<ol>
<li>the syntax of the for loop is quite different with the use of the <code>in</code> operator.
</li>
<li>python has the nice *= operator to replace a = a * i
</li>
<li>We have to loop from 1 to n+1 because the last number in the range is not returned.
</li>
</ol>
</div>
</div>
<div id="outline-container-1" class="outline-2">
<h2 id="sec-1"><span class="section-number-2">1</span> Conclusions</h2>
<div class="outline-text-2" id="text-1">
<p>
Recursive functions have a special niche in mathematical programming. There is often another way to accomplish the same goal. That is not always true though, and in a future post we will examine cases where recursion is the only way to solve a problem.
</p>
</div>
</div>
<p>Copyright (C) 2013 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2013/02/02/Lather,-rinse-and-repeat.org">org-mode source</a><p>

    </div>
  </div>
</article>



  <div class="after_post"><a href="http://jkitchin.github.io/blog/2013/02/02/Lather-rinse-and-repeat#disqus_thread">Read and Post Comments</a></div>
  <hr class="interblog" />
  





<article>
  <div class="blog_post">
    <header>
      <div id="On-the-quad-or-trapz-d-in-ChemE-heaven"></div>
      <h2 class="blog_post_title"><a href="/blog/2013/02/02/On-the-quad-or-trapz-d-in-ChemE-heaven/" rel="bookmark" title="Permanent Link to On the quad or trapz'd in ChemE heaven">On the quad or trapz'd in ChemE heaven</a></h2>
      <p><small><span class="blog_post_date">Posted February 02, 2013 at 09:00 AM</span> | categories: 
        <span class="blog_post_categories"><a href='/blog/category/python/'>python</a>, <a href='/blog/category/integration/'>integration</a></span> | tags: 
        | <a href="http://jkitchin.github.io/blog/2013/02/02/On-the-quad-or-trapz-d-in-ChemE-heaven#disqus_thread">View Comments</a>
      <p><small><span class="blog_post_date">Updated February 27, 2013 at 02:53 PM</span>
      </small></p>
    </header>
    <div class="post_prose">
      



<p>


<a href="http://matlab.cheme.cmu.edu/2011/09/12/on-the-quad-or-trapzd-in-cheme-heaven/" >Matlab post</a>
</p>

<p>
What is the difference between quad and trapz? The short answer is that quad integrates functions (via a function handle) using numerical quadrature, and trapz performs integration of arrays of data using the trapezoid method.
</p>

<p>
Let us look at some examples. We consider the example of computing \(\int_0^2 x^3 dx\). the analytical integral is \(1/4 x^4\), so we know the integral evaluates to 16/4 = 4. This will be our benchmark for comparison to the numerical methods.
</p>

<p>
We use the scipy.integrate.quad command  to evaluate this \(\int_0^2 x^3 dx\).
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">from</span> scipy.integrate <span style="color: #8b0000;">import</span> quad

ans, err = quad(<span style="color: #8b0000;">lambda</span> x: x**3, 0, 2)
<span style="color: #8b0000;">print</span> ans
</pre>
</div>

<pre class="example">
4.0
</pre>

<p>
you can also define a function for the integrand.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">from</span> scipy.integrate <span style="color: #8b0000;">import</span> quad

<span style="color: #8b0000;">def</span> <span style="color: #8b2323;">integrand</span>(x):
    <span style="color: #8b0000;">return</span> x**3

ans, err = quad(integrand, 0, 2)
<span style="color: #8b0000;">print</span> ans
</pre>
</div>

<pre class="example">
4.0
</pre>

<div id="outline-container-1" class="outline-2">
<h2 id="sec-1"><span class="section-number-2">1</span> Numerical data integration</h2>
<div class="outline-text-2" id="text-1">
<p>
if we had numerical data like this, we use trapz to integrate it
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">import</span> numpy <span style="color: #8b0000;">as</span> np

x = np.array([0, 0.5, 1, 1.5, 2])
y = x**3

i2 = np.trapz(y, x)

error = (i2 - 4)/4

<span style="color: #8b0000;">print</span> i2, error
</pre>
</div>

<pre class="example">
4.25 0.0625
</pre>

<p>
Note the integral of these vectors is greater than 4! You can see why here.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">import</span> numpy <span style="color: #8b0000;">as</span> np
<span style="color: #8b0000;">import</span> matplotlib.pyplot <span style="color: #8b0000;">as</span> plt
x = np.array([0, 0.5, 1, 1.5, 2])
y = x**3

x2 = np.linspace(0, 2)
y2 = x2**3

plt.plot(x, y, label=<span style="color: #228b22;">'5 points'</span>)
plt.plot(x2, y2, label=<span style="color: #228b22;">'50 points'</span>)
plt.legend()
plt.savefig(<span style="color: #228b22;">'images/quad-1.png'</span>)
</pre>
</div>

<p><img src="/img/./images/quad-1.png"><p>

<p>
The trapezoid method is overestimating the area significantly. With more points, we get much closer to the analytical value.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">import</span> numpy <span style="color: #8b0000;">as</span> np

x2 = np.linspace(0, 2, 100)
y2 = x2**3

<span style="color: #8b0000;">print</span> np.trapz(y2, x2)
</pre>
</div>

<pre class="example">
4.00040812162
</pre>
</div>
</div>
<div id="outline-container-2" class="outline-2">
<h2 id="sec-2"><span class="section-number-2">2</span> Combining numerical data with quad</h2>
<div class="outline-text-2" id="text-2">
<p>
You might want to combine numerical data with the quad function if you want to perform integrals easily. Let us say you are given this data:
</p>

<p>
x = [0 0.5 1 1.5 2];
y = [0    0.1250    1.0000    3.3750    8.0000];
</p>

<p>
and you want to integrate this from x = 0.25 to 1.75. We do not have data in those regions, so some interpolation is going to be needed. Here is one approach.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">from</span> scipy.interpolate <span style="color: #8b0000;">import</span> interp1d
<span style="color: #8b0000;">from</span> scipy.integrate <span style="color: #8b0000;">import</span> quad
<span style="color: #8b0000;">import</span> numpy <span style="color: #8b0000;">as</span> np

x = [0, 0.5, 1, 1.5, 2]
y = [0,    0.1250,    1.0000,    3.3750,    8.0000]

f = interp1d(x, y)

<span style="color: #ff0000; font-weight: bold;"># numerical trapezoid method</span>
xfine = np.linspace(0.25, 1.75)
yfine = f(xfine)
<span style="color: #8b0000;">print</span> np.trapz(yfine, xfine)

<span style="color: #ff0000; font-weight: bold;"># quadrature with interpolation</span>
ans, err = quad(f, 0.25, 1.75)
<span style="color: #8b0000;">print</span> ans
</pre>
</div>

<pre class="example">
2.53199187838
2.53125
</pre>

<p>
These approaches are very similar, and both rely on linear interpolation. The second approach is simpler, and uses fewer lines of code.
</p>
</div>
</div>
<div id="outline-container-3" class="outline-2">
<h2 id="sec-3"><span class="section-number-2">3</span> Summary</h2>
<div class="outline-text-2" id="text-3">
<p>
trapz and quad are functions for getting integrals. Both can be used with numerical data if interpolation is used. The syntax for the quad and trapz function is different in scipy than in Matlab.
</p>

<p>
Finally, see this <a href="http://matlab.cheme.cmu.edu/2011/08/30/solving-integral-equations/" >post</a> for an example of solving an integral equation using quad and fsolve.</p>
</div>
</div>
<p>Copyright (C) 2013 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2013/02/02/On-the-quad-or-trapz'd-in-ChemE-heaven.org">org-mode source</a><p>

    </div>
  </div>
</article>



  <div class="after_post"><a href="http://jkitchin.github.io/blog/2013/02/02/On-the-quad-or-trapz-d-in-ChemE-heaven#disqus_thread">Read and Post Comments</a></div>
  <hr class="interblog" />
  





<article>
  <div class="blog_post">
    <header>
      <div id="Solving-a-second-order-ode"></div>
      <h2 class="blog_post_title"><a href="/blog/2013/02/02/Solving-a-second-order-ode/" rel="bookmark" title="Permanent Link to Solving a second order ode">Solving a second order ode</a></h2>
      <p><small><span class="blog_post_date">Posted February 02, 2013 at 09:00 AM</span> | categories: 
        <span class="blog_post_categories"><a href='/blog/category/ode/'>ode</a>, <a href='/blog/category/math/'>math</a></span> | tags: 
        | <a href="http://jkitchin.github.io/blog/2013/02/02/Solving-a-second-order-ode#disqus_thread">View Comments</a>
      <p><small><span class="blog_post_date">Updated February 27, 2013 at 02:32 PM</span>
      </small></p>
    </header>
    <div class="post_prose">
      



<p>
<a href="http://matlab.cheme.cmu.edu/2011/09/26/solving-a-second-order-ode/" >Matlab post</a>

</p>

<p>
The odesolvers in scipy can only solve first order ODEs, or systems of first order ODES. To solve a second order ODE, we must convert it by changes of variables to a system of first order ODES. We consider the Van der Pol oscillator here:
</p>

<p>
$$\frac{d^2x}{dt^2} - \mu(1-x^2)\frac{dx}{dt} + x = 0$$
</p>

<p>
\(\mu\) is a constant. If we let \(y=x - x^3/3\) <a href="http://en.wikipedia.org/wiki/Van_der_Pol_oscillator" >http://en.wikipedia.org/wiki/Van_der_Pol_oscillator</a>, then we arrive at this set of equations:
</p>

<p>
$$\frac{dx}{dt} = \mu(x-1/3x^3-y)$$
</p>

<p>
$$\frac{dy}{dt} = \mu/x$$
</p>

<p>
here is how we solve this set of equations. Let \(\mu=1\).
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">from</span> scipy.integrate <span style="color: #8b0000;">import</span> odeint
<span style="color: #8b0000;">import</span> numpy <span style="color: #8b0000;">as</span> np

mu = 1.0

<span style="color: #8b0000;">def</span> <span style="color: #8b2323;">vanderpol</span>(X, t):
    x = X[0]
    y = X[1]
    dxdt = mu * (x - 1./3.*x**3 - y)
    dydt = x / mu
    <span style="color: #8b0000;">return</span> [dxdt, dydt]

X0 = [1, 2]
t = np.linspace(0, 40, 250)

sol = odeint(vanderpol, X0, t)

<span style="color: #8b0000;">import</span> matplotlib.pyplot <span style="color: #8b0000;">as</span> plt
x = sol[:, 0]
y = sol[:, 1]

plt.plot(t,x, t, y)
plt.xlabel(<span style="color: #228b22;">'t'</span>)
plt.legend((<span style="color: #228b22;">'x'</span>, <span style="color: #228b22;">'y'</span>))
plt.savefig(<span style="color: #228b22;">'images/vanderpol-1.png'</span>)

<span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">phase portrait</span>
plt.figure()
plt.plot(x,y)
plt.plot(x[0], y[0], <span style="color: #228b22;">'ro'</span>)
plt.xlabel(<span style="color: #228b22;">'x'</span>)
plt.ylabel(<span style="color: #228b22;">'y'</span>)
plt.savefig(<span style="color: #228b22;">'images/vanderpol-2.png'</span>)
</pre>
</div>

<p><img src="/img/./images/vanderpol-1.png"><p>

<p>
Here is the phase portrait. You can see that a limit cycle is approached, indicating periodicity in the solution.
</p>

<p><img src="/img/./images/vanderpol-2.png"><p>
<p>Copyright (C) 2013 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2013/02/02/Solving-a-second-order-ode.org">org-mode source</a><p>

    </div>
  </div>
</article>



  <div class="after_post"><a href="http://jkitchin.github.io/blog/2013/02/02/Solving-a-second-order-ode#disqus_thread">Read and Post Comments</a></div>
  <hr class="interblog" />
  





<article>
  <div class="blog_post">
    <header>
      <div id="Some-of-this-sum-of-that"></div>
      <h2 class="blog_post_title"><a href="/blog/2013/02/02/Some-of-this-sum-of-that/" rel="bookmark" title="Permanent Link to Some of this, sum of that">Some of this, sum of that</a></h2>
      <p><small><span class="blog_post_date">Posted February 02, 2013 at 09:00 AM</span> | categories: 
        <span class="blog_post_categories"><a href='/blog/category/miscellaneous/'>miscellaneous</a>, <a href='/blog/category/recursive/'>recursive</a></span> | tags: 
        | <a href="http://jkitchin.github.io/blog/2013/02/02/Some-of-this-sum-of-that#disqus_thread">View Comments</a>
      <p><small><span class="blog_post_date">Updated February 27, 2013 at 02:44 PM</span>
      </small></p>
    </header>
    <div class="post_prose">
      



<p>
<a href="http://matlab.cheme.cmu.edu/2012/05/29/some-of-this-sum-of-that/" >Matlab plot</a>
</p>

<p>
Python provides a sum function to compute the sum of a list. However, the sum function does not work on every arrangement of numbers, and it certainly does not work on nested lists. We will solve this problem with recursion.
</p>

<p>
Here is a simple example.
</p>

<div class="org-src-container">

<pre class="src src-python">v = [1, 2, 3, 4, 5, 6, 7, 8, 9] <span style="color: #ff0000; font-weight: bold;"># a list</span>
<span style="color: #8b0000;">print</span> sum(v)

v = (1, 2, 3, 4, 5, 6, 7, 8, 9)  <span style="color: #ff0000; font-weight: bold;"># a tuple</span>
<span style="color: #8b0000;">print</span> sum(v)
</pre>
</div>

<pre class="example">
45
45
</pre>

<p>
If you have data in a dictionary, sum works by default on the keys. You can give the sum function the values like this.
</p>

<div class="org-src-container">

<pre class="src src-python">v = {<span style="color: #228b22;">'a'</span>:1, <span style="color: #228b22;">'b'</span>:3, <span style="color: #228b22;">'c'</span>:4}
<span style="color: #8b0000;">print</span> sum(v.values())
</pre>
</div>

<pre class="example">
8
</pre>

<div id="outline-container-1" class="outline-2">
<h2 id="sec-1"><span class="section-number-2">1</span> Nested lists</h2>
<div class="outline-text-2" id="text-1">
<p>
Suppose now we have nested lists. This kind of structured data might come up if you had grouped several things together. For example, suppose we have 5 departments, with 1, 5, 15, 7 and 17 people in them, and in each department they are divided into groups.
</p>

<p>
Department 1: 1 person
Department 2: group of 2 and group of 3
Department 3: group of 4 and 11, with a subgroups of 5 and 6 making
              up the group of 11.
Department 4: 7 people
Department 5: one group of 8 and one group of 9.
</p>

<p>
We might represent the data like this nested list. Now, if we want to compute the total number of people, we need to add up each group. We cannot simply sum the list, because some elements are single numbers, and others are lists, or lists of lists. We need to recurse through each entry until we get down to a number, which we can add to the running sum. 
</p>
<div class="org-src-container">

<pre class="src src-python">v = [1, 
    [2, 3],
    [4, [5, 6]],
    7,
    [8,9]]

<span style="color: #8b0000;">def</span> recursive_<span style="color: #8b0000;">sum</span>(X):
    <span style="color: #228b22;">'compute sum of arbitrarily nested lists'</span>
    s = 0 <span style="color: #ff0000; font-weight: bold;"># initial value of the sum</span>

    <span style="color: #8b0000;">for</span> i <span style="color: #8b0000;">in</span> <span style="color: #8b0000;">range</span>(len(X)):
        <span style="color: #8b0000;">import</span> types  <span style="color: #ff0000; font-weight: bold;"># we use this to test if we got a number</span>
        <span style="color: #8b0000;">if</span> <span style="color: #8b0000;">isinstance</span>(X[i], (types.IntType,
                             types.LongType,
                             types.FloatType,
                             types.ComplexType)):
            <span style="color: #ff0000; font-weight: bold;"># this is the terminal step</span>
            s += X[i]
        <span style="color: #8b0000;">else:</span>
            <span style="color: #ff0000; font-weight: bold;"># we did not get a number, so we recurse</span>
            s += recursive_<span style="color: #8b0000;">sum</span>(X[i])
    <span style="color: #8b0000;">return</span> s

<span style="color: #8b0000;">print</span> recursive_<span style="color: #8b0000;">sum</span>(v)
<span style="color: #8b0000;">print</span> recursive_<span style="color: #8b0000;">sum</span>([1,2,3,4,5,6,7,8,9]) <span style="color: #ff0000; font-weight: bold;"># test on non-nested list</span>
</pre>
</div>

<pre class="example">
45
45
</pre>

<p>
In <a href="http://matlab.cheme.cmu.edu/2012/05/28/lather-rinse-and-repeat/" >Post 1970</a> we examined recursive functions that could be replaced by loops. Here we examine a function that can only work with recursion because the nature of the nested data structure is arbitrary. There are arbitary branches and depth in the data structure. Recursion is nice because you do not have to define that structure in advance.
</p>
</div>
</div>
<p>Copyright (C) 2013 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2013/02/02/Some-of-this,-sum-of-that.org">org-mode source</a><p>

    </div>
  </div>
</article>



  <div class="after_post"><a href="http://jkitchin.github.io/blog/2013/02/02/Some-of-this-sum-of-that#disqus_thread">Read and Post Comments</a></div>
  <hr class="interblog" />
 <a href="../44">« Previous Page</a>
  --  
 <a href="../46">Next Page »</a>

          </div>
          <div id="sidebar" class="grid_4">
            <aside>
<section>
Search
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:kitchingroup.cheme.cmu.edu" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
</section>


  <section>
    <h1 class="post_header_gradient theme_font">Links</h1>
    <ul>
    <li><a href="http://enthought.com">Enthought Python</a></li>
    <li><a href="/pycse">Pycse</a></li>
    <li><a href="/dft-book">DFT-book</a></li>
    </ul>
  </section>

  <section>
    <h1 class="post_header_gradient theme_font">Latest Posts</h1>
    <ul>
      <li><a href="/blog/2014/03/27/Literate-programming-in-python-with-org-mode-and-noweb/">Literate programming in python with org-mode and noweb</a></li>
      <li><a href="/blog/2014/03/26/writing-VASP-calculations-to-ase-db-formats/">writing VASP calculations to ase.db formats</a></li>
      <li><a href="/blog/2014/03/25/Deleting-multiple-elements-of-a-list/">Deleting multiple elements of a list</a></li>
      <li><a href="/blog/2014/03/24/Using-tags-searches-on-objects-in-python/">Using tags searches on objects in python</a></li>
      <li><a href="/blog/2014/03/24/Mehak-Chawla-selected-as-the-H-William-and-Ruth-Hamilton-Prengle-Fellow-of-Chemical-Enginering-for-2013-2014/">Mehak Chawla selected as the H. William and Ruth Hamilton Prengle Fellow of Chemical Enginering for 2013-2014</a></li>
    </ul>
  </section>

  <section>
 <h1 class="post_header_gradient theme_font"><a href="http://www.citeulike.org/user/jkitchin" class="external text" title="http://www.citeulike.org/user/jkitchin" rel="nofollow">CiteULike</a> Reading List</h1>
<script type="text/javascript" src="http://code.jquery.com/jquery-1.7.1.min.js"></script>
<script type="text/javascript">
$(document).ready(function() {

var d = new Date();
curr_year = d.getFullYear();

$.getJSON('http://www.citeulike.org/json/user/jkitchin/,,?callback=?&per_page=5',
function(data) {
  var items = [];
  year=curr_year
  $.each(data, function(i) {
    year=data[i].published[0];
    var cit='<li id="' + i + '">' + '<a class="pap" href="http://dx.doi.org/'+data[i].doi+'">'+ data[i].title + '</a><br>';
    cit+='</li>';
    items.push( cit )      
  });

  $('<ul/>', {
    'class': 'my-new-list',
    html: items.join('')
  }).appendTo('#papers2');
});
});
</script>

<div id="papers2"></div>

  </section>

<section>
<h1 class="post_header_gradient theme_font">Latest GitHub Repos</h1>
  <a href="https://github.com/jkitchin">@jkitchin</a> on GitHub.
<ul id="my-github-projects">
    <li class="loading">Status updating&#8230;</li>
  </ul>

</section>
</aside>

          </div>
          <div class="clear"></div>
        </div>
      </div>
      
<footer>
  <div id="footer" class="grid_12">
    <div class="grid_8">
      <p>
        <a href="/blog/feed/index.xml">RSS</a>
        <a href="http://kitchinresearchgroup.disqus.com/latest.rss">Comments RSS Feed</a>.
      </p>
    </div>
    <div class="grid_4" id="credits">
      <p>
        Copyright 2014
        John Kitchin
      </p>
      <p>
        Powered by <a href="http://www.blogofile.com">Blogofile</a>
      </p>
    </div>
  </div>
</footer>

    </div>
      <script src="//ajax.googleapis.com/ajax/libs/jquery/1.5.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="/js/libs/jquery-1.5.1.min.js"%3E%3C/script%3E'))</script>
  <script src="/js/plugins.js"></script>
  <script src="/js/script.js"></script>
  <script src="/js/jquery.tweet.js"></script>  
  <script src="/js/site.js"></script>
  <!--[if lt IE 7 ]>
  <script src="js/libs/dd_belatedpng.js"></script>
  <script> DD_belatedPNG.fix('img, .png_bg');</script>
  <![endif]-->
  <script>
      var _gaq=[['_setAccount','UA-35731398-1'],['_trackPageview']];
      (function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];g.async=1;
      g.src=('https:'==location.protocol?'//ssl':'//www')+'.google-analytics.com/ga.js';
      s.parentNode.insertBefore(g,s)}(document,'script'));
  </script>
  <script>
  (function() {
      var links = document.getElementsByTagName('a');
      var query = '?';
      for(var i = 0; i < links.length; i++) {
          if(links[i].href.indexOf('#disqus_thread') >= 0) {
              query += 'url' + i + '=' + encodeURIComponent(links[i].href) + '&';
          }
      }
      document.write('<script charset="utf-8" type="text/javascript" src="http://disqus.com/forums/kitchinresearchgroup/get_num_replies.js' + query + '"></' + 'script>');
  })();
  </script>

  </body>
</html>






<script src="http://ajax.microsoft.com/ajax/jquery/jquery-1.4.2.min.js" type="text/javascript"></script>
<script src="/js/git.js" type="text/javascript"></script>
<script type="text/javascript">
    $(function() {
     $("#my-github-projects").loadRepositories("jkitchin");
    });
</script>



