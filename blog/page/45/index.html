

<!doctype html>
<!--[if lt IE 7 ]> <html lang="en" class="no-js ie6"> <![endif]-->
<!--[if IE 7 ]>    <html lang="en" class="no-js ie7"> <![endif]-->
<!--[if IE 8 ]>    <html lang="en" class="no-js ie8"> <![endif]-->
<!--[if IE 9 ]>    <html lang="en" class="no-js ie9"> <![endif]-->
<!--[if (gt IE 9)|!(IE)]><!--> <html lang="en" class="no-js"> <!--<![endif]-->
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>The Kitchin Research Group</title>
  <meta name="google-site-verification" content="CGcacJdHc2YoZyI0Vey9XRA5qwhhFDzThKJezbRFcJ4" />
  <meta name="description" content="Chemical Engineering at Carnegie Mellon University">
  <meta name="author" content="John Kitchin">
  <link rel="alternate" type="application/rss+xml" title="RSS 2.0" href="/blog/feed" />
  <link rel="alternate" type="application/atom+xml" title="Atom 1.0" href="/blog/feed/atom" />
  <link rel="shortcut icon" href="/favicon.ico">
  <link rel="apple-touch-icon" href="/img/apple-touch-icon.png">

  <link rel="stylesheet" href="/css/base.css?v=1">
  <link rel="stylesheet" href="/css/grid.css?v=1">
  <link rel="stylesheet" media="handheld" href="/css/handheld.css?v=1">
  <link rel="stylesheet" href="/css/pygments_murphy.css" type="text/css" />

  <script src="/js/libs/modernizr-1.7.min.js"></script>
<script type="text/javascript"
  src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
  <link rel="stylesheet" href="/themes/theme1/style.css?v=1">
<link href='http://fonts.googleapis.com/css?family=Roboto' rel='stylesheet' type='text/css'>

</head>
  <body>
    <div id="container" class="container container_12">
      <div id="main" role="main">
        <div id="main_block">
          <header>
<div id="header" class="header_gradient theme_font">
<table><tr><td>
    <h1><a href="/">The Kitchin Research Group</a></h1>
    <h2>Chemical Engineering at Carnegie Mellon University</h2>
</td>
<td colspan=100%><div style="float:right;width:100%;text-align:right;"> <span id='badgeCont737515' style='width:126px'><script src='http://labs.researcherid.com/mashlets?el=badgeCont737515&mashlet=badge&showTitle=false&className=a&rid=A-2363-2010'></script></span></div>
</td></tr>
</table>
</div>
  <div id="navigation" class="grid_12">

    <ul class="theme_font">
      <li><a href="/blog"
             class="">Blog</a></li>

      <li><a href="/blog/archive"
             class="">Archives</a></li>

      <li><a href="/publications.html">Publications</a></li>
      <li><a href="/group.html">Group</a></li>

      <li><a href="/research.html"
             class="">Research</a></li>

      <li><a href="/categories.html"
             class="">Categories</a></li>

      <li><a href="/about.html"
             class="">About us</a></li>

      <li><a href="/subscribe.html">Subscribe</a></li>

    </ul>
  </div>
</header>

          <div id="prose_block" class="grid_8">
            
  





<article>
  <div class="blog_post">
    <header>
      <div id="A-helm-interface-to-ps"></div>
      <h2 class="blog_post_title"><a href="/blog/2014/11/22/A-helm-interface-to-ps/" rel="bookmark" title="Permanent Link to A helm interface to ps">A helm interface to ps</a></h2>
      <p><small><span class="blog_post_date">Posted November 22, 2014 at 12:57 PM</span> | categories:
        <span class="blog_post_categories"><a href='/blog/category/helm-emacs/'>helm emacs</a></span> | tags: 
        | <a href="http://jkitchin.github.io/blog/2014/11/22/A-helm-interface-to-ps#disqus_thread">View Comments</a>
      <p><small><span class="blog_post_date">Updated November 22, 2014 at 03:00 PM</span>
      </small></p>
    </header>
    <div class="post_prose">
      



<p>
Occassionally, I need to find the PID of a process to kill it or do something else. Usually I do the old-school unix thing  of piping the output of one command (ps) to another command (grep) to filter out interesting lines. Then, I can do something with that output.
</p>

<div class="org-src-container">

<pre class="src src-sh">ps aux | grep emacs
</pre>
</div>

<pre class="example">
jkitchin         4781   3.1  0.8  2639316  70432 s002  S    12:45PM   0:06.68 /usr/local/Cellar/emacs/HEAD/Emacs.app/Contents/MacOS/Emacs
jkitchin         4777   0.0  0.0  2433364    932 s002  S    12:45PM   0:00.00 /bin/bash /usr/local/bin/emacs
jkitchin         4874   0.0  0.0  2432784    604   ??  S    12:46PM   0:00.00 grep emacs
</pre>

<p>
Today, I will explore using helm in emacs to do something like that. The idea is to create a helm command that uses the output of ps as candidates, and then you select the process you want through the helm interface, and then select an action.
</p>

<p>
It is easy enough to get the output of the ps command in emacs like this. Here, we just get the first three results, and specify the output we want.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #8b0000;">let</span> ((results (split-string
                (shell-command-to-string
                 <span style="color: #228b22;">"ps x -o ruser,pid,command"</span>) <span style="color: #228b22;">"\n"</span>)))
  (loop for i from 1 to 3
        collect (elt results i)))
</pre>
</div>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #228b22;">"jkitchin   139 /sbin/launchd"</span> <span style="color: #228b22;">"jkitchin   151 /usr/libexec/UserEventAgent (Aqua)"</span> <span style="color: #228b22;">"jkitchin   152 /usr/sbin/distnoted agent"</span>)
</pre>
</div>

<p>
These will be the candidates for the helm command. We will create a few actions. One will provide details about the pid, and one could in principle kill the pid or send some signal to it. We will just have these actions create message boxes for us to see helm in action. We will make the kill function interactive, so it allows an arbitrary signal to be sent. The other actions are placeholders for future actions, and so we can show off some shortcuts in helm later.
</p>

<p>
For the candidates, we will construct a list of cons cells where the car is a line from ps, and that is what will show in the helm selection interface, and the cdr will be the pid which we get by parsing the line to get the second element. When you select an entry in helm, the cdr of that entry (if it exists) is passed to the action function selected.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #8b0000;">defun</span> <span style="color: #8b2323;">ps-candidates</span> ()
  <span style="color: #228b22;">"return a list of cons cells (line . pid) for the output of ps"</span>
  (loop for line in
        ;; <span style="color: #ff0000; font-weight: bold;">skip the first line which is a header</span>
        (cdr (split-string
              (shell-command-to-string
               <span style="color: #228b22;">"ps ax -o ruser,pid,command"</span>) <span style="color: #228b22;">"\n"</span>))
        collect
        (cons
         line
         (elt (split-string line) 1))))

(<span style="color: #8b0000;">defun</span> <span style="color: #8b2323;">ps-details</span> (pid)
  <span style="color: #228b22;">"give details of PID."</span>
  (message-box <span style="color: #228b22;">"%s"</span> (shell-command-to-string (format <span style="color: #228b22;">"ps ux %s"</span> pid))))

(<span style="color: #8b0000;">defun</span> <span style="color: #8b2323;">ps-kill</span> (pid)
  <span style="color: #228b22;">"Message box instead of killing PID."</span>
  (<span style="color: #8b0000;">let</span> ((SIG (read-string <span style="color: #228b22;">"Kill with signal: "</span>)))
    (message-box <span style="color: #228b22;">"Killing pid %s with signal %s"</span> pid SIG)))

(<span style="color: #8b0000;">defun</span> <span style="color: #8b2323;">ps-hello</span> (pid)
  (message-box <span style="color: #228b22;">"Silly 3rd action for %s"</span> pid))

(<span style="color: #8b0000;">defun</span> <span style="color: #8b2323;">ps-bye</span> (pid)
  (message-box <span style="color: #228b22;">"Silly 4th action for %s"</span> pid))

(<span style="color: #8b0000;">defun</span> <span style="color: #8b2323;">ps-byebye</span> (pid)
  (message-box <span style="color: #228b22;">"Silly 5th action for %s"</span> pid))

;; <span style="color: #ff0000; font-weight: bold;">the source variable for helm</span>
(setq helm-source-ps '((name . <span style="color: #228b22;">"ps output"</span>)
                       ;; <span style="color: #ff0000; font-weight: bold;">these are the entries you can select</span>
                       (candidates . ps-candidates)
                       ;; <span style="color: #ff0000; font-weight: bold;">these are the actions available for the</span>
                       ;; <span style="color: #ff0000; font-weight: bold;">selected entry. each function gets the cdr</span>
                       ;; <span style="color: #ff0000; font-weight: bold;">of the entry selected.</span>
                       (action . ((<span style="color: #228b22;">"details"</span> . ps-details)
                                  (<span style="color: #228b22;">"kill"</span> . ps-kill)
                                  (<span style="color: #228b22;">"hello"</span> . ps-hello)
                                  (<span style="color: #228b22;">"bye"</span> . ps-bye)
                                  (<span style="color: #228b22;">"byb-bye"</span> . ps-byebye)))))

;; <span style="color: #ff0000; font-weight: bold;">now we run the helm command</span>
(helm <span style="color: #cd0000;">:sources</span> '(helm-source-ps))
</pre>
</div>


<p>
You can navigate the helm interface with the arrows, or C-n (next/down) C-p (previous/up), or by typing in the pattern you want to match. There are only two actions here. The first one is the default action, which you can run by pressing tab or enter. The subtle difference between them is that tab leaves the helm window open, while enter runs the default action and closes the helm window. You can get it back with C-c h r (or M-x helm-resume). 
</p>

<p>
To get the kill function, you can press C-z to get the action menu, and then press enter. Helm provides a shortcut for this. C-e selects the second action, so when you remember what the second action is and you want it, you can skip the C-z activity. You can access the third action with C-j. There is a command like helm-select-4th-action, but it is not bound to a key, so we have to make one like this.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(define-key helm-map (kbd <span style="color: #228b22;">"C-k"</span>) 'helm-select-4th-action)
</pre>
</div>

<p>
You can also define a 5th action like this. It does not seem possible to define an arbitrary nth action, because you cannot get an input for n while helm uses the minibuffer. 
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #8b0000;">defun</span> <span style="color: #8b2323;">5th-action</span> ()
 (interactive)
 (<span style="color: #8b0000;">let</span> ((n 5))
   ;; <span style="color: #ff0000; font-weight: bold;">actions start at 0, so the 5th action is actually indexed at 4</span>
   (helm-select-nth-action (- n 1))))

(define-key helm-map (kbd <span style="color: #228b22;">"C-l"</span>) '5th-action)
</pre>
</div>

<p>
That is the proof of concept in using a helm interface to interact with unix commands. There are other actions you might choose, like renice, or maybe it is possible to suspend a job by pid. The real application for this I had in mind was interaction with the Torque queue system, where you might want to modify, kill jobs in the queue system this way. I could also see applications in user management, where you have some well defined functions to run, e.g. checking quotas, changing passwords, etc&#x2026; Clearly the utility of this approach rests heavily on there being a set of actions you do regularly enough to justify coding them into functions, and often enough you would remember to use your helm command! It is an interesting approach as an alternative to writing shell scripts to do this though.
</p>

<p>
This post might make more sense if you watch this video of the helm interface in action: <a href="http://www.youtube.com/watch?v=3FImB6OwHI0">http://www.youtube.com/watch?v=3FImB6OwHI0</a> </p>
<p>Copyright (C) 2014 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2014/11/22/A-helm-interface-to-ps.org">org-mode source</a><p><p>Org-mode version = 8.2.7c</p>

    </div>
  </div>
</article>



<a href="https://twitter.com/share" class="twitter-share-button" data-via="johnkitchin">Tweet</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>

  <div class="after_post"><a href="http://jkitchin.github.io/blog/2014/11/22/A-helm-interface-to-ps#disqus_thread">Read and Post Comments</a></div>
  <hr class="interblog" />
  





<article>
  <div class="blog_post">
    <header>
      <div id="The-loop-macro-in-emacs-lisp"></div>
      <h2 class="blog_post_title"><a href="/blog/2014/11/20/The-loop-macro-in-emacs-lisp/" rel="bookmark" title="Permanent Link to The loop macro in emacs lisp">The loop macro in emacs lisp</a></h2>
      <p><small><span class="blog_post_date">Posted November 20, 2014 at 09:50 AM</span> | categories:
        <span class="blog_post_categories"><a href='/blog/category/emacs-lisp/'>emacs_lisp</a></span> | tags: 
        | <a href="http://jkitchin.github.io/blog/2014/11/20/The-loop-macro-in-emacs-lisp#disqus_thread">View Comments</a>
      </small></p>
    </header>
    <div class="post_prose">
      



<p>
I was reading <a href="http://landoflisp.com">The Land Of Lisp</a> chapter on the loop macro in Common Lisp. I am not too familiar with it, or the implementation in emacs-lisp, so in this post we explore what it can do. Here I will explore some uses of the loop macro to do things I used to do in Python all the time.
</p>

<p>
Here is a simple example to generate a list of numbers with the loop macro..
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(loop for i
      below 5
      collect i)
</pre>
</div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="right" />

<col  class="right" />

<col  class="right" />

<col  class="right" />

<col  class="right" />
</colgroup>
<tbody>
<tr>
<td class="right">0</td>
<td class="right">1</td>
<td class="right">2</td>
<td class="right">3</td>
<td class="right">4</td>
</tr>
</tbody>
</table>

<p>
Evidently, i starts at 0, and increments by one. We can specify a different value like this. Here we use the <code>to</code> token, which also includes the last value.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(loop for i from 2 to 10
  collect i)
</pre>
</div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="right" />

<col  class="right" />

<col  class="right" />

<col  class="right" />

<col  class="right" />

<col  class="right" />

<col  class="right" />

<col  class="right" />

<col  class="right" />
</colgroup>
<tbody>
<tr>
<td class="right">2</td>
<td class="right">3</td>
<td class="right">4</td>
<td class="right">5</td>
<td class="right">6</td>
<td class="right">7</td>
<td class="right">8</td>
<td class="right">9</td>
<td class="right">10</td>
</tr>
</tbody>
</table>

<p>
IF you want to go backwards:
</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp">(loop for i downfrom 10 to 2 collect i)
</pre>
</div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="right" />

<col  class="right" />

<col  class="right" />

<col  class="right" />

<col  class="right" />

<col  class="right" />

<col  class="right" />

<col  class="right" />

<col  class="right" />
</colgroup>
<tbody>
<tr>
<td class="right">10</td>
<td class="right">9</td>
<td class="right">8</td>
<td class="right">7</td>
<td class="right">6</td>
<td class="right">5</td>
<td class="right">4</td>
<td class="right">3</td>
<td class="right">2</td>
</tr>
</tbody>
</table>

<p>
And if you want an (de)increment different than one, use the <code>by</code> token.
</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp">(loop for i downfrom 10 to 2 by 3 collect i)
</pre>
</div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="right" />

<col  class="right" />

<col  class="right" />
</colgroup>
<tbody>
<tr>
<td class="right">10</td>
<td class="right">7</td>
<td class="right">4</td>
</tr>
</tbody>
</table>

<p>
We can use this to iterate over a list too. Let us collect the square of each element in a simple list. This is similar to the mapcar function.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(loop for i in '(1 2 3 4)
  collect (* i i))
</pre>
</div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="right" />

<col  class="right" />

<col  class="right" />

<col  class="right" />
</colgroup>
<tbody>
<tr>
<td class="right">1</td>
<td class="right">4</td>
<td class="right">9</td>
<td class="right">16</td>
</tr>
</tbody>
</table>

<p>
You can combine the ideas to get something similar to the enumerate function in python. 
</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp">(loop for i
      from 0
      for month
      in '(january february march april may june july august september
                   october november december)
      collect (cons i month))
</pre>
</div>

<div class="org-src-container">

<pre class="src src-emacs-lisp">((0 . january)
 (1 . february)
 (2 . march)
 (3 . april)
 (4 . may)
 (5 . june)
 (6 . july)
 (7 . august)
 (8 . september)
 (9 . october)
 (10 . november)
 (11 . december))
</pre>
</div>

<p>
The loop stops because we run out of months to iterate over.  Here is a variation like the zip function in python.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(loop for element1 in '(a b c d)
      for element2 in '(1 2 3 4)
      collect (list element1 element2))
</pre>
</div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="left" />

<col  class="right" />
</colgroup>
<tbody>
<tr>
<td class="left">a</td>
<td class="right">1</td>
</tr>

<tr>
<td class="left">b</td>
<td class="right">2</td>
</tr>

<tr>
<td class="left">c</td>
<td class="right">3</td>
</tr>

<tr>
<td class="left">d</td>
<td class="right">4</td>
</tr>
</tbody>
</table>

<p>
We can sum in the loop:
</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp">(loop for i in '(100 200 300) sum i)
</pre>
</div>

<pre class="example">
600
</pre>

<p>
We can conditionally sum things in the loop, e.g. sum only the odd numbers.
</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp">(loop for i in '(1 2 3 4 5)
  when (oddp i)
  sum i)
</pre>
</div>

<pre class="example">
9
</pre>

<p>
We can find the minima and maxima in a list
</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp">(loop for i in '(-1 0 1)
  minimize i)
</pre>
</div>

<pre class="example">
-1
</pre>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(loop for i in '(-1 0 1)
  maximize i)
</pre>
</div>

<pre class="example">
1
</pre>

<p>
You may want to do some action in the loop. Say we want to print even numbers from a list.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(loop for i in '(1 2 3 4)
      when (evenp i)
      do (print i))
</pre>
</div>

<pre class="example">
2

4
</pre>

<p>
There are some ways to break out of a loop using <code>return</code> like this.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(loop for i upto 10
      when (= i 3)
      return 'done
      do (print i))
</pre>
</div>

<pre class="example">
0

1

2
</pre>

<p>
Alternatively, you can use while/until.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(loop for i downfrom 10
      do (print i)
      until (= i 6))
</pre>
</div>

<pre class="example">
10

9

8

7

6
</pre>

<p>
Or the while variation:
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(loop for i downfrom 10
      do (print i)
      while (&gt; i 6))
</pre>
</div>

<pre class="example">
10

9

8

7

6
</pre>

<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1"><span class="section-number-2">1</span> Summary</h2>
<div class="outline-text-2" id="text-1">
<p>
This is not everything the loop macro can do! Here is what the help for that function says.
</p>

<pre class="example">
loop is an alias for `cl-loop' in `cl.el'.

(loop CLAUSE...)

The Common Lisp `loop' macro.
Valid clauses include:
  For clauses:
    for VAR from/upfrom/downfrom EXPR1 to/upto/downto/above/below EXPR2 by EXPR3
    for VAR = EXPR1 then EXPR2
    for VAR in/on/in-ref LIST by FUNC
    for VAR across/across-ref ARRAY
    for VAR being:
      the elements of/of-ref SEQUENCE [using (index VAR2)]
      the symbols [of OBARRAY]
      the hash-keys/hash-values of HASH-TABLE [using (hash-values/hash-keys V2)]
      the key-codes/key-bindings/key-seqs of KEYMAP [using (key-bindings VAR2)]
      the overlays/intervals [of BUFFER] [from POS1] [to POS2]
      the frames/buffers
      the windows [of FRAME]
  Iteration clauses:
    repeat INTEGER
    while/until/always/never/thereis CONDITION
  Accumulation clauses:
    collect/append/nconc/concat/vconcat/count/sum/maximize/minimize FORM
      [into VAR]
  Miscellaneous clauses:
    with VAR = INIT
    if/when/unless COND CLAUSE [and CLAUSE]... else CLAUSE [and CLAUSE...]
    named NAME
    initially/finally [do] EXPRS...
    do EXPRS...
    [finally] return EXPR

For more details, see Info node `(cl)Loop Facility'.
</pre>

<p>
It is obviously quite powerful, although the syntax seems quite different than the usual lisp code I have been writing. It is not clear when this is superior to something like mapcar/mapconcat, or the dolist/dotimes functions. 
</p>
</div>
</div>
<p>Copyright (C) 2014 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2014/11/20/The-loop-macro-in-emacs-lisp.org">org-mode source</a><p><p>Org-mode version = 8.2.7c</p>

    </div>
  </div>
</article>



<a href="https://twitter.com/share" class="twitter-share-button" data-via="johnkitchin">Tweet</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>

  <div class="after_post"><a href="http://jkitchin.github.io/blog/2014/11/20/The-loop-macro-in-emacs-lisp#disqus_thread">Read and Post Comments</a></div>
  <hr class="interblog" />
  





<article>
  <div class="blog_post">
    <header>
      <div id="A-hint-system-for-problems-in-org-mode"></div>
      <h2 class="blog_post_title"><a href="/blog/2014/11/09/A-hint-system-for-problems-in-org-mode/" rel="bookmark" title="Permanent Link to A hint system for problems in org-mode">A hint system for problems in org-mode</a></h2>
      <p><small><span class="blog_post_date">Posted November 09, 2014 at 09:55 AM</span> | categories:
        <span class="blog_post_categories"><a href='/blog/category/org/'>org</a></span> | tags: 
        | <a href="http://jkitchin.github.io/blog/2014/11/09/A-hint-system-for-problems-in-org-mode#disqus_thread">View Comments</a>
      </small></p>
    </header>
    <div class="post_prose">
      



<p>
I use org-mode to write problems for classes that I teach. Sometimes it is helpful to be able to provide hints about aspects of the problem. I have used drawers for that before. Here I will look at another approach. The idea is to store a unique id (org-id) in the problem headline. We will make hints somewhere else, and each hint will store the id they refer to in some property. We will run a command in the problem that finds the hints, and offers a menu you can select from.
</p>

<p>
In the next sections, we define a <a href="#sec-1">Problem statement</a>, a section with <a href="#sec-2">hints</a> in it, and finally <a href="#sec-3">code</a> that defines a hint function.
</p>

<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1"><a id="ID-EE9523FF-C4FF-45D9-BABA-8832A6E48C3B" name="ID-EE9523FF-C4FF-45D9-BABA-8832A6E48C3B"></a><span class="section-number-2">1</span> Problem statement</h2>
<div class="outline-text-2" id="text-1">

<p>
What is the seventh number in the Fibonacci series?
</p>
</div>
</div>

<div id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2"><span class="section-number-2">2</span> Hints</h2>
<div class="outline-text-2" id="text-2">
<p>
Hints will be stored in headings somewhere. Here we put them in this file, but they could be stored in another file too. We give each hint a HINT property, with the problem id as the value. Here are three hints. In real example, the hints would not be this easy to find in the document. You might store them somewhere else, in another file for example.
</p>
</div>

<div id="outline-container-sec-2-1" class="outline-3">
<h3 id="sec-2-1"><span class="section-number-3">2.1</span> What is the Fibonacci series?</h3>
<div class="outline-text-3" id="text-2-1">
<p>
The $i<sup>th</sup> number in the Fibonacci series is equal to the sum of the previous two numbers in the series.
</p>
</div>
</div>


<div id="outline-container-sec-2-2" class="outline-3">
<h3 id="sec-2-2"><span class="section-number-3">2.2</span> What does the series start with?</h3>
<div class="outline-text-3" id="text-2-2">

<p>
The Fibonacci series starts with 1.
</p>
</div>
</div>

<div id="outline-container-sec-2-3" class="outline-3">
<h3 id="sec-2-3"><span class="section-number-3">2.3</span> Example of the series.</h3>
<div class="outline-text-3" id="text-2-3">
<p>
The Fibonacci series goes as 1, 1, 2, 3, 5, 8, &#x2026;
</p>
</div>
</div>
</div>


<div id="outline-container-sec-3" class="outline-2">
<h2 id="sec-3"><span class="section-number-2">3</span> The hint code</h2>
<div class="outline-text-2" id="text-3">
<p>
We want to get the id from the problem the point is in, and then find hints for the problem. Then, we construct a menu and prompt the user to select a hint. I use a number to select the hint because it was easier to generate the menu that way. I like characters better, because you just have to press a key. With numbers you type the number and press enter. We open a new buffer with the contents of the hint in it. You can close the buffer by pressing q.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #8b0000;">defun</span> <span style="color: #8b2323;">hint</span> ()
  <span style="color: #228b22;">"Present a menu of hints for the problem at point"</span>
  (interactive)
  (<span style="color: #8b0000;">let</span> ((id (org-entry-get (point) <span style="color: #228b22;">"ID"</span>))
        (entries '())
        (menu <span style="color: #228b22;">""</span>)
        choice)

    (<span style="color: #8b0000;">unless</span> id
      (<span style="color: #ff0000; font-weight: bold;">error</span> <span style="color: #228b22;">"No problem ID found"</span>))

    (org-map-entries
     (<span style="color: #8b0000;">lambda</span> ()
       (<span style="color: #8b0000;">save-restriction</span>
         (org-narrow-to-subtree)
         (add-to-list 'entries
                      (cons
                       (elt (org-heading-components) 4)
                       (buffer-string))
                      t)))
     (format <span style="color: #228b22;">"HINT=\"%s\""</span> id))

    ;; <span style="color: #ff0000; font-weight: bold;">generate menu string</span>
    (<span style="color: #8b0000;">dolist</span> (i (number-sequence 1 (length entries)))
      (setq menu (concat menu (format <span style="color: #228b22;">"[%s] %s\n"</span> (- i 1)
                                      (car (elt entries (- i 1)))))))

    (setq choice (elt entries (read-number (concat menu <span style="color: #228b22;">"Your choice: "</span>) 0)))
    ;; <span style="color: #ff0000; font-weight: bold;">this feels a little clunky. Maybe I could just save a marker to</span>
    ;; <span style="color: #ff0000; font-weight: bold;">the headline, and open it in a narrowed indirect buffer.</span>
    (<span style="color: #8b0000;">when</span> choice
      (switch-to-buffer <span style="color: #228b22;">"*hint*"</span>)
      (erase-buffer)
      (insert (cdr choice))
      
      (org-mode)
      (show-subtree)
      (setq buffer-read-only t)
      (use-local-map (copy-keymap org-mode-map))
      (local-set-key <span style="color: #228b22;">"q"</span> #'(<span style="color: #8b0000;">lambda</span> () (interactive) (kill-buffer)))
      )))
</pre>
</div>
<pre class="example">
hint
</pre>
</div>
</div>

<div id="outline-container-sec-4" class="outline-2">
<h2 id="sec-4"><span class="section-number-2">4</span> Summary</h2>
<div class="outline-text-2" id="text-4">
<p>
This seems like an interesting way to provide hints, or related information in org-mode.  You could also consider using tags, or more sophisticated code  to determine what else is relevant. For example, you might keep track of some performance metric, and use some heuristic algorithm that ranks the related information. Or perhaps fuzzy text searching, or combinations of criteria. If the number of hits got large, then the menu approach here might not be the best one. Then, something like the occur interface might be more suitable.</p>
</div>
</div>
<p>Copyright (C) 2014 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2014/11/09/A-hint-system-for-problems-in-org-mode.org">org-mode source</a><p><p>Org-mode version = 8.2.7c</p>

    </div>
  </div>
</article>



<a href="https://twitter.com/share" class="twitter-share-button" data-via="johnkitchin">Tweet</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>

  <div class="after_post"><a href="http://jkitchin.github.io/blog/2014/11/09/A-hint-system-for-problems-in-org-mode#disqus_thread">Read and Post Comments</a></div>
  <hr class="interblog" />
  





<article>
  <div class="blog_post">
    <header>
      <div id="A-context-sensitive-file-link-menu-in-org-mode"></div>
      <h2 class="blog_post_title"><a href="/blog/2014/11/08/A-context-sensitive-file-link-menu-in-org-mode/" rel="bookmark" title="Permanent Link to A context-sensitive file link menu in org-mode">A context-sensitive file link menu in org-mode</a></h2>
      <p><small><span class="blog_post_date">Posted November 08, 2014 at 10:24 AM</span> | categories:
        <span class="blog_post_categories"><a href='/blog/category/org/'>org</a></span> | tags: 
        | <a href="http://jkitchin.github.io/blog/2014/11/08/A-context-sensitive-file-link-menu-in-org-mode#disqus_thread">View Comments</a>
      <p><small><span class="blog_post_date">Updated November 08, 2014 at 10:26 AM</span>
      </small></p>
    </header>
    <div class="post_prose">
      



<p>
I am still interested in various ways to get more functionality of org-links. For example, we looked at: 
</p>
<ol class="org-ol">
<li><a href="http://kitchingroup.cheme.cmu.edu/blog/2013/10/21/Enabling-right-clicks-in-org-mode-links/">enabling right clicks</a> on links
</li>
<li><a href="http://kitchingroup.cheme.cmu.edu/blog/2014/11/02/A-generalized-org-link-with-an-extendable-menu-of-actions/">new links with menus</a> 
</li>
</ol>

<p>
When you click on a link, the function org-open-at-point runs, which is a <i>large</i> function that does a lot of things. One of them is to check if the link is defined in org-link-protocols, and to run the function definition there if it is. Here is a list of links defined for me. I defined a lot of these in org-ref, and my own init files, so you may not see these on your system.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(mapcar 'car org-link-protocols)
</pre>
</div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />
</colgroup>
<tbody>
<tr>
<td class="left">google</td>
<td class="left">ResearcherID</td>
<td class="left">orcid</td>
<td class="left">message</td>
<td class="left">mac-outlook</td>
<td class="left">skim</td>
<td class="left">addressbook</td>
<td class="left">x-together-item</td>
<td class="left">rmail</td>
<td class="left">mhe</td>
<td class="left">irc</td>
<td class="left">info</td>
<td class="left">gnus</td>
<td class="left">docview</td>
<td class="left">bibtex</td>
<td class="left">bbdb</td>
<td class="left">ans</td>
<td class="left">exercise</td>
<td class="left">solution</td>
<td class="left">assignment</td>
<td class="left">doi</td>
<td class="left">bibentry</td>
<td class="left">Autocites</td>
<td class="left">autocites</td>
<td class="left">supercites</td>
<td class="left">Textcites</td>
<td class="left">textcites</td>
<td class="left">Smartcites</td>
<td class="left">smartcites</td>
<td class="left">footcitetexts</td>
<td class="left">footcites</td>
<td class="left">Parencites</td>
<td class="left">parencites</td>
<td class="left">Cites</td>
<td class="left">cites</td>
<td class="left">fnotecite</td>
<td class="left">Pnotecite</td>
<td class="left">pnotecite</td>
<td class="left">Notecite</td>
<td class="left">notecite</td>
<td class="left">footfullcite</td>
<td class="left">fullcite</td>
<td class="left">citeurl</td>
<td class="left">citedate*</td>
<td class="left">citedate</td>
<td class="left">citetitle*</td>
<td class="left">citetitle</td>
<td class="left">Citeauthor*</td>
<td class="left">Autocite*</td>
<td class="left">autocite*</td>
<td class="left">Autocite</td>
<td class="left">autocite</td>
<td class="left">supercite</td>
<td class="left">parencite*</td>
<td class="left">cite*</td>
<td class="left">Smartcite</td>
<td class="left">smartcite</td>
<td class="left">Textcite</td>
<td class="left">textcite</td>
<td class="left">footcitetext</td>
<td class="left">footcite</td>
<td class="left">Parencite</td>
<td class="left">parencite</td>
<td class="left">Cite</td>
<td class="left">Citeauthor</td>
<td class="left">Citealp</td>
<td class="left">Citealt</td>
<td class="left">Citep</td>
<td class="left">Citet</td>
<td class="left">citeyear*</td>
<td class="left">citeyear</td>
<td class="left">citeauthor*</td>
<td class="left">citeauthor</td>
<td class="left">citetext</td>
<td class="left">citenum</td>
<td class="left">citealp*</td>
<td class="left">citealp</td>
<td class="left">citealt*</td>
<td class="left">citealt</td>
<td class="left">citep*</td>
<td class="left">citep</td>
<td class="left">citet*</td>
<td class="left">citet</td>
<td class="left">nocite</td>
<td class="left">cite</td>
<td class="left">eqref</td>
<td class="left">nameref</td>
<td class="left">pageref</td>
<td class="left">ref</td>
<td class="left">label</td>
<td class="left">list-of-tables</td>
<td class="left">list-of-figures</td>
<td class="left">addbibresource</td>
<td class="left">bibliographystyle</td>
<td class="left">printbibliography</td>
<td class="left">nobibliography</td>
<td class="left">bibliography</td>
<td class="left">pydoc</td>
<td class="left">index</td>
<td class="left">attachfile</td>
<td class="left">msx</td>
<td class="left">id</td>
<td class="left">file+emacs</td>
<td class="left">file+sys</td>
</tr>
</tbody>
</table>

<p>
Interestingly, file links are not defined in org-link-protocols, they are handled separately. I would like to change the behavior of file+emacs links. Instead of just opening the file, I want a menu to give me the option to create the file if it does not exist, and to open it in emacs, or with a system program if the file does exist. Let us see what this link does.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(assoc <span style="color: #228b22;">"file+emacs"</span> org-link-protocols)
</pre>
</div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="left" />

<col  class="left" />

<col  class="left" />
</colgroup>
<tbody>
<tr>
<td class="left">file+emacs</td>
<td class="left">org-open-file-with-emacs</td>
<td class="left">nil</td>
</tr>
</tbody>
</table>

<p>
When you click on the link, it runs org-open-file-with-emacs, and there is no formatting function defined.
</p>

<p>
So, let us define a list of functions that could make a menu. A new variation we use in this post is that each element of the list will be a (key menu-name action-func visible-p) list. visible-p will be a function that determines if the function is listed in the menu. That way, our menu will be context specific.
</p>

<p>
We want an option to create a file if it does not exist, and if it does exist, a choice to open in emacs, or a system program. So the idea here is to create the menu in a variable (so it easy to add to later), then when you click on the link it will run a menu function that  filters the functions to run, and then prompt you for a selection. 
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #8b0000;">defvar</span> <span style="color: #8b008b;">file+emacs-menu</span> '()
  <span style="color: #228b22;">"list of menu entries. (key name action visible).</span>
<span style="color: #228b22;">key is a character to select.</span>
<span style="color: #228b22;">name is what shows in the menu as [key]name</span>
<span style="color: #228b22;">action is a function that takes a path</span>
<span style="color: #228b22;">visible is a function that determines if the entry is in the menu."</span>)

(setq file+emacs-menu 
      '((<span style="color: #228b22;">"c"</span> <span style="color: #228b22;">"reate"</span>
         find-file ; <span style="color: #ff0000; font-weight: bold;">action function</span>
         (<span style="color: #8b0000;">lambda</span> (x) (not (file-exists-p x)))) ; <span style="color: #ff0000; font-weight: bold;">visible-p</span>
        (<span style="color: #228b22;">"o"</span> <span style="color: #228b22;">"pen"</span>
         org-open-file-with-emacs
         (<span style="color: #8b0000;">lambda</span> (x) (file-exists-p x)))
        (<span style="color: #228b22;">"e"</span> <span style="color: #228b22;">"xternal open"</span>
         (<span style="color: #8b0000;">lambda</span> (x) (org-open-file path '(16)))
         (<span style="color: #8b0000;">lambda</span> (x) (file-exists-p x)))))


(<span style="color: #8b0000;">defun</span> <span style="color: #8b2323;">file+emacs-menu</span> (path)
  <span style="color: #228b22;">"menu command for file+emacs links"</span>
  (interactive)
  (<span style="color: #8b0000;">let*</span> ((filtered-menu-list (-filter
                              (<span style="color: #8b0000;">lambda</span> (x) (funcall (car (last x)) path))
                              file+emacs-menu))
         (menu-string (concat
                       (mapconcat
                        (<span style="color: #8b0000;">lambda</span> (tup)
                          (concat <span style="color: #228b22;">"["</span> (elt tup 0) <span style="color: #228b22;">"]"</span>
                                  (elt tup 1) <span style="color: #228b22;">" "</span>))
                        filtered-menu-list
                        <span style="color: #228b22;">""</span>) <span style="color: #228b22;">": "</span>))
         (input (read-char-exclusive menu-string nil 1))
         (selected-func (and
                         input
                         (elt 
                          (assoc
                           (char-to-string input) filtered-menu-list)
                          2))))
    (<span style="color: #8b0000;">when</span> selected-func
      (funcall selected-func path))))
</pre>
</div>

<pre class="example">
file+emacs-menu
</pre>

<p>
Now we need to change the link definition in org-link-protocols. setf comes to the rescue. We just get the whole entry, and then setf the second position in it like this.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(setf (elt (assoc <span style="color: #228b22;">"file+emacs"</span> org-link-protocols) 1)
  'file+emacs-menu)
</pre>
</div>

<pre class="example">
file+emacs-menu
</pre>

<p>
Here we just confirm we set it.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(assoc <span style="color: #228b22;">"file+emacs"</span> org-link-protocols)
</pre>
</div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="left" />

<col  class="left" />

<col  class="left" />
</colgroup>
<tbody>
<tr>
<td class="left">file+emacs</td>
<td class="left">file+emacs-menu</td>
<td class="left">nil</td>
</tr>
</tbody>
</table>

<p>
Now, when we click on these links, we get our context specific menu. When 
</p>

<p>
This file exists: <a href="/media/2014-11-08-A-context-sensitive-file-link-menu-in-org-mode/ase-db.org">ase-db.org</a> so we see this menu:
</p>

<div class="figure">
<p><img src="/media/2014-11-08-A-context-sensitive-file-link-menu-in-org-mode/open-menu.png"> 
</p>
</div>

<p>
This file does not exist: <a href="test.noext">test.noext</a> 
So we see:
</p>

<div class="figure">
<p><img src="/media/2014-11-08-A-context-sensitive-file-link-menu-in-org-mode/create-menu.png"> 
</p>
</div>

<p>
For these, we can select to open them in a pdf reader or MS Word from our new menu.
<a href="/media/2014-11-08-A-context-sensitive-file-link-menu-in-org-mode/attaching-code-blocks-to-a-pdf.pdf">attaching-code-blocks-to-a-pdf.pdf</a> 
</p>

<p>
<a href="/media/2014-11-08-A-context-sensitive-file-link-menu-in-org-mode/org-to-word.docx">org-to-word.docx</a> 
</p>

<p>
I admit this example was a little contrived. You can do most of these things with prefix commands, or more specific commands in emacs. But, I rarely remember those. I would have preferred to use the file link in this example, but it is not defined in org-link-protocols, so this style of modification would not work, and I did not want to add it to org-link-protocols just to show how to change it this way. 
</p>

<p>
This general approach would be very useful for links where there may be multiple contexts or actions that make sense. For file links, you may want do different things if the file already exists, or if it does not exist. As another example, my <a href="https://github.com/jkitchin/jmax/blob/master/org/doi-utils.org#a-new-doi-link-for-org-mode">doi link</a> gives me a menu to:
</p>
<ol class="org-ol">
<li>open in <a href="http://dx.doi.org">http://dx.doi.org</a> 
</li>
<li>open the doi in Web of Science
</li>
<li>find citing articles in Web of Science
</li>
<li>search the doi in Google Scholar
</li>
<li>open the doi in CrossRef
</li>
<li>open the doi in Pubmed
</li>
<li>find the doi in my bibtex file
</li>
<li>get a bibtex entry for the doi
</li>
</ol>

<p>
I get all that from a click! org-ref offers similar functionality for cite links, where you might want to do different things from a click:
</p>
<ol class="org-ol">
<li>See preview of the citation
</li>
<li>open the bibtex entry
</li>
<li>open the pdf if you have it
</li>
<li>open the url for the entry
</li>
<li>any of the things I listed for the doi example above.
</li>
</ol>

<p>
I am sure there are many other things that might be useful to do!
</p>
<p>Copyright (C) 2014 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2014/11/08/A-context-sensitive-file-link-menu-in-org-mode.org">org-mode source</a><p><p>Org-mode version = 8.2.7c</p>

    </div>
  </div>
</article>



<a href="https://twitter.com/share" class="twitter-share-button" data-via="johnkitchin">Tweet</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>

  <div class="after_post"><a href="http://jkitchin.github.io/blog/2014/11/08/A-context-sensitive-file-link-menu-in-org-mode#disqus_thread">Read and Post Comments</a></div>
  <hr class="interblog" />
  





<article>
  <div class="blog_post">
    <header>
      <div id="Accessing-web-of-science-entry-citing-and-related-articles-from-a-doi-in-emacs"></div>
      <h2 class="blog_post_title"><a href="/blog/2014/11/04/Accessing-web-of-science-entry-citing-and-related-articles-from-a-doi-in-emacs/" rel="bookmark" title="Permanent Link to Accessing web of science entry, citing and related articles from a doi in emacs">Accessing web of science entry, citing and related articles from a doi in emacs</a></h2>
      <p><small><span class="blog_post_date">Posted November 04, 2014 at 09:18 PM</span> | categories:
        <span class="blog_post_categories"><a href='/blog/category/emacs/'>emacs</a>, <a href='/blog/category/org-ref/'>org-ref</a>, <a href='/blog/category/orgmode/'>orgmode</a></span> | tags: 
        | <a href="http://jkitchin.github.io/blog/2014/11/04/Accessing-web-of-science-entry-citing-and-related-articles-from-a-doi-in-emacs#disqus_thread">View Comments</a>
      <p><small><span class="blog_post_date">Updated November 05, 2014 at 10:55 AM</span>
      </small></p>
    </header>
    <div class="post_prose">
      




<p>
I have been investigating how to more deeply integrate online resources, scientific bibliographies and writing in Emacs. One feature I have been wanting is integration with <a href="http://apps.webofknowledge.com/UA_GeneralSearch_input.do?product=UA&search_mode=GeneralSearch&SID=4DwqzHSXl8YdqGjGQ2z&preferencesSaved=">Web Of Science</a> , especially to find citing and related articles from a DOI. This service is not free, but is available at many places where science is done. I came across this API <a href="http://wokinfo.com/media/pdf/OpenURL-guide.pdf">http://wokinfo.com/media/pdf/OpenURL-guide.pdf</a> to make links to the things I am interested in here. Based on that document, here are three links based on a <a href="10.1021/jp047349j">10.1021/jp047349j</a> that take you to different Web Of Science (WOS) pages.
</p>


<ol class="org-ol">
<li>go to article in WOS: <a href="http://ws.isiknowledge.com/cps/openurl/service?url_ver=Z39.88-2004&rft_id=info:doi/10.1021/jp047349j">http://ws.isiknowledge.com/cps/openurl/service?url_ver=Z39.88-2004&rft_id=info:doi/10.1021/jp047349j</a> 
</li>
<li>citing articles: <a href="http://ws.isiknowledge.com/cps/openurl/service?url_ver=Z39.88-2004&rft_id=info%3Adoi%2F10.1021/jp047349j&svc_val_fmt=info%3Aofi%2Ffmt%3Akev%3Amtx%3Asch_svc&svc.citing=yes">http://ws.isiknowledge.com/cps/openurl/service?url_ver=Z39.88-2004&rft_id=info%3Adoi%2F10.1021/jp047349j&svc_val_fmt=info%3Aofi%2Ffmt%3Akev%3Amtx%3Asch_svc&svc.citing=yes</a> 
</li>
<li>related articles: <a href="http://ws.isiknowledge.com/cps/openurl/service?url_ver=Z39.88-2004&rft_id=info%3Adoi%2F10.1021/jp047349j&svc_val_fmt=info%3Aofi%2Ffmt%3Akev%3Amtx%3Asch_svc&svc.related=yes">http://ws.isiknowledge.com/cps/openurl/service?url_ver=Z39.88-2004&rft_id=info%3Adoi%2F10.1021/jp047349j&svc_val_fmt=info%3Aofi%2Ffmt%3Akev%3Amtx%3Asch_svc&svc.related=yes</a> 
</li>
</ol>

<p>
These are pretty easy to construct, so we can write functions that will create them and open the url in our browser. There are some other options that could be considered, but since we usually have a doi, it seems like the best way to go for creating the links. Here are the functions.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #8b0000;">defun</span> <span style="color: #8b2323;">doi-utils-wos</span> (doi)
  <span style="color: #228b22;">"Open Web of Science entry for DOI"</span>
  (interactive <span style="color: #228b22;">"sDOI: "</span>)
  (browse-url
   (format
    <span style="color: #228b22;">"http://ws.isiknowledge.com/cps/openurl/service?url_ver=Z39.88-2004&amp;rft_id=info:doi/%s"</span> doi)))

(<span style="color: #8b0000;">defun</span> <span style="color: #8b2323;">doi-utils-wos-citing</span> (doi)
  <span style="color: #228b22;">"Open Web of Science citing articles entry. May be empty if none are found"</span>
  (interactive <span style="color: #228b22;">"sDOI: "</span>)
  (browse-url
   (concat
    <span style="color: #228b22;">"http://ws.isiknowledge.com/cps/openurl/service?url_ver=Z39.88-2004&amp;rft_id=info%3Adoi%2F"</span>
    doi
    <span style="color: #228b22;">"&amp;svc_val_fmt=info%3Aofi%2Ffmt%3Akev%3Amtx%3Asch_svc&amp;svc.citing=yes"</span>)))

(<span style="color: #8b0000;">defun</span> <span style="color: #8b2323;">doi-utils-wos-related</span> (doi)
  <span style="color: #228b22;">"Open Web of Science related articles page."</span>
  (interactive <span style="color: #228b22;">"sDOI: "</span>)
  (browse-url
   (concat <span style="color: #228b22;">"http://ws.isiknowledge.com/cps/openurl/service?url_ver=Z39.88-2004&amp;rft_id=info%3Adoi%2F"</span>
           doi
           <span style="color: #228b22;">"&amp;svc_val_fmt=info%3Aofi%2Ffmt%3Akev%3Amtx%3Asch_svc&amp;svc.related=yes"</span>)))
</pre>
</div>

<pre class="example">
doi-utils-wos-related
</pre>

<p>
These are exciting because they could be integrated into org-ref or doi-utils to make citations in an org-document even more functional! There are some other interesting things <a href="http://bibwild.wordpress.com/2009/04/13/cited-by-from-isi-and-scopus-in-the-link-resolver/">here</a> about Scopus and issues with ISI that I note for reference to future me.
</p>

<p>
Some of these are now included in <a href="https://github.com/jkitchin/jmax/blob/master/jmax-bibtex.el">jmax-bibtex.el</a> and <a href="https://github.com/jkitchin/jmax/blob/master/org/doi-utils.org">doi-utils.org</a> .
</p>
<p>Copyright (C) 2014 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2014/11/04/Accessing-web-of-science-entry,-citing-and-related-articles-from-a-doi-in-emacs.org">org-mode source</a><p><p>Org-mode version = 8.2.7c</p>

    </div>
  </div>
</article>



<a href="https://twitter.com/share" class="twitter-share-button" data-via="johnkitchin">Tweet</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>

  <div class="after_post"><a href="http://jkitchin.github.io/blog/2014/11/04/Accessing-web-of-science-entry-citing-and-related-articles-from-a-doi-in-emacs#disqus_thread">Read and Post Comments</a></div>
  <hr class="interblog" />
 <a href="../44"> Previous Page</a>
  --  
 <a href="../46">Next Page </a>

          </div>
          <div id="sidebar" class="grid_4">
            <aside>
<section>
<script>
  (function() {
    var cx = '002533177287215655227:l7uvu35ssbc';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
        '//www.google.com/cse/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>
</section>

<section>
    <h1 class="post_header_gradient theme_font">Twitter</h1>
    <a class="twitter-timeline" href="https://twitter.com/johnkitchin" data-widget-id="545217643582881792">Tweets by @johnkitchin</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+"://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
</section>


  <section>
    <h1 class="post_header_gradient theme_font">Links</h1>
    <ul>
      <li><a href="https://www.continuum.io">Anaconda Python</a></li>
      <li><a href="/pycse">Pycse</a></li>
      <li><a href="/dft-book">DFT-book</a></li>
    </ul>
  </section>

  <section>
    <h1 class="post_header_gradient theme_font">Latest Posts</h1>
    <ul>
      <li><a href="/blog/2018/05/09/Making-it-easier-to-extend-the-export-of-org-mode-links-with-generic-functions/">Making it easier to extend the export of org-mode links with generic functions</a></li>
      <li><a href="/blog/2018/04/16/New-publication-in-Nature-Catalysis/">New publication in Nature Catalysis</a></li>
      <li><a href="/blog/2018/04/11/Caching-searches-using-biblio-and-only-seeing-new-results/">Caching searches using biblio and only seeing new results</a></li>
      <li><a href="/blog/2018/04/09/Zhitao-Guo-receives-the-2017-2018-James-C-Meade-Fellowship-in-Chemical-Engineering/">Zhitao Guo receives the 2017-2018 James C. Meade Fellowship in Chemical Engineering</a></li>
      <li><a href="/blog/2018/04/01/New-publication-in-Catalysis-Today/">New publication in Catalysis Today</a></li>
    </ul>
  </section>

<section>
<h1 class="post_header_gradient theme_font">Latest GitHub Repos</h1>
  <a href="https://github.com/jkitchin">@jkitchin</a> on GitHub.
  <ul id="my-github-projects">
        <li class="loading">Status updating&#8230;</li>
  </ul>

</section>
</aside>

          </div>
          <div class="clear"></div>
        </div>
      </div>
      
<footer>
  <div id="footer" class="grid_12">
    <div class="grid_8">
      <p>
        <a href="/blog/feed/index.xml">RSS</a>
        <a href="http://kitchinresearchgroup.disqus.com/latest.rss">Comments RSS Feed</a>.
      </p>
    </div>
    <div class="grid_4" id="credits">
      <p>
        Copyright 2018
        John Kitchin
      </p>
      <p>
        Powered by <a href="http://www.blogofile.com">Blogofile</a>
      </p>
    </div>
  </div>
</footer>

    </div>
      <script src="//ajax.googleapis.com/ajax/libs/jquery/1.5.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="/js/libs/jquery-1.5.1.min.js"%3E%3C/script%3E'))</script>
  <script src="/js/plugins.js"></script>
  <script src="/js/script.js"></script>
  <script src="/js/jquery.tweet.js"></script>  
  <script src="/js/site.js"></script>
  <!--[if lt IE 7 ]>
  <script src="js/libs/dd_belatedpng.js"></script>
  <script> DD_belatedPNG.fix('img, .png_bg');</script>
  <![endif]-->
  <script>
      var _gaq=[['_setAccount','UA-35731398-1'],['_trackPageview']];
      (function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];g.async=1;
      g.src=('https:'==location.protocol?'//ssl':'//www')+'.google-analytics.com/ga.js';
      s.parentNode.insertBefore(g,s)}(document,'script'));
  </script>
  <script>
  (function() {
      var links = document.getElementsByTagName('a');
      var query = '?';
      for(var i = 0; i < links.length; i++) {
          if(links[i].href.indexOf('#disqus_thread') >= 0) {
              query += 'url' + i + '=' + encodeURIComponent(links[i].href) + '&';
          }
      }
      document.write('<script charset="utf-8" type="text/javascript" src="http://disqus.com/forums/kitchinresearchgroup/get_num_replies.js' + query + '"></' + 'script>');
  })();
  </script>

  </body>
</html>






<script src="http://ajax.microsoft.com/ajax/jquery/jquery-1.4.2.min.js" type="text/javascript"></script>
<script src="/js/git.js" type="text/javascript"></script>
<script type="text/javascript">
    $(function() {
     $("#my-github-projects").loadRepositories("jkitchin");
    });
</script>



