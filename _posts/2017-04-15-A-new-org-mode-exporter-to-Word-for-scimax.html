---
title: A new org-mode exporter to Word for scimax
date: 2017/04/15 16:19:05
updated: 2017/04/15 16:21:23
categories: emacs,orgmode,export
tags: 
---


<p>
I am continuing to chip away to getting a reasonable export behavior for org-mode to MS Word. I have previously made some progress with Pandoc <a href="http://kitchingroup.cheme.cmu.edu/blog/2015/01/29/Export-org-mode-to-docx-with-citations-via-pandoc/">here</a> and <a href="http://kitchingroup.cheme.cmu.edu/blog/2015/06/11/ox-pandoc-org-mode-+-org-ref-to-docx-with-bibliographies/">here</a>, but those solutions never stuck with me. So here is another go. Here I leverage Pandoc again, but use a path through LaTeX to get citations without modifying the org-ref cite link syntax. The code for this can be found here: <a href="https://github.com/jkitchin/scimax/blob/master/ox-word.el">https://github.com/jkitchin/scimax/blob/master/ox-word.el</a>. The gist is you use org-ref like you always do, and you specify the bibliography style for Pandoc like this:
</p>

<p>
<img src="/media/date-15-04-2017-time-16-06-53.png"> 
</p>

<p>
You can download other csl files at <a href="https://www.zotero.org/styles">https://www.zotero.org/styles</a>. Then you can simply export the org-doc to a Word document with the key-binding C-c C-e w p.
</p>

<p>
Here is an example document to illustrate the exporter. I have written about data sharing in catalysis <a class='org-ref-reference' href="#kitchin-2015-examp">kitchin-2015-examp</a> and surface science <a class='org-ref-reference' href="#kitchin-2015-data-surfac-scien">kitchin-2015-data-surfac-scien</a>.
</p>

<p>
Here is an example source block.
</p>

<div class="org-src-container">
<pre class="src src-ipython">%matplotlib inline
<span style="color: #0000FF;">import</span> matplotlib.pyplot <span style="color: #0000FF;">as</span> plt

plt.plot([1, 2, 3, 4, 5, 6])
</pre>
</div>

<p>
<img src="/media/ob-ipython-b8591826ba9e316738705d03264316a5.png"> 
</p>

<p>
See Ref. <a href="#fig:line">fig:line</a> for example. These do not work. That might require additional pre-processing to replace them with numbers.
</p>

<p>
Here is the Word document that is generated: <a href="/media/2017-04-15.docx">2017-04-15.docx</a> 
</p>

<p>
As a penultimate result it might be ok. The references are reasonably formatted, but not compatible with Endnote, or other bibliography manager software. There are still some issues with Figure numbering and cross-references, but it is not too bad. The main benefit of this seems to be that one source generates HTML and the Word document.
</p>

<p>

<h1 class='org-ref-bib-h1'>Bibliography</h1>
<ul class='org-ref-bib'><li><a id="kitchin-2015-examp">[kitchin-2015-examp] Kitchin, Examples of Effective Data Sharing in Scientific Publishing, <i>ACS Catalysis</i>, <b>5(6)</b>, 3894-3899 (2015). <a href=" http://dx.doi.org/10.1021/acscatal.5b00538 ">link</a>. <a href="http://dx.doi.org/10.1021/acscatal.5b00538">doi</a>.</a></li>
<li><a id="kitchin-2015-data-surfac-scien">[kitchin-2015-data-surfac-scien] "John Kitchin", Data Sharing in Surface Science, <i>"Surface Science "</i>, <b>647</b>, 103-107 (2016). <a href="http://www.sciencedirect.com/science/article/pii/S0039602815001326">link</a>. <a href="http://dx.doi.org/10.1016/j.susc.2015.05.007">doi</a>.</a></li>
</ul>
</p>
<p>Copyright (C) 2017 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p>
<p><a href="/org/2017/04/15/A-new-org-mode-exporter-to-Word-for-scimax.org">org-mode source</a></p>
<p>Org-mode version = 9.0.5</p>